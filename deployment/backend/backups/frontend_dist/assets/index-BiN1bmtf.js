import{_ as Eo,j as e,B as F,C as se,a as vt,V as S,H as me,T as d,b as re,c as Kr,d as Jr,e as Pt,f as Qr,g as Lt,A as kt,h as Et,F as $,i as V,I as ve,k as H,l as dn,u as Fe,m as _e,n as Wt,o as It,p as Fn,S as ua,q as A,r as et,M as jc,s as yc,t as Ei,v as bc,w as Pr,x as Jd,D as wc,y as Te,z as Sc,E as De,G as Pe,J as Le,K as mt,L as $e,N as je,O as wt,P as Xn,Q as wn,R as Ue,U as He,W as Io,X as xe,Y as be,Z as we,$ as Se,a0 as ot,a1 as xt,a2 as zo,a3 as Ot,a4 as ut,a5 as Ao,a6 as Lr,a7 as Rr,a8 as Mr,a9 as Or,aa as ue,ab as de,ac as Re,ad as Me,ae as Oe,af as _t,ag as Qd,ah as Gs,ai as da,aj as jr,ak as Be,al as vc,am as Ii,an as zi,ao as Ai,ap as Ys,aq as Ks,ar as ht,as as Ht,at as Qt,au as $t,av as Rn,aw as ur,ax as Kt,ay as ui,az as To,aA as Xd,aB as Zd,aC as eh,aD as ha,aE as Hn,aF as th,aG as $n,aH as ft,aI as bt,aJ as Yn,aK as ga,aL as pa,aM as fa,aN as nh,aO as rh,aP as ih,aQ as sh,aR as oh,aS as ah}from"./chakra-1fE3GpX8.js";import{b as lh,r as C,a as jn,c as Ti,g as _c}from"./vendor-BTukGEff.js";import{u as Xi,a as Cc,R as kc,b as St,B as ch,N as Ec}from"./router-DLIK_EF6.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}})();var Js={},ma=lh;Js.createRoot=ma.createRoot,Js.hydrateRoot=ma.hydrateRoot;var xa={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ic=function(t){const n=[];let r=0;for(let i=0;i<t.length;i++){let s=t.charCodeAt(i);s<128?n[r++]=s:s<2048?(n[r++]=s>>6|192,n[r++]=s&63|128):(s&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++i)&1023),n[r++]=s>>18|240,n[r++]=s>>12&63|128,n[r++]=s>>6&63|128,n[r++]=s&63|128):(n[r++]=s>>12|224,n[r++]=s>>6&63|128,n[r++]=s&63|128)}return n},uh=function(t){const n=[];let r=0,i=0;for(;r<t.length;){const s=t[r++];if(s<128)n[i++]=String.fromCharCode(s);else if(s>191&&s<224){const o=t[r++];n[i++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=t[r++],a=t[r++],l=t[r++],c=((s&7)<<18|(o&63)<<12|(a&63)<<6|l&63)-65536;n[i++]=String.fromCharCode(55296+(c>>10)),n[i++]=String.fromCharCode(56320+(c&1023))}else{const o=t[r++],a=t[r++];n[i++]=String.fromCharCode((s&15)<<12|(o&63)<<6|a&63)}}return n.join("")},zc={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,n){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=n?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<t.length;s+=3){const o=t[s],a=s+1<t.length,l=a?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,h=o>>2,g=(o&3)<<4|l>>4;let m=(l&15)<<2|u>>6,p=u&63;c||(p=64,a||(m=64)),i.push(r[h],r[g],r[m],r[p])}return i.join("")},encodeString(t,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(t):this.encodeByteArray(Ic(t),n)},decodeString(t,n){return this.HAS_NATIVE_SUPPORT&&!n?atob(t):uh(this.decodeStringToByteArray(t,n))},decodeStringToByteArray(t,n){this.init_();const r=n?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<t.length;){const o=r[t.charAt(s++)],l=s<t.length?r[t.charAt(s)]:0;++s;const u=s<t.length?r[t.charAt(s)]:64;++s;const g=s<t.length?r[t.charAt(s)]:64;if(++s,o==null||l==null||u==null||g==null)throw new dh;const m=o<<2|l>>4;if(i.push(m),u!==64){const p=l<<4&240|u>>2;if(i.push(p),g!==64){const j=u<<6&192|g;i.push(j)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class dh extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const hh=function(t){const n=Ic(t);return zc.encodeByteArray(n,!0)},Ac=function(t){return hh(t).replace(/\./g,"")},Tc=function(t){try{return zc.decodeString(t,!0)}catch(n){console.error("base64Decode failed: ",n)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gh(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ph=()=>gh().__FIREBASE_DEFAULTS__,fh=()=>{if(typeof process>"u"||typeof xa>"u")return;const t=xa.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},mh=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const n=t&&Tc(t[1]);return n&&JSON.parse(n)},Po=()=>{try{return ph()||fh()||mh()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},xh=t=>{var n,r;return(r=(n=Po())===null||n===void 0?void 0:n.emulatorHosts)===null||r===void 0?void 0:r[t]},Pc=()=>{var t;return(t=Po())===null||t===void 0?void 0:t.config},Lc=t=>{var n;return(n=Po())===null||n===void 0?void 0:n[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((n,r)=>{this.resolve=n,this.reject=r})}wrapCallback(n){return(r,i)=>{r?this.reject(r):this.resolve(i),typeof n=="function"&&(this.promise.catch(()=>{}),n.length===1?n(r):n(r,i))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function yh(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Rt())}function bh(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function wh(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Sh(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function vh(){const t=Rt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function _h(){try{return typeof indexedDB=="object"}catch{return!1}}function Ch(){return new Promise((t,n)=>{try{let r=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(i),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var o;n(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(r){n(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kh="FirebaseError";class Dn extends Error{constructor(n,r,i){super(r),this.code=n,this.customData=i,this.name=kh,Object.setPrototypeOf(this,Dn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Xr.prototype.create)}}class Xr{constructor(n,r,i){this.service=n,this.serviceName=r,this.errors=i}create(n,...r){const i=r[0]||{},s=`${this.service}/${n}`,o=this.errors[n],a=o?Eh(o,i):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new Dn(s,l,i)}}function Eh(t,n){return t.replace(Ih,(r,i)=>{const s=n[i];return s!=null?String(s):`<${i}?>`})}const Ih=/\{\$([^}]+)}/g;function zh(t){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n))return!1;return!0}function Pi(t,n){if(t===n)return!0;const r=Object.keys(t),i=Object.keys(n);for(const s of r){if(!i.includes(s))return!1;const o=t[s],a=n[s];if(ja(o)&&ja(a)){if(!Pi(o,a))return!1}else if(o!==a)return!1}for(const s of i)if(!r.includes(s))return!1;return!0}function ja(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zr(t){const n=[];for(const[r,i]of Object.entries(t))Array.isArray(i)?i.forEach(s=>{n.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):n.push(encodeURIComponent(r)+"="+encodeURIComponent(i));return n.length?"&"+n.join("&"):""}function Ar(t){const n={};return t.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[s,o]=i.split("=");n[decodeURIComponent(s)]=decodeURIComponent(o)}}),n}function Tr(t){const n=t.indexOf("?");if(!n)return"";const r=t.indexOf("#",n);return t.substring(n,r>0?r:void 0)}function Ah(t,n){const r=new Th(t,n);return r.subscribe.bind(r)}class Th{constructor(n,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{n(this)}).catch(i=>{this.error(i)})}next(n){this.forEachObserver(r=>{r.next(n)})}error(n){this.forEachObserver(r=>{r.error(n)}),this.close(n)}complete(){this.forEachObserver(n=>{n.complete()}),this.close()}subscribe(n,r,i){let s;if(n===void 0&&r===void 0&&i===void 0)throw new Error("Missing Observer.");Ph(n,["next","error","complete"])?s=n:s={next:n,error:r,complete:i},s.next===void 0&&(s.next=gs),s.error===void 0&&(s.error=gs),s.complete===void 0&&(s.complete=gs);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(n){this.observers===void 0||this.observers[n]===void 0||(delete this.observers[n],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(n){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,n)}sendOne(n,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[n]!==void 0)try{r(this.observers[n])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(n){this.finalized||(this.finalized=!0,n!==void 0&&(this.finalError=n),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Ph(t,n){if(typeof t!="object"||t===null)return!1;for(const r of n)if(r in t&&typeof t[r]=="function")return!0;return!1}function gs(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(t){return t&&t._delegate?t._delegate:t}class yr{constructor(n,r,i){this.name=n,this.instanceFactory=r,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(n){return this.instantiationMode=n,this}setMultipleInstances(n){return this.multipleInstances=n,this}setServiceProps(n){return this.serviceProps=n,this}setInstanceCreatedCallback(n){return this.onInstanceCreated=n,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{constructor(n,r){this.name=n,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(n){const r=this.normalizeInstanceIdentifier(n);if(!this.instancesDeferred.has(r)){const i=new jh;if(this.instancesDeferred.set(r,i),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(n){var r;const i=this.normalizeInstanceIdentifier(n?.identifier),s=(r=n?.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(n){if(n.name!==this.name)throw Error(`Mismatching Component ${n.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=n,!!this.shouldAutoInitialize()){if(Mh(n))try{this.getOrInitializeService({instanceIdentifier:Gn})}catch{}for(const[r,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:s});i.resolve(o)}catch{}}}}clearInstance(n=Gn){this.instancesDeferred.delete(n),this.instancesOptions.delete(n),this.instances.delete(n)}async delete(){const n=Array.from(this.instances.values());await Promise.all([...n.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...n.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(n=Gn){return this.instances.has(n)}getOptions(n=Gn){return this.instancesOptions.get(n)||{}}initialize(n={}){const{options:r={}}=n,i=this.normalizeInstanceIdentifier(n.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:r});for(const[o,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(o);i===l&&a.resolve(s)}return s}onInit(n,r){var i;const s=this.normalizeInstanceIdentifier(r),o=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;o.add(n),this.onInitCallbacks.set(s,o);const a=this.instances.get(s);return a&&n(a,s),()=>{o.delete(n)}}invokeOnInitCallbacks(n,r){const i=this.onInitCallbacks.get(r);if(i)for(const s of i)try{s(n,r)}catch{}}getOrInitializeService({instanceIdentifier:n,options:r={}}){let i=this.instances.get(n);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Rh(n),options:r}),this.instances.set(n,i),this.instancesOptions.set(n,r),this.invokeOnInitCallbacks(i,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,i)}catch{}return i||null}normalizeInstanceIdentifier(n=Gn){return this.component?this.component.multipleInstances?n:Gn:n}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Rh(t){return t===Gn?void 0:t}function Mh(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(n){this.name=n,this.providers=new Map}addComponent(n){const r=this.getProvider(n.name);if(r.isComponentSet())throw new Error(`Component ${n.name} has already been registered with ${this.name}`);r.setComponent(n)}addOrOverwriteComponent(n){this.getProvider(n.name).isComponentSet()&&this.providers.delete(n.name),this.addComponent(n)}getProvider(n){if(this.providers.has(n))return this.providers.get(n);const r=new Lh(n,this);return this.providers.set(n,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ze;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ze||(Ze={}));const Fh={debug:Ze.DEBUG,verbose:Ze.VERBOSE,info:Ze.INFO,warn:Ze.WARN,error:Ze.ERROR,silent:Ze.SILENT},Dh=Ze.INFO,Nh={[Ze.DEBUG]:"log",[Ze.VERBOSE]:"log",[Ze.INFO]:"info",[Ze.WARN]:"warn",[Ze.ERROR]:"error"},Wh=(t,n,...r)=>{if(n<t.logLevel)return;const i=new Date().toISOString(),s=Nh[n];if(s)console[s](`[${i}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${n})`)};class Rc{constructor(n){this.name=n,this._logLevel=Dh,this._logHandler=Wh,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(n){if(!(n in Ze))throw new TypeError(`Invalid value "${n}" assigned to \`logLevel\``);this._logLevel=n}setLogLevel(n){this._logLevel=typeof n=="string"?Fh[n]:n}get logHandler(){return this._logHandler}set logHandler(n){if(typeof n!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=n}get userLogHandler(){return this._userLogHandler}set userLogHandler(n){this._userLogHandler=n}debug(...n){this._userLogHandler&&this._userLogHandler(this,Ze.DEBUG,...n),this._logHandler(this,Ze.DEBUG,...n)}log(...n){this._userLogHandler&&this._userLogHandler(this,Ze.VERBOSE,...n),this._logHandler(this,Ze.VERBOSE,...n)}info(...n){this._userLogHandler&&this._userLogHandler(this,Ze.INFO,...n),this._logHandler(this,Ze.INFO,...n)}warn(...n){this._userLogHandler&&this._userLogHandler(this,Ze.WARN,...n),this._logHandler(this,Ze.WARN,...n)}error(...n){this._userLogHandler&&this._userLogHandler(this,Ze.ERROR,...n),this._logHandler(this,Ze.ERROR,...n)}}const Bh=(t,n)=>n.some(r=>t instanceof r);let ya,ba;function Uh(){return ya||(ya=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Hh(){return ba||(ba=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Mc=new WeakMap,Qs=new WeakMap,Oc=new WeakMap,ps=new WeakMap,Lo=new WeakMap;function $h(t){const n=new Promise((r,i)=>{const s=()=>{t.removeEventListener("success",o),t.removeEventListener("error",a)},o=()=>{r(Mn(t.result)),s()},a=()=>{i(t.error),s()};t.addEventListener("success",o),t.addEventListener("error",a)});return n.then(r=>{r instanceof IDBCursor&&Mc.set(r,t)}).catch(()=>{}),Lo.set(n,t),n}function Vh(t){if(Qs.has(t))return;const n=new Promise((r,i)=>{const s=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",a),t.removeEventListener("abort",a)},o=()=>{r(),s()},a=()=>{i(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",o),t.addEventListener("error",a),t.addEventListener("abort",a)});Qs.set(t,n)}let Xs={get(t,n,r){if(t instanceof IDBTransaction){if(n==="done")return Qs.get(t);if(n==="objectStoreNames")return t.objectStoreNames||Oc.get(t);if(n==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Mn(t[n])},set(t,n,r){return t[n]=r,!0},has(t,n){return t instanceof IDBTransaction&&(n==="done"||n==="store")?!0:n in t}};function qh(t){Xs=t(Xs)}function Gh(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(n,...r){const i=t.call(fs(this),n,...r);return Oc.set(i,n.sort?n.sort():[n]),Mn(i)}:Hh().includes(t)?function(...n){return t.apply(fs(this),n),Mn(Mc.get(this))}:function(...n){return Mn(t.apply(fs(this),n))}}function Yh(t){return typeof t=="function"?Gh(t):(t instanceof IDBTransaction&&Vh(t),Bh(t,Uh())?new Proxy(t,Xs):t)}function Mn(t){if(t instanceof IDBRequest)return $h(t);if(ps.has(t))return ps.get(t);const n=Yh(t);return n!==t&&(ps.set(t,n),Lo.set(n,t)),n}const fs=t=>Lo.get(t);function Kh(t,n,{blocked:r,upgrade:i,blocking:s,terminated:o}={}){const a=indexedDB.open(t,n),l=Mn(a);return i&&a.addEventListener("upgradeneeded",c=>{i(Mn(a.result),c.oldVersion,c.newVersion,Mn(a.transaction),c)}),r&&a.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{o&&c.addEventListener("close",()=>o()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const Jh=["get","getKey","getAll","getAllKeys","count"],Qh=["put","add","delete","clear"],ms=new Map;function wa(t,n){if(!(t instanceof IDBDatabase&&!(n in t)&&typeof n=="string"))return;if(ms.get(n))return ms.get(n);const r=n.replace(/FromIndex$/,""),i=n!==r,s=Qh.includes(r);if(!(r in(i?IDBIndex:IDBObjectStore).prototype)||!(s||Jh.includes(r)))return;const o=async function(a,...l){const c=this.transaction(a,s?"readwrite":"readonly");let u=c.store;return i&&(u=u.index(l.shift())),(await Promise.all([u[r](...l),s&&c.done]))[0]};return ms.set(n,o),o}qh(t=>({...t,get:(n,r,i)=>wa(n,r)||t.get(n,r,i),has:(n,r)=>!!wa(n,r)||t.has(n,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(n){this.container=n}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Zh(r)){const i=r.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(r=>r).join(" ")}}function Zh(t){const n=t.getComponent();return n?.type==="VERSION"}const Zs="@firebase/app",Sa="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sn=new Rc("@firebase/app"),eg="@firebase/app-compat",tg="@firebase/analytics-compat",ng="@firebase/analytics",rg="@firebase/app-check-compat",ig="@firebase/app-check",sg="@firebase/auth",og="@firebase/auth-compat",ag="@firebase/database",lg="@firebase/data-connect",cg="@firebase/database-compat",ug="@firebase/functions",dg="@firebase/functions-compat",hg="@firebase/installations",gg="@firebase/installations-compat",pg="@firebase/messaging",fg="@firebase/messaging-compat",mg="@firebase/performance",xg="@firebase/performance-compat",jg="@firebase/remote-config",yg="@firebase/remote-config-compat",bg="@firebase/storage",wg="@firebase/storage-compat",Sg="@firebase/firestore",vg="@firebase/vertexai-preview",_g="@firebase/firestore-compat",Cg="firebase",kg="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eo="[DEFAULT]",Eg={[Zs]:"fire-core",[eg]:"fire-core-compat",[ng]:"fire-analytics",[tg]:"fire-analytics-compat",[ig]:"fire-app-check",[rg]:"fire-app-check-compat",[sg]:"fire-auth",[og]:"fire-auth-compat",[ag]:"fire-rtdb",[lg]:"fire-data-connect",[cg]:"fire-rtdb-compat",[ug]:"fire-fn",[dg]:"fire-fn-compat",[hg]:"fire-iid",[gg]:"fire-iid-compat",[pg]:"fire-fcm",[fg]:"fire-fcm-compat",[mg]:"fire-perf",[xg]:"fire-perf-compat",[jg]:"fire-rc",[yg]:"fire-rc-compat",[bg]:"fire-gcs",[wg]:"fire-gcs-compat",[Sg]:"fire-fst",[_g]:"fire-fst-compat",[vg]:"fire-vertex","fire-js":"fire-js",[Cg]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Li=new Map,Ig=new Map,to=new Map;function va(t,n){try{t.container.addComponent(n)}catch(r){Sn.debug(`Component ${n.name} failed to register with FirebaseApp ${t.name}`,r)}}function Ur(t){const n=t.name;if(to.has(n))return Sn.debug(`There were multiple attempts to register component ${n}.`),!1;to.set(n,t);for(const r of Li.values())va(r,t);for(const r of Ig.values())va(r,t);return!0}function Fc(t,n){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(n)}function an(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zg={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},On=new Xr("app","Firebase",zg);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(n,r,i){this._isDeleted=!1,this._options=Object.assign({},n),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new yr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(n){this.checkDestroyed(),this._automaticDataCollectionEnabled=n}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(n){this._isDeleted=n}checkDestroyed(){if(this.isDeleted)throw On.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ei=kg;function Dc(t,n={}){let r=t;typeof n!="object"&&(n={name:n});const i=Object.assign({name:eo,automaticDataCollectionEnabled:!1},n),s=i.name;if(typeof s!="string"||!s)throw On.create("bad-app-name",{appName:String(s)});if(r||(r=Pc()),!r)throw On.create("no-options");const o=Li.get(s);if(o){if(Pi(r,o.options)&&Pi(i,o.config))return o;throw On.create("duplicate-app",{appName:s})}const a=new Oh(s);for(const c of to.values())a.addComponent(c);const l=new Ag(r,i,a);return Li.set(s,l),l}function Tg(t=eo){const n=Li.get(t);if(!n&&t===eo&&Pc())return Dc();if(!n)throw On.create("no-app",{appName:t});return n}function hr(t,n,r){var i;let s=(i=Eg[t])!==null&&i!==void 0?i:t;r&&(s+=`-${r}`);const o=s.match(/\s|\//),a=n.match(/\s|\//);if(o||a){const l=[`Unable to register library "${s}" with version "${n}":`];o&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&a&&l.push("and"),a&&l.push(`version name "${n}" contains illegal characters (whitespace or "/")`),Sn.warn(l.join(" "));return}Ur(new yr(`${s}-version`,()=>({library:s,version:n}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pg="firebase-heartbeat-database",Lg=1,Hr="firebase-heartbeat-store";let xs=null;function Nc(){return xs||(xs=Kh(Pg,Lg,{upgrade:(t,n)=>{switch(n){case 0:try{t.createObjectStore(Hr)}catch(r){console.warn(r)}}}}).catch(t=>{throw On.create("idb-open",{originalErrorMessage:t.message})})),xs}async function Rg(t){try{const r=(await Nc()).transaction(Hr),i=await r.objectStore(Hr).get(Wc(t));return await r.done,i}catch(n){if(n instanceof Dn)Sn.warn(n.message);else{const r=On.create("idb-get",{originalErrorMessage:n?.message});Sn.warn(r.message)}}}async function _a(t,n){try{const i=(await Nc()).transaction(Hr,"readwrite");await i.objectStore(Hr).put(n,Wc(t)),await i.done}catch(r){if(r instanceof Dn)Sn.warn(r.message);else{const i=On.create("idb-set",{originalErrorMessage:r?.message});Sn.warn(i.message)}}}function Wc(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mg=1024,Og=30*24*60*60*1e3;class Fg{constructor(n){this.container=n,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Ng(r),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var n,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Ca();return((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=Og}),this._storage.overwrite(this._heartbeatsCache))}catch(i){Sn.warn(i)}}async getHeartbeatsHeader(){var n;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Ca(),{heartbeatsToSend:i,unsentEntries:s}=Dg(this._heartbeatsCache.heartbeats),o=Ac(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(r){return Sn.warn(r),""}}}function Ca(){return new Date().toISOString().substring(0,10)}function Dg(t,n=Mg){const r=[];let i=t.slice();for(const s of t){const o=r.find(a=>a.agent===s.agent);if(o){if(o.dates.push(s.date),ka(r)>n){o.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),ka(r)>n){r.pop();break}i=i.slice(1)}return{heartbeatsToSend:r,unsentEntries:i}}class Ng{constructor(n){this.app=n,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return _h()?Ch().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Rg(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(n){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return _a(this.app,{lastSentHeartbeatDate:(r=n.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:n.heartbeats})}else return}async add(n){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return _a(this.app,{lastSentHeartbeatDate:(r=n.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...n.heartbeats]})}else return}}function ka(t){return Ac(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wg(t){Ur(new yr("platform-logger",n=>new Xh(n),"PRIVATE")),Ur(new yr("heartbeat",n=>new Fg(n),"PRIVATE")),hr(Zs,Sa,t),hr(Zs,Sa,"esm2017"),hr("fire-js","")}Wg("");function Bc(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Bg=Bc,Uc=new Xr("auth","Firebase",Bc());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ri=new Rc("@firebase/auth");function Ug(t,...n){Ri.logLevel<=Ze.WARN&&Ri.warn(`Auth (${ei}): ${t}`,...n)}function ji(t,...n){Ri.logLevel<=Ze.ERROR&&Ri.error(`Auth (${ei}): ${t}`,...n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xt(t,...n){throw Ro(t,...n)}function ln(t,...n){return Ro(t,...n)}function Hc(t,n,r){const i=Object.assign(Object.assign({},Bg()),{[n]:r});return new Xr("auth","Firebase",i).create(n,{appName:t.name})}function yn(t){return Hc(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ro(t,...n){if(typeof t!="string"){const r=n[0],i=[...n.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(r,...i)}return Uc.create(t,...n)}function ke(t,n,...r){if(!t)throw Ro(n,...r)}function gn(t){const n="INTERNAL ASSERTION FAILED: "+t;throw ji(n),new Error(n)}function vn(t,n){t||gn(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function no(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Hg(){return Ea()==="http:"||Ea()==="https:"}function Ea(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $g(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Hg()||wh()||"connection"in navigator)?navigator.onLine:!0}function Vg(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(n,r){this.shortDelay=n,this.longDelay=r,vn(r>n,"Short delay should be less than long delay!"),this.isMobile=yh()||Sh()}get(){return $g()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mo(t,n){vn(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return n?`${r}${n.startsWith("/")?n.slice(1):n}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{static initialize(n,r,i){this.fetchImpl=n,r&&(this.headersImpl=r),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;gn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;gn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;gn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qg={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gg=new ti(3e4,6e4);function Nn(t,n){return t.tenantId&&!n.tenantId?Object.assign(Object.assign({},n),{tenantId:t.tenantId}):n}async function Wn(t,n,r,i,s={}){return Vc(t,s,async()=>{let o={},a={};i&&(n==="GET"?a=i:o={body:JSON.stringify(i)});const l=Zr(Object.assign({key:t.config.apiKey},a)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:n,headers:c},o);return bh()||(u.referrerPolicy="no-referrer"),$c.fetch()(qc(t,t.config.apiHost,r,l),u)})}async function Vc(t,n,r){t._canInitEmulator=!1;const i=Object.assign(Object.assign({},qg),n);try{const s=new Kg(t),o=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw di(t,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const l=o.ok?a.errorMessage:a.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw di(t,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw di(t,"email-already-in-use",a);if(c==="USER_DISABLED")throw di(t,"user-disabled",a);const h=i[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Hc(t,h,u);Xt(t,h)}}catch(s){if(s instanceof Dn)throw s;Xt(t,"network-request-failed",{message:String(s)})}}async function ni(t,n,r,i,s={}){const o=await Wn(t,n,r,i,s);return"mfaPendingCredential"in o&&Xt(t,"multi-factor-auth-required",{_serverResponse:o}),o}function qc(t,n,r,i){const s=`${n}${r}?${i}`;return t.config.emulator?Mo(t.config,s):`${t.config.apiScheme}://${s}`}function Yg(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Kg{constructor(n){this.auth=n,this.timer=null,this.promise=new Promise((r,i)=>{this.timer=setTimeout(()=>i(ln(this.auth,"network-request-failed")),Gg.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function di(t,n,r){const i={appName:t.name};r.email&&(i.email=r.email),r.phoneNumber&&(i.phoneNumber=r.phoneNumber);const s=ln(t,n,i);return s.customData._tokenResponse=r,s}function Ia(t){return t!==void 0&&t.enterprise!==void 0}class Jg{constructor(n){if(this.siteKey="",this.recaptchaEnforcementState=[],n.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=n.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=n.recaptchaEnforcementState}getProviderEnforcementState(n){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===n)return Yg(r.enforcementState);return null}isProviderEnabled(n){return this.getProviderEnforcementState(n)==="ENFORCE"||this.getProviderEnforcementState(n)==="AUDIT"}}async function Qg(t,n){return Wn(t,"GET","/v2/recaptchaConfig",Nn(t,n))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xg(t,n){return Wn(t,"POST","/v1/accounts:delete",n)}async function Gc(t,n){return Wn(t,"POST","/v1/accounts:lookup",n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fr(t){if(t)try{const n=new Date(Number(t));if(!isNaN(n.getTime()))return n.toUTCString()}catch{}}async function Zg(t,n=!1){const r=_n(t),i=await r.getIdToken(n),s=Oo(i);ke(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,a=o?.sign_in_provider;return{claims:s,token:i,authTime:Fr(js(s.auth_time)),issuedAtTime:Fr(js(s.iat)),expirationTime:Fr(js(s.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}}function js(t){return Number(t)*1e3}function Oo(t){const[n,r,i]=t.split(".");if(n===void 0||r===void 0||i===void 0)return ji("JWT malformed, contained fewer than 3 sections"),null;try{const s=Tc(r);return s?JSON.parse(s):(ji("Failed to decode base64 JWT payload"),null)}catch(s){return ji("Caught error parsing JWT payload as JSON",s?.toString()),null}}function za(t){const n=Oo(t);return ke(n,"internal-error"),ke(typeof n.exp<"u","internal-error"),ke(typeof n.iat<"u","internal-error"),Number(n.exp)-Number(n.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $r(t,n,r=!1){if(r)return n;try{return await n}catch(i){throw i instanceof Dn&&ep(i)&&t.auth.currentUser===t&&await t.auth.signOut(),i}}function ep({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(n){this.user=n,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(n){var r;if(n){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(n=!1){if(!this.isRunning)return;const r=this.getInterval(n);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(n){n?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(n,r){this.createdAt=n,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Fr(this.lastLoginAt),this.creationTime=Fr(this.createdAt)}_copy(n){this.createdAt=n.createdAt,this.lastLoginAt=n.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mi(t){var n;const r=t.auth,i=await t.getIdToken(),s=await $r(t,Gc(r,{idToken:i}));ke(s?.users.length,r,"internal-error");const o=s.users[0];t._notifyReloadListener(o);const a=!((n=o.providerUserInfo)===null||n===void 0)&&n.length?Yc(o.providerUserInfo):[],l=rp(t.providerData,a),c=t.isAnonymous,u=!(t.email&&o.passwordHash)&&!l?.length,h=c?u:!1,g={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:l,metadata:new ro(o.createdAt,o.lastLoginAt),isAnonymous:h};Object.assign(t,g)}async function np(t){const n=_n(t);await Mi(n),await n.auth._persistUserIfCurrent(n),n.auth._notifyListenersIfCurrent(n)}function rp(t,n){return[...t.filter(i=>!n.some(s=>s.providerId===i.providerId)),...n]}function Yc(t){return t.map(n=>{var{providerId:r}=n,i=Eo(n,["providerId"]);return{providerId:r,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ip(t,n){const r=await Vc(t,{},async()=>{const i=Zr({grant_type:"refresh_token",refresh_token:n}).slice(1),{tokenApiHost:s,apiKey:o}=t.config,a=qc(t,s,"/v1/token",`key=${o}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",$c.fetch()(a,{method:"POST",headers:l,body:i})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function sp(t,n){return Wn(t,"POST","/v2/accounts:revokeToken",Nn(t,n))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(n){ke(n.idToken,"internal-error"),ke(typeof n.idToken<"u","internal-error"),ke(typeof n.refreshToken<"u","internal-error");const r="expiresIn"in n&&typeof n.expiresIn<"u"?Number(n.expiresIn):za(n.idToken);this.updateTokensAndExpiration(n.idToken,n.refreshToken,r)}updateFromIdToken(n){ke(n.length!==0,"internal-error");const r=za(n);this.updateTokensAndExpiration(n,null,r)}async getToken(n,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(ke(this.refreshToken,n,"user-token-expired"),this.refreshToken?(await this.refresh(n,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(n,r){const{accessToken:i,refreshToken:s,expiresIn:o}=await ip(n,r);this.updateTokensAndExpiration(i,s,Number(o))}updateTokensAndExpiration(n,r,i){this.refreshToken=r||null,this.accessToken=n||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(n,r){const{refreshToken:i,accessToken:s,expirationTime:o}=r,a=new gr;return i&&(ke(typeof i=="string","internal-error",{appName:n}),a.refreshToken=i),s&&(ke(typeof s=="string","internal-error",{appName:n}),a.accessToken=s),o&&(ke(typeof o=="number","internal-error",{appName:n}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(n){this.accessToken=n.accessToken,this.refreshToken=n.refreshToken,this.expirationTime=n.expirationTime}_clone(){return Object.assign(new gr,this.toJSON())}_performRefresh(){return gn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function In(t,n){ke(typeof t=="string"||typeof t>"u","internal-error",{appName:n})}class pn{constructor(n){var{uid:r,auth:i,stsTokenManager:s}=n,o=Eo(n,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new tp(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=i,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new ro(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(n){const r=await $r(this,this.stsTokenManager.getToken(this.auth,n));return ke(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(n){return Zg(this,n)}reload(){return np(this)}_assign(n){this!==n&&(ke(this.uid===n.uid,this.auth,"internal-error"),this.displayName=n.displayName,this.photoURL=n.photoURL,this.email=n.email,this.emailVerified=n.emailVerified,this.phoneNumber=n.phoneNumber,this.isAnonymous=n.isAnonymous,this.tenantId=n.tenantId,this.providerData=n.providerData.map(r=>Object.assign({},r)),this.metadata._copy(n.metadata),this.stsTokenManager._assign(n.stsTokenManager))}_clone(n){const r=new pn(Object.assign(Object.assign({},this),{auth:n,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(n){ke(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=n,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(n){this.reloadListener?this.reloadListener(n):this.reloadUserInfo=n}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(n,r=!1){let i=!1;n.idToken&&n.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(n),i=!0),r&&await Mi(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(an(this.auth.app))return Promise.reject(yn(this.auth));const n=await this.getIdToken();return await $r(this,Xg(this.auth,{idToken:n})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(n=>Object.assign({},n)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(n,r){var i,s,o,a,l,c,u,h;const g=(i=r.displayName)!==null&&i!==void 0?i:void 0,m=(s=r.email)!==null&&s!==void 0?s:void 0,p=(o=r.phoneNumber)!==null&&o!==void 0?o:void 0,j=(a=r.photoURL)!==null&&a!==void 0?a:void 0,b=(l=r.tenantId)!==null&&l!==void 0?l:void 0,v=(c=r._redirectEventId)!==null&&c!==void 0?c:void 0,_=(u=r.createdAt)!==null&&u!==void 0?u:void 0,N=(h=r.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:R,emailVerified:U,isAnonymous:I,providerData:w,stsTokenManager:P}=r;ke(R&&P,n,"internal-error");const M=gr.fromJSON(this.name,P);ke(typeof R=="string",n,"internal-error"),In(g,n.name),In(m,n.name),ke(typeof U=="boolean",n,"internal-error"),ke(typeof I=="boolean",n,"internal-error"),In(p,n.name),In(j,n.name),In(b,n.name),In(v,n.name),In(_,n.name),In(N,n.name);const k=new pn({uid:R,auth:n,email:m,emailVerified:U,displayName:g,isAnonymous:I,photoURL:j,phoneNumber:p,tenantId:b,stsTokenManager:M,createdAt:_,lastLoginAt:N});return w&&Array.isArray(w)&&(k.providerData=w.map(E=>Object.assign({},E))),v&&(k._redirectEventId=v),k}static async _fromIdTokenResponse(n,r,i=!1){const s=new gr;s.updateFromServerResponse(r);const o=new pn({uid:r.localId,auth:n,stsTokenManager:s,isAnonymous:i});return await Mi(o),o}static async _fromGetAccountInfoResponse(n,r,i){const s=r.users[0];ke(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?Yc(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!o?.length,l=new gr;l.updateFromIdToken(i);const c=new pn({uid:s.localId,auth:n,stsTokenManager:l,isAnonymous:a}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new ro(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!o?.length};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aa=new Map;function fn(t){vn(t instanceof Function,"Expected a class definition");let n=Aa.get(t);return n?(vn(n instanceof t,"Instance stored in cache mismatched with class"),n):(n=new t,Aa.set(t,n),n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(n,r){this.storage[n]=r}async _get(n){const r=this.storage[n];return r===void 0?null:r}async _remove(n){delete this.storage[n]}_addListener(n,r){}_removeListener(n,r){}}Kc.type="NONE";const Ta=Kc;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yi(t,n,r){return`firebase:${t}:${n}:${r}`}class pr{constructor(n,r,i){this.persistence=n,this.auth=r,this.userKey=i;const{config:s,name:o}=this.auth;this.fullUserKey=yi(this.userKey,s.apiKey,o),this.fullPersistenceKey=yi("persistence",s.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(n){return this.persistence._set(this.fullUserKey,n.toJSON())}async getCurrentUser(){const n=await this.persistence._get(this.fullUserKey);return n?pn._fromJSON(this.auth,n):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(n){if(this.persistence===n)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=n,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(n,r,i="authUser"){if(!r.length)return new pr(fn(Ta),n,i);const s=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let o=s[0]||fn(Ta);const a=yi(i,n.config.apiKey,n.name);let l=null;for(const u of r)try{const h=await u._get(a);if(h){const g=pn._fromJSON(n,h);u!==o&&(l=g),o=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!o._shouldAllowMigration||!c.length?new pr(o,n,i):(o=c[0],l&&await o._set(a,l.toJSON()),await Promise.all(r.map(async u=>{if(u!==o)try{await u._remove(a)}catch{}})),new pr(o,n,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pa(t){const n=t.toLowerCase();if(n.includes("opera/")||n.includes("opr/")||n.includes("opios/"))return"Opera";if(Zc(n))return"IEMobile";if(n.includes("msie")||n.includes("trident/"))return"IE";if(n.includes("edge/"))return"Edge";if(Jc(n))return"Firefox";if(n.includes("silk/"))return"Silk";if(tu(n))return"Blackberry";if(nu(n))return"Webos";if(Qc(n))return"Safari";if((n.includes("chrome/")||Xc(n))&&!n.includes("edge/"))return"Chrome";if(eu(n))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=t.match(r);if(i?.length===2)return i[1]}return"Other"}function Jc(t=Rt()){return/firefox\//i.test(t)}function Qc(t=Rt()){const n=t.toLowerCase();return n.includes("safari/")&&!n.includes("chrome/")&&!n.includes("crios/")&&!n.includes("android")}function Xc(t=Rt()){return/crios\//i.test(t)}function Zc(t=Rt()){return/iemobile/i.test(t)}function eu(t=Rt()){return/android/i.test(t)}function tu(t=Rt()){return/blackberry/i.test(t)}function nu(t=Rt()){return/webos/i.test(t)}function Fo(t=Rt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function op(t=Rt()){var n;return Fo(t)&&!!(!((n=window.navigator)===null||n===void 0)&&n.standalone)}function ap(){return vh()&&document.documentMode===10}function ru(t=Rt()){return Fo(t)||eu(t)||nu(t)||tu(t)||/windows phone/i.test(t)||Zc(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iu(t,n=[]){let r;switch(t){case"Browser":r=Pa(Rt());break;case"Worker":r=`${Pa(Rt())}-${t}`;break;default:r=t}const i=n.length?n.join(","):"FirebaseCore-web";return`${r}/JsCore/${ei}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp{constructor(n){this.auth=n,this.queue=[]}pushCallback(n,r){const i=o=>new Promise((a,l)=>{try{const c=n(o);a(c)}catch(c){l(c)}});i.onAbort=r,this.queue.push(i);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(n){if(this.auth.currentUser===n)return;const r=[];try{for(const i of this.queue)await i(n),i.onAbort&&r.push(i.onAbort)}catch(i){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cp(t,n={}){return Wn(t,"GET","/v2/passwordPolicy",Nn(t,n))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const up=6;class dp{constructor(n){var r,i,s,o;const a=n.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:up,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=n.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(i=n.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(o=n.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=n.schemaVersion}validatePassword(n){var r,i,s,o,a,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(n,c),this.validatePasswordCharacterOptions(n,c),c.isValid&&(c.isValid=(r=c.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsUppercaseLetter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNumericCharacter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(n,r){const i=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;i&&(r.meetsMinPasswordLength=n.length>=i),s&&(r.meetsMaxPasswordLength=n.length<=s)}validatePasswordCharacterOptions(n,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let i;for(let s=0;s<n.length;s++)i=n.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(n,r,i,s,o){this.customStrengthOptions.containsLowercaseLetter&&(n.containsLowercaseLetter||(n.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(n.containsUppercaseLetter||(n.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(n.containsNumericCharacter||(n.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(n.containsNonAlphanumericCharacter||(n.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(n,r,i,s){this.app=n,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=i,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new La(this),this.idTokenSubscription=new La(this),this.beforeStateQueue=new lp(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Uc,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=n.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(n,r){return r&&(this._popupRedirectResolver=fn(r)),this._initializationPromise=this.queue(async()=>{var i,s;if(!this._deleted&&(this.persistenceManager=await pr.create(this,n),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const n=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!n)){if(this.currentUser&&n&&this.currentUser.uid===n.uid){this._currentUser._assign(n),await this.currentUser.getIdToken();return}await this._updateCurrentUser(n,!0)}}async initializeCurrentUserFromIdToken(n){try{const r=await Gc(this,{idToken:n}),i=await pn._fromGetAccountInfoResponse(this,r,n);await this.directlySetCurrentUser(i)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(n){var r;if(an(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(l,l))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let s=i,o=!1;if(n&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,l=s?._redirectEventId,c=await this.tryRedirectSignIn(n);(!a||a===l)&&c?.user&&(s=c.user,o=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ke(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(n){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,n,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(n){try{await Mi(n)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(n)}useDeviceLanguage(){this.languageCode=Vg()}async _delete(){this._deleted=!0}async updateCurrentUser(n){if(an(this.app))return Promise.reject(yn(this));const r=n?_n(n):null;return r&&ke(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(n,r=!1){if(!this._deleted)return n&&ke(this.tenantId===n.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(n),this.queue(async()=>{await this.directlySetCurrentUser(n),this.notifyAuthListeners()})}async signOut(){return an(this.app)?Promise.reject(yn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(n){return an(this.app)?Promise.reject(yn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(fn(n))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(n){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(n)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const n=await cp(this),r=new dp(n);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(n){this._errorFactory=new Xr("auth","Firebase",n())}onAuthStateChanged(n,r,i){return this.registerStateListener(this.authStateSubscription,n,r,i)}beforeAuthStateChanged(n,r){return this.beforeStateQueue.pushCallback(n,r)}onIdTokenChanged(n,r,i){return this.registerStateListener(this.idTokenSubscription,n,r,i)}authStateReady(){return new Promise((n,r)=>{if(this.currentUser)n();else{const i=this.onAuthStateChanged(()=>{i(),n()},r)}})}async revokeAccessToken(n){if(this.currentUser){const r=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:n,idToken:r};this.tenantId!=null&&(i.tenantId=this.tenantId),await sp(this,i)}}toJSON(){var n;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(n=this._currentUser)===null||n===void 0?void 0:n.toJSON()}}async _setRedirectUser(n,r){const i=await this.getOrInitRedirectPersistenceManager(r);return n===null?i.removeCurrentUser():i.setCurrentUser(n)}async getOrInitRedirectPersistenceManager(n){if(!this.redirectPersistenceManager){const r=n&&fn(n)||this._popupRedirectResolver;ke(r,this,"argument-error"),this.redirectPersistenceManager=await pr.create(this,[fn(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(n){var r,i;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===n?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===n?this.redirectUser:null}async _persistUserIfCurrent(n){if(n===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(n))}_notifyListenersIfCurrent(n){n===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(r=(n=this.currentUser)===null||n===void 0?void 0:n.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(n,r,i,s){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let a=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(ke(l,this,"internal-error"),l.then(()=>{a||o(this.currentUser)}),typeof r=="function"){const c=n.addObserver(r,i,s);return()=>{a=!0,c()}}else{const c=n.addObserver(r);return()=>{a=!0,c()}}}async directlySetCurrentUser(n){this.currentUser&&this.currentUser!==n&&this._currentUser._stopProactiveRefresh(),n&&this.isProactiveRefreshEnabled&&n._startProactiveRefresh(),this.currentUser=n,n?await this.assertedPersistence.setCurrentUser(n):await this.assertedPersistence.removeCurrentUser()}queue(n){return this.operations=this.operations.then(n,n),this.operations}get assertedPersistence(){return ke(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(n){!n||this.frameworks.includes(n)||(this.frameworks.push(n),this.frameworks.sort(),this.clientVersion=iu(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var n;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const i=await((n=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||n===void 0?void 0:n.getHeartbeatsHeader());i&&(r["X-Firebase-Client"]=i);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var n;const r=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||n===void 0?void 0:n.getToken());return r?.error&&Ug(`Error while retrieving App Check token: ${r.error}`),r?.token}}function nr(t){return _n(t)}class La{constructor(n){this.auth=n,this.observer=null,this.addObserver=Ah(r=>this.observer=r)}get next(){return ke(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zi={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function gp(t){Zi=t}function su(t){return Zi.loadJS(t)}function pp(){return Zi.recaptchaEnterpriseScript}function fp(){return Zi.gapiScript}function mp(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const xp="recaptcha-enterprise",jp="NO_RECAPTCHA";class yp{constructor(n){this.type=xp,this.auth=nr(n)}async verify(n="verify",r=!1){async function i(o){if(!r){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(a,l)=>{Qg(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new Jg(c);return o.tenantId==null?o._agentRecaptchaConfig=u:o._tenantRecaptchaConfigs[o.tenantId]=u,a(u.siteKey)}}).catch(c=>{l(c)})})}function s(o,a,l){const c=window.grecaptcha;Ia(c)?c.enterprise.ready(()=>{c.enterprise.execute(o,{action:n}).then(u=>{a(u)}).catch(()=>{a(jp)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((o,a)=>{i(this.auth).then(l=>{if(!r&&Ia(window.grecaptcha))s(l,o,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let c=pp();c.length!==0&&(c+=l),su(c).then(()=>{s(l,o,a)}).catch(u=>{a(u)})}}).catch(l=>{a(l)})})}}async function Ra(t,n,r,i=!1){const s=new yp(t);let o;try{o=await s.verify(r)}catch{o=await s.verify(r,!0)}const a=Object.assign({},n);return i?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function io(t,n,r,i){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await Ra(t,n,r,r==="getOobCode");return i(t,o)}else return i(t,n).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Ra(t,n,r,r==="getOobCode");return i(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bp(t,n){const r=Fc(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),o=r.getOptions();if(Pi(o,n??{}))return s;Xt(s,"already-initialized")}return r.initialize({options:n})}function wp(t,n){const r=n?.persistence||[],i=(Array.isArray(r)?r:[r]).map(fn);n?.errorMap&&t._updateErrorMap(n.errorMap),t._initializeWithPersistence(i,n?.popupRedirectResolver)}function Sp(t,n,r){const i=nr(t);ke(i._canInitEmulator,i,"emulator-config-failed"),ke(/^https?:\/\//.test(n),i,"invalid-emulator-scheme");const s=!1,o=ou(n),{host:a,port:l}=vp(n),c=l===null?"":`:${l}`;i.config.emulator={url:`${o}//${a}${c}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:a,port:l,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})}),_p()}function ou(t){const n=t.indexOf(":");return n<0?"":t.substr(0,n+1)}function vp(t){const n=ou(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(n.length));if(!r)return{host:"",port:null};const i=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const o=s[1];return{host:o,port:Ma(i.substr(o.length+1))}}else{const[o,a]=i.split(":");return{host:o,port:Ma(a)}}}function Ma(t){if(!t)return null;const n=Number(t);return isNaN(n)?null:n}function _p(){function t(){const n=document.createElement("p"),r=n.style;n.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",n.classList.add("firebase-emulator-warning"),document.body.appendChild(n)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(n,r){this.providerId=n,this.signInMethod=r}toJSON(){return gn("not implemented")}_getIdTokenResponse(n){return gn("not implemented")}_linkToIdToken(n,r){return gn("not implemented")}_getReauthenticationResolver(n){return gn("not implemented")}}async function Cp(t,n){return Wn(t,"POST","/v1/accounts:signUp",n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kp(t,n){return ni(t,"POST","/v1/accounts:signInWithPassword",Nn(t,n))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ep(t,n){return ni(t,"POST","/v1/accounts:signInWithEmailLink",Nn(t,n))}async function Ip(t,n){return ni(t,"POST","/v1/accounts:signInWithEmailLink",Nn(t,n))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr extends Do{constructor(n,r,i,s=null){super("password",i),this._email=n,this._password=r,this._tenantId=s}static _fromEmailAndPassword(n,r){return new Vr(n,r,"password")}static _fromEmailAndCode(n,r,i=null){return new Vr(n,r,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(n){const r=typeof n=="string"?JSON.parse(n):n;if(r?.email&&r?.password){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(n){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return io(n,r,"signInWithPassword",kp);case"emailLink":return Ep(n,{email:this._email,oobCode:this._password});default:Xt(n,"internal-error")}}async _linkToIdToken(n,r){switch(this.signInMethod){case"password":const i={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return io(n,i,"signUpPassword",Cp);case"emailLink":return Ip(n,{idToken:r,email:this._email,oobCode:this._password});default:Xt(n,"internal-error")}}_getReauthenticationResolver(n){return this._getIdTokenResponse(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fr(t,n){return ni(t,"POST","/v1/accounts:signInWithIdp",Nn(t,n))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zp="http://localhost";class Zn extends Do{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(n){const r=new Zn(n.providerId,n.signInMethod);return n.idToken||n.accessToken?(n.idToken&&(r.idToken=n.idToken),n.accessToken&&(r.accessToken=n.accessToken),n.nonce&&!n.pendingToken&&(r.nonce=n.nonce),n.pendingToken&&(r.pendingToken=n.pendingToken)):n.oauthToken&&n.oauthTokenSecret?(r.accessToken=n.oauthToken,r.secret=n.oauthTokenSecret):Xt("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(n){const r=typeof n=="string"?JSON.parse(n):n,{providerId:i,signInMethod:s}=r,o=Eo(r,["providerId","signInMethod"]);if(!i||!s)return null;const a=new Zn(i,s);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(n){const r=this.buildRequest();return fr(n,r)}_linkToIdToken(n,r){const i=this.buildRequest();return i.idToken=r,fr(n,i)}_getReauthenticationResolver(n){const r=this.buildRequest();return r.autoCreate=!1,fr(n,r)}buildRequest(){const n={requestUri:zp,returnSecureToken:!0};if(this.pendingToken)n.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),n.postBody=Zr(r)}return n}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ap(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Tp(t){const n=Ar(Tr(t)).link,r=n?Ar(Tr(n)).deep_link_id:null,i=Ar(Tr(t)).deep_link_id;return(i?Ar(Tr(i)).link:null)||i||r||n||t}class No{constructor(n){var r,i,s,o,a,l;const c=Ar(Tr(n)),u=(r=c.apiKey)!==null&&r!==void 0?r:null,h=(i=c.oobCode)!==null&&i!==void 0?i:null,g=Ap((s=c.mode)!==null&&s!==void 0?s:null);ke(u&&h&&g,"argument-error"),this.apiKey=u,this.operation=g,this.code=h,this.continueUrl=(o=c.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(a=c.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(n){const r=Tp(n);try{return new No(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(){this.providerId=br.PROVIDER_ID}static credential(n,r){return Vr._fromEmailAndPassword(n,r)}static credentialWithLink(n,r){const i=No.parseLink(r);return ke(i,"argument-error"),Vr._fromEmailAndCode(n,i.code,i.tenantId)}}br.PROVIDER_ID="password";br.EMAIL_PASSWORD_SIGN_IN_METHOD="password";br.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au{constructor(n){this.providerId=n,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(n){this.defaultLanguageCode=n}setCustomParameters(n){return this.customParameters=n,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri extends au{constructor(){super(...arguments),this.scopes=[]}addScope(n){return this.scopes.includes(n)||this.scopes.push(n),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An extends ri{constructor(){super("facebook.com")}static credential(n){return Zn._fromParams({providerId:An.PROVIDER_ID,signInMethod:An.FACEBOOK_SIGN_IN_METHOD,accessToken:n})}static credentialFromResult(n){return An.credentialFromTaggedObject(n)}static credentialFromError(n){return An.credentialFromTaggedObject(n.customData||{})}static credentialFromTaggedObject({_tokenResponse:n}){if(!n||!("oauthAccessToken"in n)||!n.oauthAccessToken)return null;try{return An.credential(n.oauthAccessToken)}catch{return null}}}An.FACEBOOK_SIGN_IN_METHOD="facebook.com";An.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn extends ri{constructor(){super("google.com"),this.addScope("profile")}static credential(n,r){return Zn._fromParams({providerId:Tn.PROVIDER_ID,signInMethod:Tn.GOOGLE_SIGN_IN_METHOD,idToken:n,accessToken:r})}static credentialFromResult(n){return Tn.credentialFromTaggedObject(n)}static credentialFromError(n){return Tn.credentialFromTaggedObject(n.customData||{})}static credentialFromTaggedObject({_tokenResponse:n}){if(!n)return null;const{oauthIdToken:r,oauthAccessToken:i}=n;if(!r&&!i)return null;try{return Tn.credential(r,i)}catch{return null}}}Tn.GOOGLE_SIGN_IN_METHOD="google.com";Tn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn extends ri{constructor(){super("github.com")}static credential(n){return Zn._fromParams({providerId:Pn.PROVIDER_ID,signInMethod:Pn.GITHUB_SIGN_IN_METHOD,accessToken:n})}static credentialFromResult(n){return Pn.credentialFromTaggedObject(n)}static credentialFromError(n){return Pn.credentialFromTaggedObject(n.customData||{})}static credentialFromTaggedObject({_tokenResponse:n}){if(!n||!("oauthAccessToken"in n)||!n.oauthAccessToken)return null;try{return Pn.credential(n.oauthAccessToken)}catch{return null}}}Pn.GITHUB_SIGN_IN_METHOD="github.com";Pn.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln extends ri{constructor(){super("twitter.com")}static credential(n,r){return Zn._fromParams({providerId:Ln.PROVIDER_ID,signInMethod:Ln.TWITTER_SIGN_IN_METHOD,oauthToken:n,oauthTokenSecret:r})}static credentialFromResult(n){return Ln.credentialFromTaggedObject(n)}static credentialFromError(n){return Ln.credentialFromTaggedObject(n.customData||{})}static credentialFromTaggedObject({_tokenResponse:n}){if(!n)return null;const{oauthAccessToken:r,oauthTokenSecret:i}=n;if(!r||!i)return null;try{return Ln.credential(r,i)}catch{return null}}}Ln.TWITTER_SIGN_IN_METHOD="twitter.com";Ln.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pp(t,n){return ni(t,"POST","/v1/accounts:signUp",Nn(t,n))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(n){this.user=n.user,this.providerId=n.providerId,this._tokenResponse=n._tokenResponse,this.operationType=n.operationType}static async _fromIdTokenResponse(n,r,i,s=!1){const o=await pn._fromIdTokenResponse(n,i,s),a=Oa(i);return new er({user:o,providerId:a,_tokenResponse:i,operationType:r})}static async _forOperation(n,r,i){await n._updateTokensIfNecessary(i,!0);const s=Oa(i);return new er({user:n,providerId:s,_tokenResponse:i,operationType:r})}}function Oa(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi extends Dn{constructor(n,r,i,s){var o;super(r.code,r.message),this.operationType=i,this.user=s,Object.setPrototypeOf(this,Oi.prototype),this.customData={appName:n.name,tenantId:(o=n.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:r.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(n,r,i,s){return new Oi(n,r,i,s)}}function lu(t,n,r,i){return(n==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Oi._fromErrorAndOperation(t,o,n,i):o})}async function Lp(t,n,r=!1){const i=await $r(t,n._linkToIdToken(t.auth,await t.getIdToken()),r);return er._forOperation(t,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rp(t,n,r=!1){const{auth:i}=t;if(an(i.app))return Promise.reject(yn(i));const s="reauthenticate";try{const o=await $r(t,lu(i,s,n,t),r);ke(o.idToken,i,"internal-error");const a=Oo(o.idToken);ke(a,i,"internal-error");const{sub:l}=a;return ke(t.uid===l,i,"user-mismatch"),er._forOperation(t,s,o)}catch(o){throw o?.code==="auth/user-not-found"&&Xt(i,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cu(t,n,r=!1){if(an(t.app))return Promise.reject(yn(t));const i="signIn",s=await lu(t,i,n),o=await er._fromIdTokenResponse(t,i,s);return r||await t._updateCurrentUser(o.user),o}async function Mp(t,n){return cu(nr(t),n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uu(t){const n=nr(t);n._getPasswordPolicyInternal()&&await n._updatePasswordPolicy()}async function Op(t,n,r){if(an(t.app))return Promise.reject(yn(t));const i=nr(t),a=await io(i,{returnSecureToken:!0,email:n,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Pp).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&uu(t),c}),l=await er._fromIdTokenResponse(i,"signIn",a);return await i._updateCurrentUser(l.user),l}function Fp(t,n,r){return an(t.app)?Promise.reject(yn(t)):Mp(_n(t),br.credential(n,r)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&uu(t),i})}function Dp(t,n,r,i){return _n(t).onIdTokenChanged(n,r,i)}function Np(t,n,r){return _n(t).beforeAuthStateChanged(n,r)}function Wp(t,n,r,i){return _n(t).onAuthStateChanged(n,r,i)}function Bp(t){return _n(t).signOut()}const Fi="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(n,r){this.storageRetriever=n,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Fi,"1"),this.storage.removeItem(Fi),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(n,r){return this.storage.setItem(n,JSON.stringify(r)),Promise.resolve()}_get(n){const r=this.storage.getItem(n);return Promise.resolve(r?JSON.parse(r):null)}_remove(n){return this.storage.removeItem(n),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Up=1e3,Hp=10;class hu extends du{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(n,r)=>this.onStorageEvent(n,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ru(),this._shouldAllowMigration=!0}forAllChangedKeys(n){for(const r of Object.keys(this.listeners)){const i=this.storage.getItem(r),s=this.localCache[r];i!==s&&n(r,s,i)}}onStorageEvent(n,r=!1){if(!n.key){this.forAllChangedKeys((a,l,c)=>{this.notifyListeners(a,c)});return}const i=n.key;r?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);ap()&&o!==n.newValue&&n.newValue!==n.oldValue?setTimeout(s,Hp):s()}notifyListeners(n,r){this.localCache[n]=r;const i=this.listeners[n];if(i)for(const s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((n,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:n,oldValue:r,newValue:i}),!0)})},Up)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(n,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[n]||(this.listeners[n]=new Set,this.localCache[n]=this.storage.getItem(n)),this.listeners[n].add(r)}_removeListener(n,r){this.listeners[n]&&(this.listeners[n].delete(r),this.listeners[n].size===0&&delete this.listeners[n]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(n,r){await super._set(n,r),this.localCache[n]=JSON.stringify(r)}async _get(n){const r=await super._get(n);return this.localCache[n]=JSON.stringify(r),r}async _remove(n){await super._remove(n),delete this.localCache[n]}}hu.type="LOCAL";const $p=hu;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu extends du{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(n,r){}_removeListener(n,r){}}gu.type="SESSION";const pu=gu;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vp(t){return Promise.all(t.map(async n=>{try{return{fulfilled:!0,value:await n}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es{constructor(n){this.eventTarget=n,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(n){const r=this.receivers.find(s=>s.isListeningto(n));if(r)return r;const i=new es(n);return this.receivers.push(i),i}isListeningto(n){return this.eventTarget===n}async handleEvent(n){const r=n,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});const l=Array.from(a).map(async u=>u(r.origin,o)),c=await Vp(l);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:c})}_subscribe(n,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[n]||(this.handlersMap[n]=new Set),this.handlersMap[n].add(r)}_unsubscribe(n,r){this.handlersMap[n]&&r&&this.handlersMap[n].delete(r),(!r||this.handlersMap[n].size===0)&&delete this.handlersMap[n],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}es.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wo(t="",n=10){let r="";for(let i=0;i<n;i++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qp{constructor(n){this.target=n,this.handlers=new Set}removeMessageHandler(n){n.messageChannel&&(n.messageChannel.port1.removeEventListener("message",n.onMessage),n.messageChannel.port1.close()),this.handlers.delete(n)}async _send(n,r,i=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,a;return new Promise((l,c)=>{const u=Wo("",20);s.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},i);a={messageChannel:s,onMessage(g){const m=g;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(h),o=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),l(m.data.response);break;default:clearTimeout(h),clearTimeout(o),c(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:n,eventId:u,data:r},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cn(){return window}function Gp(t){cn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fu(){return typeof cn().WorkerGlobalScope<"u"&&typeof cn().importScripts=="function"}async function Yp(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Kp(){var t;return((t=navigator?.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Jp(){return fu()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mu="firebaseLocalStorageDb",Qp=1,Di="firebaseLocalStorage",xu="fbase_key";class ii{constructor(n){this.request=n}toPromise(){return new Promise((n,r)=>{this.request.addEventListener("success",()=>{n(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function ts(t,n){return t.transaction([Di],n?"readwrite":"readonly").objectStore(Di)}function Xp(){const t=indexedDB.deleteDatabase(mu);return new ii(t).toPromise()}function so(){const t=indexedDB.open(mu,Qp);return new Promise((n,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const i=t.result;try{i.createObjectStore(Di,{keyPath:xu})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const i=t.result;i.objectStoreNames.contains(Di)?n(i):(i.close(),await Xp(),n(await so()))})})}async function Fa(t,n,r){const i=ts(t,!0).put({[xu]:n,value:r});return new ii(i).toPromise()}async function Zp(t,n){const r=ts(t,!1).get(n),i=await new ii(r).toPromise();return i===void 0?null:i.value}function Da(t,n){const r=ts(t,!0).delete(n);return new ii(r).toPromise()}const ef=800,tf=3;class ju{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await so(),this.db)}async _withRetries(n){let r=0;for(;;)try{const i=await this._openDb();return await n(i)}catch(i){if(r++>tf)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return fu()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=es._getInstance(Jp()),this.receiver._subscribe("keyChanged",async(n,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(n,r)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await Yp(),!this.activeServiceWorker)return;this.sender=new qp(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((n=i[0])===null||n===void 0)&&n.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(n){if(!(!this.sender||!this.activeServiceWorker||Kp()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:n},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const n=await so();return await Fa(n,Fi,"1"),await Da(n,Fi),!0}catch{}return!1}async _withPendingWrite(n){this.pendingWrites++;try{await n()}finally{this.pendingWrites--}}async _set(n,r){return this._withPendingWrite(async()=>(await this._withRetries(i=>Fa(i,n,r)),this.localCache[n]=r,this.notifyServiceWorker(n)))}async _get(n){const r=await this._withRetries(i=>Zp(i,n));return this.localCache[n]=r,r}async _remove(n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Da(r,n)),delete this.localCache[n],this.notifyServiceWorker(n)))}async _poll(){const n=await this._withRetries(s=>{const o=ts(s,!1).getAll();return new ii(o).toPromise()});if(!n)return[];if(this.pendingWrites!==0)return[];const r=[],i=new Set;if(n.length!==0)for(const{fbase_key:s,value:o}of n)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(n,r){this.localCache[n]=r;const i=this.listeners[n];if(i)for(const s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ef)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(n,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[n]||(this.listeners[n]=new Set,this._get(n)),this.listeners[n].add(r)}_removeListener(n,r){this.listeners[n]&&(this.listeners[n].delete(r),this.listeners[n].size===0&&delete this.listeners[n]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ju.type="LOCAL";const nf=ju;new ti(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rf(t,n){return n?fn(n):(ke(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo extends Do{constructor(n){super("custom","custom"),this.params=n}_getIdTokenResponse(n){return fr(n,this._buildIdpRequest())}_linkToIdToken(n,r){return fr(n,this._buildIdpRequest(r))}_getReauthenticationResolver(n){return fr(n,this._buildIdpRequest())}_buildIdpRequest(n){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return n&&(r.idToken=n),r}}function sf(t){return cu(t.auth,new Bo(t),t.bypassAuthState)}function of(t){const{auth:n,user:r}=t;return ke(r,n,"internal-error"),Rp(r,new Bo(t),t.bypassAuthState)}async function af(t){const{auth:n,user:r}=t;return ke(r,n,"internal-error"),Lp(r,new Bo(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu{constructor(n,r,i,s,o=!1){this.auth=n,this.resolver=i,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(n,r)=>{this.pendingPromise={resolve:n,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(n){const{urlResponse:r,sessionId:i,postBody:s,tenantId:o,error:a,type:l}=n;if(a){this.reject(a);return}const c={auth:this.auth,requestUri:r,sessionId:i,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(n){this.reject(n)}getIdpTask(n){switch(n){case"signInViaPopup":case"signInViaRedirect":return sf;case"linkViaPopup":case"linkViaRedirect":return af;case"reauthViaPopup":case"reauthViaRedirect":return of;default:Xt(this.auth,"internal-error")}}resolve(n){vn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(n),this.unregisterAndCleanUp()}reject(n){vn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(n),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lf=new ti(2e3,1e4);class dr extends yu{constructor(n,r,i,s,o){super(n,r,s,o),this.provider=i,this.authWindow=null,this.pollId=null,dr.currentPopupAction&&dr.currentPopupAction.cancel(),dr.currentPopupAction=this}async executeNotNull(){const n=await this.execute();return ke(n,this.auth,"internal-error"),n}async onExecution(){vn(this.filter.length===1,"Popup operations only handle one event");const n=Wo();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],n),this.authWindow.associatedEvent=n,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ln(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var n;return((n=this.authWindow)===null||n===void 0?void 0:n.associatedEvent)||null}cancel(){this.reject(ln(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,dr.currentPopupAction=null}pollUserCancellation(){const n=()=>{var r,i;if(!((i=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ln(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(n,lf.get())};n()}}dr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cf="pendingRedirect",bi=new Map;class uf extends yu{constructor(n,r,i=!1){super(n,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,i),this.eventId=null}async execute(){let n=bi.get(this.auth._key());if(!n){try{const i=await df(this.resolver,this.auth)?await super.execute():null;n=()=>Promise.resolve(i)}catch(r){n=()=>Promise.reject(r)}bi.set(this.auth._key(),n)}return this.bypassAuthState||bi.set(this.auth._key(),()=>Promise.resolve(null)),n()}async onAuthEvent(n){if(n.type==="signInViaRedirect")return super.onAuthEvent(n);if(n.type==="unknown"){this.resolve(null);return}if(n.eventId){const r=await this.auth._redirectUserForId(n.eventId);if(r)return this.user=r,super.onAuthEvent(n);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function df(t,n){const r=pf(n),i=gf(t);if(!await i._isAvailable())return!1;const s=await i._get(r)==="true";return await i._remove(r),s}function hf(t,n){bi.set(t._key(),n)}function gf(t){return fn(t._redirectPersistence)}function pf(t){return yi(cf,t.config.apiKey,t.name)}async function ff(t,n,r=!1){if(an(t.app))return Promise.reject(yn(t));const i=nr(t),s=rf(i,n),a=await new uf(i,s,r).execute();return a&&!r&&(delete a.user._redirectEventId,await i._persistUserIfCurrent(a.user),await i._setRedirectUser(null,n)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mf=10*60*1e3;class xf{constructor(n){this.auth=n,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(n){this.consumers.add(n),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,n)&&(this.sendToConsumer(this.queuedRedirectEvent,n),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(n){this.consumers.delete(n)}onEvent(n){if(this.hasEventBeenHandled(n))return!1;let r=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(n,i)&&(r=!0,this.sendToConsumer(n,i),this.saveEventToCache(n))}),this.hasHandledPotentialRedirect||!jf(n)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=n,r=!0)),r}sendToConsumer(n,r){var i;if(n.error&&!bu(n)){const s=((i=n.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";r.onError(ln(this.auth,s))}else r.onAuthEvent(n)}isEventForConsumer(n,r){const i=r.eventId===null||!!n.eventId&&n.eventId===r.eventId;return r.filter.includes(n.type)&&i}hasEventBeenHandled(n){return Date.now()-this.lastProcessedEventTime>=mf&&this.cachedEventUids.clear(),this.cachedEventUids.has(Na(n))}saveEventToCache(n){this.cachedEventUids.add(Na(n)),this.lastProcessedEventTime=Date.now()}}function Na(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(n=>n).join("-")}function bu({type:t,error:n}){return t==="unknown"&&n?.code==="auth/no-auth-event"}function jf(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return bu(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yf(t,n={}){return Wn(t,"GET","/v1/projects",n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bf=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,wf=/^https?/;async function Sf(t){if(t.config.emulator)return;const{authorizedDomains:n}=await yf(t);for(const r of n)try{if(vf(r))return}catch{}Xt(t,"unauthorized-domain")}function vf(t){const n=no(),{protocol:r,hostname:i}=new URL(n);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&i===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===n.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===i}if(!wf.test(r))return!1;if(bf.test(t))return i===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _f=new ti(3e4,6e4);function Wa(){const t=cn().___jsl;if(t?.H){for(const n of Object.keys(t.H))if(t.H[n].r=t.H[n].r||[],t.H[n].L=t.H[n].L||[],t.H[n].r=[...t.H[n].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function Cf(t){return new Promise((n,r)=>{var i,s,o;function a(){Wa(),gapi.load("gapi.iframes",{callback:()=>{n(gapi.iframes.getContext())},ontimeout:()=>{Wa(),r(ln(t,"network-request-failed"))},timeout:_f.get()})}if(!((s=(i=cn().gapi)===null||i===void 0?void 0:i.iframes)===null||s===void 0)&&s.Iframe)n(gapi.iframes.getContext());else if(!((o=cn().gapi)===null||o===void 0)&&o.load)a();else{const l=mp("iframefcb");return cn()[l]=()=>{gapi.load?a():r(ln(t,"network-request-failed"))},su(`${fp()}?onload=${l}`).catch(c=>r(c))}}).catch(n=>{throw wi=null,n})}let wi=null;function kf(t){return wi=wi||Cf(t),wi}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ef=new ti(5e3,15e3),If="__/auth/iframe",zf="emulator/auth/iframe",Af={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Tf=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Pf(t){const n=t.config;ke(n.authDomain,t,"auth-domain-config-required");const r=n.emulator?Mo(n,zf):`https://${t.config.authDomain}/${If}`,i={apiKey:n.apiKey,appName:t.name,v:ei},s=Tf.get(t.config.apiHost);s&&(i.eid=s);const o=t._getFrameworks();return o.length&&(i.fw=o.join(",")),`${r}?${Zr(i).slice(1)}`}async function Lf(t){const n=await kf(t),r=cn().gapi;return ke(r,t,"internal-error"),n.open({where:document.body,url:Pf(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Af,dontclear:!0},i=>new Promise(async(s,o)=>{await i.restyle({setHideOnLeave:!1});const a=ln(t,"network-request-failed"),l=cn().setTimeout(()=>{o(a)},Ef.get());function c(){cn().clearTimeout(l),s(i)}i.ping(c).then(c,()=>{o(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rf={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Mf=500,Of=600,Ff="_blank",Df="http://localhost";class Ba{constructor(n){this.window=n,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Nf(t,n,r,i=Mf,s=Of){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString();let l="";const c=Object.assign(Object.assign({},Rf),{width:i.toString(),height:s.toString(),top:o,left:a}),u=Rt().toLowerCase();r&&(l=Xc(u)?Ff:r),Jc(u)&&(n=n||Df,c.scrollbars="yes");const h=Object.entries(c).reduce((m,[p,j])=>`${m}${p}=${j},`,"");if(op(u)&&l!=="_self")return Wf(n||"",l),new Ba(null);const g=window.open(n||"",l,h);ke(g,t,"popup-blocked");try{g.focus()}catch{}return new Ba(g)}function Wf(t,n){const r=document.createElement("a");r.href=t,r.target=n;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bf="__/auth/handler",Uf="emulator/auth/handler",Hf=encodeURIComponent("fac");async function Ua(t,n,r,i,s,o){ke(t.config.authDomain,t,"auth-domain-config-required"),ke(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:i,v:ei,eventId:s};if(n instanceof au){n.setDefaultLanguage(t.languageCode),a.providerId=n.providerId||"",zh(n.getCustomParameters())||(a.customParameters=JSON.stringify(n.getCustomParameters()));for(const[h,g]of Object.entries({}))a[h]=g}if(n instanceof ri){const h=n.getScopes().filter(g=>g!=="");h.length>0&&(a.scopes=h.join(","))}t.tenantId&&(a.tid=t.tenantId);const l=a;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const c=await t._getAppCheckToken(),u=c?`#${Hf}=${encodeURIComponent(c)}`:"";return`${$f(t)}?${Zr(l).slice(1)}${u}`}function $f({config:t}){return t.emulator?Mo(t,Uf):`https://${t.authDomain}/${Bf}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ys="webStorageSupport";class Vf{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=pu,this._completeRedirectFn=ff,this._overrideRedirectResult=hf}async _openPopup(n,r,i,s){var o;vn((o=this.eventManagers[n._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const a=await Ua(n,r,i,no(),s);return Nf(n,a,Wo())}async _openRedirect(n,r,i,s){await this._originValidation(n);const o=await Ua(n,r,i,no(),s);return Gp(o),new Promise(()=>{})}_initialize(n){const r=n._key();if(this.eventManagers[r]){const{manager:s,promise:o}=this.eventManagers[r];return s?Promise.resolve(s):(vn(o,"If manager is not set, promise should be"),o)}const i=this.initAndGetManager(n);return this.eventManagers[r]={promise:i},i.catch(()=>{delete this.eventManagers[r]}),i}async initAndGetManager(n){const r=await Lf(n),i=new xf(n);return r.register("authEvent",s=>(ke(s?.authEvent,n,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[n._key()]={manager:i},this.iframes[n._key()]=r,i}_isIframeWebStorageSupported(n,r){this.iframes[n._key()].send(ys,{type:ys},s=>{var o;const a=(o=s?.[0])===null||o===void 0?void 0:o[ys];a!==void 0&&r(!!a),Xt(n,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(n){const r=n._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=Sf(n)),this.originValidationPromises[r]}get _shouldInitProactively(){return ru()||Qc()||Fo()}}const qf=Vf;var Ha="@firebase/auth",$a="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gf{constructor(n){this.auth=n,this.internalListeners=new Map}getUid(){var n;return this.assertAuthConfigured(),((n=this.auth.currentUser)===null||n===void 0?void 0:n.uid)||null}async getToken(n){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(n)}:null}addAuthTokenListener(n){if(this.assertAuthConfigured(),this.internalListeners.has(n))return;const r=this.auth.onIdTokenChanged(i=>{n(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(n,r),this.updateProactiveRefresh()}removeAuthTokenListener(n){this.assertAuthConfigured();const r=this.internalListeners.get(n);r&&(this.internalListeners.delete(n),r(),this.updateProactiveRefresh())}assertAuthConfigured(){ke(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yf(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Kf(t){Ur(new yr("auth",(n,{options:r})=>{const i=n.getProvider("app").getImmediate(),s=n.getProvider("heartbeat"),o=n.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=i.options;ke(a&&!a.includes(":"),"invalid-api-key",{appName:i.name});const c={apiKey:a,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:iu(t)},u=new hp(i,s,o,c);return wp(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,r,i)=>{n.getProvider("auth-internal").initialize()})),Ur(new yr("auth-internal",n=>{const r=nr(n.getProvider("auth").getImmediate());return(i=>new Gf(i))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),hr(Ha,$a,Yf(t)),hr(Ha,$a,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jf=5*60,Qf=Lc("authIdTokenMaxAge")||Jf;let Va=null;const Xf=t=>async n=>{const r=n&&await n.getIdTokenResult(),i=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(i&&i>Qf)return;const s=r?.token;Va!==s&&(Va=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Zf(t=Tg()){const n=Fc(t,"auth");if(n.isInitialized())return n.getImmediate();const r=bp(t,{popupRedirectResolver:qf,persistence:[nf,$p,pu]}),i=Lc("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(i,location.origin);if(location.origin===o.origin){const a=Xf(o.toString());Np(r,a,()=>a(r.currentUser)),Dp(r,l=>a(l))}}const s=xh("auth");return s&&Sp(r,`http://${s}`),r}function em(){var t,n;return(n=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&n!==void 0?n:document}gp({loadJS(t){return new Promise((n,r)=>{const i=document.createElement("script");i.setAttribute("src",t),i.onload=n,i.onerror=s=>{const o=ln("internal-error");o.customData=s,r(o)},i.type="text/javascript",i.charset="UTF-8",em().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Kf("Browser");var tm="firebase",nm="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hr(tm,nm,"app");const rm={apiKey:"AIzaSyAORKm-1yynaNrSomVU0P18HyS_4HSzHks",authDomain:"food-tracker-6096d.firebaseapp.com",projectId:"food-tracker-6096d",storageBucket:"food-tracker-6096d.firebasestorage.app",messagingSenderId:"215135700985",appId:"1:215135700985:web:bfb71581010bcaab6c5f28"},im=Dc(rm),Jt=Zf(im);function wu(t,n){return function(){return t.apply(n,arguments)}}const{toString:sm}=Object.prototype,{getPrototypeOf:Uo}=Object,{iterator:ns,toStringTag:Su}=Symbol,rs=(t=>n=>{const r=sm.call(n);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Zt=t=>(t=t.toLowerCase(),n=>rs(n)===t),is=t=>n=>typeof n===t,{isArray:wr}=Array,qr=is("undefined");function om(t){return t!==null&&!qr(t)&&t.constructor!==null&&!qr(t.constructor)&&Ft(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const vu=Zt("ArrayBuffer");function am(t){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(t):n=t&&t.buffer&&vu(t.buffer),n}const lm=is("string"),Ft=is("function"),_u=is("number"),ss=t=>t!==null&&typeof t=="object",cm=t=>t===!0||t===!1,Si=t=>{if(rs(t)!=="object")return!1;const n=Uo(t);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Su in t)&&!(ns in t)},um=Zt("Date"),dm=Zt("File"),hm=Zt("Blob"),gm=Zt("FileList"),pm=t=>ss(t)&&Ft(t.pipe),fm=t=>{let n;return t&&(typeof FormData=="function"&&t instanceof FormData||Ft(t.append)&&((n=rs(t))==="formdata"||n==="object"&&Ft(t.toString)&&t.toString()==="[object FormData]"))},mm=Zt("URLSearchParams"),[xm,jm,ym,bm]=["ReadableStream","Request","Response","Headers"].map(Zt),wm=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function si(t,n,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let i,s;if(typeof t!="object"&&(t=[t]),wr(t))for(i=0,s=t.length;i<s;i++)n.call(null,t[i],i,t);else{const o=r?Object.getOwnPropertyNames(t):Object.keys(t),a=o.length;let l;for(i=0;i<a;i++)l=o[i],n.call(null,t[l],l,t)}}function Cu(t,n){n=n.toLowerCase();const r=Object.keys(t);let i=r.length,s;for(;i-- >0;)if(s=r[i],n===s.toLowerCase())return s;return null}const Jn=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ku=t=>!qr(t)&&t!==Jn;function oo(){const{caseless:t}=ku(this)&&this||{},n={},r=(i,s)=>{const o=t&&Cu(n,s)||s;Si(n[o])&&Si(i)?n[o]=oo(n[o],i):Si(i)?n[o]=oo({},i):wr(i)?n[o]=i.slice():n[o]=i};for(let i=0,s=arguments.length;i<s;i++)arguments[i]&&si(arguments[i],r);return n}const Sm=(t,n,r,{allOwnKeys:i}={})=>(si(n,(s,o)=>{r&&Ft(s)?t[o]=wu(s,r):t[o]=s},{allOwnKeys:i}),t),vm=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),_m=(t,n,r,i)=>{t.prototype=Object.create(n.prototype,i),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:n.prototype}),r&&Object.assign(t.prototype,r)},Cm=(t,n,r,i)=>{let s,o,a;const l={};if(n=n||{},t==null)return n;do{for(s=Object.getOwnPropertyNames(t),o=s.length;o-- >0;)a=s[o],(!i||i(a,t,n))&&!l[a]&&(n[a]=t[a],l[a]=!0);t=r!==!1&&Uo(t)}while(t&&(!r||r(t,n))&&t!==Object.prototype);return n},km=(t,n,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=n.length;const i=t.indexOf(n,r);return i!==-1&&i===r},Em=t=>{if(!t)return null;if(wr(t))return t;let n=t.length;if(!_u(n))return null;const r=new Array(n);for(;n-- >0;)r[n]=t[n];return r},Im=(t=>n=>t&&n instanceof t)(typeof Uint8Array<"u"&&Uo(Uint8Array)),zm=(t,n)=>{const i=(t&&t[ns]).call(t);let s;for(;(s=i.next())&&!s.done;){const o=s.value;n.call(t,o[0],o[1])}},Am=(t,n)=>{let r;const i=[];for(;(r=t.exec(n))!==null;)i.push(r);return i},Tm=Zt("HTMLFormElement"),Pm=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,i,s){return i.toUpperCase()+s}),qa=(({hasOwnProperty:t})=>(n,r)=>t.call(n,r))(Object.prototype),Lm=Zt("RegExp"),Eu=(t,n)=>{const r=Object.getOwnPropertyDescriptors(t),i={};si(r,(s,o)=>{let a;(a=n(s,o,t))!==!1&&(i[o]=a||s)}),Object.defineProperties(t,i)},Rm=t=>{Eu(t,(n,r)=>{if(Ft(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const i=t[r];if(Ft(i)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},Mm=(t,n)=>{const r={},i=s=>{s.forEach(o=>{r[o]=!0})};return wr(t)?i(t):i(String(t).split(n)),r},Om=()=>{},Fm=(t,n)=>t!=null&&Number.isFinite(t=+t)?t:n;function Dm(t){return!!(t&&Ft(t.append)&&t[Su]==="FormData"&&t[ns])}const Nm=t=>{const n=new Array(10),r=(i,s)=>{if(ss(i)){if(n.indexOf(i)>=0)return;if(!("toJSON"in i)){n[s]=i;const o=wr(i)?[]:{};return si(i,(a,l)=>{const c=r(a,s+1);!qr(c)&&(o[l]=c)}),n[s]=void 0,o}}return i};return r(t,0)},Wm=Zt("AsyncFunction"),Bm=t=>t&&(ss(t)||Ft(t))&&Ft(t.then)&&Ft(t.catch),Iu=((t,n)=>t?setImmediate:n?((r,i)=>(Jn.addEventListener("message",({source:s,data:o})=>{s===Jn&&o===r&&i.length&&i.shift()()},!1),s=>{i.push(s),Jn.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Ft(Jn.postMessage)),Um=typeof queueMicrotask<"u"?queueMicrotask.bind(Jn):typeof process<"u"&&process.nextTick||Iu,Hm=t=>t!=null&&Ft(t[ns]),Y={isArray:wr,isArrayBuffer:vu,isBuffer:om,isFormData:fm,isArrayBufferView:am,isString:lm,isNumber:_u,isBoolean:cm,isObject:ss,isPlainObject:Si,isReadableStream:xm,isRequest:jm,isResponse:ym,isHeaders:bm,isUndefined:qr,isDate:um,isFile:dm,isBlob:hm,isRegExp:Lm,isFunction:Ft,isStream:pm,isURLSearchParams:mm,isTypedArray:Im,isFileList:gm,forEach:si,merge:oo,extend:Sm,trim:wm,stripBOM:vm,inherits:_m,toFlatObject:Cm,kindOf:rs,kindOfTest:Zt,endsWith:km,toArray:Em,forEachEntry:zm,matchAll:Am,isHTMLForm:Tm,hasOwnProperty:qa,hasOwnProp:qa,reduceDescriptors:Eu,freezeMethods:Rm,toObjectSet:Mm,toCamelCase:Pm,noop:Om,toFiniteNumber:Fm,findKey:Cu,global:Jn,isContextDefined:ku,isSpecCompliantForm:Dm,toJSONObject:Nm,isAsyncFn:Wm,isThenable:Bm,setImmediate:Iu,asap:Um,isIterable:Hm};function ze(t,n,r,i,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",n&&(this.code=n),r&&(this.config=r),i&&(this.request=i),s&&(this.response=s,this.status=s.status?s.status:null)}Y.inherits(ze,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Y.toJSONObject(this.config),code:this.code,status:this.status}}});const zu=ze.prototype,Au={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Au[t]={value:t}});Object.defineProperties(ze,Au);Object.defineProperty(zu,"isAxiosError",{value:!0});ze.from=(t,n,r,i,s,o)=>{const a=Object.create(zu);return Y.toFlatObject(t,a,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),ze.call(a,t.message,n,r,i,s),a.cause=t,a.name=t.name,o&&Object.assign(a,o),a};const $m=null;function ao(t){return Y.isPlainObject(t)||Y.isArray(t)}function Tu(t){return Y.endsWith(t,"[]")?t.slice(0,-2):t}function Ga(t,n,r){return t?t.concat(n).map(function(s,o){return s=Tu(s),!r&&o?"["+s+"]":s}).join(r?".":""):n}function Vm(t){return Y.isArray(t)&&!t.some(ao)}const qm=Y.toFlatObject(Y,{},null,function(n){return/^is[A-Z]/.test(n)});function os(t,n,r){if(!Y.isObject(t))throw new TypeError("target must be an object");n=n||new FormData,r=Y.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(b,v){return!Y.isUndefined(v[b])});const i=r.metaTokens,s=r.visitor||h,o=r.dots,a=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&Y.isSpecCompliantForm(n);if(!Y.isFunction(s))throw new TypeError("visitor must be a function");function u(j){if(j===null)return"";if(Y.isDate(j))return j.toISOString();if(Y.isBoolean(j))return j.toString();if(!c&&Y.isBlob(j))throw new ze("Blob is not supported. Use a Buffer instead.");return Y.isArrayBuffer(j)||Y.isTypedArray(j)?c&&typeof Blob=="function"?new Blob([j]):Buffer.from(j):j}function h(j,b,v){let _=j;if(j&&!v&&typeof j=="object"){if(Y.endsWith(b,"{}"))b=i?b:b.slice(0,-2),j=JSON.stringify(j);else if(Y.isArray(j)&&Vm(j)||(Y.isFileList(j)||Y.endsWith(b,"[]"))&&(_=Y.toArray(j)))return b=Tu(b),_.forEach(function(R,U){!(Y.isUndefined(R)||R===null)&&n.append(a===!0?Ga([b],U,o):a===null?b:b+"[]",u(R))}),!1}return ao(j)?!0:(n.append(Ga(v,b,o),u(j)),!1)}const g=[],m=Object.assign(qm,{defaultVisitor:h,convertValue:u,isVisitable:ao});function p(j,b){if(!Y.isUndefined(j)){if(g.indexOf(j)!==-1)throw Error("Circular reference detected in "+b.join("."));g.push(j),Y.forEach(j,function(_,N){(!(Y.isUndefined(_)||_===null)&&s.call(n,_,Y.isString(N)?N.trim():N,b,m))===!0&&p(_,b?b.concat(N):[N])}),g.pop()}}if(!Y.isObject(t))throw new TypeError("data must be an object");return p(t),n}function Ya(t){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(i){return n[i]})}function Ho(t,n){this._pairs=[],t&&os(t,this,n)}const Pu=Ho.prototype;Pu.append=function(n,r){this._pairs.push([n,r])};Pu.toString=function(n){const r=n?function(i){return n.call(this,i,Ya)}:Ya;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function Gm(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Lu(t,n,r){if(!n)return t;const i=r&&r.encode||Gm;Y.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let o;if(s?o=s(n,r):o=Y.isURLSearchParams(n)?n.toString():new Ho(n,r).toString(i),o){const a=t.indexOf("#");a!==-1&&(t=t.slice(0,a)),t+=(t.indexOf("?")===-1?"?":"&")+o}return t}class Ka{constructor(){this.handlers=[]}use(n,r,i){return this.handlers.push({fulfilled:n,rejected:r,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){Y.forEach(this.handlers,function(i){i!==null&&n(i)})}}const Ru={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ym=typeof URLSearchParams<"u"?URLSearchParams:Ho,Km=typeof FormData<"u"?FormData:null,Jm=typeof Blob<"u"?Blob:null,Qm={isBrowser:!0,classes:{URLSearchParams:Ym,FormData:Km,Blob:Jm},protocols:["http","https","file","blob","url","data"]},$o=typeof window<"u"&&typeof document<"u",lo=typeof navigator=="object"&&navigator||void 0,Xm=$o&&(!lo||["ReactNative","NativeScript","NS"].indexOf(lo.product)<0),Zm=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",ex=$o&&window.location.href||"http://localhost",tx=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:$o,hasStandardBrowserEnv:Xm,hasStandardBrowserWebWorkerEnv:Zm,navigator:lo,origin:ex},Symbol.toStringTag,{value:"Module"})),Ct={...tx,...Qm};function nx(t,n){return os(t,new Ct.classes.URLSearchParams,Object.assign({visitor:function(r,i,s,o){return Ct.isNode&&Y.isBuffer(r)?(this.append(i,r.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},n))}function rx(t){return Y.matchAll(/\w+|\[(\w*)]/g,t).map(n=>n[0]==="[]"?"":n[1]||n[0])}function ix(t){const n={},r=Object.keys(t);let i;const s=r.length;let o;for(i=0;i<s;i++)o=r[i],n[o]=t[o];return n}function Mu(t){function n(r,i,s,o){let a=r[o++];if(a==="__proto__")return!0;const l=Number.isFinite(+a),c=o>=r.length;return a=!a&&Y.isArray(s)?s.length:a,c?(Y.hasOwnProp(s,a)?s[a]=[s[a],i]:s[a]=i,!l):((!s[a]||!Y.isObject(s[a]))&&(s[a]=[]),n(r,i,s[a],o)&&Y.isArray(s[a])&&(s[a]=ix(s[a])),!l)}if(Y.isFormData(t)&&Y.isFunction(t.entries)){const r={};return Y.forEachEntry(t,(i,s)=>{n(rx(i),s,r,0)}),r}return null}function sx(t,n,r){if(Y.isString(t))try{return(n||JSON.parse)(t),Y.trim(t)}catch(i){if(i.name!=="SyntaxError")throw i}return(r||JSON.stringify)(t)}const oi={transitional:Ru,adapter:["xhr","http","fetch"],transformRequest:[function(n,r){const i=r.getContentType()||"",s=i.indexOf("application/json")>-1,o=Y.isObject(n);if(o&&Y.isHTMLForm(n)&&(n=new FormData(n)),Y.isFormData(n))return s?JSON.stringify(Mu(n)):n;if(Y.isArrayBuffer(n)||Y.isBuffer(n)||Y.isStream(n)||Y.isFile(n)||Y.isBlob(n)||Y.isReadableStream(n))return n;if(Y.isArrayBufferView(n))return n.buffer;if(Y.isURLSearchParams(n))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let l;if(o){if(i.indexOf("application/x-www-form-urlencoded")>-1)return nx(n,this.formSerializer).toString();if((l=Y.isFileList(n))||i.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return os(l?{"files[]":n}:n,c&&new c,this.formSerializer)}}return o||s?(r.setContentType("application/json",!1),sx(n)):n}],transformResponse:[function(n){const r=this.transitional||oi.transitional,i=r&&r.forcedJSONParsing,s=this.responseType==="json";if(Y.isResponse(n)||Y.isReadableStream(n))return n;if(n&&Y.isString(n)&&(i&&!this.responseType||s)){const a=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(n)}catch(l){if(a)throw l.name==="SyntaxError"?ze.from(l,ze.ERR_BAD_RESPONSE,this,null,this.response):l}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ct.classes.FormData,Blob:Ct.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Y.forEach(["delete","get","head","post","put","patch"],t=>{oi.headers[t]={}});const ox=Y.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ax=t=>{const n={};let r,i,s;return t&&t.split(`
`).forEach(function(a){s=a.indexOf(":"),r=a.substring(0,s).trim().toLowerCase(),i=a.substring(s+1).trim(),!(!r||n[r]&&ox[r])&&(r==="set-cookie"?n[r]?n[r].push(i):n[r]=[i]:n[r]=n[r]?n[r]+", "+i:i)}),n},Ja=Symbol("internals");function kr(t){return t&&String(t).trim().toLowerCase()}function vi(t){return t===!1||t==null?t:Y.isArray(t)?t.map(vi):String(t)}function lx(t){const n=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=r.exec(t);)n[i[1]]=i[2];return n}const cx=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function bs(t,n,r,i,s){if(Y.isFunction(i))return i.call(this,n,r);if(s&&(n=r),!!Y.isString(n)){if(Y.isString(i))return n.indexOf(i)!==-1;if(Y.isRegExp(i))return i.test(n)}}function ux(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,r,i)=>r.toUpperCase()+i)}function dx(t,n){const r=Y.toCamelCase(" "+n);["get","set","has"].forEach(i=>{Object.defineProperty(t,i+r,{value:function(s,o,a){return this[i].call(this,n,s,o,a)},configurable:!0})})}let Dt=class{constructor(n){n&&this.set(n)}set(n,r,i){const s=this;function o(l,c,u){const h=kr(c);if(!h)throw new Error("header name must be a non-empty string");const g=Y.findKey(s,h);(!g||s[g]===void 0||u===!0||u===void 0&&s[g]!==!1)&&(s[g||c]=vi(l))}const a=(l,c)=>Y.forEach(l,(u,h)=>o(u,h,c));if(Y.isPlainObject(n)||n instanceof this.constructor)a(n,r);else if(Y.isString(n)&&(n=n.trim())&&!cx(n))a(ax(n),r);else if(Y.isObject(n)&&Y.isIterable(n)){let l={},c,u;for(const h of n){if(!Y.isArray(h))throw TypeError("Object iterator must return a key-value pair");l[u=h[0]]=(c=l[u])?Y.isArray(c)?[...c,h[1]]:[c,h[1]]:h[1]}a(l,r)}else n!=null&&o(r,n,i);return this}get(n,r){if(n=kr(n),n){const i=Y.findKey(this,n);if(i){const s=this[i];if(!r)return s;if(r===!0)return lx(s);if(Y.isFunction(r))return r.call(this,s,i);if(Y.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,r){if(n=kr(n),n){const i=Y.findKey(this,n);return!!(i&&this[i]!==void 0&&(!r||bs(this,this[i],i,r)))}return!1}delete(n,r){const i=this;let s=!1;function o(a){if(a=kr(a),a){const l=Y.findKey(i,a);l&&(!r||bs(i,i[l],l,r))&&(delete i[l],s=!0)}}return Y.isArray(n)?n.forEach(o):o(n),s}clear(n){const r=Object.keys(this);let i=r.length,s=!1;for(;i--;){const o=r[i];(!n||bs(this,this[o],o,n,!0))&&(delete this[o],s=!0)}return s}normalize(n){const r=this,i={};return Y.forEach(this,(s,o)=>{const a=Y.findKey(i,o);if(a){r[a]=vi(s),delete r[o];return}const l=n?ux(o):String(o).trim();l!==o&&delete r[o],r[l]=vi(s),i[l]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const r=Object.create(null);return Y.forEach(this,(i,s)=>{i!=null&&i!==!1&&(r[s]=n&&Y.isArray(i)?i.join(", "):i)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,r])=>n+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...r){const i=new this(n);return r.forEach(s=>i.set(s)),i}static accessor(n){const i=(this[Ja]=this[Ja]={accessors:{}}).accessors,s=this.prototype;function o(a){const l=kr(a);i[l]||(dx(s,a),i[l]=!0)}return Y.isArray(n)?n.forEach(o):o(n),this}};Dt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Y.reduceDescriptors(Dt.prototype,({value:t},n)=>{let r=n[0].toUpperCase()+n.slice(1);return{get:()=>t,set(i){this[r]=i}}});Y.freezeMethods(Dt);function ws(t,n){const r=this||oi,i=n||r,s=Dt.from(i.headers);let o=i.data;return Y.forEach(t,function(l){o=l.call(r,o,s.normalize(),n?n.status:void 0)}),s.normalize(),o}function Ou(t){return!!(t&&t.__CANCEL__)}function Sr(t,n,r){ze.call(this,t??"canceled",ze.ERR_CANCELED,n,r),this.name="CanceledError"}Y.inherits(Sr,ze,{__CANCEL__:!0});function Fu(t,n,r){const i=r.config.validateStatus;!r.status||!i||i(r.status)?t(r):n(new ze("Request failed with status code "+r.status,[ze.ERR_BAD_REQUEST,ze.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function hx(t){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return n&&n[1]||""}function gx(t,n){t=t||10;const r=new Array(t),i=new Array(t);let s=0,o=0,a;return n=n!==void 0?n:1e3,function(c){const u=Date.now(),h=i[o];a||(a=u),r[s]=c,i[s]=u;let g=o,m=0;for(;g!==s;)m+=r[g++],g=g%t;if(s=(s+1)%t,s===o&&(o=(o+1)%t),u-a<n)return;const p=h&&u-h;return p?Math.round(m*1e3/p):void 0}}function px(t,n){let r=0,i=1e3/n,s,o;const a=(u,h=Date.now())=>{r=h,s=null,o&&(clearTimeout(o),o=null),t.apply(null,u)};return[(...u)=>{const h=Date.now(),g=h-r;g>=i?a(u,h):(s=u,o||(o=setTimeout(()=>{o=null,a(s)},i-g)))},()=>s&&a(s)]}const Ni=(t,n,r=3)=>{let i=0;const s=gx(50,250);return px(o=>{const a=o.loaded,l=o.lengthComputable?o.total:void 0,c=a-i,u=s(c),h=a<=l;i=a;const g={loaded:a,total:l,progress:l?a/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&h?(l-a)/u:void 0,event:o,lengthComputable:l!=null,[n?"download":"upload"]:!0};t(g)},r)},Qa=(t,n)=>{const r=t!=null;return[i=>n[0]({lengthComputable:r,total:t,loaded:i}),n[1]]},Xa=t=>(...n)=>Y.asap(()=>t(...n)),fx=Ct.hasStandardBrowserEnv?((t,n)=>r=>(r=new URL(r,Ct.origin),t.protocol===r.protocol&&t.host===r.host&&(n||t.port===r.port)))(new URL(Ct.origin),Ct.navigator&&/(msie|trident)/i.test(Ct.navigator.userAgent)):()=>!0,mx=Ct.hasStandardBrowserEnv?{write(t,n,r,i,s,o){const a=[t+"="+encodeURIComponent(n)];Y.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),Y.isString(i)&&a.push("path="+i),Y.isString(s)&&a.push("domain="+s),o===!0&&a.push("secure"),document.cookie=a.join("; ")},read(t){const n=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function xx(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function jx(t,n){return n?t.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):t}function Du(t,n,r){let i=!xx(n);return t&&(i||r==!1)?jx(t,n):n}const Za=t=>t instanceof Dt?{...t}:t;function tr(t,n){n=n||{};const r={};function i(u,h,g,m){return Y.isPlainObject(u)&&Y.isPlainObject(h)?Y.merge.call({caseless:m},u,h):Y.isPlainObject(h)?Y.merge({},h):Y.isArray(h)?h.slice():h}function s(u,h,g,m){if(Y.isUndefined(h)){if(!Y.isUndefined(u))return i(void 0,u,g,m)}else return i(u,h,g,m)}function o(u,h){if(!Y.isUndefined(h))return i(void 0,h)}function a(u,h){if(Y.isUndefined(h)){if(!Y.isUndefined(u))return i(void 0,u)}else return i(void 0,h)}function l(u,h,g){if(g in n)return i(u,h);if(g in t)return i(void 0,u)}const c={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:l,headers:(u,h,g)=>s(Za(u),Za(h),g,!0)};return Y.forEach(Object.keys(Object.assign({},t,n)),function(h){const g=c[h]||s,m=g(t[h],n[h],h);Y.isUndefined(m)&&g!==l||(r[h]=m)}),r}const Nu=t=>{const n=tr({},t);let{data:r,withXSRFToken:i,xsrfHeaderName:s,xsrfCookieName:o,headers:a,auth:l}=n;n.headers=a=Dt.from(a),n.url=Lu(Du(n.baseURL,n.url,n.allowAbsoluteUrls),t.params,t.paramsSerializer),l&&a.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(Y.isFormData(r)){if(Ct.hasStandardBrowserEnv||Ct.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if((c=a.getContentType())!==!1){const[u,...h]=c?c.split(";").map(g=>g.trim()).filter(Boolean):[];a.setContentType([u||"multipart/form-data",...h].join("; "))}}if(Ct.hasStandardBrowserEnv&&(i&&Y.isFunction(i)&&(i=i(n)),i||i!==!1&&fx(n.url))){const u=s&&o&&mx.read(o);u&&a.set(s,u)}return n},yx=typeof XMLHttpRequest<"u",bx=yx&&function(t){return new Promise(function(r,i){const s=Nu(t);let o=s.data;const a=Dt.from(s.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=s,h,g,m,p,j;function b(){p&&p(),j&&j(),s.cancelToken&&s.cancelToken.unsubscribe(h),s.signal&&s.signal.removeEventListener("abort",h)}let v=new XMLHttpRequest;v.open(s.method.toUpperCase(),s.url,!0),v.timeout=s.timeout;function _(){if(!v)return;const R=Dt.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),I={data:!l||l==="text"||l==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:R,config:t,request:v};Fu(function(P){r(P),b()},function(P){i(P),b()},I),v=null}"onloadend"in v?v.onloadend=_:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(_)},v.onabort=function(){v&&(i(new ze("Request aborted",ze.ECONNABORTED,t,v)),v=null)},v.onerror=function(){i(new ze("Network Error",ze.ERR_NETWORK,t,v)),v=null},v.ontimeout=function(){let U=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const I=s.transitional||Ru;s.timeoutErrorMessage&&(U=s.timeoutErrorMessage),i(new ze(U,I.clarifyTimeoutError?ze.ETIMEDOUT:ze.ECONNABORTED,t,v)),v=null},o===void 0&&a.setContentType(null),"setRequestHeader"in v&&Y.forEach(a.toJSON(),function(U,I){v.setRequestHeader(I,U)}),Y.isUndefined(s.withCredentials)||(v.withCredentials=!!s.withCredentials),l&&l!=="json"&&(v.responseType=s.responseType),u&&([m,j]=Ni(u,!0),v.addEventListener("progress",m)),c&&v.upload&&([g,p]=Ni(c),v.upload.addEventListener("progress",g),v.upload.addEventListener("loadend",p)),(s.cancelToken||s.signal)&&(h=R=>{v&&(i(!R||R.type?new Sr(null,t,v):R),v.abort(),v=null)},s.cancelToken&&s.cancelToken.subscribe(h),s.signal&&(s.signal.aborted?h():s.signal.addEventListener("abort",h)));const N=hx(s.url);if(N&&Ct.protocols.indexOf(N)===-1){i(new ze("Unsupported protocol "+N+":",ze.ERR_BAD_REQUEST,t));return}v.send(o||null)})},wx=(t,n)=>{const{length:r}=t=t?t.filter(Boolean):[];if(n||r){let i=new AbortController,s;const o=function(u){if(!s){s=!0,l();const h=u instanceof Error?u:this.reason;i.abort(h instanceof ze?h:new Sr(h instanceof Error?h.message:h))}};let a=n&&setTimeout(()=>{a=null,o(new ze(`timeout ${n} of ms exceeded`,ze.ETIMEDOUT))},n);const l=()=>{t&&(a&&clearTimeout(a),a=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(o):u.removeEventListener("abort",o)}),t=null)};t.forEach(u=>u.addEventListener("abort",o));const{signal:c}=i;return c.unsubscribe=()=>Y.asap(l),c}},Sx=function*(t,n){let r=t.byteLength;if(r<n){yield t;return}let i=0,s;for(;i<r;)s=i+n,yield t.slice(i,s),i=s},vx=async function*(t,n){for await(const r of _x(t))yield*Sx(r,n)},_x=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const n=t.getReader();try{for(;;){const{done:r,value:i}=await n.read();if(r)break;yield i}}finally{await n.cancel()}},el=(t,n,r,i)=>{const s=vx(t,n);let o=0,a,l=c=>{a||(a=!0,i&&i(c))};return new ReadableStream({async pull(c){try{const{done:u,value:h}=await s.next();if(u){l(),c.close();return}let g=h.byteLength;if(r){let m=o+=g;r(m)}c.enqueue(new Uint8Array(h))}catch(u){throw l(u),u}},cancel(c){return l(c),s.return()}},{highWaterMark:2})},as=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Wu=as&&typeof ReadableStream=="function",Cx=as&&(typeof TextEncoder=="function"?(t=>n=>t.encode(n))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),Bu=(t,...n)=>{try{return!!t(...n)}catch{return!1}},kx=Wu&&Bu(()=>{let t=!1;const n=new Request(Ct.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!n}),tl=64*1024,co=Wu&&Bu(()=>Y.isReadableStream(new Response("").body)),Wi={stream:co&&(t=>t.body)};as&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!Wi[n]&&(Wi[n]=Y.isFunction(t[n])?r=>r[n]():(r,i)=>{throw new ze(`Response type '${n}' is not supported`,ze.ERR_NOT_SUPPORT,i)})})})(new Response);const Ex=async t=>{if(t==null)return 0;if(Y.isBlob(t))return t.size;if(Y.isSpecCompliantForm(t))return(await new Request(Ct.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(Y.isArrayBufferView(t)||Y.isArrayBuffer(t))return t.byteLength;if(Y.isURLSearchParams(t)&&(t=t+""),Y.isString(t))return(await Cx(t)).byteLength},Ix=async(t,n)=>{const r=Y.toFiniteNumber(t.getContentLength());return r??Ex(n)},zx=as&&(async t=>{let{url:n,method:r,data:i,signal:s,cancelToken:o,timeout:a,onDownloadProgress:l,onUploadProgress:c,responseType:u,headers:h,withCredentials:g="same-origin",fetchOptions:m}=Nu(t);u=u?(u+"").toLowerCase():"text";let p=wx([s,o&&o.toAbortSignal()],a),j;const b=p&&p.unsubscribe&&(()=>{p.unsubscribe()});let v;try{if(c&&kx&&r!=="get"&&r!=="head"&&(v=await Ix(h,i))!==0){let I=new Request(n,{method:"POST",body:i,duplex:"half"}),w;if(Y.isFormData(i)&&(w=I.headers.get("content-type"))&&h.setContentType(w),I.body){const[P,M]=Qa(v,Ni(Xa(c)));i=el(I.body,tl,P,M)}}Y.isString(g)||(g=g?"include":"omit");const _="credentials"in Request.prototype;j=new Request(n,{...m,signal:p,method:r.toUpperCase(),headers:h.normalize().toJSON(),body:i,duplex:"half",credentials:_?g:void 0});let N=await fetch(j,m);const R=co&&(u==="stream"||u==="response");if(co&&(l||R&&b)){const I={};["status","statusText","headers"].forEach(k=>{I[k]=N[k]});const w=Y.toFiniteNumber(N.headers.get("content-length")),[P,M]=l&&Qa(w,Ni(Xa(l),!0))||[];N=new Response(el(N.body,tl,P,()=>{M&&M(),b&&b()}),I)}u=u||"text";let U=await Wi[Y.findKey(Wi,u)||"text"](N,t);return!R&&b&&b(),await new Promise((I,w)=>{Fu(I,w,{data:U,headers:Dt.from(N.headers),status:N.status,statusText:N.statusText,config:t,request:j})})}catch(_){throw b&&b(),_&&_.name==="TypeError"&&/Load failed|fetch/i.test(_.message)?Object.assign(new ze("Network Error",ze.ERR_NETWORK,t,j),{cause:_.cause||_}):ze.from(_,_&&_.code,t,j)}}),uo={http:$m,xhr:bx,fetch:zx};Y.forEach(uo,(t,n)=>{if(t){try{Object.defineProperty(t,"name",{value:n})}catch{}Object.defineProperty(t,"adapterName",{value:n})}});const nl=t=>`- ${t}`,Ax=t=>Y.isFunction(t)||t===null||t===!1,Uu={getAdapter:t=>{t=Y.isArray(t)?t:[t];const{length:n}=t;let r,i;const s={};for(let o=0;o<n;o++){r=t[o];let a;if(i=r,!Ax(r)&&(i=uo[(a=String(r)).toLowerCase()],i===void 0))throw new ze(`Unknown adapter '${a}'`);if(i)break;s[a||"#"+o]=i}if(!i){const o=Object.entries(s).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let a=n?o.length>1?`since :
`+o.map(nl).join(`
`):" "+nl(o[0]):"as no adapter specified";throw new ze("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return i},adapters:uo};function Ss(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Sr(null,t)}function rl(t){return Ss(t),t.headers=Dt.from(t.headers),t.data=ws.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Uu.getAdapter(t.adapter||oi.adapter)(t).then(function(i){return Ss(t),i.data=ws.call(t,t.transformResponse,i),i.headers=Dt.from(i.headers),i},function(i){return Ou(i)||(Ss(t),i&&i.response&&(i.response.data=ws.call(t,t.transformResponse,i.response),i.response.headers=Dt.from(i.response.headers))),Promise.reject(i)})}const Hu="1.10.0",ls={};["object","boolean","number","function","string","symbol"].forEach((t,n)=>{ls[t]=function(i){return typeof i===t||"a"+(n<1?"n ":" ")+t}});const il={};ls.transitional=function(n,r,i){function s(o,a){return"[Axios v"+Hu+"] Transitional option '"+o+"'"+a+(i?". "+i:"")}return(o,a,l)=>{if(n===!1)throw new ze(s(a," has been removed"+(r?" in "+r:"")),ze.ERR_DEPRECATED);return r&&!il[a]&&(il[a]=!0,console.warn(s(a," has been deprecated since v"+r+" and will be removed in the near future"))),n?n(o,a,l):!0}};ls.spelling=function(n){return(r,i)=>(console.warn(`${i} is likely a misspelling of ${n}`),!0)};function Tx(t,n,r){if(typeof t!="object")throw new ze("options must be an object",ze.ERR_BAD_OPTION_VALUE);const i=Object.keys(t);let s=i.length;for(;s-- >0;){const o=i[s],a=n[o];if(a){const l=t[o],c=l===void 0||a(l,o,t);if(c!==!0)throw new ze("option "+o+" must be "+c,ze.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new ze("Unknown option "+o,ze.ERR_BAD_OPTION)}}const _i={assertOptions:Tx,validators:ls},rn=_i.validators;let Qn=class{constructor(n){this.defaults=n||{},this.interceptors={request:new Ka,response:new Ka}}async request(n,r){try{return await this._request(n,r)}catch(i){if(i instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const o=s.stack?s.stack.replace(/^.+\n/,""):"";try{i.stack?o&&!String(i.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+o):i.stack=o}catch{}}throw i}}_request(n,r){typeof n=="string"?(r=r||{},r.url=n):r=n||{},r=tr(this.defaults,r);const{transitional:i,paramsSerializer:s,headers:o}=r;i!==void 0&&_i.assertOptions(i,{silentJSONParsing:rn.transitional(rn.boolean),forcedJSONParsing:rn.transitional(rn.boolean),clarifyTimeoutError:rn.transitional(rn.boolean)},!1),s!=null&&(Y.isFunction(s)?r.paramsSerializer={serialize:s}:_i.assertOptions(s,{encode:rn.function,serialize:rn.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),_i.assertOptions(r,{baseUrl:rn.spelling("baseURL"),withXsrfToken:rn.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let a=o&&Y.merge(o.common,o[r.method]);o&&Y.forEach(["delete","get","head","post","put","patch","common"],j=>{delete o[j]}),r.headers=Dt.concat(a,o);const l=[];let c=!0;this.interceptors.request.forEach(function(b){typeof b.runWhen=="function"&&b.runWhen(r)===!1||(c=c&&b.synchronous,l.unshift(b.fulfilled,b.rejected))});const u=[];this.interceptors.response.forEach(function(b){u.push(b.fulfilled,b.rejected)});let h,g=0,m;if(!c){const j=[rl.bind(this),void 0];for(j.unshift.apply(j,l),j.push.apply(j,u),m=j.length,h=Promise.resolve(r);g<m;)h=h.then(j[g++],j[g++]);return h}m=l.length;let p=r;for(g=0;g<m;){const j=l[g++],b=l[g++];try{p=j(p)}catch(v){b.call(this,v);break}}try{h=rl.call(this,p)}catch(j){return Promise.reject(j)}for(g=0,m=u.length;g<m;)h=h.then(u[g++],u[g++]);return h}getUri(n){n=tr(this.defaults,n);const r=Du(n.baseURL,n.url,n.allowAbsoluteUrls);return Lu(r,n.params,n.paramsSerializer)}};Y.forEach(["delete","get","head","options"],function(n){Qn.prototype[n]=function(r,i){return this.request(tr(i||{},{method:n,url:r,data:(i||{}).data}))}});Y.forEach(["post","put","patch"],function(n){function r(i){return function(o,a,l){return this.request(tr(l||{},{method:n,headers:i?{"Content-Type":"multipart/form-data"}:{},url:o,data:a}))}}Qn.prototype[n]=r(),Qn.prototype[n+"Form"]=r(!0)});let Px=class $u{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(o){r=o});const i=this;this.promise.then(s=>{if(!i._listeners)return;let o=i._listeners.length;for(;o-- >0;)i._listeners[o](s);i._listeners=null}),this.promise.then=s=>{let o;const a=new Promise(l=>{i.subscribe(l),o=l}).then(s);return a.cancel=function(){i.unsubscribe(o)},a},n(function(o,a,l){i.reason||(i.reason=new Sr(o,a,l),r(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const r=this._listeners.indexOf(n);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const n=new AbortController,r=i=>{n.abort(i)};return this.subscribe(r),n.signal.unsubscribe=()=>this.unsubscribe(r),n.signal}static source(){let n;return{token:new $u(function(s){n=s}),cancel:n}}};function Lx(t){return function(r){return t.apply(null,r)}}function Rx(t){return Y.isObject(t)&&t.isAxiosError===!0}const ho={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ho).forEach(([t,n])=>{ho[n]=t});function Vu(t){const n=new Qn(t),r=wu(Qn.prototype.request,n);return Y.extend(r,Qn.prototype,n,{allOwnKeys:!0}),Y.extend(r,n,null,{allOwnKeys:!0}),r.create=function(s){return Vu(tr(t,s))},r}const gt=Vu(oi);gt.Axios=Qn;gt.CanceledError=Sr;gt.CancelToken=Px;gt.isCancel=Ou;gt.VERSION=Hu;gt.toFormData=os;gt.AxiosError=ze;gt.Cancel=gt.CanceledError;gt.all=function(n){return Promise.all(n)};gt.spread=Lx;gt.isAxiosError=Rx;gt.mergeConfig=tr;gt.AxiosHeaders=Dt;gt.formToJSON=t=>Mu(Y.isHTMLForm(t)?new FormData(t):t);gt.getAdapter=Uu.getAdapter;gt.HttpStatusCode=ho;gt.default=gt;const{Axios:OS,AxiosError:FS,CanceledError:DS,isCancel:NS,CancelToken:WS,VERSION:BS,all:US,Cancel:HS,isAxiosError:$S,spread:VS,toFormData:qS,AxiosHeaders:GS,HttpStatusCode:YS,formToJSON:KS,getAdapter:JS,mergeConfig:QS}=gt,Mx="https://nutrivize.onrender.com",Z=gt.create({baseURL:Mx,timeout:12e4,headers:{"Content-Type":"application/json"}});let Er=!1,ir=null;const qu=t=>{localStorage.setItem("authToken",t),sessionStorage.setItem("authToken",t);const n=Date.now()+50*60*1e3;localStorage.setItem("authTokenExpiry",n.toString()),sessionStorage.setItem("authTokenExpiry",n.toString()),Z.defaults.headers.common.Authorization=`Bearer ${t}`},Ox=()=>localStorage.getItem("authToken")||sessionStorage.getItem("authToken");Z.interceptors.request.use(async t=>{const n=Ox();if(n&&(t.headers.Authorization=`Bearer ${n}`),Jt.currentUser)try{const r=localStorage.getItem("authTokenExpiry")||sessionStorage.getItem("authTokenExpiry");if(!r||parseInt(r)<Date.now()+5*60*1e3){const s=await Jt.currentUser.getIdToken(!0);qu(s),t.headers.Authorization=`Bearer ${s}`,console.log("Token refreshed proactively")}}catch(r){console.error("Error refreshing token:",r)}return t});const sl=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("authTokenExpiry"),sessionStorage.removeItem("authToken"),sessionStorage.removeItem("authTokenExpiry"),delete Z.defaults.headers.common.Authorization},Fx=()=>window.navigator.userAgent.match(/iPhone|iPad|iPod/)&&window.matchMedia("(display-mode: standalone)").matches;Z.interceptors.response.use(t=>t,async t=>{const n=t.config;if(t.response?.status===401&&!n._retry)if(n._retry=!0,Jt.currentUser)try{if(Er&&ir){const r=await ir;return n.headers.Authorization=`Bearer ${r}`,Z(n)}if(!Er){console.log("Token expired or invalid. Refreshing..."),Er=!0,ir=Jt.currentUser.getIdToken(!0);const r=await ir;return qu(r),n.headers.Authorization=`Bearer ${r}`,Er=!1,ir=null,Z(n)}}catch(r){console.error("Token refresh failed:",r),sl(),Er=!1,ir=null,Fx()&&console.log("iOS PWA detected, directing to login"),window.location.pathname.includes("/login")||(window.location.href="/login")}else sl(),window.location.pathname.includes("/login")||(window.location.href="/login");return Promise.reject(t)});const Gu=C.createContext(void 0),vr=()=>{const t=C.useContext(Gu);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},Dx=({children:t})=>{const[n,r]=C.useState(null),[i,s]=C.useState(!0),[o,a]=C.useState(!1),l=j=>{localStorage.setItem("authToken",j),sessionStorage.setItem("authToken",j);const b=Date.now()+50*60*1e3;localStorage.setItem("authTokenExpiry",b.toString()),sessionStorage.setItem("authTokenExpiry",b.toString()),Z.defaults.headers.common.Authorization=`Bearer ${j}`},c=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("authTokenExpiry"),sessionStorage.removeItem("authToken"),sessionStorage.removeItem("authTokenExpiry"),delete Z.defaults.headers.common.Authorization},u=async()=>{if(Jt.currentUser)try{const j=await Jt.currentUser.getIdToken(!0);l(j);const b=await Z.get("/auth/me");return r(b.data),!0}catch(j){return console.error("Failed to refresh token:",j),!1}return!1};C.useEffect(()=>{const j=async()=>{console.log("PWA resumed - checking authentication"),await u()},b=async()=>{console.log("Token expiring - refreshing"),await u()};return window.addEventListener("pwa:resumed",j),window.addEventListener("auth:tokenExpiring",b),()=>{window.removeEventListener("pwa:resumed",j),window.removeEventListener("auth:tokenExpiring",b)}},[]),C.useEffect(()=>{if(!o){const b=window.location.hostname.includes("render.com")||window.location.hostname.includes("nutrivize")||!window.location.hostname.includes("localhost"),v=localStorage.getItem("authToken")||sessionStorage.getItem("authToken"),_=localStorage.getItem("authTokenExpiry")||sessionStorage.getItem("authTokenExpiry"),N=b?10*60*1e3:0,R=!_||parseInt(_)<Date.now()+N;v&&!R?(console.log("Found stored token, validating with server..."),Z.defaults.headers.common.Authorization=`Bearer ${v}`,Z.get("/auth/me").then(w=>{!b||window.sessionStorage.getItem("allow-auto-login")==="true"?(console.log("Token validated successfully"),r(w.data)):(console.log("Requiring explicit login on production deployment"),c())}).catch(w=>{console.log("Stored token is invalid or server validation failed, clearing",w),c()}).finally(()=>{a(!0),s(!1)})):(console.log("No valid token found or token expired"),c(),a(!0),s(!1));const U=window.matchMedia("(display-mode: standalone)").matches,I=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;if(U&&I){console.log("iOS PWA detected - restoring navigation state");const w=sessionStorage.getItem("pwa:lastPath");w&&w!=="/"&&w!=="/login"&&setTimeout(()=>{window.history.pushState({},"",w)},100)}return}const j=Wp(Jt,async b=>{if(b)try{console.log("Firebase user detected, getting token");const v=await b.getIdToken(!0);l(v);const _=await Z.get("/auth/me");r(_.data),console.log("User data fetched successfully")}catch(v){console.error("❌ Error fetching user data:",v),c(),r(null),await Jt.signOut().catch(_=>console.error("Error signing out:",_))}else console.log("No Firebase user, clearing tokens"),c(),r(null);s(!1)});return()=>j()},[o]);const p={user:n,loading:i,login:async(j,b)=>{s(!0);try{await Fp(Jt,j,b),window.sessionStorage.setItem("allow-auto-login","true")}catch(v){throw s(!1),v}},register:async(j,b,v)=>{s(!0);try{const N=await(await Op(Jt,j,b)).user.getIdToken();if(!(await fetch("https://nutrivize.onrender.com/auth/register",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${N}`},body:JSON.stringify({name:v,email:j})})).ok)throw new Error("Registration failed")}catch(_){throw s(!1),_}},logout:async()=>{c(),window.sessionStorage.removeItem("allow-auto-login");try{await Bp(Jt),console.log("Signed out successfully")}catch(j){console.error("Error during sign out:",j)}r(null),localStorage.removeItem("firebase:authUser"),sessionStorage.removeItem("firebase:authUser"),delete Z.defaults.headers.common.Authorization,window.location.replace("/login")}};return e.jsx(Gu.Provider,{value:p,children:t})},mn=(t="America/New_York")=>{try{const n=new Date;return new Intl.DateTimeFormat("en-CA",{timeZone:t,year:"numeric",month:"2-digit",day:"2-digit"}).format(n)}catch(n){return console.error("Error formatting date with timezone:",n),new Date().toISOString().split("T")[0]}},xn=()=>{try{const t=localStorage.getItem("nutritionPrefs");if(t){const n=JSON.parse(t);if(n.timezone)return n.timezone}}catch(t){console.error("Error reading timezone from settings:",t)}try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(t){return console.error("Error detecting browser timezone:",t),"America/New_York"}},Nx=t=>{try{const n=localStorage.getItem("nutritionPrefs"),r=n?JSON.parse(n):{};r.timezone=t,localStorage.setItem("nutritionPrefs",JSON.stringify(r))}catch(n){console.error("Error saving timezone preference:",n)}},Yu=C.createContext(void 0),Wx=t=>t*2.20462;function Bx({children:t}){const[n,r]=C.useState(null),[i,s]=C.useState([]),[o,a]=C.useState(154),[l,c]=C.useState([]),[u,h]=C.useState(null),[g,m]=C.useState(!0),p=C.useCallback(async()=>{try{console.log("🔍 Fetching goals...");const R=await Z.get("/goals/");console.log("✅ Goals response:",R.data),s(R.data);try{const U=await Z.get("/goals/active");console.log("✅ Active goal response:",U.data),r(U.data)}catch{console.log("ℹ️ No active goal found (this is okay)"),r(null)}}catch(R){console.error("❌ Error fetching goals:",R)}},[]),j=C.useCallback(async()=>{try{const R=await Z.get("/weight-logs/");if(c(R.data),R.data.length>0){const U=Wx(R.data[0].weight);a(U)}}catch(R){console.error("Error fetching weight logs:",R)}},[]),b=C.useCallback(async R=>{try{const U=R||mn(xn());console.log("🔍 Fetching daily summary for date:",U,"using timezone:",xn());const I=await Z.get(`/food-logs/daily/${U}/with-goals`);console.log("✅ Daily summary response:",I.data),console.log("🔍 Response keys:",Object.keys(I.data)),console.log("🔍 Food logs count:",I.data.food_logs?.length||0),console.log("🔍 Nutrition summary:",I.data.nutrition_summary);const w={date:U,total_nutrition:{...I.data.nutrition_summary||{calories:0,protein:0,carbs:0,fat:0,fiber:0,sugar:0,sodium:0},water:I.data.water_summary||{current:0,target:64,percentage:0}},meals:I.data.food_logs||[],meal_breakdown:{},goal_progress:I.data.goal_progress};h(w)}catch(U){console.error("❌ Error fetching daily summary for date:",R,U);const I=R||mn(xn());h({date:I,total_nutrition:{calories:0,protein:0,carbs:0,fat:0,fiber:0,sugar:0,sodium:0,water:{current:0,target:64,percentage:0}},meals:[],meal_breakdown:{}})}},[]),v=C.useCallback(async()=>{m(!0);try{await Promise.all([p(),j(),b()])}catch(R){console.error("Error refreshing app state:",R)}m(!1)},[p,j,b]);C.useEffect(()=>{v()},[v]);const N={activeGoal:n,goals:i,currentWeight:o,weightLogs:l,dailySummary:u,refreshGoals:p,refreshWeightLogs:j,refreshDailySummary:b,refreshAll:v,updateCurrentWeight:R=>{a(R)},loading:g};return e.jsx(Yu.Provider,{value:N,children:t})}function ai(){const t=C.useContext(Yu);if(t===void 0)throw new Error("useAppState must be used within an AppStateProvider");return t}const Ku=C.createContext(void 0);function Ju(){const t=C.useContext(Ku);if(!t)throw new Error("useFoodIndex must be used within a FoodIndexProvider");return t}function Ux({children:t}){const[n,r]=C.useState([]),[i,s]=C.useState(!1),[o,a]=C.useState(null),l=async()=>{s(!0),a(null);try{const h=await Z.get("/foods/search?q=&limit=100");r(h.data||[])}catch(h){console.error("Error fetching user foods:",h),a("Failed to load your food index")}finally{s(!1)}},c=async h=>{if(!h.trim())return[];try{return(await Z.get(`/foods/search?q=${encodeURIComponent(h)}&limit=50`)).data||[]}catch(g){return console.error("Error searching foods:",g),[]}};C.useEffect(()=>{l()},[]);const u={userFoods:n,isLoading:i,error:o,refreshUserFoods:l,searchUserFoods:c};return e.jsx(Ku.Provider,{value:u,children:t})}function Hx(){const[t,n]=C.useState(""),[r,i]=C.useState(""),[s,o]=C.useState(""),[a,l]=C.useState(""),[c,u]=C.useState(!1),{login:h,register:g}=vr(),m=async j=>{j.preventDefault(),l(""),u(!0);try{console.log("🔑 Starting login process..."),await h(t,r),console.log("✅ Login function completed successfully")}catch(b){console.error("❌ Login failed:",b),l(b.message||"Login failed")}u(!1)},p=async j=>{j.preventDefault(),l(""),u(!0);try{await g(t,r,s)}catch(b){l(b.message||"Registration failed")}u(!1)};return e.jsx(F,{minH:"100vh",display:"flex",alignItems:"center",justifyContent:"center",bg:"gray.50",px:4,children:e.jsxs(se,{maxW:"md",w:"full",children:[e.jsx(vt,{children:e.jsxs(S,{spacing:2,children:[e.jsx(me,{size:"lg",color:"green.600",children:"Nutrivize V2"}),e.jsx(d,{color:"gray.600",children:"Your Smart Nutrition Tracker"})]})}),e.jsx(re,{children:e.jsxs(Kr,{isFitted:!0,variant:"enclosed",children:[e.jsxs(Jr,{mb:4,children:[e.jsx(Pt,{children:"Login"}),e.jsx(Pt,{children:"Register"})]}),e.jsxs(Qr,{children:[e.jsx(Lt,{p:0,children:e.jsx("form",{onSubmit:m,children:e.jsxs(S,{spacing:4,children:[a&&e.jsxs(kt,{status:"error",children:[e.jsx(Et,{}),a]}),e.jsxs($,{isRequired:!0,children:[e.jsx(V,{children:"Email"}),e.jsx(ve,{type:"email",value:t,onChange:j=>n(j.target.value),placeholder:"Enter your email"})]}),e.jsxs($,{isRequired:!0,children:[e.jsx(V,{children:"Password"}),e.jsx(ve,{type:"password",value:r,onChange:j=>i(j.target.value),placeholder:"Enter your password"})]}),e.jsx(H,{type:"submit",colorScheme:"green",size:"lg",w:"full",isLoading:c,children:"Sign In"})]})})}),e.jsx(Lt,{p:0,children:e.jsx("form",{onSubmit:p,children:e.jsxs(S,{spacing:4,children:[a&&e.jsxs(kt,{status:"error",children:[e.jsx(Et,{}),a]}),e.jsxs($,{isRequired:!0,children:[e.jsx(V,{children:"Name"}),e.jsx(ve,{type:"text",value:s,onChange:j=>o(j.target.value),placeholder:"Enter your name"})]}),e.jsxs($,{isRequired:!0,children:[e.jsx(V,{children:"Email"}),e.jsx(ve,{type:"email",value:t,onChange:j=>n(j.target.value),placeholder:"Enter your email"})]}),e.jsxs($,{isRequired:!0,children:[e.jsx(V,{children:"Password"}),e.jsx(ve,{type:"password",value:r,onChange:j=>i(j.target.value),placeholder:"Enter your password"})]}),e.jsx(H,{type:"submit",colorScheme:"green",size:"lg",w:"full",isLoading:c,children:"Sign Up"})]})})})]})]})})]})})}const $x=dn({d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z",displayName:"CopyIcon"}),Bi=dn({d:"M0,12a1.5,1.5,0,0,0,1.5,1.5h8.75a.25.25,0,0,1,.25.25V22.5a1.5,1.5,0,0,0,3,0V13.75a.25.25,0,0,1,.25-.25H22.5a1.5,1.5,0,0,0,0-3H13.75a.25.25,0,0,1-.25-.25V1.5a1.5,1.5,0,0,0-3,0v8.75a.25.25,0,0,1-.25.25H1.5A1.5,1.5,0,0,0,0,12Z",displayName:"AddIcon"}),Vx=dn({viewBox:"0 0 14 14",d:"M14,7.77 L14,6.17 L12.06,5.53 L11.61,4.44 L12.49,2.6 L11.36,1.47 L9.55,2.38 L8.46,1.93 L7.77,0.01 L6.17,0.01 L5.54,1.95 L4.43,2.4 L2.59,1.52 L1.46,2.65 L2.37,4.46 L1.92,5.55 L0,6.23 L0,7.82 L1.94,8.46 L2.39,9.55 L1.51,11.39 L2.64,12.52 L4.45,11.61 L5.54,12.06 L6.23,13.98 L7.82,13.98 L8.45,12.04 L9.56,11.59 L11.4,12.47 L12.53,11.34 L11.61,9.53 L12.08,8.44 L14,7.75 L14,7.77 Z M7,10 C5.34,10 4,8.66 4,7 C4,5.34 5.34,4 7,4 C8.66,4 10,5.34 10,7 C10,8.66 8.66,10 7,10 Z",displayName:"SettingsIcon"}),qx=dn({displayName:"ViewIcon",path:e.jsxs("g",{fill:"currentColor",children:[e.jsx("path",{d:"M23.432,10.524C20.787,7.614,16.4,4.538,12,4.6,7.6,4.537,3.213,7.615.568,10.524a2.211,2.211,0,0,0,0,2.948C3.182,16.351,7.507,19.4,11.839,19.4h.308c4.347,0,8.671-3.049,11.288-5.929A2.21,2.21,0,0,0,23.432,10.524ZM7.4,12A4.6,4.6,0,1,1,12,16.6,4.6,4.6,0,0,1,7.4,12Z"}),e.jsx("circle",{cx:"12",cy:"12",r:"2"})]})}),Ui=dn({displayName:"DeleteIcon",path:e.jsx("g",{fill:"currentColor",children:e.jsx("path",{d:"M19.452 7.5H4.547a.5.5 0 00-.5.545l1.287 14.136A2 2 0 007.326 24h9.347a2 2 0 001.992-1.819L19.95 8.045a.5.5 0 00-.129-.382.5.5 0 00-.369-.163zm-9.2 13a.75.75 0 01-1.5 0v-9a.75.75 0 011.5 0zm5 0a.75.75 0 01-1.5 0v-9a.75.75 0 011.5 0zM22 4h-4.75a.25.25 0 01-.25-.25V2.5A2.5 2.5 0 0014.5 0h-5A2.5 2.5 0 007 2.5v1.25a.25.25 0 01-.25.25H2a1 1 0 000 2h20a1 1 0 000-2zM9 3.75V2.5a.5.5 0 01.5-.5h5a.5.5 0 01.5.5v1.25a.25.25 0 01-.25.25h-5.5A.25.25 0 019 3.75z"})})}),Qu=dn({displayName:"EditIcon",path:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeWidth:"2",children:[e.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),Gx=dn({d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z",displayName:"ChevronLeftIcon"}),Yx=dn({d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z",displayName:"ChevronRightIcon"}),Kx=dn({displayName:"MinusIcon",path:e.jsx("g",{fill:"currentColor",children:e.jsx("rect",{height:"4",width:"20",x:"2",y:"10"})})}),Jx=dn({displayName:"HamburgerIcon",viewBox:"0 0 24 24",d:"M 3 5 A 1.0001 1.0001 0 1 0 3 7 L 21 7 A 1.0001 1.0001 0 1 0 21 5 L 3 5 z M 3 11 A 1.0001 1.0001 0 1 0 3 13 L 21 13 A 1.0001 1.0001 0 1 0 21 11 L 3 11 z M 3 17 A 1.0001 1.0001 0 1 0 3 19 L 21 19 A 1.0001 1.0001 0 1 0 21 17 L 3 17 z"}),Qx=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"})}),Xx=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"})}),Zx=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),vs=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M8.1 13.34l2.83-2.83L3.91 3.5c-1.56 1.56-1.56 4.09 0 5.66l4.19 4.18zm6.78-1.81c1.53.71 3.68.21 5.27-1.38 1.91-1.91 2.28-4.65.81-6.12-1.46-1.46-4.20-1.10-6.12.81-1.59 1.59-2.09 3.74-1.38 5.27L3.7 19.87l1.41 1.41L12 14.41l6.88 6.88 1.41-1.41L13.41 13l1.47-1.47z"})}),e0=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M11 9H9V2H7v7H5V2H3v7c0 2.12 1.66 3.84 3.75 3.97V22h2.5v-9.03C11.34 12.84 13 11.12 13 9V2h-2v7zm5-3v8h2.5v8H21V2c-2.76 0-5 2.24-5 4z"})}),t0=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})}),n0=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})}),r0=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"})}),ol=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.82,11.69,4.82,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.43-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"})});function i0(t={}){const{isDrawerOpen:n,onDrawerOpen:r,onDrawerClose:i}=t,{user:s,logout:o}=vr(),a=Xi(),l=Cc(),{isOpen:c,onOpen:u,onClose:h}=Fe(),g=_e("linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(249,252,255,0.98) 100%)","gray.800"),m=_e("rgba(79, 172, 254, 0.15)","gray.700"),p=Wt({base:!0,lg:!1}),j=n!==void 0?n:c,b=r||u,v=i||h,_=async()=>{await o(),a("/login"),v()},N=[{path:"/",label:"AI Dashboard",icon:Qx,emoji:"🚀"},{path:"/food-log",label:"Food Log",icon:Xx},{path:"/food-index",label:"Food Index",icon:Zx},{path:"/meal-suggestions",label:"Meal Ideas",icon:vs},{path:"/meal-plans",label:"Meal Plans",icon:vs},{path:"/manual-meal-planning",label:"Manual Meal Planning",icon:vs,emoji:"📝"},{path:"/restaurant-ai",label:"RestaurantAI",icon:e0,emoji:"🍽️"},{path:"/ai",label:"AI Chat",icon:t0},{path:"/goals",label:"Goals",icon:n0},{path:"/analytics",label:"Analytics",icon:r0},{path:"/settings",label:"Settings",icon:ol}],R=I=>I==="/"||I==="/ai-dashboard"?l.pathname==="/"||l.pathname==="/ai-dashboard":l.pathname===I,U=I=>{a(I),p&&v()};return e.jsxs(e.Fragment,{children:[e.jsx(F,{bg:g,borderBottomWidth:1,borderColor:m,position:"sticky",top:0,zIndex:1e3,children:e.jsx(It,{maxW:"container.xl",children:e.jsxs(Fn,{h:p?14:16,alignItems:"center",children:[e.jsx(me,{size:p?"sm":"md",color:"green.600",cursor:"pointer",onClick:()=>a("/"),children:p?"Nutrivize":"Nutrivize V2"}),e.jsx(ua,{}),p?e.jsx(et,{"aria-label":"Open navigation menu",icon:e.jsx(Jx,{}),variant:"ghost",onClick:b,size:"sm"}):e.jsx(A,{spacing:1,children:N.map(I=>e.jsxs(H,{variant:R(I.path)?"solid":"ghost",colorScheme:R(I.path)?"green":"gray",onClick:()=>a(I.path),size:"sm",fontSize:"xs",children:[I.emoji&&`${I.emoji} `,I.label]},I.path))}),!p&&e.jsxs(e.Fragment,{children:[e.jsx(ua,{}),e.jsxs(jc,{children:[e.jsx(yc,{as:H,variant:"ghost",p:0,children:e.jsx(Ei,{size:"sm",name:s?.name})}),e.jsxs(bc,{children:[e.jsx(Pr,{onClick:()=>a("/settings"),children:"Profile"}),e.jsx(Pr,{onClick:()=>a("/settings"),children:"Settings"}),e.jsx(Jd,{}),e.jsx(Pr,{onClick:_,children:"Sign Out"})]})]})]})]})})}),e.jsxs(wc,{isOpen:j,placement:"right",onClose:v,size:"xs",children:[e.jsx(Te,{}),e.jsxs(Sc,{children:[e.jsx(De,{}),e.jsx(Pe,{borderBottomWidth:"1px",children:e.jsxs(A,{children:[e.jsx(Ei,{size:"sm",name:s?.name}),e.jsxs(S,{align:"start",spacing:0,children:[e.jsx(d,{fontSize:"sm",fontWeight:"bold",children:s?.name||"User"}),e.jsx(d,{fontSize:"xs",color:"gray.500",children:s?.email})]})]})}),e.jsx(Le,{p:0,children:e.jsx(S,{spacing:0,align:"stretch",children:N.map(I=>{const w=I.icon,P=R(I.path);return e.jsxs(H,{variant:"ghost",justifyContent:"flex-start",leftIcon:e.jsx(w,{}),onClick:()=>U(I.path),colorScheme:P?"green":"gray",bg:P?"green.50":"transparent",borderRadius:0,py:6,fontSize:"md",fontWeight:P?"semibold":"normal",children:[I.emoji&&`${I.emoji} `,I.label]},I.path)})})}),e.jsxs(mt,{borderTopWidth:"1px",flexDirection:"column",gap:2,children:[e.jsx(H,{variant:"outline",w:"full",onClick:()=>U("/settings"),leftIcon:e.jsx(ol,{}),children:"Settings"}),e.jsx(H,{colorScheme:"red",variant:"ghost",w:"full",onClick:_,children:"Sign Out"})]})]})]})]})}const s0=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",w:5,h:5,children:e.jsx("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"})}),o0=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",w:5,h:5,children:e.jsx("path",{d:"M19 7h-3V6a4 4 0 0 0-8 0v1H5a1 1 0 0 0-1 1v11a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V8a1 1 0 0 0-1-1zM10 6a2 2 0 0 1 4 0v1h-4V6zm6 16H8a1 1 0 0 1-1-1V9h2v1a1 1 0 0 0 2 0V9h2v1a1 1 0 0 0 2 0V9h2v12a1 1 0 0 1-1 1z"})}),a0=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",w:5,h:5,children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),l0=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",w:5,h:5,children:e.jsx("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"})}),c0=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",w:5,h:5,children:e.jsx("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"})});function u0({onMenuOpen:t}){const n=Xi(),r=Cc(),i=_e("linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(249,252,255,0.98) 100%)","gray.800"),s=_e("rgba(79, 172, 254, 0.15)","gray.700"),o=_e("gray.600","gray.400"),a=_e("green.500","green.300");if(!Wt({base:!0,lg:!1}))return null;const c=[{path:"/",label:"Home",icon:s0},{path:"/food-log",label:"Log",icon:o0},{path:"/food-index",label:"Foods",icon:a0},{path:"/ai",label:"AI",icon:l0,badge:"AI"},{label:"Menu",icon:c0,action:t}],u=g=>g?g==="/"||g==="/ai-dashboard"?r.pathname==="/"||r.pathname==="/ai-dashboard":r.pathname===g:!1,h=g=>{g.action?g.action():g.path&&n(g.path)};return e.jsx(F,{position:"fixed",bottom:0,left:0,right:0,bg:i,borderTopWidth:1,borderColor:s,zIndex:1e3,pb:"env(safe-area-inset-bottom)",children:e.jsx(A,{spacing:0,justify:"space-around",py:2,children:c.map((g,m)=>{const p=g.icon,j=g.path?u(g.path):!1;return e.jsxs(S,{spacing:1,flex:1,cursor:"pointer",onClick:()=>h(g),color:j?a:o,transition:"color 0.2s",py:1,position:"relative",children:[e.jsxs(F,{position:"relative",children:[e.jsx(p,{}),g.badge&&e.jsx(je,{position:"absolute",top:"-8px",right:"-8px",fontSize:"2xs",colorScheme:"green",borderRadius:"full",minW:"16px",h:"16px",display:"flex",alignItems:"center",justifyContent:"center",children:g.badge})]}),e.jsx(d,{fontSize:"2xs",fontWeight:j?"semibold":"normal",lineHeight:"1",children:g.label})]},m)})})})}var Xu={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},al=jn.createContext&&jn.createContext(Xu),d0=["attr","size","title"];function h0(t,n){if(t==null)return{};var r=g0(t,n),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)i=o[s],!(n.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(r[i]=t[i])}return r}function g0(t,n){if(t==null)return{};var r={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(n.indexOf(i)>=0)continue;r[i]=t[i]}return r}function Hi(){return Hi=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Hi.apply(this,arguments)}function ll(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);n&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,i)}return r}function $i(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?ll(Object(r),!0).forEach(function(i){p0(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ll(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function p0(t,n,r){return n=f0(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function f0(t){var n=m0(t,"string");return typeof n=="symbol"?n:n+""}function m0(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,n);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Zu(t){return t&&t.map((n,r)=>jn.createElement(n.tag,$i({key:r},n.attr),Zu(n.child)))}function Ce(t){return n=>jn.createElement(x0,Hi({attr:$i({},t.attr)},n),Zu(t.child))}function x0(t){var n=r=>{var{attr:i,size:s,title:o}=t,a=h0(t,d0),l=s||r.size||"1em",c;return r.className&&(c=r.className),t.className&&(c=(c?c+" ":"")+t.className),jn.createElement("svg",Hi({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,i,a,{className:c,style:$i($i({color:t.color||r.color},r.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),o&&jn.createElement("title",null,o),t.children)};return al!==void 0?jn.createElement(al.Consumer,null,r=>n(r)):n(Xu)}function j0(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"22 12 18 12 15 21 9 3 6 12 2 12"},child:[]}]})(t)}function y0(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"16",x2:"12.01",y2:"16"},child:[]}]})(t)}function b0(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"20",x2:"12",y2:"10"},child:[]},{tag:"line",attr:{x1:"18",y1:"20",x2:"18",y2:"4"},child:[]},{tag:"line",attr:{x1:"6",y1:"20",x2:"6",y2:"16"},child:[]}]})(t)}function w0(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"16",y1:"2",x2:"16",y2:"6"},child:[]},{tag:"line",attr:{x1:"8",y1:"2",x2:"8",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"10",x2:"21",y2:"10"},child:[]}]})(t)}function ed(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"13",r:"4"},child:[]}]})(t)}function Vo(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"6 9 12 15 18 9"},child:[]}]})(t)}function qo(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"18 15 12 9 6 15"},child:[]}]})(t)}function Go(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"polyline",attr:{points:"12 6 12 12 16 14"},child:[]}]})(t)}function S0(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},child:[]},{tag:"polyline",attr:{points:"7 10 12 15 17 10"},child:[]},{tag:"line",attr:{x1:"12",y1:"15",x2:"12",y2:"3"},child:[]}]})(t)}function td(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"},child:[]}]})(t)}function Gr(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"16",x2:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12.01",y2:"8"},child:[]}]})(t)}function v0(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"10",r:"3"},child:[]}]})(t)}function _0(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21.21 15.89A10 10 0 1 1 8 2.83"},child:[]},{tag:"path",attr:{d:"M22 12A10 10 0 0 0 12 2v10z"},child:[]}]})(t)}function go(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"},child:[]},{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]}]})(t)}function nd(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"},child:[]},{tag:"polyline",attr:{points:"1 20 1 14 7 14"},child:[]},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"},child:[]}]})(t)}function Vi(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"},child:[]},{tag:"polyline",attr:{points:"17 21 17 13 7 13 7 21"},child:[]},{tag:"polyline",attr:{points:"7 3 7 8 15 8"},child:[]}]})(t)}function C0(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"},child:[]},{tag:"polyline",attr:{points:"16 6 12 2 8 6"},child:[]},{tag:"line",attr:{x1:"12",y1:"2",x2:"12",y2:"15"},child:[]}]})(t)}function k0(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"5",y:"2",width:"14",height:"20",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"12",y1:"18",x2:"12.01",y2:"18"},child:[]}]})(t)}function E0(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"},child:[]}]})(t)}function I0(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"5"},child:[]},{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"3"},child:[]},{tag:"line",attr:{x1:"12",y1:"21",x2:"12",y2:"23"},child:[]},{tag:"line",attr:{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"},child:[]},{tag:"line",attr:{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"},child:[]},{tag:"line",attr:{x1:"1",y1:"12",x2:"3",y2:"12"},child:[]},{tag:"line",attr:{x1:"21",y1:"12",x2:"23",y2:"12"},child:[]},{tag:"line",attr:{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"},child:[]},{tag:"line",attr:{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"},child:[]}]})(t)}function rd(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"6"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"2"},child:[]}]})(t)}function id(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 6 13.5 15.5 8.5 10.5 1 18"},child:[]},{tag:"polyline",attr:{points:"17 6 23 6 23 12"},child:[]}]})(t)}function sd(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},child:[]},{tag:"polyline",attr:{points:"17 8 12 3 7 8"},child:[]},{tag:"line",attr:{x1:"12",y1:"3",x2:"12",y2:"15"},child:[]}]})(t)}function cl(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"1",y1:"1",x2:"23",y2:"23"},child:[]},{tag:"path",attr:{d:"M16.72 11.06A10.94 10.94 0 0 1 19 12.55"},child:[]},{tag:"path",attr:{d:"M5 12.55a10.94 10.94 0 0 1 5.17-2.39"},child:[]},{tag:"path",attr:{d:"M10.71 5.05A16 16 0 0 1 22.58 9"},child:[]},{tag:"path",attr:{d:"M1.42 9a15.91 15.91 0 0 1 4.7-2.88"},child:[]},{tag:"path",attr:{d:"M8.53 16.11a6 6 0 0 1 6.95 0"},child:[]},{tag:"line",attr:{x1:"12",y1:"20",x2:"12.01",y2:"20"},child:[]}]})(t)}function z0(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M5 12.55a11 11 0 0 1 14.08 0"},child:[]},{tag:"path",attr:{d:"M1.42 9a16 16 0 0 1 21.16 0"},child:[]},{tag:"path",attr:{d:"M8.53 16.11a6 6 0 0 1 6.95 0"},child:[]},{tag:"line",attr:{x1:"12",y1:"20",x2:"12.01",y2:"20"},child:[]}]})(t)}function A0(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(t)}function T0(t){return Ce({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"},child:[]}]})(t)}const P0=()=>{const[t,n]=C.useState(navigator.onLine),[r,i]=C.useState(!1),[s,o]=C.useState(null),a=wt();C.useEffect(()=>{const c=()=>{n(!0),a({title:"Back Online",description:"Your connection has been restored.",status:"success",duration:3e3,isClosable:!0,position:"top"})},u=()=>{n(!1),a({title:"You're Offline",description:"Some features may be limited while offline.",status:"warning",duration:5e3,isClosable:!0,position:"top"})};return window.addEventListener("online",c),window.addEventListener("offline",u),"serviceWorker"in navigator&&(navigator.serviceWorker.ready.then(h=>{o(h),h.addEventListener("updatefound",()=>{const g=h.installing;g&&g.addEventListener("statechange",()=>{g.state==="installed"&&navigator.serviceWorker.controller&&i(!0)})})}),navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()})),()=>{window.removeEventListener("online",c),window.removeEventListener("offline",u)}},[a]);const l=()=>{s&&s.waiting&&(s.waiting.postMessage({type:"SKIP_WAITING"}),i(!1))};return e.jsxs(e.Fragment,{children:[!t&&e.jsx(F,{position:"fixed",top:"0",left:"0",right:"0",zIndex:"1000",children:e.jsxs(kt,{status:"warning",justifyContent:"center",py:2,children:[e.jsx(Et,{as:cl}),e.jsx(Xn,{fontSize:"sm",children:"Offline Mode"}),e.jsx(wn,{fontSize:"xs",ml:2,children:"Some features are limited"})]})}),r&&e.jsx(F,{position:"fixed",bottom:"20px",left:"20px",right:"20px",zIndex:"1000",children:e.jsxs(kt,{status:"info",borderRadius:"12px",boxShadow:"lg",bg:"blue.50",border:"1px solid",borderColor:"blue.200",children:[e.jsx(Et,{}),e.jsxs(S,{align:"stretch",spacing:2,flex:"1",children:[e.jsx(Xn,{fontSize:"sm",children:"Update Available"}),e.jsx(wn,{fontSize:"xs",children:"A new version of Nutrivize is ready to install."}),e.jsxs(A,{spacing:2,children:[e.jsx(H,{size:"xs",colorScheme:"blue",onClick:l,leftIcon:e.jsx(nd,{}),children:"Update Now"}),e.jsx(H,{size:"xs",variant:"ghost",onClick:()=>i(!1),children:"Later"})]})]})]})}),e.jsx(F,{position:"fixed",top:"env(safe-area-inset-top)",right:"20px",zIndex:"999",children:e.jsx(Fn,{align:"center",justify:"center",w:"40px",h:"20px",bg:t?"green.500":"red.500",borderRadius:"full",opacity:.7,transition:"all 0.3s",children:t?e.jsx(z0,{size:"12px",color:"white"}):e.jsx(cl,{size:"12px",color:"white"})})})]})},L0=({isOpen:t,onClose:n})=>{const[r,i]=C.useState(null),[s,o]=C.useState(!1),[a,l]=C.useState(!1),c=_e("white","gray.800"),u=_e("gray.600","gray.300");C.useEffect(()=>{const p=window.navigator.userAgent.toLowerCase(),j=/iphone|ipad|ipod/.test(p);o(j);const b=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0;l(b);const v=_=>{_.preventDefault(),i(_)};return window.addEventListener("beforeinstallprompt",v),()=>{window.removeEventListener("beforeinstallprompt",v)}},[]);const h=async()=>{if(r){r.prompt();const{outcome:p}=await r.userChoice;p==="accepted"&&(i(null),n())}},g=[{icon:C0,text:"Tap the Share button"},{icon:go,text:'Scroll down and tap "Add to Home Screen"'},{icon:k0,text:'Tap "Add" to install Nutrivize'}],m=["Faster loading and better performance","Works offline with cached data","Quick access from your home screen","Optimized for iPhone and Dynamic Island","Push notifications for meal reminders"];return a?null:e.jsxs(Ue,{isOpen:t,onClose:n,size:"md",isCentered:!0,children:[e.jsx(Te,{}),e.jsxs(He,{bg:c,borderRadius:"20px",children:[e.jsx(Pe,{children:e.jsxs(S,{spacing:3,align:"center",children:[e.jsx(Io,{src:"/icons/icon-192x192.png",alt:"Nutrivize",boxSize:"80px",borderRadius:"18px",shadow:"lg"}),e.jsxs(S,{spacing:1,children:[e.jsx(d,{fontSize:"xl",fontWeight:"bold",children:"Install Nutrivize"}),e.jsx(je,{colorScheme:"green",borderRadius:"full",px:3,children:"PWA App"})]})]})}),e.jsx(De,{}),e.jsx(Le,{children:e.jsxs(S,{spacing:6,align:"stretch",children:[e.jsxs(F,{children:[e.jsx(d,{fontSize:"md",fontWeight:"medium",mb:3,children:"Why install the app?"}),e.jsx(S,{spacing:2,align:"stretch",children:m.map((p,j)=>e.jsxs(A,{spacing:3,children:[e.jsx(F,{w:"6px",h:"6px",borderRadius:"full",bg:"green.500",flexShrink:0,mt:2}),e.jsx(d,{fontSize:"sm",color:u,children:p})]},j))})]}),s?e.jsxs(F,{children:[e.jsx(d,{fontSize:"md",fontWeight:"medium",mb:3,children:"How to install on iPhone:"}),e.jsx(S,{spacing:3,align:"stretch",children:g.map((p,j)=>e.jsxs(A,{spacing:3,children:[e.jsx(F,{w:"32px",h:"32px",borderRadius:"8px",bg:"green.100",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,children:e.jsx($e,{as:p.icon,color:"green.600"})}),e.jsx(d,{fontSize:"sm",color:u,children:p.text})]},j))})]}):r?e.jsxs(F,{textAlign:"center",children:[e.jsx(d,{fontSize:"sm",color:u,mb:4,children:"Click the button below to install Nutrivize on your device."}),e.jsx(H,{colorScheme:"green",size:"lg",leftIcon:e.jsx(S0,{}),onClick:h,borderRadius:"12px",w:"full",children:"Install App"})]}):e.jsx(F,{textAlign:"center",children:e.jsx(d,{fontSize:"sm",color:u,children:"Your browser doesn't support app installation. You can still use Nutrivize in your browser!"})})]})}),e.jsx(mt,{children:e.jsx(H,{variant:"ghost",onClick:n,borderRadius:"12px",children:"Maybe Later"})})]})]})};function R0(){const{user:t}=vr(),n=Xi(),r=Wt({base:!0,md:!1}),{dailySummary:i,goals:s,loading:o,refreshDailySummary:a,refreshGoals:l}=ai(),c=_e("white","gray.800"),u=_e("gray.200","gray.700");C.useEffect(()=>{const j=xn(),b=mn(j);console.log("📅 Dashboard loading data for today:",b,"in timezone:",j),a(b),l()},[a,l]);const h=s.find(j=>j.active)||null,g=(j,b)=>Math.min(j/b*100,100),m=h?.nutrition_targets||{calories:2e3,protein:150,carbs:250,fat:65};if(o)return e.jsx(It,{maxW:"container.xl",py:8,children:e.jsx(d,{children:"Loading..."})});const p=i?.total_nutrition||{calories:0,protein:0,carbs:0,fat:0};return e.jsx(It,{maxW:r?"100%":"container.xl",py:r?4:8,px:r?3:8,children:e.jsxs(S,{spacing:r?4:8,align:"stretch",children:[e.jsxs(F,{textAlign:r?"center":"left",children:[e.jsxs(me,{size:r?"md":"lg",mb:2,children:["Welcome back, ",t?.name,"! 👋"]}),e.jsx(d,{color:"gray.600",fontSize:r?"sm":"md",children:"Here's your nutrition summary for today"})]}),!h&&e.jsxs(kt,{status:"info",children:[e.jsx(Et,{}),e.jsxs(F,{flex:"1",children:[e.jsx(Xn,{children:"Welcome to Nutrivize!"}),e.jsx(wn,{children:"Set up your nutrition goals to get personalized recommendations and track your progress."})]}),e.jsx(H,{colorScheme:"blue",size:"sm",onClick:()=>n("/goals"),children:"Set Goals"})]}),e.jsxs(xe,{columns:{base:1,md:4},spacing:6,children:[e.jsx(se,{bg:c,borderColor:u,children:e.jsx(re,{children:e.jsxs(be,{children:[e.jsx(we,{children:"Calories"}),e.jsx(Se,{children:Math.round(p.calories)}),e.jsxs(ot,{children:["of ",m.calories," kcal"]}),e.jsx(xt,{value:g(p.calories,m.calories),colorScheme:"blue",size:"sm",mt:2})]})})}),e.jsx(se,{bg:c,borderColor:u,children:e.jsx(re,{children:e.jsxs(be,{children:[e.jsx(we,{children:"Protein"}),e.jsxs(Se,{children:[Math.round(p.protein),"g"]}),e.jsxs(ot,{children:["of ",m.protein,"g"]}),e.jsx(xt,{value:g(p.protein,m.protein),colorScheme:"red",size:"sm",mt:2})]})})}),e.jsx(se,{bg:c,borderColor:u,children:e.jsx(re,{children:e.jsxs(be,{children:[e.jsx(we,{children:"Carbs"}),e.jsxs(Se,{children:[Math.round(p.carbs),"g"]}),e.jsxs(ot,{children:["of ",m.carbs,"g"]}),e.jsx(xt,{value:g(p.carbs,m.carbs),colorScheme:"green",size:"sm",mt:2})]})})}),e.jsx(se,{bg:c,borderColor:u,children:e.jsx(re,{children:e.jsxs(be,{children:[e.jsx(we,{children:"Fat"}),e.jsxs(Se,{children:[Math.round(p.fat),"g"]}),e.jsxs(ot,{children:["of ",m.fat,"g"]}),e.jsx(xt,{value:g(p.fat,m.fat),colorScheme:"yellow",size:"sm",mt:2})]})})})]}),e.jsx(se,{bg:c,borderColor:u,children:e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsx(me,{size:"md",children:"Quick Actions"}),e.jsxs(A,{spacing:4,wrap:"wrap",children:[e.jsx(H,{colorScheme:"green",size:"md",onClick:()=>n("/food-log"),children:"Log Food"}),e.jsx(H,{colorScheme:"blue",size:"md",onClick:()=>n("/meal-planning"),children:"Get Meal Suggestions"}),e.jsx(H,{colorScheme:"purple",size:"md",onClick:()=>n("/ai"),children:"Chat with AI Assistant"}),e.jsx(H,{colorScheme:"orange",size:"md",onClick:()=>n("/analytics"),children:"View Analytics"})]})]})})}),i?.meals&&i.meals.length>0&&e.jsx(se,{bg:c,borderColor:u,children:e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsx(me,{size:"md",children:"Today's Meals"}),e.jsx(S,{spacing:3,align:"stretch",children:i.meals.map(j=>e.jsx(F,{p:3,borderWidth:1,borderColor:u,borderRadius:"md",children:e.jsxs(A,{justify:"space-between",children:[e.jsxs(S,{align:"start",spacing:1,children:[e.jsx(d,{fontWeight:"medium",children:j.food_name}),e.jsxs(d,{fontSize:"sm",color:"gray.600",children:[j.meal_type," • ",j.amount," ",j.unit]})]}),e.jsxs(d,{fontWeight:"medium",children:[Math.round(j.nutrition.calories)," cal"]})]})},j.id))})]})})})]})})}const M0=()=>{const[t,n]=C.useState(null),[r,i]=C.useState(!0),[s,o]=C.useState(null),a=async()=>{try{i(!0),o(null);const l=await Z.get("/ai-dashboard/coaching");n(l.data)}catch(l){console.error("Error fetching AI coaching:",l),o(l.message),n(null)}finally{i(!1)}};return C.useEffect(()=>{a()},[]),{coaching:t,loading:r,error:s,refetch:a}},O0=()=>{const[t,n]=C.useState(null),[r,i]=C.useState(!0),[s,o]=C.useState(null),a=async()=>{try{i(!0),o(null);const l=await Z.get("/ai-dashboard/nutrition");n(l.data)}catch(l){console.error("Error fetching nutrition data:",l),o(l.message),n(null)}finally{i(!1)}};return C.useEffect(()=>{a()},[]),{nutrition:t,loading:r,error:s,refetch:a}},F0=()=>{const[t,n]=C.useState(null),[r,i]=C.useState(!0),[s,o]=C.useState(null),a=async()=>{try{i(!0),o(null);const l=await Z.get("/ai-dashboard/health-score");n(l.data)}catch(l){console.error("Error fetching health score:",l),o(l.message),n(null)}finally{i(!1)}};return C.useEffect(()=>{a()},[]),{healthScore:t,loading:r,error:s,refetch:a}};function D0(){const[t,n]=C.useState(null),[r,i]=C.useState(!0),[s,o]=C.useState(null);return C.useEffect(()=>{async function a(){try{i(!0);const l=await Z.get("/ai-health/health-score");n(l.data),o(null)}catch(l){console.error("Error fetching enhanced health score:",l),o("Failed to load health score data"),n(null)}finally{i(!1)}}a()},[]),{enhancedHealthScore:t,loading:r,error:s}}const hi=zo(se);function N0({isOpen:t,onClose:n}){const[r,i]=C.useState(null),[s,o]=C.useState(!1),[a,l]=C.useState(null),c=_e("white","gray.800"),u=_e("gray.200","gray.600"),h=_e("gray.50","gray.700"),g=async()=>{try{o(!0),l(null);const b=await Z.get("/ai-dashboard/todays-nutrition-detail");i(b.data)}catch(b){console.error("Error fetching nutrition detail:",b),l(b.message||"Failed to load nutrition details")}finally{o(!1)}};C.useEffect(()=>{t&&g()},[t]);const m=b=>{switch(b.toLowerCase()){case"breakfast":return"🌅";case"lunch":return"🌞";case"dinner":return"🌙";case"snack":return"🍎";default:return"🍽️"}},p=b=>b>=90?"green":b>=70?"blue":b>=50?"yellow":"red",j=b=>{try{const[v,_]=b.split(":"),N=parseInt(v),R=N>=12?"PM":"AM";return`${N%12||12}:${_} ${R}`}catch{return b}};return s?e.jsxs(Ue,{isOpen:t,onClose:n,size:"6xl",scrollBehavior:"inside",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsx(Pe,{children:"Today's Nutrition Details"}),e.jsx(De,{}),e.jsx(Le,{children:e.jsx(Ot,{py:20,children:e.jsxs(S,{spacing:4,children:[e.jsx(ut,{size:"xl",color:"blue.500"}),e.jsx(d,{children:"Loading your nutrition details..."})]})})})]})]}):a||!r?.success?e.jsxs(Ue,{isOpen:t,onClose:n,size:"xl",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsx(Pe,{children:"Today's Nutrition Details"}),e.jsx(De,{}),e.jsx(Le,{children:e.jsxs(kt,{status:"error",children:[e.jsx(Et,{}),e.jsx(wn,{children:a||"Unable to load nutrition details. Please try again."})]})}),e.jsxs(mt,{children:[e.jsx(H,{onClick:()=>g(),colorScheme:"blue",mr:3,children:"Retry"}),e.jsx(H,{onClick:n,children:"Close"})]})]})]}):e.jsxs(Ue,{isOpen:t,onClose:n,size:"6xl",scrollBehavior:"inside",children:[e.jsx(Te,{zIndex:1400}),e.jsxs(He,{zIndex:1500,children:[e.jsx(Pe,{children:e.jsxs(A,{justify:"space-between",children:[e.jsxs(S,{align:"start",spacing:1,children:[e.jsx(me,{size:"lg",children:"📊 Today's Nutrition Breakdown"}),e.jsx(d,{fontSize:"sm",color:"gray.500",children:new Date(r.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs(S,{spacing:1,children:[e.jsxs(je,{colorScheme:"blue",fontSize:"sm",children:[r.total_foods_logged," foods logged"]}),e.jsxs(je,{colorScheme:"green",fontSize:"sm",children:[r.meals_with_data," meals"]})]})]})}),e.jsx(De,{}),e.jsx(Le,{children:e.jsxs(S,{spacing:6,align:"stretch",children:[e.jsxs(hi,{bg:c,borderColor:u,borderWidth:1,initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[e.jsx(vt,{children:e.jsx(me,{size:"md",children:"📈 Daily Summary"})}),e.jsx(re,{children:e.jsxs(xe,{columns:{base:2,md:4},spacing:4,children:[e.jsxs(be,{children:[e.jsx(we,{children:"Calories"}),e.jsx(Se,{color:p(r.target_percentages.calories?.percentage||0)+".500",children:r.summary.calories_consumed}),e.jsx(ot,{children:r.summary.calories_remaining>0?`${r.summary.calories_remaining} remaining`:"Target reached!"})]}),e.jsxs(be,{children:[e.jsx(we,{children:"Protein"}),e.jsxs(Se,{color:p(r.target_percentages.protein?.percentage||0)+".500",children:[r.summary.protein_consumed,"g"]}),e.jsx(ot,{children:r.summary.protein_remaining>0?`${r.summary.protein_remaining.toFixed(1)}g remaining`:"Target reached!"})]}),e.jsxs(be,{children:[e.jsx(we,{children:"Carbs"}),e.jsxs(Se,{color:p(r.target_percentages.carbs?.percentage||0)+".500",children:[r.summary.carbs_consumed,"g"]}),e.jsxs(ot,{children:[r.target_percentages.carbs?.percentage.toFixed(0),"% of target"]})]}),e.jsxs(be,{children:[e.jsx(we,{children:"Fat"}),e.jsxs(Se,{color:p(r.target_percentages.fat?.percentage||0)+".500",children:[r.summary.fat_consumed,"g"]}),e.jsxs(ot,{children:[r.target_percentages.fat?.percentage.toFixed(0),"% of target"]})]})]})})]}),e.jsxs(hi,{bg:c,borderColor:u,borderWidth:1,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:[e.jsx(vt,{children:e.jsx(me,{size:"md",children:"🎯 Progress Towards Targets"})}),e.jsx(re,{children:e.jsx(S,{spacing:4,children:Object.entries(r.target_percentages).map(([b,v])=>e.jsxs(S,{w:"full",spacing:2,children:[e.jsxs(A,{justify:"space-between",w:"full",children:[e.jsx(d,{fontWeight:"medium",textTransform:"capitalize",children:b}),e.jsxs(d,{fontSize:"sm",color:"gray.600",children:[v.current," / ",v.target,b==="calories"?"":"g"]})]}),e.jsx(xt,{value:v.percentage,w:"full",colorScheme:p(v.percentage),size:"lg",borderRadius:"md"}),e.jsxs(d,{fontSize:"xs",color:"gray.500",alignSelf:"end",children:[v.percentage.toFixed(1),"%"]})]},b))})})]}),r.meal_timing.length>0&&e.jsxs(hi,{bg:c,borderColor:u,borderWidth:1,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:[e.jsx(vt,{children:e.jsx(me,{size:"md",children:"⏰ Meal Timeline"})}),e.jsx(re,{children:e.jsx(S,{spacing:3,align:"stretch",children:r.meal_timing.map((b,v)=>e.jsxs(A,{spacing:4,p:3,bg:h,borderRadius:"lg",children:[e.jsx(d,{fontSize:"lg",children:m(b.meal_type)}),e.jsx(d,{fontWeight:"bold",minW:"80px",children:j(b.time)}),e.jsx(je,{colorScheme:"blue",textTransform:"capitalize",children:b.meal_type}),e.jsx(d,{flex:1,children:b.food})]},v))})})]}),e.jsxs(hi,{bg:c,borderColor:u,borderWidth:1,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[e.jsx(vt,{children:e.jsx(me,{size:"md",children:"🍽️ Meal-by-Meal Breakdown"})}),e.jsx(re,{children:e.jsx(Ao,{allowMultiple:!0,children:Object.entries(r.meals_breakdown).filter(([b,v])=>v.logs.length>0).map(([b,v])=>e.jsxs(Lr,{children:[e.jsxs(Rr,{children:[e.jsx(F,{flex:"1",textAlign:"left",children:e.jsxs(A,{children:[e.jsx(d,{fontSize:"lg",children:m(b)}),e.jsx(d,{fontWeight:"bold",textTransform:"capitalize",children:b}),e.jsxs(je,{colorScheme:"blue",children:[v.logs.length," items"]}),e.jsxs(je,{colorScheme:"green",children:[Math.round(v.totals.calories||0)," cal"]})]})}),e.jsx(Mr,{})]}),e.jsx(Or,{pb:4,children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs(F,{p:4,bg:h,borderRadius:"lg",children:[e.jsx(d,{fontWeight:"bold",mb:2,children:"Meal Totals:"}),e.jsxs(xe,{columns:{base:2,md:4},spacing:2,children:[e.jsxs(d,{fontSize:"sm",children:[e.jsx("strong",{children:"Calories:"})," ",Math.round(v.totals.calories||0)]}),e.jsxs(d,{fontSize:"sm",children:[e.jsx("strong",{children:"Protein:"})," ",(v.totals.protein||0).toFixed(1),"g"]}),e.jsxs(d,{fontSize:"sm",children:[e.jsx("strong",{children:"Carbs:"})," ",(v.totals.carbs||0).toFixed(1),"g"]}),e.jsxs(d,{fontSize:"sm",children:[e.jsx("strong",{children:"Fat:"})," ",(v.totals.fat||0).toFixed(1),"g"]})]})]}),e.jsx(S,{spacing:3,children:v.logs.map(_=>e.jsxs(F,{p:4,border:"1px",borderColor:u,borderRadius:"lg",w:"full",children:[e.jsxs(A,{justify:"space-between",mb:2,children:[e.jsxs(S,{align:"start",spacing:1,children:[e.jsx(d,{fontWeight:"bold",children:_.food_name}),e.jsxs(d,{fontSize:"sm",color:"gray.600",children:[_.amount," ",_.unit,_.logged_at&&e.jsxs(e.Fragment,{children:[" • ",j(_.logged_at.split("T")[1]?.substring(0,5)||"")]})]}),_.notes&&e.jsx(d,{fontSize:"xs",color:"gray.500",fontStyle:"italic",children:_.notes})]}),e.jsxs(S,{align:"end",spacing:1,children:[e.jsxs(d,{fontSize:"sm",fontWeight:"bold",children:[Math.round(_.nutrition.calories||0)," cal"]}),e.jsxs(d,{fontSize:"xs",color:"gray.600",children:["P: ",(_.nutrition.protein||0).toFixed(1),"g"]})]})]}),e.jsxs(xe,{columns:{base:2,md:4},spacing:2,fontSize:"xs",color:"gray.600",children:[e.jsxs(d,{children:["Carbs: ",(_.nutrition.carbs||0).toFixed(1),"g"]}),e.jsxs(d,{children:["Fat: ",(_.nutrition.fat||0).toFixed(1),"g"]}),e.jsxs(d,{children:["Fiber: ",(_.nutrition.fiber||0).toFixed(1),"g"]}),e.jsxs(d,{children:["Sugar: ",(_.nutrition.sugar||0).toFixed(1),"g"]})]})]},_._id))})]})})]},b))})})]})]})}),e.jsxs(mt,{children:[e.jsx(H,{colorScheme:"blue",mr:3,onClick:()=>g(),children:"Refresh Data"}),e.jsx(H,{onClick:n,children:"Close"})]})]})]})}const W0=({isOpen:t,onClose:n,onSuccess:r})=>{const[i,s]=C.useState(8),[o,a]=C.useState(!1),l=wt(),c=[4,8,12,16,20,24,32],u=async()=>{if(i<=0){l({title:"Invalid Amount",description:"Please enter a valid water amount",status:"error",duration:3e3,isClosable:!0});return}try{a(!0);const h=new Date().toISOString().split("T")[0];await Z.post("/water-logs/",{date:h,amount:i,notes:""}),l({title:"Water Logged!",description:`Successfully logged ${i} fl oz of water`,status:"success",duration:3e3,isClosable:!0}),r?.(),n(),s(8)}catch(h){console.error("Error logging water:",h),l({title:"Error",description:"Failed to log water. Please try again.",status:"error",duration:3e3,isClosable:!0})}finally{a(!1)}};return e.jsxs(Ue,{isOpen:t,onClose:n,size:"md",children:[e.jsx(Te,{zIndex:1200}),e.jsxs(He,{zIndex:1300,children:[e.jsx(Pe,{children:e.jsxs(A,{children:[e.jsx(d,{fontSize:"xl",children:"💧 Log Water Intake"}),e.jsx(je,{colorScheme:"blue",variant:"subtle",children:"fl oz"})]})}),e.jsx(De,{}),e.jsx(Le,{children:e.jsxs(S,{spacing:6,children:[e.jsxs(S,{spacing:3,w:"full",children:[e.jsx(d,{fontSize:"md",fontWeight:"medium",children:"Amount (fl oz)"}),e.jsxs(ue,{value:i,onChange:(h,g)=>s(g||0),min:0,max:100,step:.1,precision:2,size:"lg",w:"full",allowMouseWheel:!1,children:[e.jsx(de,{textAlign:"center",fontSize:"xl"}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]}),e.jsx(_t,{}),e.jsxs(S,{spacing:3,w:"full",children:[e.jsx(d,{fontSize:"sm",color:"gray.600",children:"Quick Select (fl oz)"}),e.jsx(xe,{columns:4,spacing:2,w:"full",children:c.map(h=>e.jsx(H,{size:"sm",variant:i===h?"solid":"outline",colorScheme:"blue",onClick:()=>s(h),children:h},h))})]}),e.jsxs(F,{p:4,bg:"blue.50",borderRadius:"md",w:"full",textAlign:"center",children:[e.jsxs(d,{fontSize:"lg",fontWeight:"bold",color:"blue.700",children:["Logging: ",i," fl oz"]}),e.jsxs(d,{fontSize:"sm",color:"blue.600",children:["≈ ",(i*29.5735).toFixed(0)," ml"]})]})]})}),e.jsxs(mt,{children:[e.jsx(H,{variant:"ghost",mr:3,onClick:n,children:"Cancel"}),e.jsx(H,{colorScheme:"blue",onClick:u,isLoading:o,loadingText:"Logging...",children:"Log Water"})]})]})]})},B0=({isOpen:t,onClose:n,onSuccess:r})=>{const[i,s]=C.useState(150),[o,a]=C.useState("lbs"),[l,c]=C.useState(!1),u=wt(),h=async()=>{if(i<=0){u({title:"Invalid Weight",description:"Please enter a valid weight",status:"error",duration:3e3,isClosable:!0});return}try{c(!0);const m=new Date().toISOString().split("T")[0],p=o==="kg"?i*2.20462:i;await Z.post("/weight-logs/",{date:m,weight_lbs:p,timestamp:new Date().toISOString()}),u({title:"Weight Logged!",description:`Successfully logged ${i} ${o}`,status:"success",duration:3e3,isClosable:!0}),r?.(),n()}catch(m){console.error("Error logging weight:",m),u({title:"Error",description:"Failed to log weight. Please try again.",status:"error",duration:3e3,isClosable:!0})}finally{c(!1)}},g=o==="lbs"?(i*.453592).toFixed(1):(i*2.20462).toFixed(1);return e.jsxs(Ue,{isOpen:t,onClose:n,size:"md",children:[e.jsx(Te,{zIndex:1200}),e.jsxs(He,{zIndex:1300,children:[e.jsx(Pe,{children:e.jsxs(A,{children:[e.jsx(d,{fontSize:"xl",children:"⚖️ Log Weight"}),e.jsx(je,{colorScheme:"purple",variant:"subtle",children:o})]})}),e.jsx(De,{}),e.jsx(Le,{children:e.jsxs(S,{spacing:6,children:[e.jsxs(S,{spacing:3,w:"full",children:[e.jsx(d,{fontSize:"md",fontWeight:"medium",children:"Unit"}),e.jsx(Qd,{value:o,onChange:a,children:e.jsxs(Gs,{direction:"row",spacing:6,children:[e.jsx(da,{value:"lbs",colorScheme:"purple",children:"Pounds (lbs)"}),e.jsx(da,{value:"kg",colorScheme:"purple",children:"Kilograms (kg)"})]})})]}),e.jsxs(S,{spacing:3,w:"full",children:[e.jsxs(d,{fontSize:"md",fontWeight:"medium",children:["Weight (",o,")"]}),e.jsxs(ue,{value:i,onChange:(m,p)=>s(p||0),min:0,max:1e3,step:.1,size:"lg",w:"full",children:[e.jsx(de,{textAlign:"center",fontSize:"xl"}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]}),e.jsxs(F,{p:4,bg:"purple.50",borderRadius:"md",w:"full",textAlign:"center",children:[e.jsxs(d,{fontSize:"lg",fontWeight:"bold",color:"purple.700",children:["Logging: ",i," ",o]}),e.jsxs(d,{fontSize:"sm",color:"purple.600",children:["≈ ",g," ",o==="lbs"?"kg":"lbs"]})]})]})}),e.jsxs(mt,{children:[e.jsx(H,{variant:"ghost",mr:3,onClick:n,children:"Cancel"}),e.jsx(H,{colorScheme:"purple",onClick:h,isLoading:l,loadingText:"Logging...",children:"Log Weight"})]})]})]})},qi={g:1,gram:1,grams:1,kg:1e3,kilogram:1e3,kilograms:1e3,oz:28.3495,ounce:28.3495,ounces:28.3495,lb:453.592,pound:453.592,pounds:453.592,mg:.001,milligram:.001,milligrams:.001},Gi={ml:1,milliliter:1,milliliters:1,l:1e3,liter:1e3,liters:1e3,cup:236.588,cups:236.588,tbsp:14.7868,tablespoon:14.7868,tablespoons:14.7868,tsp:4.92892,teaspoon:4.92892,teaspoons:4.92892,"fl oz":29.5735,"fluid ounce":29.5735,"fluid ounces":29.5735,pint:473.176,pints:473.176,quart:946.353,quarts:946.353,gallon:3785.41,gallons:3785.41},od=["piece","pieces","item","items","serving","servings","slice","slices","unit","units","each","whole","can","cans","bottle","bottles","package","packages","pack","packs"],U0=[{foodType:"Beverages",preferredUnits:["ml","fl oz","cup"],keywords:["drink","juice","water","soda","beer","wine","coffee","tea","milk"]},{foodType:"Soups & Sauces",preferredUnits:["ml","cup","tbsp"],keywords:["soup","sauce","broth","dressing","syrup"]},{foodType:"Cooking Oils",preferredUnits:["tbsp","tsp","ml"],keywords:["oil","butter","margarine","lard"]},{foodType:"Spices & Seasonings",preferredUnits:["tsp","tbsp","g"],keywords:["salt","pepper","spice","herb","seasoning","garlic powder","onion powder"]},{foodType:"Baking Ingredients",preferredUnits:["cup","tbsp","tsp"],keywords:["flour","sugar","baking powder","vanilla","cocoa"]},{foodType:"Meat & Poultry",preferredUnits:["oz","g","lb"],keywords:["chicken","beef","pork","turkey","lamb","meat","steak","breast"]},{foodType:"Fish & Seafood",preferredUnits:["oz","g","piece"],keywords:["fish","salmon","tuna","shrimp","crab","lobster","seafood"]},{foodType:"Eggs & Dairy",preferredUnits:["piece","cup","oz"],keywords:["egg","cheese","yogurt","cream","sour cream"]},{foodType:"Fresh Fruits",preferredUnits:["piece","cup","g"],keywords:["apple","banana","orange","berry","grape","fruit"]},{foodType:"Fresh Vegetables",preferredUnits:["cup","piece","g"],keywords:["carrot","broccoli","spinach","lettuce","tomato","onion","vegetable"]},{foodType:"Rice & Grains",preferredUnits:["cup","g","oz"],keywords:["rice","quinoa","oats","cereal","grain"]},{foodType:"Bread & Baked",preferredUnits:["slice","piece","oz"],keywords:["bread","bagel","muffin","roll","biscuit"]},{foodType:"Pasta & Noodles",preferredUnits:["cup","oz","g"],keywords:["pasta","noodles","spaghetti","macaroni"]},{foodType:"Nuts & Seeds",preferredUnits:["oz","cup","tbsp"],keywords:["nuts","almonds","peanuts","seeds","cashews","walnuts"]},{foodType:"Packaged Foods",preferredUnits:["serving","package","piece"],keywords:["packaged","frozen","canned","boxed"]},{foodType:"Snacks",preferredUnits:["serving","piece","oz"],keywords:["chips","crackers","cookies","snack"]}],_s={weight:Object.keys(qi),volume:Object.keys(Gi),pieces:od},H0=[..._s.weight,..._s.volume,..._s.pieces].sort();function bn(t){const n=t.toLowerCase().trim();return qi[n]?"weight":Gi[n]?"volume":od.includes(n)?"pieces":"unknown"}function ad(t,n){const r=[],i=t.toLowerCase();if(n){const o=n.toLowerCase().trim(),a=bn(o);a!=="unknown"&&r.push({unit:o,category:a,isRecommended:!0,description:"From nutrition label"})}return U0.filter(o=>o.keywords.some(a=>i.includes(a))).forEach(o=>{o.preferredUnits.forEach((a,l)=>{if(!r.some(c=>c.unit===a)){const c=bn(a);c!=="unknown"&&r.push({unit:a,category:c,isRecommended:l===0&&!n,description:`Recommended for ${o.foodType.toLowerCase()}`})}})}),r.length===0&&["g","oz","cup","piece","serving"].forEach(a=>{const l=bn(a);r.push({unit:a,category:l,isRecommended:a==="g",description:"Common unit"})}),r}function ld(t,n){const r=bn(t),i=bn(n);return r===i&&r!=="unknown"?!0:r==="pieces"||i==="pieces"?r===i:!1}function cd(t,n,r){const i=n.toLowerCase().trim(),s=r.toLowerCase().trim();if(i===s)return{value:t,unit:r,isValid:!0};if(!ld(n,r))return{value:t,unit:n,isValid:!1,error:`Cannot convert ${n} to ${r} - incompatible unit types`};const o=bn(n);if(o==="pieces")return{value:t,unit:r,isValid:!0};if(o==="weight"){const a=qi[i],l=qi[s];if(!a||!l)return{value:t,unit:n,isValid:!1,error:`Unknown weight unit: ${a?r:n}`};const u=t*a/l;return{value:Math.round(u*1e3)/1e3,unit:r,isValid:!0}}if(o==="volume"){const a=Gi[i],l=Gi[s];if(!a||!l)return{value:t,unit:n,isValid:!1,error:`Unknown volume unit: ${a?r:n}`};const u=t*a/l;return{value:Math.round(u*1e3)/1e3,unit:r,isValid:!0}}return{value:t,unit:n,isValid:!1,error:"Unknown conversion error"}}function $0(t){switch(t){case"weight":return["g","kg","oz","lb"];case"volume":return["ml","l","cup","tbsp","tsp","fl oz"];case"pieces":return["piece","serving","slice","can","package"];default:return[]}}function ud(t,n,r,i,s){const o=cd(i,s,r);if(!o.isValid)return null;const a=o.value/n,l={};for(const[c,u]of Object.entries(t))l[c]=Math.round(u*a*100)/100;return l}function Cs(t){if(typeof t=="number")return Math.max(0,Math.round(t*1e3)/1e3);const n=parseFloat(t.toString());return isNaN(n)?0:Math.max(0,Math.round(n*1e3)/1e3)}function sr(t){const n=t.toLowerCase().trim();return{g:"g",kg:"kg",oz:"oz",lb:"lb",ml:"ml",l:"L",cup:"cup",tbsp:"tbsp",tsp:"tsp","fl oz":"fl oz",piece:"piece",serving:"serving",slice:"slice"}[n]||t}const po="nutrivize_unit_memory";function V0(t,n){try{const r=JSON.parse(localStorage.getItem(po)||"{}"),i=t.toLowerCase().trim();r[i]?(r[i].unit=n,r[i].frequency+=1,r[i].lastUsed=Date.now()):r[i]={unit:n,frequency:1,lastUsed:Date.now()},localStorage.setItem(po,JSON.stringify(r))}catch(r){console.warn("Failed to save unit preference:",r)}}function q0(t){try{const n=JSON.parse(localStorage.getItem(po)||"{}"),r=t.toLowerCase().trim(),i=n[r];return i?i.unit:null}catch(n){return console.warn("Failed to get unit preference:",n),null}}function dd(t,n){const r=q0(t);if(r)return r;if(n){const o=n.toLowerCase().trim();if(bn(o)!=="unknown")return o}const s=ad(t,n).find(o=>o.isRecommended);return s?s.unit:"g"}function G0(t){switch(bn(t)){case"weight":return"Weight units (g, kg, oz, lb) - good for solid foods";case"volume":return"Volume units (ml, cup, tbsp, tsp) - good for liquids";case"pieces":return"Count units (piece, serving, slice) - good for individual items";default:return"Unit measurement"}}function Yo({quantity:t,unit:n,onQuantityChange:r,onUnitChange:i,onConvertedChange:s,size:o="md",isDisabled:a=!1,showConversionHint:l=!0,allowDecimals:c=!0,min:u=.01,label:h,foodName:g,servingUnit:m,showSmartSuggestions:p=!0}){const[j,b]=C.useState(t),[v,_]=C.useState("");C.useEffect(()=>{b(t)},[t]);const N=g&&p?ad(g,m):[],R=bn(n),U=R!=="unknown"?$0(R):H0.slice(0,20),w=(()=>{const E=new Set;return N.forEach(B=>E.add(B.unit)),U.forEach(B=>E.add(B)),E.add(n),["g","oz","cup","tbsp","tsp","ml","piece","serving"].forEach(B=>E.add(B)),Array.from(E)})(),P=E=>{if(!E||E===n)return;if(g&&V0(g,E),!ld(n,E)){i(E),s&&s(j,E),l&&_(`Changed unit to ${sr(E)} (no conversion applied)`);return}const O=cd(j,n,E);if(O.isValid){const B=Cs(O.value);b(B),r(B),i(E),s&&s(B,E),l&&_(`Converted from ${Cs(j)} ${sr(n)} to ${B} ${sr(E)}`)}else i(E),s&&s(j,E),l&&_(`Changed unit to ${sr(E)} (conversion not available)`)},M=()=>{if(j>0&&j<u){const E=u;b(E),r(E),s&&s(E,n)}},k=E=>{const O=N.find(J=>J.unit===E),B=sr(E);return O?`${B} ${O.isRecommended?"⭐":"💡"}`:B};return e.jsxs(S,{spacing:2,align:"stretch",children:[e.jsxs(A,{spacing:2,children:[e.jsxs($,{flex:2,children:[h&&e.jsxs(V,{mb:1,fontSize:"sm",children:[h," Quantity"]}),e.jsxs(ue,{value:j===0?"":j,onChange:(E,O)=>{if(E===""||E==="0")b(0),r(0),s&&s(0,n);else if(!isNaN(O)&&O>=0){const B=Cs(O);b(B),r(B),s&&s(B,n)}},onBlur:M,min:0,step:c?.1:1,precision:c?3:0,size:o,isDisabled:a,allowMouseWheel:!0,children:[e.jsx(de,{onFocus:E=>E.target.select(),placeholder:"0.0"}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]}),e.jsxs($,{flex:1,children:[h&&e.jsx(V,{mb:1,fontSize:"sm",children:"Unit"}),e.jsx(jr,{label:G0(n),hasArrow:!0,children:e.jsx(Be,{value:n,onChange:E=>P(E.target.value),size:o,isDisabled:a,children:w.map(E=>e.jsx("option",{value:E,children:k(E)},E))})})]})]}),p&&N.length>0&&e.jsxs(F,{children:[e.jsx(d,{fontSize:"xs",color:"gray.600",mb:1,children:"Suggested units:"}),e.jsx(Fn,{wrap:"wrap",gap:1,children:N.slice(0,4).map(E=>e.jsxs(je,{colorScheme:E.isRecommended?"green":"blue",cursor:"pointer",onClick:()=>P(E.unit),size:"sm",variant:E.unit===n?"solid":"outline",children:[sr(E.unit),E.isRecommended&&" ⭐"]},E.unit))})]}),l&&v&&e.jsx(d,{fontSize:"xs",color:"green.600",fontStyle:"italic",children:v})]})}function Y0({isOpen:t,onClose:n,onSuccess:r}){const[i,s]=C.useState([]),[o,a]=C.useState([]),[l,c]=C.useState([]),[u,h]=C.useState([]),[g,m]=C.useState(""),[p,j]=C.useState(null),[b,v]=C.useState(1),[_,N]=C.useState("serving"),[R,U]=C.useState("breakfast"),[I,w]=C.useState(!1),[P,M]=C.useState(null),[k,E]=C.useState(!1),[O,B]=C.useState(!1),[J,ae]=C.useState(!1),[q,oe]=C.useState(!1),fe=wt(),pe=_e("white","gray.800"),X=_e("gray.200","gray.600");C.useEffect(()=>{t&&(f(),W(),te())},[t]),C.useEffect(()=>{g.trim()?ee():s([])},[g]),C.useEffect(()=>{if(p){const ne=dd(p.name,p.serving_unit);N(ne),v(p.serving_size||1)}},[p]);const f=async()=>{E(!0);try{const ne=await Z.get("/foods/user-foods/");a(ne.data)}catch(ne){console.error("Error fetching user foods:",ne),a([])}finally{E(!1)}},W=async()=>{ae(!0);try{const ne=await Z.get("/foods/popular/");c(ne.data)}catch(ne){console.error("Error fetching popular foods:",ne),c([])}finally{ae(!1)}},te=async()=>{oe(!0);try{const ne=await Z.get("/food-logs/recent/");h(ne.data)}catch(ne){console.error("Error fetching recent foods:",ne),h([])}finally{oe(!1)}},y=(ne,he)=>{if(v(ne),N(he),p){const dt={calories:p.nutrition?.calories||0,protein:p.nutrition?.protein||0,carbs:p.nutrition?.carbs||0,fat:p.nutrition?.fat||0,fiber:p.nutrition?.fiber||0,sugar:p.nutrition?.sugar||0,sodium:p.nutrition?.sodium||0},Qe=ud(dt,p.serving_size||1,p.serving_unit||"serving",ne,he);M(Qe)}},ee=async()=>{B(!0);try{const ne=await Z.get(`/foods/search/?q=${encodeURIComponent(g)}`);s(ne.data)}catch(ne){console.error("Error searching foods:",ne),s([]),fe({title:"Error searching foods",description:"Failed to search for foods. Please try again.",status:"error",duration:3e3,isClosable:!0})}finally{B(!1)}},Ie=async()=>{if(!p){fe({title:"No food selected",description:"Please select a food item to log.",status:"warning",duration:3e3,isClosable:!0});return}w(!0);try{const ne=P||{calories:(p.nutrition?.calories||0)*b,protein:(p.nutrition?.protein||0)*b,carbs:(p.nutrition?.carbs||0)*b,fat:(p.nutrition?.fat||0)*b,fiber:(p.nutrition?.fiber||0)*b,sugar:(p.nutrition?.sugar||0)*b,sodium:(p.nutrition?.sodium||0)*b};await Z.post("/food-logs/",{food_id:p.id,food_name:p.name,brand:p.brand||"",amount:b,unit:_,meal_type:R,nutrition:ne}),fe({title:"Food logged successfully!",description:`${b} ${_} of ${p.name} added to ${R}`,status:"success",duration:3e3,isClosable:!0}),j(null),v(1),N("serving"),m(""),s([]),M(null),r?.(),n()}catch(ne){console.error("Error logging food:",ne),fe({title:"Error logging food",description:ne.response?.data?.detail||"Failed to log food. Please try again.",status:"error",duration:5e3,isClosable:!0})}finally{w(!1)}},ce=({food:ne,onClick:he})=>e.jsx(se,{variant:p?.id===ne.id?"filled":"outline",cursor:"pointer",onClick:()=>{he(),M(null),v(1),N("serving")},_hover:{bg:_e("gray.50","gray.700"),transform:"translateY(-1px)"},transition:"all 0.2s",size:"sm",bg:p?.id===ne.id?_e("blue.50","blue.900"):pe,borderColor:p?.id===ne.id?"blue.300":X,children:e.jsx(re,{py:2,px:3,children:e.jsxs(S,{align:"start",spacing:1,children:[e.jsx(d,{fontWeight:"medium",fontSize:"sm",noOfLines:2,lineHeight:"1.2",children:ne.name}),ne.brand&&e.jsx(d,{fontSize:"xs",color:"gray.500",noOfLines:1,children:ne.brand}),e.jsxs(A,{fontSize:"xs",justify:"space-between",w:"full",children:[e.jsxs(A,{children:[e.jsx(d,{color:"green.500",fontWeight:"bold",children:ne.nutrition?.calories||0}),e.jsx(d,{color:"gray.500",children:"cal"})]}),ne.nutrition?.protein&&e.jsxs(A,{children:[e.jsxs(d,{color:"blue.500",fontWeight:"bold",children:[ne.nutrition.protein,"g"]}),e.jsx(d,{color:"gray.500",children:"protein"})]})]})]})})});return e.jsxs(Ue,{isOpen:t,onClose:n,size:"4xl",scrollBehavior:"inside",children:[e.jsx(Te,{bg:"blackAlpha.300",backdropFilter:"blur(10px)",zIndex:1200}),e.jsxs(He,{maxH:"90vh",bg:pe,zIndex:1300,children:[e.jsx(Pe,{children:e.jsxs(A,{children:[e.jsx(d,{fontSize:"xl",children:"🍎 Log Food"}),p&&e.jsxs(je,{colorScheme:"green",variant:"solid",children:[p.name," selected"]})]})}),e.jsx(De,{}),e.jsx(Le,{pb:6,children:e.jsxs(S,{spacing:6,align:"stretch",children:[e.jsxs($,{children:[e.jsx(V,{children:"Search for food"}),e.jsx(ve,{placeholder:"Search for food items...",value:g,onChange:ne=>m(ne.target.value),size:"lg"}),O&&e.jsxs(A,{mt:2,children:[e.jsx(ut,{size:"sm"}),e.jsx(d,{fontSize:"sm",color:"gray.500",children:"Searching..."})]})]}),g.trim()&&i.length>0&&e.jsxs(F,{children:[e.jsx(d,{fontWeight:"medium",mb:3,children:"Search Results:"}),e.jsx(F,{maxH:"200px",overflowY:"auto",children:e.jsx(xe,{columns:{base:1,md:2,lg:3},spacing:3,children:i.slice(0,12).map(ne=>e.jsx(ce,{food:ne,onClick:()=>j(ne)},ne.id))})})]}),e.jsx(_t,{}),e.jsxs(Kr,{variant:"soft-rounded",colorScheme:"blue",children:[e.jsxs(Jr,{children:[e.jsx(Pt,{fontSize:"sm",children:"Recent Foods"}),e.jsx(Pt,{fontSize:"sm",children:"Popular Foods"}),e.jsx(Pt,{fontSize:"sm",children:"My Foods"})]}),e.jsxs(Qr,{children:[e.jsx(Lt,{px:0,children:e.jsxs(S,{align:"stretch",spacing:3,children:[e.jsx(d,{fontWeight:"medium",children:"Recently Logged Foods:"}),q?e.jsxs(A,{justify:"center",py:8,children:[e.jsx(ut,{size:"md"}),e.jsx(d,{children:"Loading recent foods..."})]}):u.length>0?e.jsx(F,{maxH:"300px",overflowY:"auto",children:e.jsx(xe,{columns:{base:1,md:2,lg:3},spacing:3,children:u.map(ne=>e.jsx(ce,{food:ne,onClick:()=>j(ne)},ne.id))})}):e.jsxs(F,{textAlign:"center",py:8,children:[e.jsx(d,{fontSize:"sm",color:"gray.500",children:"No recent foods found."}),e.jsx(d,{fontSize:"xs",color:"gray.400",children:"Start logging foods to see them here!"})]})]})}),e.jsx(Lt,{px:0,children:e.jsxs(S,{align:"stretch",spacing:3,children:[e.jsx(d,{fontWeight:"medium",children:"Popular Foods:"}),J?e.jsxs(A,{justify:"center",py:8,children:[e.jsx(ut,{size:"md"}),e.jsx(d,{children:"Loading popular foods..."})]}):l.length>0?e.jsx(F,{maxH:"300px",overflowY:"auto",children:e.jsx(xe,{columns:{base:1,md:2,lg:3},spacing:3,children:l.map(ne=>e.jsx(ce,{food:ne,onClick:()=>j(ne)},ne.id))})}):e.jsx(F,{textAlign:"center",py:8,children:e.jsx(d,{fontSize:"sm",color:"gray.500",children:"No popular foods available."})})]})}),e.jsx(Lt,{px:0,children:e.jsxs(S,{align:"stretch",spacing:3,children:[e.jsx(d,{fontWeight:"medium",children:"Your Personal Food Index:"}),k?e.jsxs(A,{justify:"center",py:8,children:[e.jsx(ut,{size:"md"}),e.jsx(d,{children:"Loading your foods..."})]}):o.length>0?e.jsx(F,{maxH:"300px",overflowY:"auto",children:e.jsx(xe,{columns:{base:1,md:2,lg:3},spacing:3,children:o.map(ne=>e.jsx(ce,{food:ne,onClick:()=>j(ne)},ne.id))})}):e.jsxs(F,{textAlign:"center",py:8,children:[e.jsx(d,{fontSize:"sm",color:"gray.500",children:"No custom foods in your food index."}),e.jsx(d,{fontSize:"xs",color:"gray.400",children:"Add custom foods to build your personal index!"})]})]})})]})]}),p&&e.jsx(se,{bg:_e("blue.50","blue.900"),borderColor:"blue.300",children:e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs(S,{align:"start",spacing:1,children:[e.jsxs(d,{fontSize:"lg",fontWeight:"bold",children:["Log: ",p.name]}),p.brand&&e.jsxs(d,{fontSize:"sm",color:"gray.600",fontStyle:"italic",children:["Brand: ",p.brand]})]}),e.jsxs(xe,{columns:4,spacing:4,children:[e.jsxs(S,{spacing:1,children:[e.jsx(d,{fontSize:"lg",fontWeight:"bold",color:"green.500",children:Math.round(P?.calories||p.nutrition?.calories||0)}),e.jsx(d,{fontSize:"xs",color:"gray.500",children:"Calories"})]}),e.jsxs(S,{spacing:1,children:[e.jsxs(d,{fontSize:"lg",fontWeight:"bold",color:"blue.500",children:[(P?.protein||p.nutrition?.protein||0).toFixed(1),"g"]}),e.jsx(d,{fontSize:"xs",color:"gray.500",children:"Protein"})]}),e.jsxs(S,{spacing:1,children:[e.jsxs(d,{fontSize:"lg",fontWeight:"bold",color:"orange.500",children:[(P?.carbs||p.nutrition?.carbs||0).toFixed(1),"g"]}),e.jsx(d,{fontSize:"xs",color:"gray.500",children:"Carbs"})]}),e.jsxs(S,{spacing:1,children:[e.jsxs(d,{fontSize:"lg",fontWeight:"bold",color:"purple.500",children:[(P?.fat||p.nutrition?.fat||0).toFixed(1),"g"]}),e.jsx(d,{fontSize:"xs",color:"gray.500",children:"Fat"})]})]}),e.jsxs(xe,{columns:2,spacing:4,children:[e.jsx(Yo,{quantity:b,unit:_,onQuantityChange:ne=>y(ne,_),onUnitChange:ne=>y(b,ne),label:"Quantity & Unit",foodName:p.name,servingUnit:p.serving_unit,showSmartSuggestions:!0}),e.jsxs($,{children:[e.jsx(V,{fontSize:"sm",children:"Meal"}),e.jsxs(Be,{value:R,onChange:ne=>U(ne.target.value),children:[e.jsx("option",{value:"breakfast",children:"Breakfast"}),e.jsx("option",{value:"lunch",children:"Lunch"}),e.jsx("option",{value:"dinner",children:"Dinner"}),e.jsx("option",{value:"snack",children:"Snack"})]})]})]}),e.jsx(H,{colorScheme:"green",size:"lg",onClick:Ie,isLoading:I,loadingText:"Logging...",children:"Log Food"})]})})})]})})]})]})}function K0(t,n){const r={};return(t[t.length-1]===""?[...t,""]:t).join((r.padRight?" ":"")+","+(r.padLeft===!1?"":" ")).trim()}const J0=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,Q0=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,X0={};function ul(t,n){return(X0.jsx?Q0:J0).test(t)}const Z0=/[ \t\n\f\r]/g;function ej(t){return typeof t=="object"?t.type==="text"?dl(t.value):!1:dl(t)}function dl(t){return t.replace(Z0,"")===""}class li{constructor(n,r,i){this.normal=r,this.property=n,i&&(this.space=i)}}li.prototype.normal={};li.prototype.property={};li.prototype.space=void 0;function hd(t,n){const r={},i={};for(const s of t)Object.assign(r,s.property),Object.assign(i,s.normal);return new li(r,i,n)}function fo(t){return t.toLowerCase()}class Bt{constructor(n,r){this.attribute=r,this.property=n}}Bt.prototype.attribute="";Bt.prototype.booleanish=!1;Bt.prototype.boolean=!1;Bt.prototype.commaOrSpaceSeparated=!1;Bt.prototype.commaSeparated=!1;Bt.prototype.defined=!1;Bt.prototype.mustUseProperty=!1;Bt.prototype.number=!1;Bt.prototype.overloadedBoolean=!1;Bt.prototype.property="";Bt.prototype.spaceSeparated=!1;Bt.prototype.space=void 0;let tj=0;const Ae=rr(),pt=rr(),mo=rr(),ie=rr(),nt=rr(),mr=rr(),Ut=rr();function rr(){return 2**++tj}const xo=Object.freeze(Object.defineProperty({__proto__:null,boolean:Ae,booleanish:pt,commaOrSpaceSeparated:Ut,commaSeparated:mr,number:ie,overloadedBoolean:mo,spaceSeparated:nt},Symbol.toStringTag,{value:"Module"})),ks=Object.keys(xo);class Ko extends Bt{constructor(n,r,i,s){let o=-1;if(super(n,r),hl(this,"space",s),typeof i=="number")for(;++o<ks.length;){const a=ks[o];hl(this,ks[o],(i&xo[a])===xo[a])}}}Ko.prototype.defined=!0;function hl(t,n,r){r&&(t[n]=r)}function _r(t){const n={},r={};for(const[i,s]of Object.entries(t.properties)){const o=new Ko(i,t.transform(t.attributes||{},i),s,t.space);t.mustUseProperty&&t.mustUseProperty.includes(i)&&(o.mustUseProperty=!0),n[i]=o,r[fo(i)]=i,r[fo(o.attribute)]=i}return new li(n,r,t.space)}const gd=_r({properties:{ariaActiveDescendant:null,ariaAtomic:pt,ariaAutoComplete:null,ariaBusy:pt,ariaChecked:pt,ariaColCount:ie,ariaColIndex:ie,ariaColSpan:ie,ariaControls:nt,ariaCurrent:null,ariaDescribedBy:nt,ariaDetails:null,ariaDisabled:pt,ariaDropEffect:nt,ariaErrorMessage:null,ariaExpanded:pt,ariaFlowTo:nt,ariaGrabbed:pt,ariaHasPopup:null,ariaHidden:pt,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:nt,ariaLevel:ie,ariaLive:null,ariaModal:pt,ariaMultiLine:pt,ariaMultiSelectable:pt,ariaOrientation:null,ariaOwns:nt,ariaPlaceholder:null,ariaPosInSet:ie,ariaPressed:pt,ariaReadOnly:pt,ariaRelevant:null,ariaRequired:pt,ariaRoleDescription:nt,ariaRowCount:ie,ariaRowIndex:ie,ariaRowSpan:ie,ariaSelected:pt,ariaSetSize:ie,ariaSort:null,ariaValueMax:ie,ariaValueMin:ie,ariaValueNow:ie,ariaValueText:null,role:null},transform(t,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function pd(t,n){return n in t?t[n]:n}function fd(t,n){return pd(t,n.toLowerCase())}const nj=_r({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:mr,acceptCharset:nt,accessKey:nt,action:null,allow:null,allowFullScreen:Ae,allowPaymentRequest:Ae,allowUserMedia:Ae,alt:null,as:null,async:Ae,autoCapitalize:null,autoComplete:nt,autoFocus:Ae,autoPlay:Ae,blocking:nt,capture:null,charSet:null,checked:Ae,cite:null,className:nt,cols:ie,colSpan:null,content:null,contentEditable:pt,controls:Ae,controlsList:nt,coords:ie|mr,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Ae,defer:Ae,dir:null,dirName:null,disabled:Ae,download:mo,draggable:pt,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Ae,formTarget:null,headers:nt,height:ie,hidden:mo,high:ie,href:null,hrefLang:null,htmlFor:nt,httpEquiv:nt,id:null,imageSizes:null,imageSrcSet:null,inert:Ae,inputMode:null,integrity:null,is:null,isMap:Ae,itemId:null,itemProp:nt,itemRef:nt,itemScope:Ae,itemType:nt,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Ae,low:ie,manifest:null,max:null,maxLength:ie,media:null,method:null,min:null,minLength:ie,multiple:Ae,muted:Ae,name:null,nonce:null,noModule:Ae,noValidate:Ae,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Ae,optimum:ie,pattern:null,ping:nt,placeholder:null,playsInline:Ae,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Ae,referrerPolicy:null,rel:nt,required:Ae,reversed:Ae,rows:ie,rowSpan:ie,sandbox:nt,scope:null,scoped:Ae,seamless:Ae,selected:Ae,shadowRootClonable:Ae,shadowRootDelegatesFocus:Ae,shadowRootMode:null,shape:null,size:ie,sizes:null,slot:null,span:ie,spellCheck:pt,src:null,srcDoc:null,srcLang:null,srcSet:null,start:ie,step:null,style:null,tabIndex:ie,target:null,title:null,translate:null,type:null,typeMustMatch:Ae,useMap:null,value:pt,width:ie,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:nt,axis:null,background:null,bgColor:null,border:ie,borderColor:null,bottomMargin:ie,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Ae,declare:Ae,event:null,face:null,frame:null,frameBorder:null,hSpace:ie,leftMargin:ie,link:null,longDesc:null,lowSrc:null,marginHeight:ie,marginWidth:ie,noResize:Ae,noHref:Ae,noShade:Ae,noWrap:Ae,object:null,profile:null,prompt:null,rev:null,rightMargin:ie,rules:null,scheme:null,scrolling:pt,standby:null,summary:null,text:null,topMargin:ie,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ie,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Ae,disableRemotePlayback:Ae,prefix:null,property:null,results:ie,security:null,unselectable:null},space:"html",transform:fd}),rj=_r({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Ut,accentHeight:ie,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:ie,amplitude:ie,arabicForm:null,ascent:ie,attributeName:null,attributeType:null,azimuth:ie,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:ie,by:null,calcMode:null,capHeight:ie,className:nt,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:ie,diffuseConstant:ie,direction:null,display:null,dur:null,divisor:ie,dominantBaseline:null,download:Ae,dx:null,dy:null,edgeMode:null,editable:null,elevation:ie,enableBackground:null,end:null,event:null,exponent:ie,externalResourcesRequired:null,fill:null,fillOpacity:ie,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:mr,g2:mr,glyphName:mr,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:ie,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:ie,horizOriginX:ie,horizOriginY:ie,id:null,ideographic:ie,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:ie,k:ie,k1:ie,k2:ie,k3:ie,k4:ie,kernelMatrix:Ut,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:ie,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:ie,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:ie,overlineThickness:ie,paintOrder:null,panose1:null,path:null,pathLength:ie,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:nt,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:ie,pointsAtY:ie,pointsAtZ:ie,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ut,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ut,rev:Ut,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ut,requiredFeatures:Ut,requiredFonts:Ut,requiredFormats:Ut,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:ie,specularExponent:ie,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:ie,strikethroughThickness:ie,string:null,stroke:null,strokeDashArray:Ut,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:ie,strokeOpacity:ie,strokeWidth:null,style:null,surfaceScale:ie,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ut,tabIndex:ie,tableValues:null,target:null,targetX:ie,targetY:ie,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ut,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:ie,underlineThickness:ie,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:ie,values:null,vAlphabetic:ie,vMathematical:ie,vectorEffect:null,vHanging:ie,vIdeographic:ie,version:null,vertAdvY:ie,vertOriginX:ie,vertOriginY:ie,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:ie,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:pd}),md=_r({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(t,n){return"xlink:"+n.slice(5).toLowerCase()}}),xd=_r({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:fd}),jd=_r({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(t,n){return"xml:"+n.slice(3).toLowerCase()}}),ij={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},sj=/[A-Z]/g,gl=/-[a-z]/g,oj=/^data[-\w.:]+$/i;function aj(t,n){const r=fo(n);let i=n,s=Bt;if(r in t.normal)return t.property[t.normal[r]];if(r.length>4&&r.slice(0,4)==="data"&&oj.test(n)){if(n.charAt(4)==="-"){const o=n.slice(5).replace(gl,cj);i="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=n.slice(4);if(!gl.test(o)){let a=o.replace(sj,lj);a.charAt(0)!=="-"&&(a="-"+a),n="data"+a}}s=Ko}return new s(i,n)}function lj(t){return"-"+t.toLowerCase()}function cj(t){return t.charAt(1).toUpperCase()}const uj=hd([gd,nj,md,xd,jd],"html"),Jo=hd([gd,rj,md,xd,jd],"svg");function dj(t){return t.join(" ").trim()}var Qo={},pl=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,hj=/\n/g,gj=/^\s*/,pj=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,fj=/^:\s*/,mj=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,xj=/^[;\s]*/,jj=/^\s+|\s+$/g,yj=`
`,fl="/",ml="*",Kn="",bj="comment",wj="declaration",Sj=function(t,n){if(typeof t!="string")throw new TypeError("First argument must be a string");if(!t)return[];n=n||{};var r=1,i=1;function s(j){var b=j.match(hj);b&&(r+=b.length);var v=j.lastIndexOf(yj);i=~v?j.length-v:i+j.length}function o(){var j={line:r,column:i};return function(b){return b.position=new a(j),u(),b}}function a(j){this.start=j,this.end={line:r,column:i},this.source=n.source}a.prototype.content=t;function l(j){var b=new Error(n.source+":"+r+":"+i+": "+j);if(b.reason=j,b.filename=n.source,b.line=r,b.column=i,b.source=t,!n.silent)throw b}function c(j){var b=j.exec(t);if(b){var v=b[0];return s(v),t=t.slice(v.length),b}}function u(){c(gj)}function h(j){var b;for(j=j||[];b=g();)b!==!1&&j.push(b);return j}function g(){var j=o();if(!(fl!=t.charAt(0)||ml!=t.charAt(1))){for(var b=2;Kn!=t.charAt(b)&&(ml!=t.charAt(b)||fl!=t.charAt(b+1));)++b;if(b+=2,Kn===t.charAt(b-1))return l("End of comment missing");var v=t.slice(2,b-2);return i+=2,s(v),t=t.slice(b),i+=2,j({type:bj,comment:v})}}function m(){var j=o(),b=c(pj);if(b){if(g(),!c(fj))return l("property missing ':'");var v=c(mj),_=j({type:wj,property:xl(b[0].replace(pl,Kn)),value:v?xl(v[0].replace(pl,Kn)):Kn});return c(xj),_}}function p(){var j=[];h(j);for(var b;b=m();)b!==!1&&(j.push(b),h(j));return j}return u(),p()};function xl(t){return t?t.replace(jj,Kn):Kn}var vj=Ti&&Ti.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Qo,"__esModule",{value:!0});Qo.default=Cj;var _j=vj(Sj);function Cj(t,n){var r=null;if(!t||typeof t!="string")return r;var i=(0,_j.default)(t),s=typeof n=="function";return i.forEach(function(o){if(o.type==="declaration"){var a=o.property,l=o.value;s?n(a,l,o):l&&(r=r||{},r[a]=l)}}),r}var cs={};Object.defineProperty(cs,"__esModule",{value:!0});cs.camelCase=void 0;var kj=/^--[a-zA-Z0-9_-]+$/,Ej=/-([a-z])/g,Ij=/^[^-]+$/,zj=/^-(webkit|moz|ms|o|khtml)-/,Aj=/^-(ms)-/,Tj=function(t){return!t||Ij.test(t)||kj.test(t)},Pj=function(t,n){return n.toUpperCase()},jl=function(t,n){return"".concat(n,"-")},Lj=function(t,n){return n===void 0&&(n={}),Tj(t)?t:(t=t.toLowerCase(),n.reactCompat?t=t.replace(Aj,jl):t=t.replace(zj,jl),t.replace(Ej,Pj))};cs.camelCase=Lj;var Rj=Ti&&Ti.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},Mj=Rj(Qo),Oj=cs;function jo(t,n){var r={};return!t||typeof t!="string"||(0,Mj.default)(t,function(i,s){i&&s&&(r[(0,Oj.camelCase)(i,n)]=s)}),r}jo.default=jo;var Fj=jo;const Dj=_c(Fj),yd=bd("end"),Xo=bd("start");function bd(t){return n;function n(r){const i=r&&r.position&&r.position[t]||{};if(typeof i.line=="number"&&i.line>0&&typeof i.column=="number"&&i.column>0)return{line:i.line,column:i.column,offset:typeof i.offset=="number"&&i.offset>-1?i.offset:void 0}}}function Nj(t){const n=Xo(t),r=yd(t);if(n&&r)return{start:n,end:r}}function Dr(t){return!t||typeof t!="object"?"":"position"in t||"type"in t?yl(t.position):"start"in t||"end"in t?yl(t):"line"in t||"column"in t?yo(t):""}function yo(t){return bl(t&&t.line)+":"+bl(t&&t.column)}function yl(t){return yo(t&&t.start)+"-"+yo(t&&t.end)}function bl(t){return t&&typeof t=="number"?t:1}class zt extends Error{constructor(n,r,i){super(),typeof r=="string"&&(i=r,r=void 0);let s="",o={},a=!1;if(r&&("line"in r&&"column"in r?o={place:r}:"start"in r&&"end"in r?o={place:r}:"type"in r?o={ancestors:[r],place:r.position}:o={...r}),typeof n=="string"?s=n:!o.cause&&n&&(a=!0,s=n.message,o.cause=n),!o.ruleId&&!o.source&&typeof i=="string"){const c=i.indexOf(":");c===-1?o.ruleId=i:(o.source=i.slice(0,c),o.ruleId=i.slice(c+1))}if(!o.place&&o.ancestors&&o.ancestors){const c=o.ancestors[o.ancestors.length-1];c&&(o.place=c.position)}const l=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=l?l.column:void 0,this.fatal=void 0,this.file,this.message=s,this.line=l?l.line:void 0,this.name=Dr(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=a&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual,this.expected,this.note,this.url}}zt.prototype.file="";zt.prototype.name="";zt.prototype.reason="";zt.prototype.message="";zt.prototype.stack="";zt.prototype.column=void 0;zt.prototype.line=void 0;zt.prototype.ancestors=void 0;zt.prototype.cause=void 0;zt.prototype.fatal=void 0;zt.prototype.place=void 0;zt.prototype.ruleId=void 0;zt.prototype.source=void 0;const Zo={}.hasOwnProperty,Wj=new Map,Bj=/[A-Z]/g,Uj=new Set(["table","tbody","thead","tfoot","tr"]),Hj=new Set(["td","th"]),wd="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function $j(t,n){if(!n||n.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const r=n.filePath||void 0;let i;if(n.development){if(typeof n.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");i=Xj(r,n.jsxDEV)}else{if(typeof n.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof n.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");i=Qj(r,n.jsx,n.jsxs)}const s={Fragment:n.Fragment,ancestors:[],components:n.components||{},create:i,elementAttributeNameCase:n.elementAttributeNameCase||"react",evaluater:n.createEvaluater?n.createEvaluater():void 0,filePath:r,ignoreInvalidStyle:n.ignoreInvalidStyle||!1,passKeys:n.passKeys!==!1,passNode:n.passNode||!1,schema:n.space==="svg"?Jo:uj,stylePropertyNameCase:n.stylePropertyNameCase||"dom",tableCellAlignToStyle:n.tableCellAlignToStyle!==!1},o=Sd(s,t,void 0);return o&&typeof o!="string"?o:s.create(t,s.Fragment,{children:o||void 0},void 0)}function Sd(t,n,r){if(n.type==="element")return Vj(t,n,r);if(n.type==="mdxFlowExpression"||n.type==="mdxTextExpression")return qj(t,n);if(n.type==="mdxJsxFlowElement"||n.type==="mdxJsxTextElement")return Yj(t,n,r);if(n.type==="mdxjsEsm")return Gj(t,n);if(n.type==="root")return Kj(t,n,r);if(n.type==="text")return Jj(t,n)}function Vj(t,n,r){const i=t.schema;let s=i;n.tagName.toLowerCase()==="svg"&&i.space==="html"&&(s=Jo,t.schema=s),t.ancestors.push(n);const o=_d(t,n.tagName,!1),a=Zj(t,n);let l=ta(t,n);return Uj.has(n.tagName)&&(l=l.filter(function(c){return typeof c=="string"?!ej(c):!0})),vd(t,a,o,n),ea(a,l),t.ancestors.pop(),t.schema=i,t.create(n,o,a,r)}function qj(t,n){if(n.data&&n.data.estree&&t.evaluater){const i=n.data.estree.body[0];return i.type,t.evaluater.evaluateExpression(i.expression)}Yr(t,n.position)}function Gj(t,n){if(n.data&&n.data.estree&&t.evaluater)return t.evaluater.evaluateProgram(n.data.estree);Yr(t,n.position)}function Yj(t,n,r){const i=t.schema;let s=i;n.name==="svg"&&i.space==="html"&&(s=Jo,t.schema=s),t.ancestors.push(n);const o=n.name===null?t.Fragment:_d(t,n.name,!0),a=ey(t,n),l=ta(t,n);return vd(t,a,o,n),ea(a,l),t.ancestors.pop(),t.schema=i,t.create(n,o,a,r)}function Kj(t,n,r){const i={};return ea(i,ta(t,n)),t.create(n,t.Fragment,i,r)}function Jj(t,n){return n.value}function vd(t,n,r,i){typeof r!="string"&&r!==t.Fragment&&t.passNode&&(n.node=i)}function ea(t,n){if(n.length>0){const r=n.length>1?n:n[0];r&&(t.children=r)}}function Qj(t,n,r){return i;function i(s,o,a,l){const u=Array.isArray(a.children)?r:n;return l?u(o,a,l):u(o,a)}}function Xj(t,n){return r;function r(i,s,o,a){const l=Array.isArray(o.children),c=Xo(i);return n(s,o,a,l,{columnNumber:c?c.column-1:void 0,fileName:t,lineNumber:c?c.line:void 0},void 0)}}function Zj(t,n){const r={};let i,s;for(s in n.properties)if(s!=="children"&&Zo.call(n.properties,s)){const o=ty(t,s,n.properties[s]);if(o){const[a,l]=o;t.tableCellAlignToStyle&&a==="align"&&typeof l=="string"&&Hj.has(n.tagName)?i=l:r[a]=l}}if(i){const o=r.style||(r.style={});o[t.stylePropertyNameCase==="css"?"text-align":"textAlign"]=i}return r}function ey(t,n){const r={};for(const i of n.attributes)if(i.type==="mdxJsxExpressionAttribute")if(i.data&&i.data.estree&&t.evaluater){const o=i.data.estree.body[0];o.type;const a=o.expression;a.type;const l=a.properties[0];l.type,Object.assign(r,t.evaluater.evaluateExpression(l.argument))}else Yr(t,n.position);else{const s=i.name;let o;if(i.value&&typeof i.value=="object")if(i.value.data&&i.value.data.estree&&t.evaluater){const l=i.value.data.estree.body[0];l.type,o=t.evaluater.evaluateExpression(l.expression)}else Yr(t,n.position);else o=i.value===null?!0:i.value;r[s]=o}return r}function ta(t,n){const r=[];let i=-1;const s=t.passKeys?new Map:Wj;for(;++i<n.children.length;){const o=n.children[i];let a;if(t.passKeys){const c=o.type==="element"?o.tagName:o.type==="mdxJsxFlowElement"||o.type==="mdxJsxTextElement"?o.name:void 0;if(c){const u=s.get(c)||0;a=c+"-"+u,s.set(c,u+1)}}const l=Sd(t,o,a);l!==void 0&&r.push(l)}return r}function ty(t,n,r){const i=aj(t.schema,n);if(!(r==null||typeof r=="number"&&Number.isNaN(r))){if(Array.isArray(r)&&(r=i.commaSeparated?K0(r):dj(r)),i.property==="style"){let s=typeof r=="object"?r:ny(t,String(r));return t.stylePropertyNameCase==="css"&&(s=ry(s)),["style",s]}return[t.elementAttributeNameCase==="react"&&i.space?ij[i.property]||i.property:i.attribute,r]}}function ny(t,n){try{return Dj(n,{reactCompat:!0})}catch(r){if(t.ignoreInvalidStyle)return{};const i=r,s=new zt("Cannot parse `style` attribute",{ancestors:t.ancestors,cause:i,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw s.file=t.filePath||void 0,s.url=wd+"#cannot-parse-style-attribute",s}}function _d(t,n,r){let i;if(!r)i={type:"Literal",value:n};else if(n.includes(".")){const s=n.split(".");let o=-1,a;for(;++o<s.length;){const l=ul(s[o])?{type:"Identifier",name:s[o]}:{type:"Literal",value:s[o]};a=a?{type:"MemberExpression",object:a,property:l,computed:!!(o&&l.type==="Literal"),optional:!1}:l}i=a}else i=ul(n)&&!/^[a-z]/.test(n)?{type:"Identifier",name:n}:{type:"Literal",value:n};if(i.type==="Literal"){const s=i.value;return Zo.call(t.components,s)?t.components[s]:s}if(t.evaluater)return t.evaluater.evaluateExpression(i);Yr(t)}function Yr(t,n){const r=new zt("Cannot handle MDX estrees without `createEvaluater`",{ancestors:t.ancestors,place:n,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw r.file=t.filePath||void 0,r.url=wd+"#cannot-handle-mdx-estrees-without-createevaluater",r}function ry(t){const n={};let r;for(r in t)Zo.call(t,r)&&(n[iy(r)]=t[r]);return n}function iy(t){let n=t.replace(Bj,sy);return n.slice(0,3)==="ms-"&&(n="-"+n),n}function sy(t){return"-"+t.toLowerCase()}const Es={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},oy={};function ay(t,n){const r=oy,i=typeof r.includeImageAlt=="boolean"?r.includeImageAlt:!0,s=typeof r.includeHtml=="boolean"?r.includeHtml:!0;return Cd(t,i,s)}function Cd(t,n,r){if(ly(t)){if("value"in t)return t.type==="html"&&!r?"":t.value;if(n&&"alt"in t&&t.alt)return t.alt;if("children"in t)return wl(t.children,n,r)}return Array.isArray(t)?wl(t,n,r):""}function wl(t,n,r){const i=[];let s=-1;for(;++s<t.length;)i[s]=Cd(t[s],n,r);return i.join("")}function ly(t){return!!(t&&typeof t=="object")}const Sl=document.createElement("i");function na(t){const n="&"+t+";";Sl.innerHTML=n;const r=Sl.textContent;return r.charCodeAt(r.length-1)===59&&t!=="semi"||r===n?!1:r}function un(t,n,r,i){const s=t.length;let o=0,a;if(n<0?n=-n>s?0:s+n:n=n>s?s:n,r=r>0?r:0,i.length<1e4)a=Array.from(i),a.unshift(n,r),t.splice(...a);else for(r&&t.splice(n,r);o<i.length;)a=i.slice(o,o+1e4),a.unshift(n,0),t.splice(...a),o+=1e4,n+=1e4}function Yt(t,n){return t.length>0?(un(t,t.length,0,n),t):n}const vl={}.hasOwnProperty;function cy(t){const n={};let r=-1;for(;++r<t.length;)uy(n,t[r]);return n}function uy(t,n){let r;for(r in n){const s=(vl.call(t,r)?t[r]:void 0)||(t[r]={}),o=n[r];let a;if(o)for(a in o){vl.call(s,a)||(s[a]=[]);const l=o[a];dy(s[a],Array.isArray(l)?l:l?[l]:[])}}}function dy(t,n){let r=-1;const i=[];for(;++r<n.length;)(n[r].add==="after"?t:i).push(n[r]);un(t,0,0,i)}function kd(t,n){const r=Number.parseInt(t,n);return r<9||r===11||r>13&&r<32||r>126&&r<160||r>55295&&r<57344||r>64975&&r<65008||(r&65535)===65535||(r&65535)===65534||r>1114111?"�":String.fromCodePoint(r)}function xr(t){return t.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const on=Bn(/[A-Za-z]/),Vt=Bn(/[\dA-Za-z]/),hy=Bn(/[#-'*+\--9=?A-Z^-~]/);function bo(t){return t!==null&&(t<32||t===127)}const wo=Bn(/\d/),gy=Bn(/[\dA-Fa-f]/),py=Bn(/[!-/:-@[-`{-~]/);function Ee(t){return t!==null&&t<-2}function Nt(t){return t!==null&&(t<0||t===32)}function Je(t){return t===-2||t===-1||t===32}const fy=Bn(/\p{P}|\p{S}/u),my=Bn(/\s/);function Bn(t){return n;function n(r){return r!==null&&r>-1&&t.test(String.fromCharCode(r))}}function Cr(t){const n=[];let r=-1,i=0,s=0;for(;++r<t.length;){const o=t.charCodeAt(r);let a="";if(o===37&&Vt(t.charCodeAt(r+1))&&Vt(t.charCodeAt(r+2)))s=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(a=String.fromCharCode(o));else if(o>55295&&o<57344){const l=t.charCodeAt(r+1);o<56320&&l>56319&&l<57344?(a=String.fromCharCode(o,l),s=1):a="�"}else a=String.fromCharCode(o);a&&(n.push(t.slice(i,r),encodeURIComponent(a)),i=r+s+1,a=""),s&&(r+=s,s=0)}return n.join("")+t.slice(i)}function rt(t,n,r,i){const s=i?i-1:Number.POSITIVE_INFINITY;let o=0;return a;function a(c){return Je(c)?(t.enter(r),l(c)):n(c)}function l(c){return Je(c)&&o++<s?(t.consume(c),l):(t.exit(r),n(c))}}const xy={tokenize:jy};function jy(t){const n=t.attempt(this.parser.constructs.contentInitial,i,s);let r;return n;function i(l){if(l===null){t.consume(l);return}return t.enter("lineEnding"),t.consume(l),t.exit("lineEnding"),rt(t,n,"linePrefix")}function s(l){return t.enter("paragraph"),o(l)}function o(l){const c=t.enter("chunkText",{contentType:"text",previous:r});return r&&(r.next=c),r=c,a(l)}function a(l){if(l===null){t.exit("chunkText"),t.exit("paragraph"),t.consume(l);return}return Ee(l)?(t.consume(l),t.exit("chunkText"),o):(t.consume(l),a)}}const yy={tokenize:by},_l={tokenize:wy};function by(t){const n=this,r=[];let i=0,s,o,a;return l;function l(R){if(i<r.length){const U=r[i];return n.containerState=U[1],t.attempt(U[0].continuation,c,u)(R)}return u(R)}function c(R){if(i++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,s&&N();const U=n.events.length;let I=U,w;for(;I--;)if(n.events[I][0]==="exit"&&n.events[I][1].type==="chunkFlow"){w=n.events[I][1].end;break}_(i);let P=U;for(;P<n.events.length;)n.events[P][1].end={...w},P++;return un(n.events,I+1,0,n.events.slice(U)),n.events.length=P,u(R)}return l(R)}function u(R){if(i===r.length){if(!s)return m(R);if(s.currentConstruct&&s.currentConstruct.concrete)return j(R);n.interrupt=!!(s.currentConstruct&&!s._gfmTableDynamicInterruptHack)}return n.containerState={},t.check(_l,h,g)(R)}function h(R){return s&&N(),_(i),m(R)}function g(R){return n.parser.lazy[n.now().line]=i!==r.length,a=n.now().offset,j(R)}function m(R){return n.containerState={},t.attempt(_l,p,j)(R)}function p(R){return i++,r.push([n.currentConstruct,n.containerState]),m(R)}function j(R){if(R===null){s&&N(),_(0),t.consume(R);return}return s=s||n.parser.flow(n.now()),t.enter("chunkFlow",{_tokenizer:s,contentType:"flow",previous:o}),b(R)}function b(R){if(R===null){v(t.exit("chunkFlow"),!0),_(0),t.consume(R);return}return Ee(R)?(t.consume(R),v(t.exit("chunkFlow")),i=0,n.interrupt=void 0,l):(t.consume(R),b)}function v(R,U){const I=n.sliceStream(R);if(U&&I.push(null),R.previous=o,o&&(o.next=R),o=R,s.defineSkip(R.start),s.write(I),n.parser.lazy[R.start.line]){let w=s.events.length;for(;w--;)if(s.events[w][1].start.offset<a&&(!s.events[w][1].end||s.events[w][1].end.offset>a))return;const P=n.events.length;let M=P,k,E;for(;M--;)if(n.events[M][0]==="exit"&&n.events[M][1].type==="chunkFlow"){if(k){E=n.events[M][1].end;break}k=!0}for(_(i),w=P;w<n.events.length;)n.events[w][1].end={...E},w++;un(n.events,M+1,0,n.events.slice(P)),n.events.length=w}}function _(R){let U=r.length;for(;U-- >R;){const I=r[U];n.containerState=I[1],I[0].exit.call(n,t)}r.length=R}function N(){s.write([null]),o=void 0,s=void 0,n.containerState._closeFlow=void 0}}function wy(t,n,r){return rt(t,t.attempt(this.parser.constructs.document,n,r),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Cl(t){if(t===null||Nt(t)||my(t))return 1;if(fy(t))return 2}function ra(t,n,r){const i=[];let s=-1;for(;++s<t.length;){const o=t[s].resolveAll;o&&!i.includes(o)&&(n=o(n,r),i.push(o))}return n}const So={name:"attention",resolveAll:Sy,tokenize:vy};function Sy(t,n){let r=-1,i,s,o,a,l,c,u,h;for(;++r<t.length;)if(t[r][0]==="enter"&&t[r][1].type==="attentionSequence"&&t[r][1]._close){for(i=r;i--;)if(t[i][0]==="exit"&&t[i][1].type==="attentionSequence"&&t[i][1]._open&&n.sliceSerialize(t[i][1]).charCodeAt(0)===n.sliceSerialize(t[r][1]).charCodeAt(0)){if((t[i][1]._close||t[r][1]._open)&&(t[r][1].end.offset-t[r][1].start.offset)%3&&!((t[i][1].end.offset-t[i][1].start.offset+t[r][1].end.offset-t[r][1].start.offset)%3))continue;c=t[i][1].end.offset-t[i][1].start.offset>1&&t[r][1].end.offset-t[r][1].start.offset>1?2:1;const g={...t[i][1].end},m={...t[r][1].start};kl(g,-c),kl(m,c),a={type:c>1?"strongSequence":"emphasisSequence",start:g,end:{...t[i][1].end}},l={type:c>1?"strongSequence":"emphasisSequence",start:{...t[r][1].start},end:m},o={type:c>1?"strongText":"emphasisText",start:{...t[i][1].end},end:{...t[r][1].start}},s={type:c>1?"strong":"emphasis",start:{...a.start},end:{...l.end}},t[i][1].end={...a.start},t[r][1].start={...l.end},u=[],t[i][1].end.offset-t[i][1].start.offset&&(u=Yt(u,[["enter",t[i][1],n],["exit",t[i][1],n]])),u=Yt(u,[["enter",s,n],["enter",a,n],["exit",a,n],["enter",o,n]]),u=Yt(u,ra(n.parser.constructs.insideSpan.null,t.slice(i+1,r),n)),u=Yt(u,[["exit",o,n],["enter",l,n],["exit",l,n],["exit",s,n]]),t[r][1].end.offset-t[r][1].start.offset?(h=2,u=Yt(u,[["enter",t[r][1],n],["exit",t[r][1],n]])):h=0,un(t,i-1,r-i+3,u),r=i+u.length-h-2;break}}for(r=-1;++r<t.length;)t[r][1].type==="attentionSequence"&&(t[r][1].type="data");return t}function vy(t,n){const r=this.parser.constructs.attentionMarkers.null,i=this.previous,s=Cl(i);let o;return a;function a(c){return o=c,t.enter("attentionSequence"),l(c)}function l(c){if(c===o)return t.consume(c),l;const u=t.exit("attentionSequence"),h=Cl(c),g=!h||h===2&&s||r.includes(c),m=!s||s===2&&h||r.includes(i);return u._open=!!(o===42?g:g&&(s||!m)),u._close=!!(o===42?m:m&&(h||!g)),n(c)}}function kl(t,n){t.column+=n,t.offset+=n,t._bufferIndex+=n}const _y={name:"autolink",tokenize:Cy};function Cy(t,n,r){let i=0;return s;function s(p){return t.enter("autolink"),t.enter("autolinkMarker"),t.consume(p),t.exit("autolinkMarker"),t.enter("autolinkProtocol"),o}function o(p){return on(p)?(t.consume(p),a):p===64?r(p):u(p)}function a(p){return p===43||p===45||p===46||Vt(p)?(i=1,l(p)):u(p)}function l(p){return p===58?(t.consume(p),i=0,c):(p===43||p===45||p===46||Vt(p))&&i++<32?(t.consume(p),l):(i=0,u(p))}function c(p){return p===62?(t.exit("autolinkProtocol"),t.enter("autolinkMarker"),t.consume(p),t.exit("autolinkMarker"),t.exit("autolink"),n):p===null||p===32||p===60||bo(p)?r(p):(t.consume(p),c)}function u(p){return p===64?(t.consume(p),h):hy(p)?(t.consume(p),u):r(p)}function h(p){return Vt(p)?g(p):r(p)}function g(p){return p===46?(t.consume(p),i=0,h):p===62?(t.exit("autolinkProtocol").type="autolinkEmail",t.enter("autolinkMarker"),t.consume(p),t.exit("autolinkMarker"),t.exit("autolink"),n):m(p)}function m(p){if((p===45||Vt(p))&&i++<63){const j=p===45?m:g;return t.consume(p),j}return r(p)}}const us={partial:!0,tokenize:ky};function ky(t,n,r){return i;function i(o){return Je(o)?rt(t,s,"linePrefix")(o):s(o)}function s(o){return o===null||Ee(o)?n(o):r(o)}}const Ed={continuation:{tokenize:Iy},exit:zy,name:"blockQuote",tokenize:Ey};function Ey(t,n,r){const i=this;return s;function s(a){if(a===62){const l=i.containerState;return l.open||(t.enter("blockQuote",{_container:!0}),l.open=!0),t.enter("blockQuotePrefix"),t.enter("blockQuoteMarker"),t.consume(a),t.exit("blockQuoteMarker"),o}return r(a)}function o(a){return Je(a)?(t.enter("blockQuotePrefixWhitespace"),t.consume(a),t.exit("blockQuotePrefixWhitespace"),t.exit("blockQuotePrefix"),n):(t.exit("blockQuotePrefix"),n(a))}}function Iy(t,n,r){const i=this;return s;function s(a){return Je(a)?rt(t,o,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a):o(a)}function o(a){return t.attempt(Ed,n,r)(a)}}function zy(t){t.exit("blockQuote")}const Id={name:"characterEscape",tokenize:Ay};function Ay(t,n,r){return i;function i(o){return t.enter("characterEscape"),t.enter("escapeMarker"),t.consume(o),t.exit("escapeMarker"),s}function s(o){return py(o)?(t.enter("characterEscapeValue"),t.consume(o),t.exit("characterEscapeValue"),t.exit("characterEscape"),n):r(o)}}const zd={name:"characterReference",tokenize:Ty};function Ty(t,n,r){const i=this;let s=0,o,a;return l;function l(g){return t.enter("characterReference"),t.enter("characterReferenceMarker"),t.consume(g),t.exit("characterReferenceMarker"),c}function c(g){return g===35?(t.enter("characterReferenceMarkerNumeric"),t.consume(g),t.exit("characterReferenceMarkerNumeric"),u):(t.enter("characterReferenceValue"),o=31,a=Vt,h(g))}function u(g){return g===88||g===120?(t.enter("characterReferenceMarkerHexadecimal"),t.consume(g),t.exit("characterReferenceMarkerHexadecimal"),t.enter("characterReferenceValue"),o=6,a=gy,h):(t.enter("characterReferenceValue"),o=7,a=wo,h(g))}function h(g){if(g===59&&s){const m=t.exit("characterReferenceValue");return a===Vt&&!na(i.sliceSerialize(m))?r(g):(t.enter("characterReferenceMarker"),t.consume(g),t.exit("characterReferenceMarker"),t.exit("characterReference"),n)}return a(g)&&s++<o?(t.consume(g),h):r(g)}}const El={partial:!0,tokenize:Ly},Il={concrete:!0,name:"codeFenced",tokenize:Py};function Py(t,n,r){const i=this,s={partial:!0,tokenize:I};let o=0,a=0,l;return c;function c(w){return u(w)}function u(w){const P=i.events[i.events.length-1];return o=P&&P[1].type==="linePrefix"?P[2].sliceSerialize(P[1],!0).length:0,l=w,t.enter("codeFenced"),t.enter("codeFencedFence"),t.enter("codeFencedFenceSequence"),h(w)}function h(w){return w===l?(a++,t.consume(w),h):a<3?r(w):(t.exit("codeFencedFenceSequence"),Je(w)?rt(t,g,"whitespace")(w):g(w))}function g(w){return w===null||Ee(w)?(t.exit("codeFencedFence"),i.interrupt?n(w):t.check(El,b,U)(w)):(t.enter("codeFencedFenceInfo"),t.enter("chunkString",{contentType:"string"}),m(w))}function m(w){return w===null||Ee(w)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),g(w)):Je(w)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),rt(t,p,"whitespace")(w)):w===96&&w===l?r(w):(t.consume(w),m)}function p(w){return w===null||Ee(w)?g(w):(t.enter("codeFencedFenceMeta"),t.enter("chunkString",{contentType:"string"}),j(w))}function j(w){return w===null||Ee(w)?(t.exit("chunkString"),t.exit("codeFencedFenceMeta"),g(w)):w===96&&w===l?r(w):(t.consume(w),j)}function b(w){return t.attempt(s,U,v)(w)}function v(w){return t.enter("lineEnding"),t.consume(w),t.exit("lineEnding"),_}function _(w){return o>0&&Je(w)?rt(t,N,"linePrefix",o+1)(w):N(w)}function N(w){return w===null||Ee(w)?t.check(El,b,U)(w):(t.enter("codeFlowValue"),R(w))}function R(w){return w===null||Ee(w)?(t.exit("codeFlowValue"),N(w)):(t.consume(w),R)}function U(w){return t.exit("codeFenced"),n(w)}function I(w,P,M){let k=0;return E;function E(q){return w.enter("lineEnding"),w.consume(q),w.exit("lineEnding"),O}function O(q){return w.enter("codeFencedFence"),Je(q)?rt(w,B,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(q):B(q)}function B(q){return q===l?(w.enter("codeFencedFenceSequence"),J(q)):M(q)}function J(q){return q===l?(k++,w.consume(q),J):k>=a?(w.exit("codeFencedFenceSequence"),Je(q)?rt(w,ae,"whitespace")(q):ae(q)):M(q)}function ae(q){return q===null||Ee(q)?(w.exit("codeFencedFence"),P(q)):M(q)}}}function Ly(t,n,r){const i=this;return s;function s(a){return a===null?r(a):(t.enter("lineEnding"),t.consume(a),t.exit("lineEnding"),o)}function o(a){return i.parser.lazy[i.now().line]?r(a):n(a)}}const Is={name:"codeIndented",tokenize:My},Ry={partial:!0,tokenize:Oy};function My(t,n,r){const i=this;return s;function s(u){return t.enter("codeIndented"),rt(t,o,"linePrefix",5)(u)}function o(u){const h=i.events[i.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?a(u):r(u)}function a(u){return u===null?c(u):Ee(u)?t.attempt(Ry,a,c)(u):(t.enter("codeFlowValue"),l(u))}function l(u){return u===null||Ee(u)?(t.exit("codeFlowValue"),a(u)):(t.consume(u),l)}function c(u){return t.exit("codeIndented"),n(u)}}function Oy(t,n,r){const i=this;return s;function s(a){return i.parser.lazy[i.now().line]?r(a):Ee(a)?(t.enter("lineEnding"),t.consume(a),t.exit("lineEnding"),s):rt(t,o,"linePrefix",5)(a)}function o(a){const l=i.events[i.events.length-1];return l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?n(a):Ee(a)?s(a):r(a)}}const Fy={name:"codeText",previous:Ny,resolve:Dy,tokenize:Wy};function Dy(t){let n=t.length-4,r=3,i,s;if((t[r][1].type==="lineEnding"||t[r][1].type==="space")&&(t[n][1].type==="lineEnding"||t[n][1].type==="space")){for(i=r;++i<n;)if(t[i][1].type==="codeTextData"){t[r][1].type="codeTextPadding",t[n][1].type="codeTextPadding",r+=2,n-=2;break}}for(i=r-1,n++;++i<=n;)s===void 0?i!==n&&t[i][1].type!=="lineEnding"&&(s=i):(i===n||t[i][1].type==="lineEnding")&&(t[s][1].type="codeTextData",i!==s+2&&(t[s][1].end=t[i-1][1].end,t.splice(s+2,i-s-2),n-=i-s-2,i=s+2),s=void 0);return t}function Ny(t){return t!==96||this.events[this.events.length-1][1].type==="characterEscape"}function Wy(t,n,r){let i=0,s,o;return a;function a(g){return t.enter("codeText"),t.enter("codeTextSequence"),l(g)}function l(g){return g===96?(t.consume(g),i++,l):(t.exit("codeTextSequence"),c(g))}function c(g){return g===null?r(g):g===32?(t.enter("space"),t.consume(g),t.exit("space"),c):g===96?(o=t.enter("codeTextSequence"),s=0,h(g)):Ee(g)?(t.enter("lineEnding"),t.consume(g),t.exit("lineEnding"),c):(t.enter("codeTextData"),u(g))}function u(g){return g===null||g===32||g===96||Ee(g)?(t.exit("codeTextData"),c(g)):(t.consume(g),u)}function h(g){return g===96?(t.consume(g),s++,h):s===i?(t.exit("codeTextSequence"),t.exit("codeText"),n(g)):(o.type="codeTextData",u(g))}}class By{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,r){const i=r??Number.POSITIVE_INFINITY;return i<this.left.length?this.left.slice(n,i):n>this.left.length?this.right.slice(this.right.length-i+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-i+this.left.length).reverse())}splice(n,r,i){const s=r||0;this.setCursor(Math.trunc(n));const o=this.right.splice(this.right.length-s,Number.POSITIVE_INFINITY);return i&&Ir(this.left,i),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Ir(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Ir(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const r=this.left.splice(n,Number.POSITIVE_INFINITY);Ir(this.right,r.reverse())}else{const r=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Ir(this.left,r.reverse())}}}function Ir(t,n){let r=0;if(n.length<1e4)t.push(...n);else for(;r<n.length;)t.push(...n.slice(r,r+1e4)),r+=1e4}function Ad(t){const n={};let r=-1,i,s,o,a,l,c,u;const h=new By(t);for(;++r<h.length;){for(;r in n;)r=n[r];if(i=h.get(r),r&&i[1].type==="chunkFlow"&&h.get(r-1)[1].type==="listItemPrefix"&&(c=i[1]._tokenizer.events,o=0,o<c.length&&c[o][1].type==="lineEndingBlank"&&(o+=2),o<c.length&&c[o][1].type==="content"))for(;++o<c.length&&c[o][1].type!=="content";)c[o][1].type==="chunkText"&&(c[o][1]._isInFirstContentOfListItem=!0,o++);if(i[0]==="enter")i[1].contentType&&(Object.assign(n,Uy(h,r)),r=n[r],u=!0);else if(i[1]._container){for(o=r,s=void 0;o--;)if(a=h.get(o),a[1].type==="lineEnding"||a[1].type==="lineEndingBlank")a[0]==="enter"&&(s&&(h.get(s)[1].type="lineEndingBlank"),a[1].type="lineEnding",s=o);else if(!(a[1].type==="linePrefix"||a[1].type==="listItemIndent"))break;s&&(i[1].end={...h.get(s)[1].start},l=h.slice(s,r),l.unshift(i),h.splice(s,r-s+1,l))}}return un(t,0,Number.POSITIVE_INFINITY,h.slice(0)),!u}function Uy(t,n){const r=t.get(n)[1],i=t.get(n)[2];let s=n-1;const o=[];let a=r._tokenizer;a||(a=i.parser[r.contentType](r.start),r._contentTypeTextTrailing&&(a._contentTypeTextTrailing=!0));const l=a.events,c=[],u={};let h,g,m=-1,p=r,j=0,b=0;const v=[b];for(;p;){for(;t.get(++s)[1]!==p;);o.push(s),p._tokenizer||(h=i.sliceStream(p),p.next||h.push(null),g&&a.defineSkip(p.start),p._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=!0),a.write(h),p._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=void 0)),g=p,p=p.next}for(p=r;++m<l.length;)l[m][0]==="exit"&&l[m-1][0]==="enter"&&l[m][1].type===l[m-1][1].type&&l[m][1].start.line!==l[m][1].end.line&&(b=m+1,v.push(b),p._tokenizer=void 0,p.previous=void 0,p=p.next);for(a.events=[],p?(p._tokenizer=void 0,p.previous=void 0):v.pop(),m=v.length;m--;){const _=l.slice(v[m],v[m+1]),N=o.pop();c.push([N,N+_.length-1]),t.splice(N,2,_)}for(c.reverse(),m=-1;++m<c.length;)u[j+c[m][0]]=j+c[m][1],j+=c[m][1]-c[m][0]-1;return u}const Hy={resolve:Vy,tokenize:qy},$y={partial:!0,tokenize:Gy};function Vy(t){return Ad(t),t}function qy(t,n){let r;return i;function i(l){return t.enter("content"),r=t.enter("chunkContent",{contentType:"content"}),s(l)}function s(l){return l===null?o(l):Ee(l)?t.check($y,a,o)(l):(t.consume(l),s)}function o(l){return t.exit("chunkContent"),t.exit("content"),n(l)}function a(l){return t.consume(l),t.exit("chunkContent"),r.next=t.enter("chunkContent",{contentType:"content",previous:r}),r=r.next,s}}function Gy(t,n,r){const i=this;return s;function s(a){return t.exit("chunkContent"),t.enter("lineEnding"),t.consume(a),t.exit("lineEnding"),rt(t,o,"linePrefix")}function o(a){if(a===null||Ee(a))return r(a);const l=i.events[i.events.length-1];return!i.parser.constructs.disable.null.includes("codeIndented")&&l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?n(a):t.interrupt(i.parser.constructs.flow,r,n)(a)}}function Td(t,n,r,i,s,o,a,l,c){const u=c||Number.POSITIVE_INFINITY;let h=0;return g;function g(_){return _===60?(t.enter(i),t.enter(s),t.enter(o),t.consume(_),t.exit(o),m):_===null||_===32||_===41||bo(_)?r(_):(t.enter(i),t.enter(a),t.enter(l),t.enter("chunkString",{contentType:"string"}),b(_))}function m(_){return _===62?(t.enter(o),t.consume(_),t.exit(o),t.exit(s),t.exit(i),n):(t.enter(l),t.enter("chunkString",{contentType:"string"}),p(_))}function p(_){return _===62?(t.exit("chunkString"),t.exit(l),m(_)):_===null||_===60||Ee(_)?r(_):(t.consume(_),_===92?j:p)}function j(_){return _===60||_===62||_===92?(t.consume(_),p):p(_)}function b(_){return!h&&(_===null||_===41||Nt(_))?(t.exit("chunkString"),t.exit(l),t.exit(a),t.exit(i),n(_)):h<u&&_===40?(t.consume(_),h++,b):_===41?(t.consume(_),h--,b):_===null||_===32||_===40||bo(_)?r(_):(t.consume(_),_===92?v:b)}function v(_){return _===40||_===41||_===92?(t.consume(_),b):b(_)}}function Pd(t,n,r,i,s,o){const a=this;let l=0,c;return u;function u(p){return t.enter(i),t.enter(s),t.consume(p),t.exit(s),t.enter(o),h}function h(p){return l>999||p===null||p===91||p===93&&!c||p===94&&!l&&"_hiddenFootnoteSupport"in a.parser.constructs?r(p):p===93?(t.exit(o),t.enter(s),t.consume(p),t.exit(s),t.exit(i),n):Ee(p)?(t.enter("lineEnding"),t.consume(p),t.exit("lineEnding"),h):(t.enter("chunkString",{contentType:"string"}),g(p))}function g(p){return p===null||p===91||p===93||Ee(p)||l++>999?(t.exit("chunkString"),h(p)):(t.consume(p),c||(c=!Je(p)),p===92?m:g)}function m(p){return p===91||p===92||p===93?(t.consume(p),l++,g):g(p)}}function Ld(t,n,r,i,s,o){let a;return l;function l(m){return m===34||m===39||m===40?(t.enter(i),t.enter(s),t.consume(m),t.exit(s),a=m===40?41:m,c):r(m)}function c(m){return m===a?(t.enter(s),t.consume(m),t.exit(s),t.exit(i),n):(t.enter(o),u(m))}function u(m){return m===a?(t.exit(o),c(a)):m===null?r(m):Ee(m)?(t.enter("lineEnding"),t.consume(m),t.exit("lineEnding"),rt(t,u,"linePrefix")):(t.enter("chunkString",{contentType:"string"}),h(m))}function h(m){return m===a||m===null||Ee(m)?(t.exit("chunkString"),u(m)):(t.consume(m),m===92?g:h)}function g(m){return m===a||m===92?(t.consume(m),h):h(m)}}function Nr(t,n){let r;return i;function i(s){return Ee(s)?(t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),r=!0,i):Je(s)?rt(t,i,r?"linePrefix":"lineSuffix")(s):n(s)}}const Yy={name:"definition",tokenize:Jy},Ky={partial:!0,tokenize:Qy};function Jy(t,n,r){const i=this;let s;return o;function o(p){return t.enter("definition"),a(p)}function a(p){return Pd.call(i,t,l,r,"definitionLabel","definitionLabelMarker","definitionLabelString")(p)}function l(p){return s=xr(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)),p===58?(t.enter("definitionMarker"),t.consume(p),t.exit("definitionMarker"),c):r(p)}function c(p){return Nt(p)?Nr(t,u)(p):u(p)}function u(p){return Td(t,h,r,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(p)}function h(p){return t.attempt(Ky,g,g)(p)}function g(p){return Je(p)?rt(t,m,"whitespace")(p):m(p)}function m(p){return p===null||Ee(p)?(t.exit("definition"),i.parser.defined.push(s),n(p)):r(p)}}function Qy(t,n,r){return i;function i(l){return Nt(l)?Nr(t,s)(l):r(l)}function s(l){return Ld(t,o,r,"definitionTitle","definitionTitleMarker","definitionTitleString")(l)}function o(l){return Je(l)?rt(t,a,"whitespace")(l):a(l)}function a(l){return l===null||Ee(l)?n(l):r(l)}}const Xy={name:"hardBreakEscape",tokenize:Zy};function Zy(t,n,r){return i;function i(o){return t.enter("hardBreakEscape"),t.consume(o),s}function s(o){return Ee(o)?(t.exit("hardBreakEscape"),n(o)):r(o)}}const eb={name:"headingAtx",resolve:tb,tokenize:nb};function tb(t,n){let r=t.length-2,i=3,s,o;return t[i][1].type==="whitespace"&&(i+=2),r-2>i&&t[r][1].type==="whitespace"&&(r-=2),t[r][1].type==="atxHeadingSequence"&&(i===r-1||r-4>i&&t[r-2][1].type==="whitespace")&&(r-=i+1===r?2:4),r>i&&(s={type:"atxHeadingText",start:t[i][1].start,end:t[r][1].end},o={type:"chunkText",start:t[i][1].start,end:t[r][1].end,contentType:"text"},un(t,i,r-i+1,[["enter",s,n],["enter",o,n],["exit",o,n],["exit",s,n]])),t}function nb(t,n,r){let i=0;return s;function s(h){return t.enter("atxHeading"),o(h)}function o(h){return t.enter("atxHeadingSequence"),a(h)}function a(h){return h===35&&i++<6?(t.consume(h),a):h===null||Nt(h)?(t.exit("atxHeadingSequence"),l(h)):r(h)}function l(h){return h===35?(t.enter("atxHeadingSequence"),c(h)):h===null||Ee(h)?(t.exit("atxHeading"),n(h)):Je(h)?rt(t,l,"whitespace")(h):(t.enter("atxHeadingText"),u(h))}function c(h){return h===35?(t.consume(h),c):(t.exit("atxHeadingSequence"),l(h))}function u(h){return h===null||h===35||Nt(h)?(t.exit("atxHeadingText"),l(h)):(t.consume(h),u)}}const rb=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],zl=["pre","script","style","textarea"],ib={concrete:!0,name:"htmlFlow",resolveTo:ab,tokenize:lb},sb={partial:!0,tokenize:ub},ob={partial:!0,tokenize:cb};function ab(t){let n=t.length;for(;n--&&!(t[n][0]==="enter"&&t[n][1].type==="htmlFlow"););return n>1&&t[n-2][1].type==="linePrefix"&&(t[n][1].start=t[n-2][1].start,t[n+1][1].start=t[n-2][1].start,t.splice(n-2,2)),t}function lb(t,n,r){const i=this;let s,o,a,l,c;return u;function u(y){return h(y)}function h(y){return t.enter("htmlFlow"),t.enter("htmlFlowData"),t.consume(y),g}function g(y){return y===33?(t.consume(y),m):y===47?(t.consume(y),o=!0,b):y===63?(t.consume(y),s=3,i.interrupt?n:f):on(y)?(t.consume(y),a=String.fromCharCode(y),v):r(y)}function m(y){return y===45?(t.consume(y),s=2,p):y===91?(t.consume(y),s=5,l=0,j):on(y)?(t.consume(y),s=4,i.interrupt?n:f):r(y)}function p(y){return y===45?(t.consume(y),i.interrupt?n:f):r(y)}function j(y){const ee="CDATA[";return y===ee.charCodeAt(l++)?(t.consume(y),l===ee.length?i.interrupt?n:B:j):r(y)}function b(y){return on(y)?(t.consume(y),a=String.fromCharCode(y),v):r(y)}function v(y){if(y===null||y===47||y===62||Nt(y)){const ee=y===47,Ie=a.toLowerCase();return!ee&&!o&&zl.includes(Ie)?(s=1,i.interrupt?n(y):B(y)):rb.includes(a.toLowerCase())?(s=6,ee?(t.consume(y),_):i.interrupt?n(y):B(y)):(s=7,i.interrupt&&!i.parser.lazy[i.now().line]?r(y):o?N(y):R(y))}return y===45||Vt(y)?(t.consume(y),a+=String.fromCharCode(y),v):r(y)}function _(y){return y===62?(t.consume(y),i.interrupt?n:B):r(y)}function N(y){return Je(y)?(t.consume(y),N):E(y)}function R(y){return y===47?(t.consume(y),E):y===58||y===95||on(y)?(t.consume(y),U):Je(y)?(t.consume(y),R):E(y)}function U(y){return y===45||y===46||y===58||y===95||Vt(y)?(t.consume(y),U):I(y)}function I(y){return y===61?(t.consume(y),w):Je(y)?(t.consume(y),I):R(y)}function w(y){return y===null||y===60||y===61||y===62||y===96?r(y):y===34||y===39?(t.consume(y),c=y,P):Je(y)?(t.consume(y),w):M(y)}function P(y){return y===c?(t.consume(y),c=null,k):y===null||Ee(y)?r(y):(t.consume(y),P)}function M(y){return y===null||y===34||y===39||y===47||y===60||y===61||y===62||y===96||Nt(y)?I(y):(t.consume(y),M)}function k(y){return y===47||y===62||Je(y)?R(y):r(y)}function E(y){return y===62?(t.consume(y),O):r(y)}function O(y){return y===null||Ee(y)?B(y):Je(y)?(t.consume(y),O):r(y)}function B(y){return y===45&&s===2?(t.consume(y),oe):y===60&&s===1?(t.consume(y),fe):y===62&&s===4?(t.consume(y),W):y===63&&s===3?(t.consume(y),f):y===93&&s===5?(t.consume(y),X):Ee(y)&&(s===6||s===7)?(t.exit("htmlFlowData"),t.check(sb,te,J)(y)):y===null||Ee(y)?(t.exit("htmlFlowData"),J(y)):(t.consume(y),B)}function J(y){return t.check(ob,ae,te)(y)}function ae(y){return t.enter("lineEnding"),t.consume(y),t.exit("lineEnding"),q}function q(y){return y===null||Ee(y)?J(y):(t.enter("htmlFlowData"),B(y))}function oe(y){return y===45?(t.consume(y),f):B(y)}function fe(y){return y===47?(t.consume(y),a="",pe):B(y)}function pe(y){if(y===62){const ee=a.toLowerCase();return zl.includes(ee)?(t.consume(y),W):B(y)}return on(y)&&a.length<8?(t.consume(y),a+=String.fromCharCode(y),pe):B(y)}function X(y){return y===93?(t.consume(y),f):B(y)}function f(y){return y===62?(t.consume(y),W):y===45&&s===2?(t.consume(y),f):B(y)}function W(y){return y===null||Ee(y)?(t.exit("htmlFlowData"),te(y)):(t.consume(y),W)}function te(y){return t.exit("htmlFlow"),n(y)}}function cb(t,n,r){const i=this;return s;function s(a){return Ee(a)?(t.enter("lineEnding"),t.consume(a),t.exit("lineEnding"),o):r(a)}function o(a){return i.parser.lazy[i.now().line]?r(a):n(a)}}function ub(t,n,r){return i;function i(s){return t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),t.attempt(us,n,r)}}const db={name:"htmlText",tokenize:hb};function hb(t,n,r){const i=this;let s,o,a;return l;function l(f){return t.enter("htmlText"),t.enter("htmlTextData"),t.consume(f),c}function c(f){return f===33?(t.consume(f),u):f===47?(t.consume(f),I):f===63?(t.consume(f),R):on(f)?(t.consume(f),M):r(f)}function u(f){return f===45?(t.consume(f),h):f===91?(t.consume(f),o=0,j):on(f)?(t.consume(f),N):r(f)}function h(f){return f===45?(t.consume(f),p):r(f)}function g(f){return f===null?r(f):f===45?(t.consume(f),m):Ee(f)?(a=g,fe(f)):(t.consume(f),g)}function m(f){return f===45?(t.consume(f),p):g(f)}function p(f){return f===62?oe(f):f===45?m(f):g(f)}function j(f){const W="CDATA[";return f===W.charCodeAt(o++)?(t.consume(f),o===W.length?b:j):r(f)}function b(f){return f===null?r(f):f===93?(t.consume(f),v):Ee(f)?(a=b,fe(f)):(t.consume(f),b)}function v(f){return f===93?(t.consume(f),_):b(f)}function _(f){return f===62?oe(f):f===93?(t.consume(f),_):b(f)}function N(f){return f===null||f===62?oe(f):Ee(f)?(a=N,fe(f)):(t.consume(f),N)}function R(f){return f===null?r(f):f===63?(t.consume(f),U):Ee(f)?(a=R,fe(f)):(t.consume(f),R)}function U(f){return f===62?oe(f):R(f)}function I(f){return on(f)?(t.consume(f),w):r(f)}function w(f){return f===45||Vt(f)?(t.consume(f),w):P(f)}function P(f){return Ee(f)?(a=P,fe(f)):Je(f)?(t.consume(f),P):oe(f)}function M(f){return f===45||Vt(f)?(t.consume(f),M):f===47||f===62||Nt(f)?k(f):r(f)}function k(f){return f===47?(t.consume(f),oe):f===58||f===95||on(f)?(t.consume(f),E):Ee(f)?(a=k,fe(f)):Je(f)?(t.consume(f),k):oe(f)}function E(f){return f===45||f===46||f===58||f===95||Vt(f)?(t.consume(f),E):O(f)}function O(f){return f===61?(t.consume(f),B):Ee(f)?(a=O,fe(f)):Je(f)?(t.consume(f),O):k(f)}function B(f){return f===null||f===60||f===61||f===62||f===96?r(f):f===34||f===39?(t.consume(f),s=f,J):Ee(f)?(a=B,fe(f)):Je(f)?(t.consume(f),B):(t.consume(f),ae)}function J(f){return f===s?(t.consume(f),s=void 0,q):f===null?r(f):Ee(f)?(a=J,fe(f)):(t.consume(f),J)}function ae(f){return f===null||f===34||f===39||f===60||f===61||f===96?r(f):f===47||f===62||Nt(f)?k(f):(t.consume(f),ae)}function q(f){return f===47||f===62||Nt(f)?k(f):r(f)}function oe(f){return f===62?(t.consume(f),t.exit("htmlTextData"),t.exit("htmlText"),n):r(f)}function fe(f){return t.exit("htmlTextData"),t.enter("lineEnding"),t.consume(f),t.exit("lineEnding"),pe}function pe(f){return Je(f)?rt(t,X,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(f):X(f)}function X(f){return t.enter("htmlTextData"),a(f)}}const ia={name:"labelEnd",resolveAll:mb,resolveTo:xb,tokenize:jb},gb={tokenize:yb},pb={tokenize:bb},fb={tokenize:wb};function mb(t){let n=-1;const r=[];for(;++n<t.length;){const i=t[n][1];if(r.push(t[n]),i.type==="labelImage"||i.type==="labelLink"||i.type==="labelEnd"){const s=i.type==="labelImage"?4:2;i.type="data",n+=s}}return t.length!==r.length&&un(t,0,t.length,r),t}function xb(t,n){let r=t.length,i=0,s,o,a,l;for(;r--;)if(s=t[r][1],o){if(s.type==="link"||s.type==="labelLink"&&s._inactive)break;t[r][0]==="enter"&&s.type==="labelLink"&&(s._inactive=!0)}else if(a){if(t[r][0]==="enter"&&(s.type==="labelImage"||s.type==="labelLink")&&!s._balanced&&(o=r,s.type!=="labelLink")){i=2;break}}else s.type==="labelEnd"&&(a=r);const c={type:t[o][1].type==="labelLink"?"link":"image",start:{...t[o][1].start},end:{...t[t.length-1][1].end}},u={type:"label",start:{...t[o][1].start},end:{...t[a][1].end}},h={type:"labelText",start:{...t[o+i+2][1].end},end:{...t[a-2][1].start}};return l=[["enter",c,n],["enter",u,n]],l=Yt(l,t.slice(o+1,o+i+3)),l=Yt(l,[["enter",h,n]]),l=Yt(l,ra(n.parser.constructs.insideSpan.null,t.slice(o+i+4,a-3),n)),l=Yt(l,[["exit",h,n],t[a-2],t[a-1],["exit",u,n]]),l=Yt(l,t.slice(a+1)),l=Yt(l,[["exit",c,n]]),un(t,o,t.length,l),t}function jb(t,n,r){const i=this;let s=i.events.length,o,a;for(;s--;)if((i.events[s][1].type==="labelImage"||i.events[s][1].type==="labelLink")&&!i.events[s][1]._balanced){o=i.events[s][1];break}return l;function l(m){return o?o._inactive?g(m):(a=i.parser.defined.includes(xr(i.sliceSerialize({start:o.end,end:i.now()}))),t.enter("labelEnd"),t.enter("labelMarker"),t.consume(m),t.exit("labelMarker"),t.exit("labelEnd"),c):r(m)}function c(m){return m===40?t.attempt(gb,h,a?h:g)(m):m===91?t.attempt(pb,h,a?u:g)(m):a?h(m):g(m)}function u(m){return t.attempt(fb,h,g)(m)}function h(m){return n(m)}function g(m){return o._balanced=!0,r(m)}}function yb(t,n,r){return i;function i(g){return t.enter("resource"),t.enter("resourceMarker"),t.consume(g),t.exit("resourceMarker"),s}function s(g){return Nt(g)?Nr(t,o)(g):o(g)}function o(g){return g===41?h(g):Td(t,a,l,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function a(g){return Nt(g)?Nr(t,c)(g):h(g)}function l(g){return r(g)}function c(g){return g===34||g===39||g===40?Ld(t,u,r,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):h(g)}function u(g){return Nt(g)?Nr(t,h)(g):h(g)}function h(g){return g===41?(t.enter("resourceMarker"),t.consume(g),t.exit("resourceMarker"),t.exit("resource"),n):r(g)}}function bb(t,n,r){const i=this;return s;function s(l){return Pd.call(i,t,o,a,"reference","referenceMarker","referenceString")(l)}function o(l){return i.parser.defined.includes(xr(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)))?n(l):r(l)}function a(l){return r(l)}}function wb(t,n,r){return i;function i(o){return t.enter("reference"),t.enter("referenceMarker"),t.consume(o),t.exit("referenceMarker"),s}function s(o){return o===93?(t.enter("referenceMarker"),t.consume(o),t.exit("referenceMarker"),t.exit("reference"),n):r(o)}}const Sb={name:"labelStartImage",resolveAll:ia.resolveAll,tokenize:vb};function vb(t,n,r){const i=this;return s;function s(l){return t.enter("labelImage"),t.enter("labelImageMarker"),t.consume(l),t.exit("labelImageMarker"),o}function o(l){return l===91?(t.enter("labelMarker"),t.consume(l),t.exit("labelMarker"),t.exit("labelImage"),a):r(l)}function a(l){return l===94&&"_hiddenFootnoteSupport"in i.parser.constructs?r(l):n(l)}}const _b={name:"labelStartLink",resolveAll:ia.resolveAll,tokenize:Cb};function Cb(t,n,r){const i=this;return s;function s(a){return t.enter("labelLink"),t.enter("labelMarker"),t.consume(a),t.exit("labelMarker"),t.exit("labelLink"),o}function o(a){return a===94&&"_hiddenFootnoteSupport"in i.parser.constructs?r(a):n(a)}}const zs={name:"lineEnding",tokenize:kb};function kb(t,n){return r;function r(i){return t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),rt(t,n,"linePrefix")}}const Ci={name:"thematicBreak",tokenize:Eb};function Eb(t,n,r){let i=0,s;return o;function o(u){return t.enter("thematicBreak"),a(u)}function a(u){return s=u,l(u)}function l(u){return u===s?(t.enter("thematicBreakSequence"),c(u)):i>=3&&(u===null||Ee(u))?(t.exit("thematicBreak"),n(u)):r(u)}function c(u){return u===s?(t.consume(u),i++,c):(t.exit("thematicBreakSequence"),Je(u)?rt(t,l,"whitespace")(u):l(u))}}const Mt={continuation:{tokenize:Tb},exit:Lb,name:"list",tokenize:Ab},Ib={partial:!0,tokenize:Rb},zb={partial:!0,tokenize:Pb};function Ab(t,n,r){const i=this,s=i.events[i.events.length-1];let o=s&&s[1].type==="linePrefix"?s[2].sliceSerialize(s[1],!0).length:0,a=0;return l;function l(p){const j=i.containerState.type||(p===42||p===43||p===45?"listUnordered":"listOrdered");if(j==="listUnordered"?!i.containerState.marker||p===i.containerState.marker:wo(p)){if(i.containerState.type||(i.containerState.type=j,t.enter(j,{_container:!0})),j==="listUnordered")return t.enter("listItemPrefix"),p===42||p===45?t.check(Ci,r,u)(p):u(p);if(!i.interrupt||p===49)return t.enter("listItemPrefix"),t.enter("listItemValue"),c(p)}return r(p)}function c(p){return wo(p)&&++a<10?(t.consume(p),c):(!i.interrupt||a<2)&&(i.containerState.marker?p===i.containerState.marker:p===41||p===46)?(t.exit("listItemValue"),u(p)):r(p)}function u(p){return t.enter("listItemMarker"),t.consume(p),t.exit("listItemMarker"),i.containerState.marker=i.containerState.marker||p,t.check(us,i.interrupt?r:h,t.attempt(Ib,m,g))}function h(p){return i.containerState.initialBlankLine=!0,o++,m(p)}function g(p){return Je(p)?(t.enter("listItemPrefixWhitespace"),t.consume(p),t.exit("listItemPrefixWhitespace"),m):r(p)}function m(p){return i.containerState.size=o+i.sliceSerialize(t.exit("listItemPrefix"),!0).length,n(p)}}function Tb(t,n,r){const i=this;return i.containerState._closeFlow=void 0,t.check(us,s,o);function s(l){return i.containerState.furtherBlankLines=i.containerState.furtherBlankLines||i.containerState.initialBlankLine,rt(t,n,"listItemIndent",i.containerState.size+1)(l)}function o(l){return i.containerState.furtherBlankLines||!Je(l)?(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,a(l)):(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,t.attempt(zb,n,a)(l))}function a(l){return i.containerState._closeFlow=!0,i.interrupt=void 0,rt(t,t.attempt(Mt,n,r),"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l)}}function Pb(t,n,r){const i=this;return rt(t,s,"listItemIndent",i.containerState.size+1);function s(o){const a=i.events[i.events.length-1];return a&&a[1].type==="listItemIndent"&&a[2].sliceSerialize(a[1],!0).length===i.containerState.size?n(o):r(o)}}function Lb(t){t.exit(this.containerState.type)}function Rb(t,n,r){const i=this;return rt(t,s,"listItemPrefixWhitespace",i.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function s(o){const a=i.events[i.events.length-1];return!Je(o)&&a&&a[1].type==="listItemPrefixWhitespace"?n(o):r(o)}}const Al={name:"setextUnderline",resolveTo:Mb,tokenize:Ob};function Mb(t,n){let r=t.length,i,s,o;for(;r--;)if(t[r][0]==="enter"){if(t[r][1].type==="content"){i=r;break}t[r][1].type==="paragraph"&&(s=r)}else t[r][1].type==="content"&&t.splice(r,1),!o&&t[r][1].type==="definition"&&(o=r);const a={type:"setextHeading",start:{...t[i][1].start},end:{...t[t.length-1][1].end}};return t[s][1].type="setextHeadingText",o?(t.splice(s,0,["enter",a,n]),t.splice(o+1,0,["exit",t[i][1],n]),t[i][1].end={...t[o][1].end}):t[i][1]=a,t.push(["exit",a,n]),t}function Ob(t,n,r){const i=this;let s;return o;function o(u){let h=i.events.length,g;for(;h--;)if(i.events[h][1].type!=="lineEnding"&&i.events[h][1].type!=="linePrefix"&&i.events[h][1].type!=="content"){g=i.events[h][1].type==="paragraph";break}return!i.parser.lazy[i.now().line]&&(i.interrupt||g)?(t.enter("setextHeadingLine"),s=u,a(u)):r(u)}function a(u){return t.enter("setextHeadingLineSequence"),l(u)}function l(u){return u===s?(t.consume(u),l):(t.exit("setextHeadingLineSequence"),Je(u)?rt(t,c,"lineSuffix")(u):c(u))}function c(u){return u===null||Ee(u)?(t.exit("setextHeadingLine"),n(u)):r(u)}}const Fb={tokenize:Db};function Db(t){const n=this,r=t.attempt(us,i,t.attempt(this.parser.constructs.flowInitial,s,rt(t,t.attempt(this.parser.constructs.flow,s,t.attempt(Hy,s)),"linePrefix")));return r;function i(o){if(o===null){t.consume(o);return}return t.enter("lineEndingBlank"),t.consume(o),t.exit("lineEndingBlank"),n.currentConstruct=void 0,r}function s(o){if(o===null){t.consume(o);return}return t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),n.currentConstruct=void 0,r}}const Nb={resolveAll:Md()},Wb=Rd("string"),Bb=Rd("text");function Rd(t){return{resolveAll:Md(t==="text"?Ub:void 0),tokenize:n};function n(r){const i=this,s=this.parser.constructs[t],o=r.attempt(s,a,l);return a;function a(h){return u(h)?o(h):l(h)}function l(h){if(h===null){r.consume(h);return}return r.enter("data"),r.consume(h),c}function c(h){return u(h)?(r.exit("data"),o(h)):(r.consume(h),c)}function u(h){if(h===null)return!0;const g=s[h];let m=-1;if(g)for(;++m<g.length;){const p=g[m];if(!p.previous||p.previous.call(i,i.previous))return!0}return!1}}}function Md(t){return n;function n(r,i){let s=-1,o;for(;++s<=r.length;)o===void 0?r[s]&&r[s][1].type==="data"&&(o=s,s++):(!r[s]||r[s][1].type!=="data")&&(s!==o+2&&(r[o][1].end=r[s-1][1].end,r.splice(o+2,s-o-2),s=o+2),o=void 0);return t?t(r,i):r}}function Ub(t,n){let r=0;for(;++r<=t.length;)if((r===t.length||t[r][1].type==="lineEnding")&&t[r-1][1].type==="data"){const i=t[r-1][1],s=n.sliceStream(i);let o=s.length,a=-1,l=0,c;for(;o--;){const u=s[o];if(typeof u=="string"){for(a=u.length;u.charCodeAt(a-1)===32;)l++,a--;if(a)break;a=-1}else if(u===-2)c=!0,l++;else if(u!==-1){o++;break}}if(n._contentTypeTextTrailing&&r===t.length&&(l=0),l){const u={type:r===t.length||c||l<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?a:i.start._bufferIndex+a,_index:i.start._index+o,line:i.end.line,column:i.end.column-l,offset:i.end.offset-l},end:{...i.end}};i.end={...u.start},i.start.offset===i.end.offset?Object.assign(i,u):(t.splice(r,0,["enter",u,n],["exit",u,n]),r+=2)}r++}return t}const Hb={42:Mt,43:Mt,45:Mt,48:Mt,49:Mt,50:Mt,51:Mt,52:Mt,53:Mt,54:Mt,55:Mt,56:Mt,57:Mt,62:Ed},$b={91:Yy},Vb={[-2]:Is,[-1]:Is,32:Is},qb={35:eb,42:Ci,45:[Al,Ci],60:ib,61:Al,95:Ci,96:Il,126:Il},Gb={38:zd,92:Id},Yb={[-5]:zs,[-4]:zs,[-3]:zs,33:Sb,38:zd,42:So,60:[_y,db],91:_b,92:[Xy,Id],93:ia,95:So,96:Fy},Kb={null:[So,Nb]},Jb={null:[42,95]},Qb={null:[]},Xb=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:Jb,contentInitial:$b,disable:Qb,document:Hb,flow:qb,flowInitial:Vb,insideSpan:Kb,string:Gb,text:Yb},Symbol.toStringTag,{value:"Module"}));function Zb(t,n,r){let i={_bufferIndex:-1,_index:0,line:r&&r.line||1,column:r&&r.column||1,offset:r&&r.offset||0};const s={},o=[];let a=[],l=[];const c={attempt:P(I),check:P(w),consume:N,enter:R,exit:U,interrupt:P(w,{interrupt:!0})},u={code:null,containerState:{},defineSkip:b,events:[],now:j,parser:t,previous:null,sliceSerialize:m,sliceStream:p,write:g};let h=n.tokenize.call(u,c);return n.resolveAll&&o.push(n),u;function g(O){return a=Yt(a,O),v(),a[a.length-1]!==null?[]:(M(n,0),u.events=ra(o,u.events,u),u.events)}function m(O,B){return t1(p(O),B)}function p(O){return e1(a,O)}function j(){const{_bufferIndex:O,_index:B,line:J,column:ae,offset:q}=i;return{_bufferIndex:O,_index:B,line:J,column:ae,offset:q}}function b(O){s[O.line]=O.column,E()}function v(){let O;for(;i._index<a.length;){const B=a[i._index];if(typeof B=="string")for(O=i._index,i._bufferIndex<0&&(i._bufferIndex=0);i._index===O&&i._bufferIndex<B.length;)_(B.charCodeAt(i._bufferIndex));else _(B)}}function _(O){h=h(O)}function N(O){Ee(O)?(i.line++,i.column=1,i.offset+=O===-3?2:1,E()):O!==-1&&(i.column++,i.offset++),i._bufferIndex<0?i._index++:(i._bufferIndex++,i._bufferIndex===a[i._index].length&&(i._bufferIndex=-1,i._index++)),u.previous=O}function R(O,B){const J=B||{};return J.type=O,J.start=j(),u.events.push(["enter",J,u]),l.push(J),J}function U(O){const B=l.pop();return B.end=j(),u.events.push(["exit",B,u]),B}function I(O,B){M(O,B.from)}function w(O,B){B.restore()}function P(O,B){return J;function J(ae,q,oe){let fe,pe,X,f;return Array.isArray(ae)?te(ae):"tokenize"in ae?te([ae]):W(ae);function W(ce){return ne;function ne(he){const dt=he!==null&&ce[he],Qe=he!==null&&ce.null,Ye=[...Array.isArray(dt)?dt:dt?[dt]:[],...Array.isArray(Qe)?Qe:Qe?[Qe]:[]];return te(Ye)(he)}}function te(ce){return fe=ce,pe=0,ce.length===0?oe:y(ce[pe])}function y(ce){return ne;function ne(he){return f=k(),X=ce,ce.partial||(u.currentConstruct=ce),ce.name&&u.parser.constructs.disable.null.includes(ce.name)?Ie():ce.tokenize.call(B?Object.assign(Object.create(u),B):u,c,ee,Ie)(he)}}function ee(ce){return O(X,f),q}function Ie(ce){return f.restore(),++pe<fe.length?y(fe[pe]):oe}}}function M(O,B){O.resolveAll&&!o.includes(O)&&o.push(O),O.resolve&&un(u.events,B,u.events.length-B,O.resolve(u.events.slice(B),u)),O.resolveTo&&(u.events=O.resolveTo(u.events,u))}function k(){const O=j(),B=u.previous,J=u.currentConstruct,ae=u.events.length,q=Array.from(l);return{from:ae,restore:oe};function oe(){i=O,u.previous=B,u.currentConstruct=J,u.events.length=ae,l=q,E()}}function E(){i.line in s&&i.column<2&&(i.column=s[i.line],i.offset+=s[i.line]-1)}}function e1(t,n){const r=n.start._index,i=n.start._bufferIndex,s=n.end._index,o=n.end._bufferIndex;let a;if(r===s)a=[t[r].slice(i,o)];else{if(a=t.slice(r,s),i>-1){const l=a[0];typeof l=="string"?a[0]=l.slice(i):a.shift()}o>0&&a.push(t[s].slice(0,o))}return a}function t1(t,n){let r=-1;const i=[];let s;for(;++r<t.length;){const o=t[r];let a;if(typeof o=="string")a=o;else switch(o){case-5:{a="\r";break}case-4:{a=`
`;break}case-3:{a=`\r
`;break}case-2:{a=n?" ":"	";break}case-1:{if(!n&&s)continue;a=" ";break}default:a=String.fromCharCode(o)}s=o===-2,i.push(a)}return i.join("")}function n1(t){const i={constructs:cy([Xb,...(t||{}).extensions||[]]),content:s(xy),defined:[],document:s(yy),flow:s(Fb),lazy:{},string:s(Wb),text:s(Bb)};return i;function s(o){return a;function a(l){return Zb(i,o,l)}}}function r1(t){for(;!Ad(t););return t}const Tl=/[\0\t\n\r]/g;function i1(){let t=1,n="",r=!0,i;return s;function s(o,a,l){const c=[];let u,h,g,m,p;for(o=n+(typeof o=="string"?o.toString():new TextDecoder(a||void 0).decode(o)),g=0,n="",r&&(o.charCodeAt(0)===65279&&g++,r=void 0);g<o.length;){if(Tl.lastIndex=g,u=Tl.exec(o),m=u&&u.index!==void 0?u.index:o.length,p=o.charCodeAt(m),!u){n=o.slice(g);break}if(p===10&&g===m&&i)c.push(-3),i=void 0;else switch(i&&(c.push(-5),i=void 0),g<m&&(c.push(o.slice(g,m)),t+=m-g),p){case 0:{c.push(65533),t++;break}case 9:{for(h=Math.ceil(t/4)*4,c.push(-2);t++<h;)c.push(-1);break}case 10:{c.push(-4),t=1;break}default:i=!0,t=1}g=m+1}return l&&(i&&c.push(-5),n&&c.push(n),c.push(null)),c}}const s1=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function o1(t){return t.replace(s1,a1)}function a1(t,n,r){if(n)return n;if(r.charCodeAt(0)===35){const s=r.charCodeAt(1),o=s===120||s===88;return kd(r.slice(o?2:1),o?16:10)}return na(r)||t}const Od={}.hasOwnProperty;function l1(t,n,r){return typeof n!="string"&&(r=n,n=void 0),c1(r)(r1(n1(r).document().write(i1()(t,n,!0))))}function c1(t){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(en),autolinkProtocol:k,autolinkEmail:k,atxHeading:o(ye),blockQuote:o(Qe),characterEscape:k,characterReference:k,codeFenced:o(Ye),codeFencedFenceInfo:a,codeFencedFenceMeta:a,codeIndented:o(Ye,a),codeText:o(z,a),codeTextData:k,data:k,codeFlowValue:k,definition:o(Q),definitionDestinationString:a,definitionLabelString:a,definitionTitleString:a,emphasis:o(Ne),hardBreakEscape:o(Cn),hardBreakTrailing:o(Cn),htmlFlow:o(hn,a),htmlFlowData:k,htmlText:o(hn,a),htmlTextData:k,image:o(At),label:a,link:o(en),listItem:o(tn),listItemValue:m,listOrdered:o(qt,g),listUnordered:o(qt),paragraph:o(Tt),reference:y,referenceString:a,resourceDestinationString:a,resourceTitleString:a,setextHeading:o(ye),strong:o(Un),thematicBreak:o(En)},exit:{atxHeading:c(),atxHeadingSequence:I,autolink:c(),autolinkEmail:dt,autolinkProtocol:he,blockQuote:c(),characterEscapeValue:E,characterReferenceMarkerHexadecimal:Ie,characterReferenceMarkerNumeric:Ie,characterReferenceValue:ce,characterReference:ne,codeFenced:c(v),codeFencedFence:b,codeFencedFenceInfo:p,codeFencedFenceMeta:j,codeFlowValue:E,codeIndented:c(_),codeText:c(q),codeTextData:E,data:E,definition:c(),definitionDestinationString:U,definitionLabelString:N,definitionTitleString:R,emphasis:c(),hardBreakEscape:c(B),hardBreakTrailing:c(B),htmlFlow:c(J),htmlFlowData:E,htmlText:c(ae),htmlTextData:E,image:c(fe),label:X,labelText:pe,lineEnding:O,link:c(oe),listItem:c(),listOrdered:c(),listUnordered:c(),paragraph:c(),referenceString:ee,resourceDestinationString:f,resourceTitleString:W,resource:te,setextHeading:c(M),setextHeadingLineSequence:P,setextHeadingText:w,strong:c(),thematicBreak:c()}};Fd(n,(t||{}).mdastExtensions||[]);const r={};return i;function i(K){let x={type:"root",children:[]};const T={stack:[x],tokenStack:[],config:n,enter:l,exit:u,buffer:a,resume:h,data:r},L=[];let G=-1;for(;++G<K.length;)if(K[G][1].type==="listOrdered"||K[G][1].type==="listUnordered")if(K[G][0]==="enter")L.push(G);else{const le=L.pop();G=s(K,le,G)}for(G=-1;++G<K.length;){const le=n[K[G][0]];Od.call(le,K[G][1].type)&&le[K[G][1].type].call(Object.assign({sliceSerialize:K[G][2].sliceSerialize},T),K[G][1])}if(T.tokenStack.length>0){const le=T.tokenStack[T.tokenStack.length-1];(le[1]||Pl).call(T,void 0,le[0])}for(x.position={start:zn(K.length>0?K[0][1].start:{line:1,column:1,offset:0}),end:zn(K.length>0?K[K.length-2][1].end:{line:1,column:1,offset:0})},G=-1;++G<n.transforms.length;)x=n.transforms[G](x)||x;return x}function s(K,x,T){let L=x-1,G=-1,le=!1,Ve,at,nn,D;for(;++L<=T;){const ge=K[L];switch(ge[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{ge[0]==="enter"?G++:G--,D=void 0;break}case"lineEndingBlank":{ge[0]==="enter"&&(Ve&&!D&&!G&&!nn&&(nn=L),D=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:D=void 0}if(!G&&ge[0]==="enter"&&ge[1].type==="listItemPrefix"||G===-1&&ge[0]==="exit"&&(ge[1].type==="listUnordered"||ge[1].type==="listOrdered")){if(Ve){let Xe=L;for(at=void 0;Xe--;){const Ge=K[Xe];if(Ge[1].type==="lineEnding"||Ge[1].type==="lineEndingBlank"){if(Ge[0]==="exit")continue;at&&(K[at][1].type="lineEndingBlank",le=!0),Ge[1].type="lineEnding",at=Xe}else if(!(Ge[1].type==="linePrefix"||Ge[1].type==="blockQuotePrefix"||Ge[1].type==="blockQuotePrefixWhitespace"||Ge[1].type==="blockQuoteMarker"||Ge[1].type==="listItemIndent"))break}nn&&(!at||nn<at)&&(Ve._spread=!0),Ve.end=Object.assign({},at?K[at][1].start:ge[1].end),K.splice(at||L,0,["exit",Ve,ge[2]]),L++,T++}if(ge[1].type==="listItemPrefix"){const Xe={type:"listItem",_spread:!1,start:Object.assign({},ge[1].start),end:void 0};Ve=Xe,K.splice(L,0,["enter",Xe,ge[2]]),L++,T++,nn=void 0,D=!0}}}return K[x][1]._spread=le,T}function o(K,x){return T;function T(L){l.call(this,K(L),L),x&&x.call(this,L)}}function a(){this.stack.push({type:"fragment",children:[]})}function l(K,x,T){this.stack[this.stack.length-1].children.push(K),this.stack.push(K),this.tokenStack.push([x,T||void 0]),K.position={start:zn(x.start),end:void 0}}function c(K){return x;function x(T){K&&K.call(this,T),u.call(this,T)}}function u(K,x){const T=this.stack.pop(),L=this.tokenStack.pop();if(L)L[0].type!==K.type&&(x?x.call(this,K,L[0]):(L[1]||Pl).call(this,K,L[0]));else throw new Error("Cannot close `"+K.type+"` ("+Dr({start:K.start,end:K.end})+"): it’s not open");T.position.end=zn(K.end)}function h(){return ay(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function m(K){if(this.data.expectingFirstListItemValue){const x=this.stack[this.stack.length-2];x.start=Number.parseInt(this.sliceSerialize(K),10),this.data.expectingFirstListItemValue=void 0}}function p(){const K=this.resume(),x=this.stack[this.stack.length-1];x.lang=K}function j(){const K=this.resume(),x=this.stack[this.stack.length-1];x.meta=K}function b(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function v(){const K=this.resume(),x=this.stack[this.stack.length-1];x.value=K.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function _(){const K=this.resume(),x=this.stack[this.stack.length-1];x.value=K.replace(/(\r?\n|\r)$/g,"")}function N(K){const x=this.resume(),T=this.stack[this.stack.length-1];T.label=x,T.identifier=xr(this.sliceSerialize(K)).toLowerCase()}function R(){const K=this.resume(),x=this.stack[this.stack.length-1];x.title=K}function U(){const K=this.resume(),x=this.stack[this.stack.length-1];x.url=K}function I(K){const x=this.stack[this.stack.length-1];if(!x.depth){const T=this.sliceSerialize(K).length;x.depth=T}}function w(){this.data.setextHeadingSlurpLineEnding=!0}function P(K){const x=this.stack[this.stack.length-1];x.depth=this.sliceSerialize(K).codePointAt(0)===61?1:2}function M(){this.data.setextHeadingSlurpLineEnding=void 0}function k(K){const T=this.stack[this.stack.length-1].children;let L=T[T.length-1];(!L||L.type!=="text")&&(L=kn(),L.position={start:zn(K.start),end:void 0},T.push(L)),this.stack.push(L)}function E(K){const x=this.stack.pop();x.value+=this.sliceSerialize(K),x.position.end=zn(K.end)}function O(K){const x=this.stack[this.stack.length-1];if(this.data.atHardBreak){const T=x.children[x.children.length-1];T.position.end=zn(K.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(x.type)&&(k.call(this,K),E.call(this,K))}function B(){this.data.atHardBreak=!0}function J(){const K=this.resume(),x=this.stack[this.stack.length-1];x.value=K}function ae(){const K=this.resume(),x=this.stack[this.stack.length-1];x.value=K}function q(){const K=this.resume(),x=this.stack[this.stack.length-1];x.value=K}function oe(){const K=this.stack[this.stack.length-1];if(this.data.inReference){const x=this.data.referenceType||"shortcut";K.type+="Reference",K.referenceType=x,delete K.url,delete K.title}else delete K.identifier,delete K.label;this.data.referenceType=void 0}function fe(){const K=this.stack[this.stack.length-1];if(this.data.inReference){const x=this.data.referenceType||"shortcut";K.type+="Reference",K.referenceType=x,delete K.url,delete K.title}else delete K.identifier,delete K.label;this.data.referenceType=void 0}function pe(K){const x=this.sliceSerialize(K),T=this.stack[this.stack.length-2];T.label=o1(x),T.identifier=xr(x).toLowerCase()}function X(){const K=this.stack[this.stack.length-1],x=this.resume(),T=this.stack[this.stack.length-1];if(this.data.inReference=!0,T.type==="link"){const L=K.children;T.children=L}else T.alt=x}function f(){const K=this.resume(),x=this.stack[this.stack.length-1];x.url=K}function W(){const K=this.resume(),x=this.stack[this.stack.length-1];x.title=K}function te(){this.data.inReference=void 0}function y(){this.data.referenceType="collapsed"}function ee(K){const x=this.resume(),T=this.stack[this.stack.length-1];T.label=x,T.identifier=xr(this.sliceSerialize(K)).toLowerCase(),this.data.referenceType="full"}function Ie(K){this.data.characterReferenceType=K.type}function ce(K){const x=this.sliceSerialize(K),T=this.data.characterReferenceType;let L;T?(L=kd(x,T==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):L=na(x);const G=this.stack[this.stack.length-1];G.value+=L}function ne(K){const x=this.stack.pop();x.position.end=zn(K.end)}function he(K){E.call(this,K);const x=this.stack[this.stack.length-1];x.url=this.sliceSerialize(K)}function dt(K){E.call(this,K);const x=this.stack[this.stack.length-1];x.url="mailto:"+this.sliceSerialize(K)}function Qe(){return{type:"blockquote",children:[]}}function Ye(){return{type:"code",lang:null,meta:null,value:""}}function z(){return{type:"inlineCode",value:""}}function Q(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Ne(){return{type:"emphasis",children:[]}}function ye(){return{type:"heading",depth:0,children:[]}}function Cn(){return{type:"break"}}function hn(){return{type:"html",value:""}}function At(){return{type:"image",title:null,url:"",alt:null}}function en(){return{type:"link",title:null,url:"",children:[]}}function qt(K){return{type:"list",ordered:K.type==="listOrdered",start:null,spread:K._spread,children:[]}}function tn(K){return{type:"listItem",spread:K._spread,checked:null,children:[]}}function Tt(){return{type:"paragraph",children:[]}}function Un(){return{type:"strong",children:[]}}function kn(){return{type:"text",value:""}}function En(){return{type:"thematicBreak"}}}function zn(t){return{line:t.line,column:t.column,offset:t.offset}}function Fd(t,n){let r=-1;for(;++r<n.length;){const i=n[r];Array.isArray(i)?Fd(t,i):u1(t,i)}}function u1(t,n){let r;for(r in n)if(Od.call(n,r))switch(r){case"canContainEols":{const i=n[r];i&&t[r].push(...i);break}case"transforms":{const i=n[r];i&&t[r].push(...i);break}case"enter":case"exit":{const i=n[r];i&&Object.assign(t[r],i);break}}}function Pl(t,n){throw t?new Error("Cannot close `"+t.type+"` ("+Dr({start:t.start,end:t.end})+"): a different token (`"+n.type+"`, "+Dr({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+Dr({start:n.start,end:n.end})+") is still open")}function d1(t){const n=this;n.parser=r;function r(i){return l1(i,{...n.data("settings"),...t,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}function h1(t,n){const r={type:"element",tagName:"blockquote",properties:{},children:t.wrap(t.all(n),!0)};return t.patch(n,r),t.applyData(n,r)}function g1(t,n){const r={type:"element",tagName:"br",properties:{},children:[]};return t.patch(n,r),[t.applyData(n,r),{type:"text",value:`
`}]}function p1(t,n){const r=n.value?n.value+`
`:"",i={};n.lang&&(i.className=["language-"+n.lang]);let s={type:"element",tagName:"code",properties:i,children:[{type:"text",value:r}]};return n.meta&&(s.data={meta:n.meta}),t.patch(n,s),s=t.applyData(n,s),s={type:"element",tagName:"pre",properties:{},children:[s]},t.patch(n,s),s}function f1(t,n){const r={type:"element",tagName:"del",properties:{},children:t.all(n)};return t.patch(n,r),t.applyData(n,r)}function m1(t,n){const r={type:"element",tagName:"em",properties:{},children:t.all(n)};return t.patch(n,r),t.applyData(n,r)}function x1(t,n){const r=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",i=String(n.identifier).toUpperCase(),s=Cr(i.toLowerCase()),o=t.footnoteOrder.indexOf(i);let a,l=t.footnoteCounts.get(i);l===void 0?(l=0,t.footnoteOrder.push(i),a=t.footnoteOrder.length):a=o+1,l+=1,t.footnoteCounts.set(i,l);const c={type:"element",tagName:"a",properties:{href:"#"+r+"fn-"+s,id:r+"fnref-"+s+(l>1?"-"+l:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(a)}]};t.patch(n,c);const u={type:"element",tagName:"sup",properties:{},children:[c]};return t.patch(n,u),t.applyData(n,u)}function j1(t,n){const r={type:"element",tagName:"h"+n.depth,properties:{},children:t.all(n)};return t.patch(n,r),t.applyData(n,r)}function y1(t,n){if(t.options.allowDangerousHtml){const r={type:"raw",value:n.value};return t.patch(n,r),t.applyData(n,r)}}function Dd(t,n){const r=n.referenceType;let i="]";if(r==="collapsed"?i+="[]":r==="full"&&(i+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+i}];const s=t.all(n),o=s[0];o&&o.type==="text"?o.value="["+o.value:s.unshift({type:"text",value:"["});const a=s[s.length-1];return a&&a.type==="text"?a.value+=i:s.push({type:"text",value:i}),s}function b1(t,n){const r=String(n.identifier).toUpperCase(),i=t.definitionById.get(r);if(!i)return Dd(t,n);const s={src:Cr(i.url||""),alt:n.alt};i.title!==null&&i.title!==void 0&&(s.title=i.title);const o={type:"element",tagName:"img",properties:s,children:[]};return t.patch(n,o),t.applyData(n,o)}function w1(t,n){const r={src:Cr(n.url)};n.alt!==null&&n.alt!==void 0&&(r.alt=n.alt),n.title!==null&&n.title!==void 0&&(r.title=n.title);const i={type:"element",tagName:"img",properties:r,children:[]};return t.patch(n,i),t.applyData(n,i)}function S1(t,n){const r={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};t.patch(n,r);const i={type:"element",tagName:"code",properties:{},children:[r]};return t.patch(n,i),t.applyData(n,i)}function v1(t,n){const r=String(n.identifier).toUpperCase(),i=t.definitionById.get(r);if(!i)return Dd(t,n);const s={href:Cr(i.url||"")};i.title!==null&&i.title!==void 0&&(s.title=i.title);const o={type:"element",tagName:"a",properties:s,children:t.all(n)};return t.patch(n,o),t.applyData(n,o)}function _1(t,n){const r={href:Cr(n.url)};n.title!==null&&n.title!==void 0&&(r.title=n.title);const i={type:"element",tagName:"a",properties:r,children:t.all(n)};return t.patch(n,i),t.applyData(n,i)}function C1(t,n,r){const i=t.all(n),s=r?k1(r):Nd(n),o={},a=[];if(typeof n.checked=="boolean"){const h=i[0];let g;h&&h.type==="element"&&h.tagName==="p"?g=h:(g={type:"element",tagName:"p",properties:{},children:[]},i.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let l=-1;for(;++l<i.length;){const h=i[l];(s||l!==0||h.type!=="element"||h.tagName!=="p")&&a.push({type:"text",value:`
`}),h.type==="element"&&h.tagName==="p"&&!s?a.push(...h.children):a.push(h)}const c=i[i.length-1];c&&(s||c.type!=="element"||c.tagName!=="p")&&a.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:o,children:a};return t.patch(n,u),t.applyData(n,u)}function k1(t){let n=!1;if(t.type==="list"){n=t.spread||!1;const r=t.children;let i=-1;for(;!n&&++i<r.length;)n=Nd(r[i])}return n}function Nd(t){const n=t.spread;return n??t.children.length>1}function E1(t,n){const r={},i=t.all(n);let s=-1;for(typeof n.start=="number"&&n.start!==1&&(r.start=n.start);++s<i.length;){const a=i[s];if(a.type==="element"&&a.tagName==="li"&&a.properties&&Array.isArray(a.properties.className)&&a.properties.className.includes("task-list-item")){r.className=["contains-task-list"];break}}const o={type:"element",tagName:n.ordered?"ol":"ul",properties:r,children:t.wrap(i,!0)};return t.patch(n,o),t.applyData(n,o)}function I1(t,n){const r={type:"element",tagName:"p",properties:{},children:t.all(n)};return t.patch(n,r),t.applyData(n,r)}function z1(t,n){const r={type:"root",children:t.wrap(t.all(n))};return t.patch(n,r),t.applyData(n,r)}function A1(t,n){const r={type:"element",tagName:"strong",properties:{},children:t.all(n)};return t.patch(n,r),t.applyData(n,r)}function T1(t,n){const r=t.all(n),i=r.shift(),s=[];if(i){const a={type:"element",tagName:"thead",properties:{},children:t.wrap([i],!0)};t.patch(n.children[0],a),s.push(a)}if(r.length>0){const a={type:"element",tagName:"tbody",properties:{},children:t.wrap(r,!0)},l=Xo(n.children[1]),c=yd(n.children[n.children.length-1]);l&&c&&(a.position={start:l,end:c}),s.push(a)}const o={type:"element",tagName:"table",properties:{},children:t.wrap(s,!0)};return t.patch(n,o),t.applyData(n,o)}function P1(t,n,r){const i=r?r.children:void 0,o=(i?i.indexOf(n):1)===0?"th":"td",a=r&&r.type==="table"?r.align:void 0,l=a?a.length:n.children.length;let c=-1;const u=[];for(;++c<l;){const g=n.children[c],m={},p=a?a[c]:void 0;p&&(m.align=p);let j={type:"element",tagName:o,properties:m,children:[]};g&&(j.children=t.all(g),t.patch(g,j),j=t.applyData(g,j)),u.push(j)}const h={type:"element",tagName:"tr",properties:{},children:t.wrap(u,!0)};return t.patch(n,h),t.applyData(n,h)}function L1(t,n){const r={type:"element",tagName:"td",properties:{},children:t.all(n)};return t.patch(n,r),t.applyData(n,r)}const Ll=9,Rl=32;function R1(t){const n=String(t),r=/\r?\n|\r/g;let i=r.exec(n),s=0;const o=[];for(;i;)o.push(Ml(n.slice(s,i.index),s>0,!0),i[0]),s=i.index+i[0].length,i=r.exec(n);return o.push(Ml(n.slice(s),s>0,!1)),o.join("")}function Ml(t,n,r){let i=0,s=t.length;if(n){let o=t.codePointAt(i);for(;o===Ll||o===Rl;)i++,o=t.codePointAt(i)}if(r){let o=t.codePointAt(s-1);for(;o===Ll||o===Rl;)s--,o=t.codePointAt(s-1)}return s>i?t.slice(i,s):""}function M1(t,n){const r={type:"text",value:R1(String(n.value))};return t.patch(n,r),t.applyData(n,r)}function O1(t,n){const r={type:"element",tagName:"hr",properties:{},children:[]};return t.patch(n,r),t.applyData(n,r)}const F1={blockquote:h1,break:g1,code:p1,delete:f1,emphasis:m1,footnoteReference:x1,heading:j1,html:y1,imageReference:b1,image:w1,inlineCode:S1,linkReference:v1,link:_1,listItem:C1,list:E1,paragraph:I1,root:z1,strong:A1,table:T1,tableCell:L1,tableRow:P1,text:M1,thematicBreak:O1,toml:gi,yaml:gi,definition:gi,footnoteDefinition:gi};function gi(){}const Wd=-1,ds=0,Wr=1,Yi=2,sa=3,oa=4,aa=5,la=6,Bd=7,Ud=8,Ol=typeof self=="object"?self:globalThis,D1=(t,n)=>{const r=(s,o)=>(t.set(o,s),s),i=s=>{if(t.has(s))return t.get(s);const[o,a]=n[s];switch(o){case ds:case Wd:return r(a,s);case Wr:{const l=r([],s);for(const c of a)l.push(i(c));return l}case Yi:{const l=r({},s);for(const[c,u]of a)l[i(c)]=i(u);return l}case sa:return r(new Date(a),s);case oa:{const{source:l,flags:c}=a;return r(new RegExp(l,c),s)}case aa:{const l=r(new Map,s);for(const[c,u]of a)l.set(i(c),i(u));return l}case la:{const l=r(new Set,s);for(const c of a)l.add(i(c));return l}case Bd:{const{name:l,message:c}=a;return r(new Ol[l](c),s)}case Ud:return r(BigInt(a),s);case"BigInt":return r(Object(BigInt(a)),s);case"ArrayBuffer":return r(new Uint8Array(a).buffer,a);case"DataView":{const{buffer:l}=new Uint8Array(a);return r(new DataView(l),a)}}return r(new Ol[o](a),s)};return i},Fl=t=>D1(new Map,t)(0),or="",{toString:N1}={},{keys:W1}=Object,zr=t=>{const n=typeof t;if(n!=="object"||!t)return[ds,n];const r=N1.call(t).slice(8,-1);switch(r){case"Array":return[Wr,or];case"Object":return[Yi,or];case"Date":return[sa,or];case"RegExp":return[oa,or];case"Map":return[aa,or];case"Set":return[la,or];case"DataView":return[Wr,r]}return r.includes("Array")?[Wr,r]:r.includes("Error")?[Bd,r]:[Yi,r]},pi=([t,n])=>t===ds&&(n==="function"||n==="symbol"),B1=(t,n,r,i)=>{const s=(a,l)=>{const c=i.push(a)-1;return r.set(l,c),c},o=a=>{if(r.has(a))return r.get(a);let[l,c]=zr(a);switch(l){case ds:{let h=a;switch(c){case"bigint":l=Ud,h=a.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+c);h=null;break;case"undefined":return s([Wd],a)}return s([l,h],a)}case Wr:{if(c){let m=a;return c==="DataView"?m=new Uint8Array(a.buffer):c==="ArrayBuffer"&&(m=new Uint8Array(a)),s([c,[...m]],a)}const h=[],g=s([l,h],a);for(const m of a)h.push(o(m));return g}case Yi:{if(c)switch(c){case"BigInt":return s([c,a.toString()],a);case"Boolean":case"Number":case"String":return s([c,a.valueOf()],a)}if(n&&"toJSON"in a)return o(a.toJSON());const h=[],g=s([l,h],a);for(const m of W1(a))(t||!pi(zr(a[m])))&&h.push([o(m),o(a[m])]);return g}case sa:return s([l,a.toISOString()],a);case oa:{const{source:h,flags:g}=a;return s([l,{source:h,flags:g}],a)}case aa:{const h=[],g=s([l,h],a);for(const[m,p]of a)(t||!(pi(zr(m))||pi(zr(p))))&&h.push([o(m),o(p)]);return g}case la:{const h=[],g=s([l,h],a);for(const m of a)(t||!pi(zr(m)))&&h.push(o(m));return g}}const{message:u}=a;return s([l,{name:c,message:u}],a)};return o},Dl=(t,{json:n,lossy:r}={})=>{const i=[];return B1(!(n||r),!!n,new Map,i)(t),i},Ki=typeof structuredClone=="function"?(t,n)=>n&&("json"in n||"lossy"in n)?Fl(Dl(t,n)):structuredClone(t):(t,n)=>Fl(Dl(t,n));function U1(t,n){const r=[{type:"text",value:"↩"}];return n>1&&r.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),r}function H1(t,n){return"Back to reference "+(t+1)+(n>1?"-"+n:"")}function $1(t){const n=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",r=t.options.footnoteBackContent||U1,i=t.options.footnoteBackLabel||H1,s=t.options.footnoteLabel||"Footnotes",o=t.options.footnoteLabelTagName||"h2",a=t.options.footnoteLabelProperties||{className:["sr-only"]},l=[];let c=-1;for(;++c<t.footnoteOrder.length;){const u=t.footnoteById.get(t.footnoteOrder[c]);if(!u)continue;const h=t.all(u),g=String(u.identifier).toUpperCase(),m=Cr(g.toLowerCase());let p=0;const j=[],b=t.footnoteCounts.get(g);for(;b!==void 0&&++p<=b;){j.length>0&&j.push({type:"text",value:" "});let N=typeof r=="string"?r:r(c,p);typeof N=="string"&&(N={type:"text",value:N}),j.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+m+(p>1?"-"+p:""),dataFootnoteBackref:"",ariaLabel:typeof i=="string"?i:i(c,p),className:["data-footnote-backref"]},children:Array.isArray(N)?N:[N]})}const v=h[h.length-1];if(v&&v.type==="element"&&v.tagName==="p"){const N=v.children[v.children.length-1];N&&N.type==="text"?N.value+=" ":v.children.push({type:"text",value:" "}),v.children.push(...j)}else h.push(...j);const _={type:"element",tagName:"li",properties:{id:n+"fn-"+m},children:t.wrap(h,!0)};t.patch(u,_),l.push(_)}if(l.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...Ki(a),id:"footnote-label"},children:[{type:"text",value:s}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:t.wrap(l,!0)},{type:"text",value:`
`}]}}const Hd=function(t){if(t==null)return Y1;if(typeof t=="function")return hs(t);if(typeof t=="object")return Array.isArray(t)?V1(t):q1(t);if(typeof t=="string")return G1(t);throw new Error("Expected function, string, or object as test")};function V1(t){const n=[];let r=-1;for(;++r<t.length;)n[r]=Hd(t[r]);return hs(i);function i(...s){let o=-1;for(;++o<n.length;)if(n[o].apply(this,s))return!0;return!1}}function q1(t){const n=t;return hs(r);function r(i){const s=i;let o;for(o in t)if(s[o]!==n[o])return!1;return!0}}function G1(t){return hs(n);function n(r){return r&&r.type===t}}function hs(t){return n;function n(r,i,s){return!!(K1(r)&&t.call(this,r,typeof i=="number"?i:void 0,s||void 0))}}function Y1(){return!0}function K1(t){return t!==null&&typeof t=="object"&&"type"in t}const $d=[],J1=!0,Nl=!1,Q1="skip";function X1(t,n,r,i){let s;typeof n=="function"&&typeof r!="function"?(i=r,r=n):s=n;const o=Hd(s),a=i?-1:1;l(t,void 0,[])();function l(c,u,h){const g=c&&typeof c=="object"?c:{};if(typeof g.type=="string"){const p=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(m,"name",{value:"node ("+(c.type+(p?"<"+p+">":""))+")"})}return m;function m(){let p=$d,j,b,v;if((!n||o(c,u,h[h.length-1]||void 0))&&(p=Z1(r(c,h)),p[0]===Nl))return p;if("children"in c&&c.children){const _=c;if(_.children&&p[0]!==Q1)for(b=(i?_.children.length:-1)+a,v=h.concat(_);b>-1&&b<_.children.length;){const N=_.children[b];if(j=l(N,b,v)(),j[0]===Nl)return j;b=typeof j[1]=="number"?j[1]:b+a}}return p}}}function Z1(t){return Array.isArray(t)?t:typeof t=="number"?[J1,t]:t==null?$d:[t]}function Vd(t,n,r,i){let s,o,a;typeof n=="function"&&typeof r!="function"?(o=void 0,a=n,s=r):(o=n,a=r,s=i),X1(t,o,l,s);function l(c,u){const h=u[u.length-1],g=h?h.children.indexOf(c):void 0;return a(c,g,h)}}const vo={}.hasOwnProperty,ew={};function tw(t,n){const r=n||ew,i=new Map,s=new Map,o=new Map,a={...F1,...r.handlers},l={all:u,applyData:rw,definitionById:i,footnoteById:s,footnoteCounts:o,footnoteOrder:[],handlers:a,one:c,options:r,patch:nw,wrap:sw};return Vd(t,function(h){if(h.type==="definition"||h.type==="footnoteDefinition"){const g=h.type==="definition"?i:s,m=String(h.identifier).toUpperCase();g.has(m)||g.set(m,h)}}),l;function c(h,g){const m=h.type,p=l.handlers[m];if(vo.call(l.handlers,m)&&p)return p(l,h,g);if(l.options.passThrough&&l.options.passThrough.includes(m)){if("children"in h){const{children:b,...v}=h,_=Ki(v);return _.children=l.all(h),_}return Ki(h)}return(l.options.unknownHandler||iw)(l,h,g)}function u(h){const g=[];if("children"in h){const m=h.children;let p=-1;for(;++p<m.length;){const j=l.one(m[p],h);if(j){if(p&&m[p-1].type==="break"&&(!Array.isArray(j)&&j.type==="text"&&(j.value=Wl(j.value)),!Array.isArray(j)&&j.type==="element")){const b=j.children[0];b&&b.type==="text"&&(b.value=Wl(b.value))}Array.isArray(j)?g.push(...j):g.push(j)}}}return g}}function nw(t,n){t.position&&(n.position=Nj(t))}function rw(t,n){let r=n;if(t&&t.data){const i=t.data.hName,s=t.data.hChildren,o=t.data.hProperties;if(typeof i=="string")if(r.type==="element")r.tagName=i;else{const a="children"in r?r.children:[r];r={type:"element",tagName:i,properties:{},children:a}}r.type==="element"&&o&&Object.assign(r.properties,Ki(o)),"children"in r&&r.children&&s!==null&&s!==void 0&&(r.children=s)}return r}function iw(t,n){const r=n.data||{},i="value"in n&&!(vo.call(r,"hProperties")||vo.call(r,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:t.all(n)};return t.patch(n,i),t.applyData(n,i)}function sw(t,n){const r=[];let i=-1;for(n&&r.push({type:"text",value:`
`});++i<t.length;)i&&r.push({type:"text",value:`
`}),r.push(t[i]);return n&&t.length>0&&r.push({type:"text",value:`
`}),r}function Wl(t){let n=0,r=t.charCodeAt(n);for(;r===9||r===32;)n++,r=t.charCodeAt(n);return t.slice(n)}function Bl(t,n){const r=tw(t,n),i=r.one(t,void 0),s=$1(r),o=Array.isArray(i)?{type:"root",children:i}:i||{type:"root",children:[]};return s&&o.children.push({type:"text",value:`
`},s),o}function ow(t,n){return t&&"run"in t?async function(r,i){const s=Bl(r,{file:i,...n});await t.run(s,i)}:function(r,i){return Bl(r,{file:i,...t||n})}}function Ul(t){if(t)throw t}var ki=Object.prototype.hasOwnProperty,qd=Object.prototype.toString,Hl=Object.defineProperty,$l=Object.getOwnPropertyDescriptor,Vl=function(n){return typeof Array.isArray=="function"?Array.isArray(n):qd.call(n)==="[object Array]"},ql=function(n){if(!n||qd.call(n)!=="[object Object]")return!1;var r=ki.call(n,"constructor"),i=n.constructor&&n.constructor.prototype&&ki.call(n.constructor.prototype,"isPrototypeOf");if(n.constructor&&!r&&!i)return!1;var s;for(s in n);return typeof s>"u"||ki.call(n,s)},Gl=function(n,r){Hl&&r.name==="__proto__"?Hl(n,r.name,{enumerable:!0,configurable:!0,value:r.newValue,writable:!0}):n[r.name]=r.newValue},Yl=function(n,r){if(r==="__proto__")if(ki.call(n,r)){if($l)return $l(n,r).value}else return;return n[r]},aw=function t(){var n,r,i,s,o,a,l=arguments[0],c=1,u=arguments.length,h=!1;for(typeof l=="boolean"&&(h=l,l=arguments[1]||{},c=2),(l==null||typeof l!="object"&&typeof l!="function")&&(l={});c<u;++c)if(n=arguments[c],n!=null)for(r in n)i=Yl(l,r),s=Yl(n,r),l!==s&&(h&&s&&(ql(s)||(o=Vl(s)))?(o?(o=!1,a=i&&Vl(i)?i:[]):a=i&&ql(i)?i:{},Gl(l,{name:r,newValue:t(h,a,s)})):typeof s<"u"&&Gl(l,{name:r,newValue:s}));return l};const As=_c(aw);function _o(t){if(typeof t!="object"||t===null)return!1;const n=Object.getPrototypeOf(t);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function lw(){const t=[],n={run:r,use:i};return n;function r(...s){let o=-1;const a=s.pop();if(typeof a!="function")throw new TypeError("Expected function as last argument, not "+a);l(null,...s);function l(c,...u){const h=t[++o];let g=-1;if(c){a(c);return}for(;++g<s.length;)(u[g]===null||u[g]===void 0)&&(u[g]=s[g]);s=u,h?cw(h,l)(...u):a(null,...u)}}function i(s){if(typeof s!="function")throw new TypeError("Expected `middelware` to be a function, not "+s);return t.push(s),n}}function cw(t,n){let r;return i;function i(...a){const l=t.length>a.length;let c;l&&a.push(s);try{c=t.apply(this,a)}catch(u){const h=u;if(l&&r)throw h;return s(h)}l||(c&&c.then&&typeof c.then=="function"?c.then(o,s):c instanceof Error?s(c):o(c))}function s(a,...l){r||(r=!0,n(a,...l))}function o(a){s(null,a)}}const sn={basename:uw,dirname:dw,extname:hw,join:gw,sep:"/"};function uw(t,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');ci(t);let r=0,i=-1,s=t.length,o;if(n===void 0||n.length===0||n.length>t.length){for(;s--;)if(t.codePointAt(s)===47){if(o){r=s+1;break}}else i<0&&(o=!0,i=s+1);return i<0?"":t.slice(r,i)}if(n===t)return"";let a=-1,l=n.length-1;for(;s--;)if(t.codePointAt(s)===47){if(o){r=s+1;break}}else a<0&&(o=!0,a=s+1),l>-1&&(t.codePointAt(s)===n.codePointAt(l--)?l<0&&(i=s):(l=-1,i=a));return r===i?i=a:i<0&&(i=t.length),t.slice(r,i)}function dw(t){if(ci(t),t.length===0)return".";let n=-1,r=t.length,i;for(;--r;)if(t.codePointAt(r)===47){if(i){n=r;break}}else i||(i=!0);return n<0?t.codePointAt(0)===47?"/":".":n===1&&t.codePointAt(0)===47?"//":t.slice(0,n)}function hw(t){ci(t);let n=t.length,r=-1,i=0,s=-1,o=0,a;for(;n--;){const l=t.codePointAt(n);if(l===47){if(a){i=n+1;break}continue}r<0&&(a=!0,r=n+1),l===46?s<0?s=n:o!==1&&(o=1):s>-1&&(o=-1)}return s<0||r<0||o===0||o===1&&s===r-1&&s===i+1?"":t.slice(s,r)}function gw(...t){let n=-1,r;for(;++n<t.length;)ci(t[n]),t[n]&&(r=r===void 0?t[n]:r+"/"+t[n]);return r===void 0?".":pw(r)}function pw(t){ci(t);const n=t.codePointAt(0)===47;let r=fw(t,!n);return r.length===0&&!n&&(r="."),r.length>0&&t.codePointAt(t.length-1)===47&&(r+="/"),n?"/"+r:r}function fw(t,n){let r="",i=0,s=-1,o=0,a=-1,l,c;for(;++a<=t.length;){if(a<t.length)l=t.codePointAt(a);else{if(l===47)break;l=47}if(l===47){if(!(s===a-1||o===1))if(s!==a-1&&o===2){if(r.length<2||i!==2||r.codePointAt(r.length-1)!==46||r.codePointAt(r.length-2)!==46){if(r.length>2){if(c=r.lastIndexOf("/"),c!==r.length-1){c<0?(r="",i=0):(r=r.slice(0,c),i=r.length-1-r.lastIndexOf("/")),s=a,o=0;continue}}else if(r.length>0){r="",i=0,s=a,o=0;continue}}n&&(r=r.length>0?r+"/..":"..",i=2)}else r.length>0?r+="/"+t.slice(s+1,a):r=t.slice(s+1,a),i=a-s-1;s=a,o=0}else l===46&&o>-1?o++:o=-1}return r}function ci(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}const mw={cwd:xw};function xw(){return"/"}function Co(t){return!!(t!==null&&typeof t=="object"&&"href"in t&&t.href&&"protocol"in t&&t.protocol&&t.auth===void 0)}function jw(t){if(typeof t=="string")t=new URL(t);else if(!Co(t)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+t+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(t.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return yw(t)}function yw(t){if(t.hostname!==""){const i=new TypeError('File URL host must be "localhost" or empty on darwin');throw i.code="ERR_INVALID_FILE_URL_HOST",i}const n=t.pathname;let r=-1;for(;++r<n.length;)if(n.codePointAt(r)===37&&n.codePointAt(r+1)===50){const i=n.codePointAt(r+2);if(i===70||i===102){const s=new TypeError("File URL path must not include encoded / characters");throw s.code="ERR_INVALID_FILE_URL_PATH",s}}return decodeURIComponent(n)}const Ts=["history","path","basename","stem","extname","dirname"];class Gd{constructor(n){let r;n?Co(n)?r={path:n}:typeof n=="string"||bw(n)?r={value:n}:r=n:r={},this.cwd="cwd"in r?"":mw.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let i=-1;for(;++i<Ts.length;){const o=Ts[i];o in r&&r[o]!==void 0&&r[o]!==null&&(this[o]=o==="history"?[...r[o]]:r[o])}let s;for(s in r)Ts.includes(s)||(this[s]=r[s])}get basename(){return typeof this.path=="string"?sn.basename(this.path):void 0}set basename(n){Ls(n,"basename"),Ps(n,"basename"),this.path=sn.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?sn.dirname(this.path):void 0}set dirname(n){Kl(this.basename,"dirname"),this.path=sn.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?sn.extname(this.path):void 0}set extname(n){if(Ps(n,"extname"),Kl(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=sn.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){Co(n)&&(n=jw(n)),Ls(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?sn.basename(this.path,this.extname):void 0}set stem(n){Ls(n,"stem"),Ps(n,"stem"),this.path=sn.join(this.dirname||"",n+(this.extname||""))}fail(n,r,i){const s=this.message(n,r,i);throw s.fatal=!0,s}info(n,r,i){const s=this.message(n,r,i);return s.fatal=void 0,s}message(n,r,i){const s=new zt(n,r,i);return this.path&&(s.name=this.path+":"+s.name,s.file=this.path),s.fatal=!1,this.messages.push(s),s}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}}function Ps(t,n){if(t&&t.includes(sn.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+sn.sep+"`")}function Ls(t,n){if(!t)throw new Error("`"+n+"` cannot be empty")}function Kl(t,n){if(!t)throw new Error("Setting `"+n+"` requires `path` to be set too")}function bw(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const ww=function(t){const i=this.constructor.prototype,s=i[t],o=function(){return s.apply(o,arguments)};return Object.setPrototypeOf(o,i),o},Sw={}.hasOwnProperty;class ca extends ww{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=lw()}copy(){const n=new ca;let r=-1;for(;++r<this.attachers.length;){const i=this.attachers[r];n.use(...i)}return n.data(As(!0,{},this.namespace)),n}data(n,r){return typeof n=="string"?arguments.length===2?(Os("data",this.frozen),this.namespace[n]=r,this):Sw.call(this.namespace,n)&&this.namespace[n]||void 0:n?(Os("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[r,...i]=this.attachers[this.freezeIndex];if(i[0]===!1)continue;i[0]===!0&&(i[0]=void 0);const s=r.call(n,...i);typeof s=="function"&&this.transformers.use(s)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const r=fi(n),i=this.parser||this.Parser;return Rs("parse",i),i(String(r),r)}process(n,r){const i=this;return this.freeze(),Rs("process",this.parser||this.Parser),Ms("process",this.compiler||this.Compiler),r?s(void 0,r):new Promise(s);function s(o,a){const l=fi(n),c=i.parse(l);i.run(c,l,function(h,g,m){if(h||!g||!m)return u(h);const p=g,j=i.stringify(p,m);Cw(j)?m.value=j:m.result=j,u(h,m)});function u(h,g){h||!g?a(h):o?o(g):r(void 0,g)}}}processSync(n){let r=!1,i;return this.freeze(),Rs("processSync",this.parser||this.Parser),Ms("processSync",this.compiler||this.Compiler),this.process(n,s),Ql("processSync","process",r),i;function s(o,a){r=!0,Ul(o),i=a}}run(n,r,i){Jl(n),this.freeze();const s=this.transformers;return!i&&typeof r=="function"&&(i=r,r=void 0),i?o(void 0,i):new Promise(o);function o(a,l){const c=fi(r);s.run(n,c,u);function u(h,g,m){const p=g||n;h?l(h):a?a(p):i(void 0,p,m)}}}runSync(n,r){let i=!1,s;return this.run(n,r,o),Ql("runSync","run",i),s;function o(a,l){Ul(a),s=l,i=!0}}stringify(n,r){this.freeze();const i=fi(r),s=this.compiler||this.Compiler;return Ms("stringify",s),Jl(n),s(n,i)}use(n,...r){const i=this.attachers,s=this.namespace;if(Os("use",this.frozen),n!=null)if(typeof n=="function")c(n,r);else if(typeof n=="object")Array.isArray(n)?l(n):a(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function o(u){if(typeof u=="function")c(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[h,...g]=u;c(h,g)}else a(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function a(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");l(u.plugins),u.settings&&(s.settings=As(!0,s.settings,u.settings))}function l(u){let h=-1;if(u!=null)if(Array.isArray(u))for(;++h<u.length;){const g=u[h];o(g)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function c(u,h){let g=-1,m=-1;for(;++g<i.length;)if(i[g][0]===u){m=g;break}if(m===-1)i.push([u,...h]);else if(h.length>0){let[p,...j]=h;const b=i[m][1];_o(b)&&_o(p)&&(p=As(!0,b,p)),i[m]=[u,p,...j]}}}}const vw=new ca().freeze();function Rs(t,n){if(typeof n!="function")throw new TypeError("Cannot `"+t+"` without `parser`")}function Ms(t,n){if(typeof n!="function")throw new TypeError("Cannot `"+t+"` without `compiler`")}function Os(t,n){if(n)throw new Error("Cannot call `"+t+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function Jl(t){if(!_o(t)||typeof t.type!="string")throw new TypeError("Expected node, got `"+t+"`")}function Ql(t,n,r){if(!r)throw new Error("`"+t+"` finished async. Use `"+n+"` instead")}function fi(t){return _w(t)?t:new Gd(t)}function _w(t){return!!(t&&typeof t=="object"&&"message"in t&&"messages"in t)}function Cw(t){return typeof t=="string"||kw(t)}function kw(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const Ew="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",Xl=[],Zl={allowDangerousHtml:!0},Iw=/^(https?|ircs?|mailto|xmpp)$/i,zw=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Aw(t){const n=Tw(t),r=Pw(t);return Lw(n.runSync(n.parse(r),r),t)}function Tw(t){const n=t.rehypePlugins||Xl,r=t.remarkPlugins||Xl,i=t.remarkRehypeOptions?{...t.remarkRehypeOptions,...Zl}:Zl;return vw().use(d1).use(r).use(ow,i).use(n)}function Pw(t){const n=t.children||"",r=new Gd;return typeof n=="string"&&(r.value=n),r}function Lw(t,n){const r=n.allowedElements,i=n.allowElement,s=n.components,o=n.disallowedElements,a=n.skipHtml,l=n.unwrapDisallowed,c=n.urlTransform||Rw;for(const h of zw)Object.hasOwn(n,h.from)&&(""+h.from+(h.to?"use `"+h.to+"` instead":"remove it")+Ew+h.id,void 0);return Vd(t,u),$j(t,{Fragment:e.Fragment,components:s,ignoreInvalidStyle:!0,jsx:e.jsx,jsxs:e.jsxs,passKeys:!0,passNode:!0});function u(h,g,m){if(h.type==="raw"&&m&&typeof g=="number")return a?m.children.splice(g,1):m.children[g]={type:"text",value:h.value},g;if(h.type==="element"){let p;for(p in Es)if(Object.hasOwn(Es,p)&&Object.hasOwn(h.properties,p)){const j=h.properties[p],b=Es[p];(b===null||b.includes(h.tagName))&&(h.properties[p]=c(String(j||""),p,h))}}if(h.type==="element"){let p=r?!r.includes(h.tagName):o?o.includes(h.tagName):!1;if(!p&&i&&typeof g=="number"&&(p=!i(h,g,m)),p&&m&&typeof g=="number")return l&&h.children?m.children.splice(g,1,...h.children):m.children.splice(g,1),g}}}function Rw(t){const n=t.indexOf(":"),r=t.indexOf("?"),i=t.indexOf("#"),s=t.indexOf("/");return n===-1||s!==-1&&n>s||r!==-1&&n>r||i!==-1&&n>i||Iw.test(t.slice(0,n))?t:""}const Mw=t=>{let n=t.replace(/AI_SEARCH_FOODS:\s*[^\n]*/gi,"").replace(/AI_LOG_FOOD:\s*[^\n]*/gi,"").replace(/AI_CREATE_MEAL_PLAN:\s*[^\n]*/gi,"").replace(/AI_INDEX_FOOD:\s*[^\n]*/gi,"").replace(/AI_SAVE_PREFERENCES:\s*[^\n]*/gi,"").replace(/AI_UPDATE_GOAL:\s*[^\n]*/gi,"").replace(/AI_SEARCH_USER_LOGS:\s*[^\n]*/gi,"");return n=n.replace(/❌ Couldn't search foods:[^\n]*/gi,"🔍 Searching your food database...").replace(/Expecting property name enclosed in double quotes[^\n]*/gi,"").replace(/line \d+ column \d+ \(char \d+\)/gi,""),(t.toLowerCase().includes("food index")||t.toLowerCase().includes("indexed foods"))&&(t.includes("**Your Personal Food Index:")?n="🍎 "+n.replace(/•\s+([^\n]+)/g,"* $1").replace(/\*\*([^:]+)\*\*/g,"**$1**"):(n=n.replace(/Let me search your food index\.?\s*/gi,`🍎 **Your Food Index:**

`).replace(/Based on the context provided,?\s*/gi,"").replace(/I can see that your food index is currently empty or not available/gi,"Your food index appears to be empty. You can add foods by logging meals or manually adding them.").replace(/Let me search your personal food index\./gi,`🔍 **Searching Food Index:**

`),n.toLowerCase().includes("don't have direct access")&&(n=`🔍 **Food Index Search:**

`+n.replace(/Note: I notice/gi,"").replace(/Would you like me to:/gi,"**I can help you with:**")),n.toLowerCase().includes("i see you're asking about your food index")&&(n=n.replace(/I see you're asking about your food index/gi,`🍎 **Food Index Query:**

`).replace(/indexed foods in your records/gi,"**indexed foods** in your records")),n.toLowerCase().includes("i'm not able to see any specifically indexed foods")&&(n=`🔍 **Food Index Results:**

`+n.replace(/I'm not able to see any specifically indexed foods/gi,"I'm not able to see any **specifically indexed foods**").replace(/What I do know about you is:/g,"**What I know about you:**")),n=n.replace(/(\d+)\.\s+([^\n]+)/g,"* **$2**"))),t.toLowerCase().includes("calorie")&&t.toLowerCase().includes("should")&&(n=n.replace(/Based on your profile/gi,`📊 **Calorie Recommendation:**

Based on your profile`)),(t.toLowerCase().includes("meal plan")||t.toLowerCase().includes("meal suggestion"))&&(n=n.replace(/I'd love to help you/gi,`🍽️ **Meal Planning:**

I'd love to help you`)),(t.toLowerCase().includes("restaurant")||t.toLowerCase().includes("menu"))&&(n=n.replace(/Based on the image/gi,`🍴 **Restaurant Analysis:**

Based on the image`).replace(/I can see/gi,"👀 I can see")),t.toLowerCase().includes("health")&&(t.toLowerCase().includes("insight")||t.toLowerCase().includes("progress"))&&(n=n.replace(/Based on your recent/gi,`📈 **Health Insights:**

Based on your recent`)),t.toLowerCase().includes("goal")&&(t.toLowerCase().includes("progress")||t.toLowerCase().includes("target"))&&(n=n.replace(/Your current/gi,`🎯 **Goal Progress:**

Your current`)),t.toLowerCase().includes("nutrition")&&(t.toLowerCase().includes("analysis")||t.toLowerCase().includes("breakdown"))&&(n=n.replace(/Here's your/gi,`📊 **Nutrition Analysis:**

Here's your`)),n=n.replace(/\n\s*\n\s*\n/g,`

`).replace(/^\s+|\s+$/g,"").replace(/\s+([.!?])/g,"$1"),(n.includes("•")||n.includes("-")||/\d+\.\s/.test(n))&&(n=n.replace(/(^|\n)(\d+)\.\s+/gm,"$1$2. ").replace(/(^|\n)[•]\s*/gm,"$1* ").replace(/(^|\n)[-]\s*/gm,"$1- ")),n=n.replace(/(^|\n)You('re| are| have| prefer| avoid)/gm,"$1* You$2"),n=n.replace(/([^\n])\n(\*|-|\d+\.)/g,`$1

$2`),(n.toLowerCase().includes("i see you're asking about")||n.toLowerCase().includes("i see that you're asking"))&&(n=n.replace(/I see (?:that )?you're asking about your food index/i,`🔍 **Food Index Query:**

`)),n.match(/^[🔍🍎📊🍽️💡⚠️✅❌🍴👀📈🎯]/)||(t.toLowerCase().includes("nutrition")||t.toLowerCase().includes("health")?n="💡 "+n:t.toLowerCase().includes("error")||t.toLowerCase().includes("sorry")?n="⚠️ "+n:t.toLowerCase().includes("would you like")&&(n="💬 "+n)),n.includes("What would you prefer?")&&(n=n.replace(/What would you prefer\?/g,"**What would you prefer?**")),(n.toLowerCase().includes("i'm not able to see")||n.toLowerCase().includes("i see you're asking about"))&&(n=`🔍 **Food Index Search:**

`+n.replace(/I see you're asking about your food index, but/gi,"").replace(/I'm not able to see any specifically indexed foods/gi,"I'm not able to see any **specifically indexed foods**")),n=n.replace(/You're vegetarian/g,"* You're **vegetarian**").replace(/You avoid nuts/g,"* You **avoid nuts**").replace(/You prefer Mediterranean/g,"* You **prefer Mediterranean**").replace(/What I do know about you is:/g,"**What I know about you:**"),n},Ji=({content:t,isMobile:n=!1,fontSize:r="md"})=>{const i=Mw(t);return e.jsx(F,{children:e.jsx(Aw,{components:{h1:({children:s})=>e.jsx(d,{fontSize:"lg",fontWeight:"bold",mb:2,children:s}),h2:({children:s})=>e.jsx(d,{fontSize:"md",fontWeight:"bold",mb:2,children:s}),h3:({children:s})=>e.jsx(d,{fontSize:"sm",fontWeight:"bold",mb:1,children:s}),p:({children:s})=>e.jsx(d,{fontSize:n?"sm":r,lineHeight:"1.6",mb:2,children:s}),strong:({children:s})=>e.jsx(d,{as:"span",fontWeight:"bold",children:s}),em:({children:s})=>e.jsx(d,{as:"span",fontStyle:"italic",children:s}),ul:({children:s})=>e.jsx(F,{as:"ul",pl:4,mb:2,children:s}),ol:({children:s})=>e.jsx(F,{as:"ol",pl:4,mb:2,children:s}),li:({children:s})=>e.jsx(d,{as:"li",fontSize:n?"sm":r,mb:1,children:s}),code:({children:s})=>e.jsx(vc,{fontSize:"xs",px:1,children:s}),blockquote:({children:s})=>e.jsx(F,{borderLeft:"3px solid",borderColor:"gray.300",pl:3,ml:2,mb:2,children:s})},children:i})})},Fs=zo(F),ec=({nutrition:t,loading:n,error:r,onOpenDetail:i,isMobile:s})=>{const o=_e("white","gray.800"),a=_e("gray.100","gray.700");if(n)return e.jsx(ut,{size:"md"});if(r||!t)return null;const l=c=>c>=80?"green":c>=60?"yellow":"red";return e.jsxs(se,{bg:o,borderRadius:"xl",boxShadow:"md",children:[e.jsx(vt,{children:e.jsxs(A,{justify:"space-between",children:[e.jsxs(A,{children:[e.jsx($e,{as:rd,color:"green.500"}),e.jsx(d,{fontWeight:"bold",color:"green.600",children:"Today's Nutrition"})]}),e.jsx(je,{colorScheme:"green",variant:"solid",children:"Live Tracking"})]})}),e.jsx(re,{children:e.jsxs(S,{spacing:4,children:[e.jsx(zi,{value:t.calories.percentage,size:s?"120px":"160px",thickness:"12px",color:l(t.calories.percentage)+".400",trackColor:a,children:e.jsx(Ai,{children:e.jsxs(S,{spacing:0,children:[e.jsx(d,{fontSize:s?"xl":"2xl",fontWeight:"bold",children:t.calories.current}),e.jsxs(d,{fontSize:"sm",color:"gray.500",children:["/ ",t.calories.target]}),e.jsx(d,{fontSize:"xs",color:"gray.400",children:"calories"})]})})}),e.jsx(xe,{columns:3,spacing:4,w:"full",children:["protein","carbs","fat"].map(c=>{const u=t[c];return e.jsxs(S,{spacing:2,children:[e.jsx(zi,{value:u.percentage,size:"60px",thickness:"8px",color:l(u.percentage)+".400",trackColor:a,children:e.jsxs(Ai,{fontSize:"sm",fontWeight:"bold",children:[u.percentage,"%"]})}),e.jsxs(S,{spacing:0,children:[e.jsx(d,{fontSize:"sm",fontWeight:"bold",textTransform:"capitalize",children:c}),e.jsxs(d,{fontSize:"xs",color:"gray.500",children:[u.current,"g"]})]})]},c)})}),e.jsx(H,{onClick:i,size:"sm",variant:"outline",w:"full",children:"View Details"})]})})]})},tc=({healthScore:t,enhancedHealthScore:n,basicLoading:r,enhancedLoading:i,basicError:s,enhancedError:o,onOpenDetail:a,isMobile:l})=>{const c=_e("white","gray.800"),u=_e("gray.100","gray.700"),h=n||t,g=r||i,m=s&&o;if(g)return e.jsx(ut,{size:"md"});if(m||!h)return null;const p=j=>j>=80?"green":j>=60?"yellow":"red";return e.jsxs(se,{bg:c,borderRadius:"xl",boxShadow:"md",children:[e.jsx(vt,{children:e.jsxs(A,{justify:"space-between",children:[e.jsxs(A,{children:[e.jsx($e,{as:td,color:"red.500"}),e.jsx(d,{fontWeight:"bold",color:"red.600",children:"Health Score"})]}),e.jsxs(je,{colorScheme:p(h.overall_score),variant:"solid",children:[h.trend==="improving"?"📈":"📉"," ",h.trend]})]})}),e.jsx(re,{children:e.jsxs(S,{spacing:4,children:[e.jsx(zi,{value:h.overall_score,size:l?"120px":"160px",thickness:"12px",color:p(h.overall_score)+".400",trackColor:u,children:e.jsx(Ai,{children:e.jsxs(S,{spacing:0,children:[e.jsx(d,{fontSize:l?"2xl":"3xl",fontWeight:"bold",color:p(h.overall_score)+".600",children:h.overall_score}),e.jsx(d,{fontSize:"xs",color:"gray.500",children:"/100"})]})})}),e.jsx(H,{onClick:a,size:"sm",variant:"outline",w:"full",children:"View Analysis"})]})})]})},nc=({coaching:t,loading:n,error:r,isMobile:i})=>{const s=_e("white","gray.800"),o=_e("purple.50","purple.900");return n?e.jsx(ut,{size:"md"}):r||!t?null:e.jsxs(se,{bg:s,borderRadius:"xl",boxShadow:"md",children:[e.jsx(vt,{children:e.jsxs(A,{justify:"space-between",children:[e.jsxs(A,{children:[e.jsx($e,{as:j0,color:"purple.500"}),e.jsx(d,{fontWeight:"bold",color:"purple.600",children:"AI Health Coach"})]}),e.jsxs(je,{colorScheme:"green",variant:"solid",children:[t.aiConfidence,"% Confidence"]})]})}),e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs(F,{p:4,borderRadius:"lg",bg:o,children:[e.jsx(d,{fontWeight:"bold",color:"purple.600",mb:2,children:"💡 Today's Insight"}),e.jsx(Ji,{content:t.personalizedInsight,isMobile:i,fontSize:"sm"})]}),t.urgentAction&&e.jsxs(kt,{status:"warning",borderRadius:"lg",size:"sm",children:[e.jsx(Et,{}),e.jsx(wn,{fontSize:"sm",children:t.urgentAction})]})]})})]})},rc=({onScanFood:t,onMealPlan:n,onHealthReport:r,onAskAI:i,isMobile:s})=>{const o=_e("white","gray.800"),a=[{label:"Scan Food",icon:"📱",colorScheme:"purple",onClick:t},{label:"Meal Plan",icon:"🍽️",colorScheme:"blue",onClick:n},{label:"Health Report",icon:"📊",colorScheme:"green",onClick:r},{label:"Ask AI",icon:"🤖",colorScheme:"orange",onClick:i}];return e.jsxs(se,{bg:o,borderRadius:"xl",boxShadow:"md",children:[e.jsx(vt,{children:e.jsxs(A,{children:[e.jsx($e,{as:T0,color:"orange.500"}),e.jsx(d,{fontWeight:"bold",color:"orange.600",children:"Quick Actions"})]})}),e.jsx(re,{children:e.jsx(xe,{columns:2,spacing:3,children:a.map((l,c)=>e.jsx(H,{colorScheme:l.colorScheme,variant:"outline",size:s?"sm":"md",onClick:l.onClick,h:"60px",flexDirection:"column",children:e.jsxs(S,{spacing:1,children:[e.jsx(d,{fontSize:"lg",children:l.icon}),e.jsx(d,{fontSize:"xs",fontWeight:"bold",children:l.label})]})},c))})})]})},ic=({onLogFood:t,onLogWater:n,onLogWeight:r,isMobile:i})=>{const s=_e("white","gray.800");return e.jsxs(se,{bg:s,borderRadius:"xl",boxShadow:"md",children:[e.jsx(vt,{children:e.jsxs(A,{children:[e.jsx($e,{as:w0,color:"blue.500"}),e.jsx(d,{fontWeight:"bold",color:"blue.600",children:"Quick Logging"})]})}),e.jsx(re,{children:e.jsxs(xe,{columns:3,spacing:2,children:[e.jsx(H,{size:i?"sm":"md",colorScheme:"green",leftIcon:e.jsx(d,{fontSize:"lg",children:"🍎"}),onClick:t,children:"Food"}),e.jsx(H,{size:i?"sm":"md",colorScheme:"blue",leftIcon:e.jsx(d,{fontSize:"lg",children:"💧"}),onClick:n,children:"Water"}),e.jsx(H,{size:i?"sm":"md",colorScheme:"purple",leftIcon:e.jsx(d,{fontSize:"lg",children:"⚖️"}),onClick:r,children:"Weight"})]})})]})};function sc(){const t=Xi(),n=Wt({base:!0,md:!1}),[r,i]=C.useState(!0),{isOpen:s,onOpen:o,onClose:a}=Fe(),{isOpen:l,onOpen:c,onClose:u}=Fe(),{isOpen:h,onOpen:g,onClose:m}=Fe(),{isOpen:p,onOpen:j,onClose:b}=Fe(),{isOpen:v,onOpen:_,onClose:N}=Fe(),{nutrition:R,loading:U,error:I}=O0(),{healthScore:w,loading:P,error:M}=F0(),{enhancedHealthScore:k,loading:E,error:O}=D0(),{coaching:B,loading:J,error:ae}=M0(),q=()=>t("/food-log"),oe=()=>t("/meal-plans"),fe=()=>t("/analytics"),pe=()=>t("/ai-chat");return C.useEffect(()=>{const X=setTimeout(()=>i(!1),800);return()=>clearTimeout(X)},[]),r?e.jsx(It,{maxW:"container.xl",py:8,children:e.jsxs(S,{spacing:8,align:"center",justify:"center",minH:"60vh",children:[e.jsx(Fs,{initial:{scale:0},animate:{scale:1},transition:{duration:.5},children:e.jsx(ut,{size:"xl",color:"purple.500",thickness:"4px"})}),e.jsx(Fs,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsx(S,{spacing:2,children:e.jsx(d,{fontSize:"lg",fontWeight:"bold",children:"🤖 Analyzing your health data..."})})})]})}):e.jsx(It,{maxW:n?"100%":"1400px",py:n?4:8,px:n?4:8,children:e.jsxs(S,{spacing:6,align:"stretch",children:[e.jsx(Fs,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},children:e.jsx(A,{justify:"space-between",align:"center",children:e.jsxs(S,{align:"start",spacing:1,children:[e.jsxs(A,{children:[e.jsx($e,{as:I0,color:"orange.500"}),e.jsx(d,{fontSize:n?"xl":"2xl",fontWeight:"bold",children:"Good morning! 👋"})]}),e.jsx(d,{fontSize:n?"sm":"md",color:"gray.600",children:"Here's your health overview for today"})]})})}),n?e.jsxs(Kr,{variant:"soft-rounded",colorScheme:"green",size:"sm",children:[e.jsxs(Jr,{bg:"white",p:2,borderRadius:"xl",boxShadow:"sm",children:[e.jsx(Pt,{fontSize:"xs",children:"Overview"}),e.jsx(Pt,{fontSize:"xs",children:"Actions"}),e.jsx(Pt,{fontSize:"xs",children:"Progress"})]}),e.jsxs(Qr,{children:[e.jsx(Lt,{px:0,children:e.jsxs(S,{spacing:4,children:[e.jsx(ic,{onLogFood:_,onLogWater:g,onLogWeight:j,isMobile:n}),e.jsx(ec,{nutrition:R,loading:U,error:I,onOpenDetail:o,isMobile:n}),e.jsx(tc,{healthScore:w,enhancedHealthScore:k,basicLoading:P,enhancedLoading:E,basicError:M,enhancedError:O,onOpenDetail:c,isMobile:n})]})}),e.jsx(Lt,{px:0,children:e.jsxs(S,{spacing:4,children:[e.jsx(rc,{onScanFood:q,onMealPlan:oe,onHealthReport:fe,onAskAI:pe,isMobile:n}),e.jsx(nc,{coaching:B,loading:J,error:ae,isMobile:n})]})}),e.jsx(Lt,{px:0,children:e.jsx(S,{spacing:4,children:e.jsx(d,{children:"Progress content coming soon..."})})})]})]}):e.jsxs(Ii,{templateColumns:"repeat(auto-fit, minmax(350px, 1fr))",gap:6,children:[e.jsx(ec,{nutrition:R,loading:U,error:I,onOpenDetail:o,isMobile:n}),e.jsx(tc,{healthScore:w,enhancedHealthScore:k,basicLoading:P,enhancedLoading:E,basicError:M,enhancedError:O,onOpenDetail:c,isMobile:n}),e.jsx(nc,{coaching:B,loading:J,error:ae,isMobile:n}),e.jsx(rc,{onScanFood:q,onMealPlan:oe,onHealthReport:fe,onAskAI:pe,isMobile:n}),e.jsx(ic,{onLogFood:_,onLogWater:g,onLogWeight:j,isMobile:n})]}),e.jsx(N0,{isOpen:s,onClose:a}),e.jsxs(Ue,{isOpen:l,onClose:u,size:"xl",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsx(Pe,{children:"Health Score Details"}),e.jsx(De,{}),e.jsx(Le,{pb:6,children:e.jsx(d,{children:"Detailed health analysis coming soon..."})})]})]}),e.jsx(W0,{isOpen:h,onClose:m,onSuccess:()=>window.location.reload()}),e.jsx(B0,{isOpen:p,onClose:b,onSuccess:()=>window.location.reload()}),e.jsx(Y0,{isOpen:v,onClose:N,onSuccess:()=>window.location.reload()})]})})}const Ow=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})}),Fw=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})});function Dw(){const{activeGoal:t}=ai(),[n,r]=C.useState(()=>{const O=xn(),B=mn(O),J=new Date(B+"T12:00:00"),ae=new Date(J);return ae.setDate(J.getDate()-J.getDay()),ae}),[i,s]=C.useState([]),[o,a]=C.useState(!1),[l,c]=C.useState(null),[u,h]=C.useState(null),{isOpen:g,onOpen:m,onClose:p}=Fe(),{isOpen:j,onOpen:b,onClose:v}=Fe(),_=O=>{const B=[];for(let J=0;J<7;J++){const ae=new Date(O);ae.setDate(O.getDate()+J),B.push(ae)}return B},N=async()=>{a(!0);try{const O=_(n),B=O[0].toISOString().split("T")[0],J=O[6].toISOString().split("T")[0],ae=await Z.get(`/food-logs/range?start_date=${B}&end_date=${J}`);s(ae.data)}catch(O){console.error("Error fetching weekly data:",O)}a(!1)};C.useEffect(()=>{N()},[n]);const R=O=>{const B=new Date(n);B.setDate(n.getDate()+(O==="next"?7:-7)),r(B)},U=()=>{const O=xn(),B=mn(O),J=new Date(B+"T12:00:00"),ae=new Date(J);ae.setDate(J.getDate()-J.getDay()),r(ae)},I=O=>{const B=O.toISOString().split("T")[0];return i.find(J=>J.date===B)},w=O=>O.charAt(0).toUpperCase()+O.slice(1),P=(O,B)=>{c({...O,date:B}),m()},M=O=>{h(O),b()},k=_(n),E=k.some(O=>{const B=xn(),J=mn(B),ae=new Date(J+"T12:00:00");return O.toDateString()===ae.toDateString()});return e.jsxs(S,{spacing:6,align:"stretch",children:[e.jsxs(A,{justify:"space-between",align:"center",children:[e.jsxs(A,{spacing:2,children:[e.jsx(et,{"aria-label":"Previous week",icon:e.jsx(Ow,{}),onClick:()=>R("prev"),variant:"outline",size:"sm"}),e.jsxs(d,{fontWeight:"medium",minW:"200px",textAlign:"center",children:[n.toLocaleDateString("en-US",{month:"short",day:"numeric"})," - ",k[6].toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]}),e.jsx(et,{"aria-label":"Next week",icon:e.jsx(Fw,{}),onClick:()=>R("next"),variant:"outline",size:"sm"})]}),!E&&e.jsx(A,{spacing:2,children:e.jsx(H,{size:"sm",onClick:U,colorScheme:"blue",children:"Current Week"})})]}),o?e.jsx(Ot,{py:20,children:e.jsxs(S,{spacing:4,children:[e.jsx(ut,{size:"xl",color:"green.500"}),e.jsx(d,{color:"gray.600",children:"Loading weekly data..."})]})}):e.jsx(xe,{columns:{base:1,md:7},spacing:4,children:k.map((O,B)=>{const J=I(O),ae=xn(),q=mn(ae),oe=new Date(q+"T12:00:00"),fe=O.toDateString()===oe.toDateString();return e.jsx(se,{variant:fe?"filled":"outline",bg:fe?"blue.50":"white",borderColor:fe?"blue.200":"gray.200",children:e.jsx(re,{p:4,children:e.jsxs(S,{spacing:3,align:"stretch",children:[e.jsxs(S,{spacing:1,children:[e.jsx(d,{fontSize:"sm",fontWeight:"bold",color:"gray.600",children:O.toLocaleDateString("en-US",{weekday:"short"})}),e.jsx(d,{fontSize:"lg",fontWeight:"bold",children:O.getDate()})]}),J?e.jsxs(e.Fragment,{children:[e.jsxs(F,{textAlign:"center",children:[e.jsx(d,{fontSize:"sm",color:"gray.600",children:"Calories"}),e.jsx(d,{fontSize:"lg",fontWeight:"bold",children:Math.round(J.total_nutrition.calories)}),t?.nutrition_targets?.calories&&e.jsxs(e.Fragment,{children:[e.jsxs(d,{fontSize:"xs",color:"gray.500",children:["/ ",t.nutrition_targets.calories]}),e.jsx(d,{fontSize:"xs",color:J.total_nutrition.calories>t.nutrition_targets.calories?"red.500":J.total_nutrition.calories>=t.nutrition_targets.calories*.9?"green.500":"orange.500",children:J.total_nutrition.calories>t.nutrition_targets.calories?"Over":J.total_nutrition.calories>=t.nutrition_targets.calories*.9?"On Track":"Under"})]})]}),e.jsxs(S,{spacing:1,children:[e.jsxs(A,{justify:"space-between",w:"full",fontSize:"xs",children:[e.jsxs(d,{children:["P: ",Math.round(J.total_nutrition.protein),"g"]}),t?.nutrition_targets?.protein&&e.jsx(d,{color:J.total_nutrition.protein>=t.nutrition_targets.protein*.9?"green.500":"orange.500",children:J.total_nutrition.protein>=t.nutrition_targets.protein*.9?"✓":"!"})]}),e.jsxs(A,{justify:"space-between",w:"full",fontSize:"xs",children:[e.jsxs(d,{children:["C: ",Math.round(J.total_nutrition.carbs),"g"]}),t?.nutrition_targets?.carbs&&e.jsx(d,{color:Math.abs(J.total_nutrition.carbs-t.nutrition_targets.carbs)<=t.nutrition_targets.carbs*.2?"green.500":"orange.500",children:Math.abs(J.total_nutrition.carbs-t.nutrition_targets.carbs)<=t.nutrition_targets.carbs*.2?"✓":"!"})]}),e.jsxs(A,{justify:"space-between",w:"full",fontSize:"xs",children:[e.jsxs(d,{children:["F: ",Math.round(J.total_nutrition.fat),"g"]}),t?.nutrition_targets?.fat&&e.jsx(d,{color:Math.abs(J.total_nutrition.fat-t.nutrition_targets.fat)<=t.nutrition_targets.fat*.2?"green.500":"orange.500",children:Math.abs(J.total_nutrition.fat-t.nutrition_targets.fat)<=t.nutrition_targets.fat*.2?"✓":"!"})]})]}),J.meals&&J.meals.length>0&&e.jsxs(S,{spacing:1,align:"stretch",children:[e.jsx(d,{fontSize:"xs",color:"gray.600",children:"Meals:"}),["breakfast","lunch","dinner","snack"].map(pe=>{const X=J.meals.filter(f=>f.meal_type===pe);return X.length===0?null:e.jsx(F,{children:e.jsxs(je,{size:"xs",colorScheme:"green",cursor:"pointer",onClick:()=>P(X[0],J.date),children:[w(pe)," (",X.length,")"]})},pe)}),e.jsx(H,{size:"xs",variant:"ghost",colorScheme:"blue",onClick:()=>M(J),mt:1,children:"View Day"})]})]}):e.jsx(F,{textAlign:"center",py:4,children:e.jsx(d,{fontSize:"xs",color:"gray.400",children:"No data"})})]})})},B)})}),e.jsxs(Ue,{isOpen:g,onClose:p,size:"md",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsx(Pe,{children:"Food Log Details"}),e.jsx(De,{}),e.jsx(Le,{pb:6,children:l&&e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs(F,{children:[e.jsx(d,{fontWeight:"bold",fontSize:"lg",children:l.food_name}),e.jsxs(d,{fontSize:"sm",color:"gray.600",children:[new Date(l.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})," • ",w(l.meal_type)]})]}),e.jsx(_t,{}),e.jsxs(F,{children:[e.jsx(d,{fontWeight:"medium",mb:2,children:"Serving Size"}),e.jsxs(d,{children:[l.amount," ",l.unit]})]}),e.jsxs(F,{children:[e.jsx(d,{fontWeight:"medium",mb:2,children:"Nutrition Information"}),e.jsxs(xe,{columns:2,spacing:3,children:[e.jsxs(d,{children:["Calories: ",Math.round(l.nutrition.calories)]}),e.jsxs(d,{children:["Protein: ",Math.round(l.nutrition.protein),"g"]}),e.jsxs(d,{children:["Carbs: ",Math.round(l.nutrition.carbs),"g"]}),e.jsxs(d,{children:["Fat: ",Math.round(l.nutrition.fat),"g"]}),l.nutrition.fiber&&e.jsxs(d,{children:["Fiber: ",Math.round(l.nutrition.fiber),"g"]}),l.nutrition.sugar&&e.jsxs(d,{children:["Sugar: ",Math.round(l.nutrition.sugar),"g"]}),l.nutrition.sodium&&e.jsxs(d,{children:["Sodium: ",Math.round(l.nutrition.sodium),"mg"]})]})]})]})})]})]}),e.jsxs(Ue,{isOpen:j,onClose:v,size:"xl",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsxs(Pe,{children:["Daily Food Log - ",u&&new Date(u.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]}),e.jsx(De,{}),e.jsx(Le,{pb:6,children:u&&e.jsxs(S,{spacing:6,align:"stretch",children:[e.jsx(se,{bg:"blue.50",borderColor:"blue.200",borderWidth:1,children:e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsx(me,{size:"sm",children:"Daily Summary"}),e.jsxs(xe,{columns:4,spacing:4,children:[e.jsxs(F,{textAlign:"center",children:[e.jsx(d,{fontSize:"sm",color:"gray.600",children:"Calories"}),e.jsx(d,{fontSize:"lg",fontWeight:"bold",children:Math.round(u.total_nutrition.calories)}),t?.nutrition_targets?.calories&&e.jsxs(d,{fontSize:"xs",color:"gray.500",children:["/ ",t.nutrition_targets.calories]})]}),e.jsxs(F,{textAlign:"center",children:[e.jsx(d,{fontSize:"sm",color:"gray.600",children:"Protein"}),e.jsxs(d,{fontSize:"lg",fontWeight:"bold",children:[Math.round(u.total_nutrition.protein),"g"]}),t?.nutrition_targets?.protein&&e.jsxs(d,{fontSize:"xs",color:"gray.500",children:["/ ",t.nutrition_targets.protein,"g"]})]}),e.jsxs(F,{textAlign:"center",children:[e.jsx(d,{fontSize:"sm",color:"gray.600",children:"Carbs"}),e.jsxs(d,{fontSize:"lg",fontWeight:"bold",children:[Math.round(u.total_nutrition.carbs),"g"]}),t?.nutrition_targets?.carbs&&e.jsxs(d,{fontSize:"xs",color:"gray.500",children:["/ ",t.nutrition_targets.carbs,"g"]})]}),e.jsxs(F,{textAlign:"center",children:[e.jsx(d,{fontSize:"sm",color:"gray.600",children:"Fat"}),e.jsxs(d,{fontSize:"lg",fontWeight:"bold",children:[Math.round(u.total_nutrition.fat),"g"]}),t?.nutrition_targets?.fat&&e.jsxs(d,{fontSize:"xs",color:"gray.500",children:["/ ",t.nutrition_targets.fat,"g"]})]})]})]})})}),["breakfast","lunch","dinner","snack"].map(O=>{const B=u.meals.filter(ae=>ae.meal_type===O);if(B.length===0)return null;const J=B.reduce((ae,q)=>({calories:ae.calories+q.nutrition.calories,protein:ae.protein+q.nutrition.protein,carbs:ae.carbs+q.nutrition.carbs,fat:ae.fat+q.nutrition.fat}),{calories:0,protein:0,carbs:0,fat:0});return e.jsx(se,{variant:"outline",children:e.jsx(re,{children:e.jsxs(S,{spacing:3,align:"stretch",children:[e.jsxs(A,{justify:"space-between",children:[e.jsx(me,{size:"sm",children:w(O)}),e.jsxs(je,{colorScheme:"blue",fontSize:"sm",children:[Math.round(J.calories)," calories"]})]}),e.jsx(S,{spacing:2,align:"stretch",children:B.map(ae=>e.jsxs(A,{justify:"space-between",p:3,bg:"gray.50",borderRadius:"md",children:[e.jsxs(F,{flex:"1",children:[e.jsx(d,{fontWeight:"medium",children:ae.food_name}),e.jsxs(d,{fontSize:"sm",color:"gray.600",children:[ae.amount," ",ae.unit]})]}),e.jsxs(S,{spacing:0,align:"end",children:[e.jsxs(d,{fontWeight:"bold",children:[Math.round(ae.nutrition.calories)," cal"]}),e.jsxs(d,{fontSize:"xs",color:"gray.500",children:["P:",Math.round(ae.nutrition.protein)," C:",Math.round(ae.nutrition.carbs)," F:",Math.round(ae.nutrition.fat)]})]})]},ae.id))}),e.jsx(_t,{}),e.jsxs(A,{justify:"space-between",fontSize:"sm",color:"gray.600",children:[e.jsx(d,{children:"Meal Total:"}),e.jsxs(d,{children:[Math.round(J.calories)," cal, P:",Math.round(J.protein),"g, C:",Math.round(J.carbs),"g, F:",Math.round(J.fat),"g"]})]})]})})},O)})]})})]})]})]})}const Nw=({value:t,onChange:n,min:r=0,max:i=1/0,step:s=1,precision:o=2,placeholder:a="",size:l="md",allowDecimal:c=!0,showSteppers:u=!1,isDisabled:h=!1})=>{const[g,m]=C.useState(""),p=_e("gray.300","gray.600");C.useEffect(()=>{t!=null&&m(String(t))},[t]);const j=N=>{const R=N.target.value;if(R===""){m(""),n(0);return}if((c?/^-?\d*\.?\d*$/:/^-?\d*$/).test(R)){m(R);const I=parseFloat(R);if(!isNaN(I)){const w=Math.max(r,Math.min(i,I));if(R.endsWith("."))n(w);else{const P=c?Math.round(w*Math.pow(10,o))/Math.pow(10,o):Math.round(w);n(P)}}}},b=()=>{if(g===""||isNaN(parseFloat(g))){const N=Math.max(r,0);m(String(N)),n(N)}else{const N=parseFloat(g),R=Math.max(r,Math.min(i,N)),U=c?Math.round(R*Math.pow(10,o))/Math.pow(10,o):Math.round(R);m(String(U)),n(U)}},v=()=>{const N=parseFloat(g)||0,R=Math.min(i,N+s),U=c?Math.round(R*Math.pow(10,o))/Math.pow(10,o):Math.round(R);m(String(U)),n(U)},_=()=>{const N=parseFloat(g)||0,R=Math.max(r,N-s),U=c?Math.round(R*Math.pow(10,o))/Math.pow(10,o):Math.round(R);m(String(U)),n(U)};return u?e.jsxs(A,{children:[e.jsx(H,{size:"sm",onClick:_,isDisabled:h||parseFloat(g)<=r,variant:"outline",children:e.jsx(Kx,{})}),e.jsx(ve,{value:g,onChange:j,onBlur:b,placeholder:a,size:l,textAlign:"center",isDisabled:h,inputMode:"decimal",borderColor:p}),e.jsx(H,{size:"sm",onClick:v,isDisabled:h||parseFloat(g)>=i,variant:"outline",children:e.jsx(Bi,{})})]}):e.jsx(ve,{value:g,onChange:j,onBlur:b,placeholder:a,size:l,isDisabled:h,inputMode:"decimal",borderColor:p})},Ww=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M23.384,21.619,16.855,15.09a9.284,9.284,0,1,0-1.768,1.768l6.529,6.529a1.266,1.266,0,0,0,1.768,0A1.251,1.251,0,0,0,23.384,21.619ZM2.75,9.5a6.75,6.75,0,1,1,6.75,6.75A6.758,6.758,0,0,1,2.75,9.5Z"})}),Bw=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})}),Uw=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})});function Hw(){const{activeGoal:t,dailySummary:n,refreshDailySummary:r,loading:i}=ai(),s=(f=new Date)=>{const W=f.getFullYear(),te=String(f.getMonth()+1).padStart(2,"0"),y=String(f.getDate()).padStart(2,"0");return`${W}-${te}-${y}`},o=f=>{const[W,te,y]=f.split("-").map(Number);return new Date(W,te-1,y)},[a,l]=C.useState(()=>s()),[c,u]=C.useState(""),[h,g]=C.useState([]),[m,p]=C.useState(null),[j,b]=C.useState(!1),[v,_]=C.useState(!1),[N,R]=C.useState([]),{isOpen:U,onOpen:I,onClose:w}=Fe(),P=wt(),[M,k]=C.useState({meal_type:"breakfast",amount:1,unit:"serving"});C.useEffect(()=>{r(a)},[a]),C.useEffect(()=>{if(c.trim().length>=2){const f=setTimeout(()=>{B()},300);return()=>clearTimeout(f)}else g([])},[c]);const E=f=>{const W=new Date(a+"T12:00:00");W.setDate(W.getDate()+(f==="next"?1:-1)),l(s(W))},O=()=>{l(s(new Date))},B=async()=>{if(c.trim()){b(!0);try{const f=await Z.get(`/foods/search?q=${encodeURIComponent(c)}&limit=20`);g(f.data)}catch(f){console.error("Error searching foods:",f),P({title:"Search Error",description:"Failed to search foods. Please try again.",status:"error",duration:3e3,isClosable:!0})}b(!1)}},J=async()=>{try{const f=await Z.get("/foods/search?q=chicken&limit=10");R(f.data)}catch(f){console.error("Error loading popular foods:",f)}};C.useEffect(()=>{U&&N.length===0&&J()},[U]);const ae=f=>{f.preventDefault(),B()},q=f=>{p(f),k({meal_type:"breakfast",amount:1,unit:f.serving_unit}),I()},oe=async()=>{if(m){_(!0);try{const f={date:a,meal_type:M.meal_type,food_id:m.id,food_name:m.name,amount:M.amount,unit:M.unit,nutrition:{calories:m.nutrition.calories*M.amount,protein:m.nutrition.protein*M.amount,carbs:m.nutrition.carbs*M.amount,fat:m.nutrition.fat*M.amount,fiber:(m.nutrition.fiber||0)*M.amount,sugar:(m.nutrition.sugar||0)*M.amount,sodium:(m.nutrition.sodium||0)*M.amount},notes:""};await Z.post("/food-logs/",f),P({title:"Food Logged",description:`${m.name} has been added to your ${M.meal_type}!`,status:"success",duration:3e3,isClosable:!0}),w(),r(a),u(""),g([]),p(null)}catch(f){console.error("Error logging food:",f),P({title:"Log Error",description:"Failed to log food. Please try again.",status:"error",duration:3e3,isClosable:!0})}_(!1)}},fe=async f=>{try{await Z.delete(`/food-logs/${f}`),P({title:"Food Deleted",description:"Food entry has been removed.",status:"success",duration:3e3,isClosable:!0}),r(a)}catch(W){console.error("Error deleting food:",W),P({title:"Delete Error",description:"Failed to delete food entry.",status:"error",duration:3e3,isClosable:!0})}},pe=(f,W)=>{const te=f/W*100;return te<70?"red":te<90?"yellow":"green"},X=f=>f.charAt(0).toUpperCase()+f.slice(1);return e.jsxs(It,{maxW:"container.xl",py:8,children:[e.jsxs(S,{spacing:8,align:"stretch",children:[e.jsxs(A,{justify:"space-between",children:[e.jsxs(F,{children:[e.jsx(me,{size:"lg",mb:2,children:"Food Log 📱"}),e.jsx(d,{color:"gray.600",children:"Track your daily nutrition like MyFitnessPal, but with AI"})]}),e.jsx(H,{colorScheme:"green",onClick:I,children:"Add Food"})]}),e.jsxs(Kr,{colorScheme:"green",children:[e.jsxs(Jr,{children:[e.jsx(Pt,{children:"Daily View"}),e.jsx(Pt,{children:"Weekly View"})]}),e.jsxs(Qr,{children:[e.jsx(Lt,{px:0,children:i?e.jsx(Ot,{py:20,children:e.jsxs(S,{spacing:4,children:[e.jsx(ut,{size:"xl",color:"green.500"}),e.jsx(d,{color:"gray.600",children:"Loading your food log..."})]})}):e.jsxs(S,{spacing:8,align:"stretch",children:[e.jsxs(A,{justify:"space-between",children:[e.jsxs(A,{spacing:2,children:[e.jsx(et,{"aria-label":"Previous day",icon:e.jsx(Bw,{}),onClick:()=>E("prev"),variant:"outline",size:"sm"}),e.jsx(d,{fontWeight:"medium",minW:"200px",textAlign:"center",children:o(a).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx(et,{"aria-label":"Next day",icon:e.jsx(Uw,{}),onClick:()=>E("next"),variant:"outline",size:"sm"})]}),e.jsxs(A,{spacing:2,children:[a!==s()&&e.jsx(H,{size:"sm",onClick:O,colorScheme:"blue",children:"Today"}),e.jsx(ve,{type:"date",value:a,onChange:f=>l(f.target.value),size:"sm",w:"auto"})]})]}),n&&n.total_nutrition&&t&&t.nutrition_targets&&e.jsx(se,{bg:"blue.50",borderColor:"blue.200",borderWidth:2,children:e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs(A,{justify:"space-between",children:[e.jsxs(F,{children:[e.jsx(me,{size:"md",children:"Daily Summary"}),e.jsx(d,{color:"gray.600",fontSize:"sm",children:o(a).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsx(A,{spacing:6,children:e.jsx(zi,{value:t.nutrition_targets.calories>0&&n.total_nutrition?n.total_nutrition.calories/t.nutrition_targets.calories*100:0,size:"80px",color:t.nutrition_targets.calories>0&&n.total_nutrition?pe(n.total_nutrition.calories,t.nutrition_targets.calories):"gray",children:e.jsxs(Ai,{fontSize:"sm",children:[t.nutrition_targets.calories>0&&n.total_nutrition?Math.round(n.total_nutrition.calories/t.nutrition_targets.calories*100):0,"%"]})})})]}),e.jsxs(xe,{columns:{base:2,md:4},spacing:4,children:[e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Calories"}),e.jsx(Se,{children:n.total_nutrition?Math.round(n.total_nutrition.calories):0}),e.jsxs(ot,{children:[t?.nutrition_targets?.calories&&n.total_nutrition?Math.round(t.nutrition_targets.calories-n.total_nutrition.calories):0," remaining"]}),e.jsx(xt,{value:t?.nutrition_targets?.calories&&n.total_nutrition?n.total_nutrition.calories/t.nutrition_targets.calories*100:0,colorScheme:t?.nutrition_targets?.calories&&n.total_nutrition?pe(n.total_nutrition.calories,t.nutrition_targets.calories):"gray",size:"sm"})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Protein"}),e.jsxs(Se,{children:[n.total_nutrition?Math.round(n.total_nutrition.protein):0,"g"]}),e.jsxs(ot,{children:[t?.nutrition_targets?.protein&&n.total_nutrition?Math.round(t.nutrition_targets.protein-n.total_nutrition.protein):0," remaining"]}),e.jsx(xt,{value:t?.nutrition_targets?.protein&&n.total_nutrition?n.total_nutrition.protein/t.nutrition_targets.protein*100:0,colorScheme:t?.nutrition_targets?.protein&&n.total_nutrition?pe(n.total_nutrition.protein,t.nutrition_targets.protein):"gray",size:"sm"})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Carbs"}),e.jsxs(Se,{children:[n.total_nutrition?Math.round(n.total_nutrition.carbs):0,"g"]}),e.jsxs(ot,{children:[t?.nutrition_targets?.carbs&&n.total_nutrition?Math.round(t.nutrition_targets.carbs-n.total_nutrition.carbs):0," remaining"]}),e.jsx(xt,{value:t?.nutrition_targets?.carbs&&n.total_nutrition?n.total_nutrition.carbs/t.nutrition_targets.carbs*100:0,colorScheme:t?.nutrition_targets?.carbs&&n.total_nutrition?pe(n.total_nutrition.carbs,t.nutrition_targets.carbs):"gray",size:"sm"})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Fat"}),e.jsxs(Se,{children:[n.total_nutrition?Math.round(n.total_nutrition.fat):0,"g"]}),e.jsxs(ot,{children:[t?.nutrition_targets?.fat&&n.total_nutrition?Math.round(t.nutrition_targets.fat-n.total_nutrition.fat):0," remaining"]}),e.jsx(xt,{value:t?.nutrition_targets?.fat&&n.total_nutrition?n.total_nutrition.fat/t.nutrition_targets.fat*100:0,colorScheme:t?.nutrition_targets?.fat&&n.total_nutrition?pe(n.total_nutrition.fat,t.nutrition_targets.fat):"gray",size:"sm"})]})]})]})})}),!t&&e.jsxs(kt,{status:"warning",children:[e.jsx(Et,{}),e.jsxs(F,{children:[e.jsx(Xn,{children:"No Active Goal"}),e.jsx(wn,{children:"Set a nutrition goal to see your daily targets and progress."})]})]}),n&&n.meals&&n.meals.length>0?e.jsx(S,{spacing:4,align:"stretch",children:["breakfast","lunch","dinner","snack"].map(f=>{const W=n.meals.filter(y=>y.meal_type===f);if(W.length===0)return null;const te=W.reduce((y,ee)=>({calories:y.calories+ee.nutrition.calories,protein:y.protein+ee.nutrition.protein,carbs:y.carbs+ee.nutrition.carbs,fat:y.fat+ee.nutrition.fat}),{calories:0,protein:0,carbs:0,fat:0});return e.jsx(se,{variant:"outline",children:e.jsx(re,{children:e.jsxs(S,{spacing:3,align:"stretch",children:[e.jsxs(A,{justify:"space-between",children:[e.jsx(me,{size:"md",children:X(f)}),e.jsxs(je,{colorScheme:"blue",fontSize:"sm",children:[Math.round(te.calories)," calories"]})]}),e.jsx(S,{spacing:2,align:"stretch",children:W.map(y=>e.jsxs(A,{justify:"space-between",p:3,bg:"gray.50",borderRadius:"md",children:[e.jsxs(F,{flex:"1",children:[e.jsx(d,{fontWeight:"medium",children:y.food_name}),e.jsxs(d,{fontSize:"sm",color:"gray.600",children:[y.amount," ",y.unit]})]}),e.jsxs(S,{spacing:0,align:"end",children:[e.jsxs(d,{fontWeight:"bold",children:[Math.round(y.nutrition.calories)," cal"]}),e.jsxs(d,{fontSize:"xs",color:"gray.500",children:["P:",Math.round(y.nutrition.protein)," C:",Math.round(y.nutrition.carbs)," F:",Math.round(y.nutrition.fat)]})]}),e.jsx(H,{size:"sm",variant:"ghost",colorScheme:"red",onClick:()=>fe(y.id),children:"✕"})]},y.id))}),e.jsx(_t,{}),e.jsxs(A,{justify:"space-between",fontSize:"sm",color:"gray.600",children:[e.jsx(d,{children:"Meal Total:"}),e.jsxs(d,{children:[Math.round(te.calories)," cal, P:",Math.round(te.protein),"g, C:",Math.round(te.carbs),"g, F:",Math.round(te.fat),"g"]})]})]})})},f)})}):e.jsx(se,{children:e.jsxs(re,{textAlign:"center",py:12,children:[e.jsxs(d,{fontSize:"lg",color:"gray.500",children:["No foods logged for ",o(a).toLocaleDateString()]}),e.jsx(d,{fontSize:"sm",color:"gray.400",mt:2,children:"Start tracking your nutrition by adding foods to your meals"})]})})]})}),e.jsx(Lt,{px:0,children:e.jsx(Dw,{})})]})]})]}),e.jsxs(Ue,{isOpen:U,onClose:w,size:"xl",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsx(Pe,{children:"Add Food to Log"}),e.jsx(De,{}),e.jsx(Le,{pb:6,children:e.jsxs(S,{spacing:4,children:[e.jsxs($,{children:[e.jsx(V,{children:"Search for Food"}),e.jsx("form",{onSubmit:ae,children:e.jsxs(Ys,{children:[e.jsx(Ks,{children:e.jsx(Ww,{})}),e.jsx(ve,{value:c,onChange:f=>u(f.target.value),placeholder:"Search foods (e.g., chicken breast, apple)..."})]})})]}),j&&e.jsx(Ot,{py:8,children:e.jsx(ut,{size:"lg",color:"green.500"})}),!j&&(h.length>0||!c.trim()&&N.length>0)&&e.jsxs(S,{spacing:2,align:"stretch",maxH:"300px",overflowY:"auto",w:"full",children:[e.jsx(d,{fontSize:"sm",color:"gray.600",mb:2,children:c.trim()?`Search Results (${h.length})`:"Popular Foods"}),(c.trim()?h:N).map(f=>e.jsx(se,{variant:"outline",cursor:"pointer",_hover:{shadow:"md"},onClick:()=>q(f),children:e.jsx(re,{p:3,children:e.jsxs(A,{justify:"space-between",children:[e.jsxs(F,{children:[e.jsx(d,{fontWeight:"medium",children:f.name}),e.jsxs(d,{fontSize:"sm",color:"gray.600",children:[f.serving_size," ",f.serving_unit," • ",Math.round(f.nutrition.calories)," calories"]})]}),e.jsx(H,{size:"sm",colorScheme:"green",children:"Select"})]})})},f.id))]}),m&&e.jsxs(e.Fragment,{children:[e.jsx(_t,{}),e.jsx(se,{bg:"green.50",borderColor:"green.200",w:"full",children:e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs(F,{children:[e.jsx(d,{fontWeight:"bold",fontSize:"lg",children:m.name}),e.jsxs(d,{fontSize:"sm",color:"gray.600",children:["Per ",m.serving_size," ",m.serving_unit,": ",Math.round(m.nutrition.calories)," calories"]})]}),e.jsxs(xe,{columns:2,spacing:4,children:[e.jsxs($,{children:[e.jsx(V,{children:"Meal"}),e.jsxs(Be,{value:M.meal_type,onChange:f=>k({...M,meal_type:f.target.value}),children:[e.jsx("option",{value:"breakfast",children:"Breakfast"}),e.jsx("option",{value:"lunch",children:"Lunch"}),e.jsx("option",{value:"dinner",children:"Dinner"}),e.jsx("option",{value:"snack",children:"Snack"})]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Amount"}),e.jsx(Nw,{value:M.amount,onChange:f=>k({...M,amount:f}),min:.1,step:.1,allowDecimal:!0,precision:2})]})]}),e.jsxs(F,{children:[e.jsxs(d,{fontSize:"sm",fontWeight:"medium",mb:2,children:["Nutrition (for ",M.amount," ",M.unit,"):"]}),e.jsxs(xe,{columns:4,spacing:2,fontSize:"sm",children:[e.jsxs(d,{children:["Calories: ",Math.round(m.nutrition.calories*M.amount)]}),e.jsxs(d,{children:["Protein: ",Math.round(m.nutrition.protein*M.amount),"g"]}),e.jsxs(d,{children:["Carbs: ",Math.round(m.nutrition.carbs*M.amount),"g"]}),e.jsxs(d,{children:["Fat: ",Math.round(m.nutrition.fat*M.amount),"g"]})]})]}),e.jsxs(H,{colorScheme:"green",onClick:oe,isLoading:v,loadingText:"Adding to log...",w:"full",children:["Add to ",X(M.meal_type)]})]})})})]})]})})]})]})]})}const oc=["cup","cups","fl oz","ml","l","liter","tsp","teaspoon","tbsp","tablespoon","pint","quart","gallon","g","gram","grams","kg","kilogram","oz","ounce","ounces","lb","pound","pounds","piece","pieces","item","items","serving","servings","portion","portions","slice","slices","can","cans","bottle","bottles","package","packages","container","containers","scoop","scoops","handful","handfuls","stick","sticks","pat","pats","clove","cloves","bulb","bulbs","head","heads","bunch","bunches","stalk","stalks","small","medium","large","extra large","thin slice","thick slice","wedge","wedges","fillet","fillets","breast","breasts","thigh","thighs","wing","wings","leg","legs","unit","units"],$w=({onScanComplete:t,onCreateFood:n,showCreateButton:r=!0,className:i=""})=>{const[s,o]=C.useState(!1),[a,l]=C.useState(null),[c,u]=C.useState(null),[h,g]=C.useState(!1),[m,p]=C.useState(!1),[j,b]=C.useState(null),v=C.useRef(null),_=async M=>{if(!M.type.startsWith("image/")){alert("Please select an image file");return}const k=new FileReader;k.onload=E=>{b(E.target?.result)},k.readAsDataURL(M),o(!0),l(null),u(null);try{const E=new FormData;E.append("file",M);const B=(await Z.post("/nutrition-labels/scan",E,{headers:{"Content-Type":"multipart/form-data"}})).data;l(B),u(B.nutrition_info),g(!0),t&&t(B.nutrition_info)}catch(E){console.error("Error scanning nutrition label:",E),alert("Failed to scan nutrition label. Please try again.")}finally{o(!1)}},N=M=>{const k=M.target.files?.[0];k&&_(k)},R=M=>{M.preventDefault();const k=M.dataTransfer.files[0];k&&_(k)},U=(M,k)=>{c&&u({...c,[M]:M==="name"||M==="serving_size"?k:parseFloat(k.toString())||0})},I=()=>{c&&(t&&t(c),g(!1))},w=async()=>{if(c){p(!0);try{const M=new FormData;if(v.current?.files?.[0]){M.append("file",v.current.files[0]),M.append("food_name",c.name);const E=(await Z.post("/nutrition-labels/scan-and-create",M,{headers:{"Content-Type":"multipart/form-data"}})).data;alert("Food item created successfully!"),n&&n(E.food)}}catch(M){console.error("Error creating food:",M),alert("Failed to create food item. Please try again.")}finally{p(!1)}}},P=()=>{l(null),u(null),g(!1),b(null),v.current&&(v.current.value="")};return e.jsxs(F,{className:i,children:[!a&&e.jsxs(F,{border:"2px dashed",borderColor:"gray.300",borderRadius:"md",p:8,textAlign:"center",_hover:{borderColor:"blue.500"},transition:"border-color 0.2s",cursor:"pointer",onDrop:R,onDragOver:M=>M.preventDefault(),onClick:()=>v.current?.click(),children:[e.jsx(ve,{ref:v,type:"file",accept:"image/*",onChange:N,display:"none"}),s?e.jsxs(S,{spacing:4,children:[e.jsx(ut,{size:"xl",color:"blue.500"}),e.jsx(d,{color:"gray.600",children:"Scanning nutrition label..."})]}):e.jsxs(S,{spacing:4,children:[e.jsxs(A,{spacing:4,children:[e.jsx(sd,{size:32,color:"gray.400"}),e.jsx(ed,{size:32,color:"gray.400"})]}),e.jsxs(F,{children:[e.jsx(d,{fontSize:"lg",fontWeight:"medium",color:"gray.900",children:"Scan Nutrition Label"}),e.jsx(d,{fontSize:"sm",color:"gray.600",children:"Click to upload or drag and drop an image"})]})]})]}),j&&e.jsx(F,{mt:4,textAlign:"center",children:e.jsx(Io,{src:j,alt:"Nutrition label preview",maxW:"xs",mx:"auto",borderRadius:"md",shadow:"md"})}),a&&c&&e.jsxs(S,{mt:6,spacing:4,align:"stretch",children:[e.jsxs(Fn,{justify:"space-between",align:"center",children:[e.jsx(me,{size:"md",children:"Scanned Nutrition Information"}),e.jsxs(A,{spacing:2,children:[e.jsx(H,{onClick:()=>g(!h),size:"sm",variant:"outline",children:h?"View":"Edit"}),e.jsx(H,{onClick:P,size:"sm",variant:"outline",children:e.jsx(A0,{})})]})]}),h?e.jsxs(Ii,{templateColumns:{base:"1fr",md:"repeat(2, 1fr)"},gap:4,children:[e.jsx(ht,{children:e.jsxs($,{children:[e.jsx(V,{children:"Food Name"}),e.jsx(ve,{value:c.name,onChange:M=>U("name",M.target.value)})]})}),e.jsx(ht,{children:e.jsxs($,{children:[e.jsx(V,{children:"Serving Size"}),e.jsx(ve,{value:c.serving_size,onChange:M=>U("serving_size",M.target.value)})]})}),e.jsx(ht,{children:e.jsxs($,{children:[e.jsx(V,{children:"Calories"}),e.jsx(ue,{value:c.calories,onChange:(M,k)=>U("calories",k),children:e.jsx(de,{})})]})}),e.jsx(ht,{children:e.jsxs($,{children:[e.jsx(V,{children:"Protein (g)"}),e.jsx(ue,{value:c.protein,onChange:(M,k)=>U("protein",k),children:e.jsx(de,{})})]})}),e.jsx(ht,{children:e.jsxs($,{children:[e.jsx(V,{children:"Carbs (g)"}),e.jsx(ue,{value:c.carbs,onChange:(M,k)=>U("carbs",k),children:e.jsx(de,{})})]})}),e.jsx(ht,{children:e.jsxs($,{children:[e.jsx(V,{children:"Fat (g)"}),e.jsx(ue,{value:c.fat,onChange:(M,k)=>U("fat",k),children:e.jsx(de,{})})]})}),e.jsx(ht,{children:e.jsxs($,{children:[e.jsx(V,{children:"Fiber (g)"}),e.jsx(ue,{value:c.fiber,onChange:(M,k)=>U("fiber",k),children:e.jsx(de,{})})]})}),e.jsx(ht,{children:e.jsxs($,{children:[e.jsx(V,{children:"Sugar (g)"}),e.jsx(ue,{value:c.sugar,onChange:(M,k)=>U("sugar",k),children:e.jsx(de,{})})]})}),e.jsx(ht,{children:e.jsxs($,{children:[e.jsx(V,{children:"Sodium (mg)"}),e.jsx(ue,{value:c.sodium,onChange:(M,k)=>U("sodium",k),children:e.jsx(de,{})})]})}),e.jsx(ht,{children:e.jsxs($,{children:[e.jsx(V,{children:"Saturated Fat (g)"}),e.jsx(ue,{value:c.saturated_fat,onChange:(M,k)=>U("saturated_fat",k),children:e.jsx(de,{})})]})})]}):e.jsxs(Ii,{templateColumns:{base:"1fr",md:"repeat(2, 1fr)"},gap:4,children:[e.jsx(ht,{colSpan:2,children:e.jsxs(A,{children:[e.jsx(d,{fontWeight:"medium",children:c.name}),e.jsxs(d,{color:"gray.600",children:["(",c.serving_size,")"]})]})}),e.jsx(ht,{children:e.jsxs(A,{justify:"space-between",children:[e.jsx(d,{children:"Calories:"}),e.jsx(d,{fontWeight:"medium",children:c.calories})]})}),e.jsx(ht,{children:e.jsxs(A,{justify:"space-between",children:[e.jsx(d,{children:"Protein:"}),e.jsxs(d,{fontWeight:"medium",children:[c.protein,"g"]})]})}),e.jsx(ht,{children:e.jsxs(A,{justify:"space-between",children:[e.jsx(d,{children:"Carbs:"}),e.jsxs(d,{fontWeight:"medium",children:[c.carbs,"g"]})]})}),e.jsx(ht,{children:e.jsxs(A,{justify:"space-between",children:[e.jsx(d,{children:"Fat:"}),e.jsxs(d,{fontWeight:"medium",children:[c.fat,"g"]})]})}),e.jsx(ht,{children:e.jsxs(A,{justify:"space-between",children:[e.jsx(d,{children:"Fiber:"}),e.jsxs(d,{fontWeight:"medium",children:[c.fiber,"g"]})]})}),e.jsx(ht,{children:e.jsxs(A,{justify:"space-between",children:[e.jsx(d,{children:"Sugar:"}),e.jsxs(d,{fontWeight:"medium",children:[c.sugar,"g"]})]})})]}),e.jsxs(A,{spacing:3,pt:4,children:[h&&e.jsx(H,{onClick:I,colorScheme:"blue",leftIcon:e.jsx(Vi,{}),children:"Save Changes"}),r&&e.jsx(H,{onClick:w,isLoading:m,colorScheme:"green",leftIcon:m?e.jsx(ut,{size:"sm"}):e.jsx(Vi,{}),children:"Create Food Item"})]}),a.ocr_text&&e.jsxs(F,{mt:4,children:[e.jsx(d,{fontSize:"sm",color:"gray.600",cursor:"pointer",onClick:()=>g(!h),children:"View Raw OCR Text"}),h&&e.jsx(F,{mt:2,p:3,bg:"gray.100",borderRadius:"md",fontSize:"xs",whiteSpace:"pre-wrap",children:a.ocr_text})]})]})]})},Vw=(t,n)=>{if(!n||!n.dietary_restrictions?.length&&!n.allergens?.length)return{score:75,rating:"good",warnings:[],benefits:["No dietary restrictions set"]};let r=100,i=[],s=[];const o=t.dietary_attributes?.dietary_restrictions||[],a=t.dietary_attributes?.allergens||[],l=t.dietary_attributes?.food_categories||[];console.log("🔍 Calculating compatibility for:",t.name,{userProfile:n,foodRestrictions:o,foodAllergens:a,foodCategories:l});const c={vegetarian:["meat","beef","pork","chicken","turkey","fish","seafood","lamb","veal","duck","game"],vegan:["meat","beef","pork","chicken","turkey","fish","seafood","lamb","veal","duck","game","dairy","milk","cheese","yogurt","butter","cream","eggs","honey"],pescatarian:["meat","beef","pork","chicken","turkey","lamb","veal","duck","game"],kosher:["pork","shellfish","non-kosher"],halal:["pork","alcohol","non-halal"],"gluten-free":["gluten","wheat","barley","rye","malt"],"dairy-free":["dairy","milk","cheese","yogurt","butter","cream","lactose"],"nut-free":["nuts","peanuts","tree nuts","almonds","walnuts","cashews","pistachios"],keto:["high-carb","grains","sugar","bread","pasta","rice"],paleo:["grains","legumes","dairy","processed","sugar","bread","pasta"]},u={"high-protein":{minProtein:15,benefits:g=>(g.nutrition?.protein||0)>=15?["High protein content"]:[],penalties:g=>{const m=g.nutrition?.protein||0;return m<5?40:m<10?30:m<15?20:0}},"low-carb":{maxCarbs:15,benefits:g=>(g.nutrition?.carbs||0)<=10?["Very low carb"]:(g.nutrition?.carbs||0)<=15?["Low carb friendly"]:[],penalties:g=>{const m=g.nutrition?.carbs||0;return m>30?40:m>20?25:m>15?15:0}},"low-sugar":{maxSugar:5,benefits:g=>(g.nutrition?.sugar||0)<=2?["Sugar-free"]:(g.nutrition?.sugar||0)<=5?["Low sugar"]:[],penalties:g=>{const m=g.nutrition?.sugar||0;return m>20?50:m>10?35:m>5?20:0}},"whole-foods":{benefits:g=>{const m=g.dietary_attributes?.food_categories||[];return(g.dietary_attributes?.dietary_restrictions||[]).includes("whole-foods")||m.includes("whole-foods")||m.includes("unprocessed")?["Whole food"]:[]},penalties:g=>{const m=g.dietary_attributes?.food_categories||[];return(g.dietary_attributes?.dietary_restrictions||[]).includes("whole-foods")?0:m.includes("processed")||m.includes("ultra-processed")?35:m.includes("packaged")?15:0}},"heart-healthy":{maxSodium:600,benefits:g=>{const m=[];return(g.dietary_attributes?.dietary_restrictions||[]).includes("heart-healthy")&&m.push("Heart healthy"),(g.nutrition?.fiber||0)>=5&&m.push("High fiber"),(g.nutrition?.sodium||0)<=300&&m.push("Low sodium"),m},penalties:g=>{if((g.dietary_attributes?.dietary_restrictions||[]).includes("heart-healthy"))return 0;const p=g.nutrition?.sodium||0;return p>1200?40:p>800?25:p>600?15:0}},"anti-inflammatory":{benefits:g=>{const m=g.dietary_attributes?.food_categories||[],p=g.dietary_attributes?.dietary_restrictions||[],j=[];return p.includes("anti-inflammatory")&&j.push("Anti-inflammatory"),m.includes("antioxidant-rich")&&j.push("Antioxidant rich"),m.includes("omega-3")&&j.push("Omega-3 rich"),j},penalties:g=>{const m=g.dietary_attributes?.food_categories||[];return(g.dietary_attributes?.dietary_restrictions||[]).includes("anti-inflammatory")?0:m.includes("inflammatory")||m.includes("ultra-processed")?30:m.includes("processed")?15:0}},"high-fiber":{minFiber:5,benefits:g=>{const m=g.nutrition?.fiber||0;return m>=8?["Very high fiber"]:m>=5?["High fiber"]:[]},penalties:g=>{const m=g.nutrition?.fiber||0;return m<1?25:m<3?15:m<5?10:0}}};n.allergens.forEach(g=>{(a.includes(g)||l.includes(g))&&(r=0,i.push(`⚠️ Contains ${g}`))}),r>0&&n.dietary_restrictions.forEach(g=>{const p=(c[g.toLowerCase()]||[]).some(_=>o.some(N=>N.toLowerCase().includes(_.toLowerCase()))||l.some(N=>N.toLowerCase().includes(_.toLowerCase()))),j=o.some(_=>_.toLowerCase().includes(g.toLowerCase()));let b=!1;if(g.toLowerCase()==="vegan"){const _=["fruit","fruits","vegetable","vegetables","grain","grains","nuts","seeds","legume","legumes","berries","herbs","spices"],N=l.some(I=>_.includes(I.toLowerCase())),U=["avocado","apple","banana","orange","lettuce","tomato","carrot","spinach","kale","broccoli","quinoa","rice","oats","almond","walnut","cashew","pistachio","pecan"].some(I=>t.name.toLowerCase().includes(I));b=N||U||l.length===0&&o.length===0&&!p}else if(g.toLowerCase()==="vegetarian"){const _=["fruit","fruits","vegetable","vegetables","grain","grains","nuts","seeds","legume","legumes","berries","herbs","spices","dairy","eggs"],N=l.some(I=>_.includes(I.toLowerCase())),R=["meat","beef","pork","chicken","turkey","fish","seafood","lamb","veal","duck","game"],U=l.some(I=>R.includes(I.toLowerCase()));b=N||l.length===0&&o.length===0&&!U}const v=g.toLowerCase()==="pescatarian"&&(l.includes("fish")||l.includes("seafood")||o.includes("pescatarian"));if(p&&!b)if(n.strictness_level==="strict")r=0,i.push(`❌ Not ${g} (strict mode)`);else{const _=n.strictness_level==="moderate"?40:20;r-=_,i.push(`⚠️ Not ${g}`)}else if(j||v||b)s.push(`✅ ${g.charAt(0).toUpperCase()+g.slice(1)}`);else{const _=l.includes("fruit")||l.includes("vegetable")||l.includes("grain")||l.includes("legume")||l.includes("nuts")||l.includes("dairy")||!l.includes("processed"),N=g.toLowerCase()==="pescatarian"&&(l.includes("fruit")||l.includes("vegetable")||l.includes("grain")||l.includes("legume")||l.includes("nuts")||l.includes("dairy")||o.includes("vegetarian")||o.includes("vegan"));n.strictness_level==="strict"&&!_&&!N&&(r-=10,i.push(`? Unverified ${g} status`))}}),r>0&&o.forEach(g=>{n.dietary_restrictions.some(m=>m.toLowerCase()===g.toLowerCase())||(r+=3,s.push(`+ ${g}`))}),r>0&&n.dietary_restrictions.forEach(g=>{if(u[g]){const{benefits:m,penalties:p}=u[g],j=m(t);let b=p(t);n.strictness_level==="strict"&&b>0?b=Math.min(50,b*1.5):n.strictness_level==="moderate"&&b>0&&(b=Math.min(40,b*1.2)),b>0&&(console.log(`🔍 Applying penalty for ${g}: ${b} points for ${t.name}`),r-=b,n.strictness_level==="strict"&&(g==="high-protein"&&(t.nutrition?.protein||0)<15?i.push(`⚠️ Low protein: ${t.nutrition?.protein||0}g (need ≥15g)`):g==="low-carb"&&(t.nutrition?.carbs||0)>15?i.push(`⚠️ High carb: ${t.nutrition?.carbs||0}g (need ≤15g)`):g==="low-sugar"&&(t.nutrition?.sugar||0)>5?i.push(`⚠️ High sugar: ${t.nutrition?.sugar||0}g (need ≤5g)`):g==="high-fiber"&&(t.nutrition?.fiber||0)<5&&i.push(`⚠️ Low fiber: ${t.nutrition?.fiber||0}g (need ≥5g)`))),b===0&&s.push(...j)}});const h=Math.max(0,Math.min(100,r));return console.log(`🎯 Final compatibility score for ${t.name}: ${h}% (penalties applied: ${100-r})`),{score:h,warnings:i,benefits:s,isSafe:h>0}};function ac({food:t,userProfile:n}){const r=_e("white","gray.800"),i=_e("gray.200","gray.600"),s=C.useMemo(()=>Vw(t,n),[t,n]),o=()=>s.isSafe?s.score>=80?"green":s.score>=60?"yellow":"orange":"red",a=()=>s.isSafe?s.score>=95?"Perfect Match":s.score>=85?"Excellent":s.score>=70?"Good":s.score>=50?"Okay":s.score>=25?"Poor Match":"Avoid":"Incompatible";return e.jsx(se,{bg:r,borderColor:i,borderWidth:1,size:"sm",children:e.jsx(re,{p:3,children:e.jsxs(S,{spacing:3,align:"stretch",children:[e.jsxs(A,{justify:"space-between",children:[e.jsx(d,{fontWeight:"bold",fontSize:"sm",children:"Diet Compatibility"}),e.jsx(jr,{label:`${s.score}/100 compatibility score`,children:e.jsx(je,{colorScheme:o(),variant:s.isSafe?"solid":"outline",px:2,children:a()})})]}),s.isSafe&&e.jsx(xt,{value:s.score,colorScheme:o(),size:"sm",borderRadius:"md"}),s.benefits.length>0&&e.jsxs(S,{spacing:1,align:"stretch",children:[e.jsx(d,{fontSize:"xs",fontWeight:"medium",color:"green.600",children:"✅ Compatible Features:"}),e.jsxs(F,{children:[s.benefits.slice(0,3).map((l,c)=>e.jsx(je,{colorScheme:"green",variant:"outline",size:"sm",mr:1,mb:1,children:l},c)),s.benefits.length>3&&e.jsxs(je,{colorScheme:"green",variant:"outline",size:"sm",children:["+",s.benefits.length-3," more"]})]})]}),s.warnings.length>0&&e.jsxs(S,{spacing:1,align:"stretch",children:[e.jsx(d,{fontSize:"xs",fontWeight:"medium",color:"red.600",children:"⚠️ Concerns:"}),e.jsx(F,{children:s.warnings.map((l,c)=>e.jsx(je,{colorScheme:"red",variant:"outline",size:"sm",mr:1,mb:1,children:l},c))})]}),t.dietary_attributes?.food_categories&&t.dietary_attributes.food_categories.length>0&&e.jsxs(S,{spacing:1,align:"stretch",children:[e.jsx(d,{fontSize:"xs",fontWeight:"medium",color:"gray.600",children:"🏷️ Categories:"}),e.jsx(F,{children:t.dietary_attributes.food_categories.map((l,c)=>e.jsx(je,{colorScheme:"blue",variant:"subtle",size:"sm",mr:1,mb:1,children:l},c))})]})]})})})}const qw={lifestyle:{name:"Lifestyle",options:["vegetarian","vegan","pescatarian","flexitarian"],icon:"🌱",description:"Your dietary lifestyle choice"},religious:{name:"Religious/Cultural",options:["halal","kosher","jain"],icon:"🕊️",description:"Religious or cultural dietary requirements"},health:{name:"Health Requirements",options:["gluten-free","dairy-free","keto","paleo","low-sodium"],icon:"🏥",description:"Health-based dietary needs"},fitness:{name:"Health & Fitness Goals",options:["high-protein","low-carb","low-sugar","whole-foods","heart-healthy","anti-inflammatory","high-fiber"],icon:"💪",description:"Nutritional goals for health and fitness"},allergens:{name:"Allergens to Avoid",options:["nuts","shellfish","eggs","soy","fish","sesame"],icon:"⚠️",description:"Foods that cause allergic reactions"}};function Gw({currentProfile:t,onProfileUpdate:n}){const[r,i]=C.useState(t?.dietary_restrictions||[]),[s,o]=C.useState(t?.allergens||[]),[a,l]=C.useState(t?.strictness_level||"moderate"),c=_e("white","gray.800"),u=_e("gray.200","gray.600"),h=j=>{i(b=>b.includes(j)?b.filter(v=>v!==j):[...b,j])},g=j=>{o(b=>b.includes(j)?b.filter(v=>v!==j):[...b,j])},m=()=>{const b=r.length*5,v=s.length*10,_=a==="strict"?15:a==="moderate"?5:0;return Math.max(0,100-b-v-_)},p=()=>{const j=m();return j>=80?"green":j>=60?"yellow":"red"};return e.jsxs(S,{spacing:6,align:"stretch",children:[e.jsxs(F,{children:[e.jsx(me,{size:"md",mb:2,children:"🎯 Build Your Dietary Profile"}),e.jsx(d,{color:"gray.600",fontSize:"sm",children:"Help us find foods that perfectly match your lifestyle"})]}),e.jsx(se,{bg:c,borderColor:u,borderWidth:1,children:e.jsx(re,{children:e.jsxs(S,{spacing:3,children:[e.jsxs(A,{justify:"space-between",w:"full",children:[e.jsx(d,{fontWeight:"bold",children:"Food Compatibility Score"}),e.jsxs(je,{colorScheme:p(),size:"lg",children:[m(),"%"]})]}),e.jsx(xt,{value:m(),colorScheme:p(),w:"full",borderRadius:"md"}),e.jsx(d,{fontSize:"sm",color:"gray.600",children:"Higher scores mean more food options available"})]})})}),Object.entries(qw).map(([j,b])=>e.jsx(se,{bg:c,borderColor:u,borderWidth:1,children:e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs(A,{children:[e.jsx(d,{fontSize:"2xl",children:b.icon}),e.jsxs(S,{align:"start",spacing:0,children:[e.jsx(d,{fontWeight:"bold",children:b.name}),e.jsx(d,{fontSize:"sm",color:"gray.600",children:b.description})]})]}),e.jsx(xe,{columns:{base:2,md:3},spacing:2,children:b.options.map(v=>{const _=j==="allergens"?s.includes(v):r.includes(v);return e.jsx(H,{size:"sm",variant:_?"solid":"outline",colorScheme:j==="allergens"?"red":"green",onClick:()=>j==="allergens"?g(v):h(v),textTransform:"capitalize",children:v},v)})})]})})},j)),e.jsx(se,{bg:c,borderColor:u,borderWidth:1,children:e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs(A,{children:[e.jsx(d,{fontSize:"2xl",children:"🎚️"}),e.jsxs(S,{align:"start",spacing:0,children:[e.jsx(d,{fontWeight:"bold",children:"Strictness Level"}),e.jsx(d,{fontSize:"sm",color:"gray.600",children:"How strictly do you follow your dietary preferences?"})]})]}),e.jsx(A,{spacing:2,children:["flexible","moderate","strict"].map(j=>e.jsx(H,{flex:1,size:"sm",variant:a===j?"solid":"outline",colorScheme:"blue",onClick:()=>l(j),textTransform:"capitalize",children:j},j))})]})})}),e.jsx(H,{colorScheme:"green",size:"lg",onClick:()=>n({dietary_restrictions:r,allergens:s,strictness_level:a,compatibility_score:m()}),children:"💾 Save Dietary Profile"})]})}const Ds=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",w:4,h:4,children:e.jsx("path",{d:"M23.384,21.619,16.855,15.09a9.284,9.284,0,1,0-1.768,1.768l6.529,6.529a1.266,1.266,0,0,0,1.768,0A1.251,1.251,0,0,0,23.384,21.619ZM2.75,9.5a6.75,6.75,0,1,1,6.75,6.75A6.758,6.758,0,0,1,2.75,9.5Z"})}),mi=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",w:4,h:4,children:e.jsx("path",{d:"M19,11H13V5a1,1,0,0,0-2,0v6H5a1,1,0,0,0,0,2h6v6a1,1,0,0,0,2,0V13h6a1,1,0,0,0,0-2Z"})}),lc=()=>e.jsx($e,{viewBox:"0 0 24 24",fill:"currentColor",w:4,h:4,children:e.jsx("path",{d:"M14,12V19.88C14.04,20.18 13.94,20.5 13.71,20.71C13.32,21.1 12.69,21.1 12.3,20.71L10.29,18.7C10.06,18.47 9.96,18.16 10,17.87V12H9.97L4.21,4.62C3.87,4.19 3.95,3.56 4.38,3.22C4.57,3.08 4.78,3 5,3V3H19V3C19.22,3 19.43,3.08 19.62,3.22C20.05,3.56 20.13,4.19 19.79,4.62L14.03,12H14Z"})}),cc=()=>e.jsxs($e,{viewBox:"0 0 24 24",fill:"currentColor",w:4,h:4,children:[e.jsx("path",{d:"M9 2a1 1 0 000 2h6a1 1 0 100-2H9z"}),e.jsx("path",{fillRule:"evenodd",d:"M10 5a2 2 0 00-2 2v1H5a1 1 0 000 2h1v11a3 3 0 003 3h6a3 3 0 003-3V10h1a1 1 0 100-2h-3V7a2 2 0 00-2-2h-6zm0 2h6v1h-6V7zm-1 3h8v11a1 1 0 01-1 1H10a1 1 0 01-1-1V10z"})]});function Yw(){const[t,n]=C.useState(""),[r,i]=C.useState([]),[s,o]=C.useState([]),[,a]=C.useState(!1),[l,c]=C.useState(!1),[u,h]=C.useState(1),[g,m]=C.useState(!1),[,p]=C.useState(0),[j]=C.useState(""),[b,v]=C.useState("name"),[_,N]=C.useState("asc"),{isOpen:R,onOpen:U,onClose:I}=Fe(),{isOpen:w,onOpen:P,onClose:M}=Fe(),{isOpen:k,onOpen:E,onClose:O}=Fe(),{isOpen:B,onOpen:J,onClose:ae}=Fe(),q=wt(),{refreshUserFoods:oe}=Ju(),fe=20,[pe,X]=C.useState(null),[f,W]=C.useState({meal_type:"lunch",servings:1,unit:"serving",notes:""}),[te,y]=C.useState(null),[ee,Ie]=C.useState(null),[ce,ne]=C.useState({name:"",brand:"",serving_size:1,serving_unit:"",nutrition:{calories:0,protein:0,carbs:0,fat:0,fiber:0,sugar:0,sodium:0},notes:"",dietary_attributes:{dietary_restrictions:[],allergens:[],food_categories:[]}}),[he,dt]=C.useState(null),[Qe,Ye]=C.useState(!1),{isOpen:z,onOpen:Q,onClose:Ne}=Fe(),ye=Wt({base:!0,lg:!1}),{isOpen:Cn,onOpen:hn,onClose:At}=Fe();C.useEffect(()=>{(async()=>{try{const ge=await Z.get("/preferences/dietary");console.log("✅ Loaded user dietary preferences:",ge.data),dt(ge.data)}catch(ge){console.error("❌ Error fetching dietary preferences:",ge),dt({dietary_restrictions:[],allergens:[],strictness_level:"moderate"})}})()},[]);const en=D=>{if(console.log("🔍 FILTER DEBUG - User Preferences:",JSON.stringify(he,null,2)),console.log("🔍 FILTER DEBUG - Apply Filter:",Qe),console.log("🔍 FILTER DEBUG - Foods to filter:",D.length),!he||!Qe)return console.log("🔄 No dietary filtering applied - showing all foods"),D;console.log("🔍 Applying dietary filters:",{userPreferences:he,applyDietaryFilter:Qe,totalFoods:D.length});const ge=D.filter(Xe=>{const Ge=Xe.dietary_attributes?.dietary_restrictions||[],lt=Xe.dietary_attributes?.food_categories||[],Gt=Xe.dietary_attributes?.allergens||[];if(he.allergens?.length>0)for(const tt of he.allergens){const We=tt.toLowerCase(),ct=Gt.some(qe=>{const Ke=qe.toLowerCase();if(Ke===We)return console.log(`🔍 Exact allergen match: ${Ke} === ${We}`),!0;if(We==="nuts"||We==="tree nuts"){const yt=["nuts","tree nuts","almonds","walnuts","cashews","pistachios","pecans","hazelnuts","brazil nuts","macadamia","pine nuts"].includes(Ke);return yt&&console.log(`🔍 Nut allergen match: ${Ke} found in nut types`),yt}return We==="dairy"?["dairy","milk","lactose","cheese","yogurt","butter","cream","whey","casein"].includes(Ke):We==="gluten"?["gluten","wheat","barley","rye","oats"].includes(Ke):Ke.includes(We)||We.includes(Ke)}),jt=lt.some(qe=>{const Ke=qe.toLowerCase();if(Ke===We)return console.log(`🔍 Exact category allergen match: ${Ke} === ${We}`),!0;if(We==="nuts"||We==="tree nuts"){const yt=["nuts","tree nuts","almonds","walnuts","cashews","pistachios","pecans","hazelnuts","brazil nuts","macadamia","pine nuts"].includes(Ke);return yt&&console.log(`🔍 Nut category allergen match: ${Ke} found in nut types`),yt}return We==="dairy"?["dairy","milk","lactose","cheese","yogurt","butter","cream","whey","casein"].includes(Ke):Ke.includes(We)||We.includes(Ke)});if(ct||jt)return console.log(`❌ ${Xe.name} contains allergen: ${tt} (found in allergens: [${Gt.join(", ")}] or categories: [${lt.join(", ")}])`),!1}if(he.dietary_restrictions?.length>0){let tt=!1,We=!1;for(const ct of he.dietary_restrictions){const jt=ct.toLowerCase();if(Ge.some(qe=>qe.toLowerCase()===jt)){tt=!0;continue}switch(jt){case"vegetarian":lt.length===0&&Ge.length===0?tt=!0:lt.some(qe=>["meat","beef","pork","chicken","turkey","fish","seafood"].includes(qe.toLowerCase()))?We=!0:tt=!0;break;case"vegan":if(Ge.includes("vegan"))tt=!0;else if(lt.some(qe=>["meat","dairy","eggs","fish","seafood","cheese","milk","butter","cream","honey"].includes(qe.toLowerCase())))We=!0;else if(Gt.some(qe=>["dairy","milk","eggs","fish","shellfish"].includes(qe.toLowerCase())))We=!0;else{const qe=["fruits","vegetables","grains","nuts","seeds","legumes","berries","herbs","spices"],Ke=lt.some(yt=>qe.includes(yt.toLowerCase())),st=["fruit","vegetable","grain","nut","seed","legume","berry","herb","spice"].some(yt=>Xe.name.toLowerCase().includes(yt)||lt.some(Kd=>Kd.toLowerCase().includes(yt)));Ke||st||lt.length===0&&Ge.length,tt=!0}break;case"gluten-free":Ge.includes("gluten-free")?tt=!0:lt.some(qe=>["wheat","gluten","barley","rye"].includes(qe.toLowerCase()))?We=!0:tt=!0;break;case"dairy-free":Ge.includes("dairy-free")?tt=!0:lt.includes("dairy")||Gt.includes("dairy")?We=!0:tt=!0;break;case"pescatarian":lt.some(qe=>["fish","seafood"].includes(qe.toLowerCase()))||Ge.includes("pescatarian")||Ge.includes("vegetarian")?tt=!0:lt.some(qe=>["meat","beef","pork","chicken","turkey"].includes(qe.toLowerCase()))?We=!0:tt=!0;break;default:(Ge.includes(jt)||Ge.length===0&&lt.length===0)&&(tt=!0);break}}if(We)return console.log(`❌ ${Xe.name} has incompatible elements for dietary restrictions`),!1;!tt&&Ge.length>0&&console.log(`⚠️ ${Xe.name} might not match dietary restrictions but allowing due to uncertainty`)}return console.log(`✅ ${Xe.name} passed dietary filters`),!0});return console.log(`🔍 Dietary filtering complete: ${ge.length}/${D.length} foods remaining`),ge},qt=async(D=1,ge="",Xe="name",Ge="asc")=>{console.log("🔄 loadAllFoods called with:",{page:D,filter:ge,sort:Xe,order:Ge}),c(!0);try{if(ge.trim()){console.log("📍 Using search endpoint with filter:",ge);const lt=(D-1)*fe,Gt=new URLSearchParams({q:ge,limit:(fe+1).toString(),skip:lt.toString()}),We=(await Z.get(`/foods/search?${Gt}`)).data||[];console.log("🔍 Search response:",{foodsCount:We.length,foods:We});const ct=[...We].sort((jt,qe)=>{if(Xe==="name"){const Ke=jt.name?.toLowerCase()||"",st=qe.name?.toLowerCase()||"";return Ge==="asc"?Ke.localeCompare(st):st.localeCompare(Ke)}else if(Xe==="calories"){const Ke=jt.nutrition?.calories||0,st=qe.nutrition?.calories||0;return Ge==="asc"?Ke-st:st-Ke}else if(Xe==="protein"){const Ke=jt.nutrition?.protein||0,st=qe.nutrition?.protein||0;return Ge==="asc"?Ke-st:st-Ke}return 0});ct.length>fe?(m(!0),o(ct.slice(0,fe))):(m(!1),o(ct)),p(lt+ct.length)}else{console.log("📍 Using search endpoint with empty query (no filter)");const lt=await Z.get("/foods/search?q=&limit=100"),Gt=lt.data||[];console.log("📋 Search response (empty query):",{status:lt.status,foodsCount:Gt.length,foods:Gt.slice(0,3)});const tt=[...Gt].sort((qe,Ke)=>{if(Xe==="name"){const st=qe.name?.toLowerCase()||"",yt=Ke.name?.toLowerCase()||"";return Ge==="asc"?st.localeCompare(yt):yt.localeCompare(st)}else if(Xe==="calories"){const st=qe.nutrition?.calories||0,yt=Ke.nutrition?.calories||0;return Ge==="asc"?st-yt:yt-st}else if(Xe==="protein"){const st=qe.nutrition?.protein||0,yt=Ke.nutrition?.protein||0;return Ge==="asc"?st-yt:yt-st}return 0}),We=(D-1)*fe,ct=We+fe,jt=tt.slice(We,ct);o(jt),m(ct<tt.length),p(tt.length)}}catch(lt){console.error("Error loading foods:",lt),q({title:"Load Error",description:"Failed to load foods. Please try again.",status:"error",duration:3e3,isClosable:!0}),o([]),m(!1),p(0)}c(!1)};C.useEffect(()=>{qt(u,j,b,_)},[u,j,b,_,oe]);const tn=async D=>{if(!D.trim()){i([]);return}a(!0);try{const lt=((await Z.get(`/foods/search?q=${encodeURIComponent(D)}&limit=50`)).data||[]).filter(tt=>{const We=D.toLowerCase(),ct=tt.name?.toLowerCase()||"";return ct.includes(We)||ct.split(" ").some(jt=>jt.startsWith(We))}).sort((tt,We)=>{const ct=D.toLowerCase(),jt=tt.name?.toLowerCase()||"",qe=We.name?.toLowerCase()||"";return jt===ct&&qe!==ct?-1:qe===ct&&jt!==ct?1:jt.startsWith(ct)&&!qe.startsWith(ct)?-1:qe.startsWith(ct)&&!jt.startsWith(ct)?1:jt.localeCompare(qe)}),Gt=en(lt);i(Gt)}catch(ge){console.error("Error searching foods:",ge),i([])}a(!1)};C.useEffect(()=>{const D=setTimeout(()=>{tn(t)},300);return()=>clearTimeout(D)},[t,he,Qe]);const Tt=D=>{h(D)},Un=async()=>{try{await Z.post("/foods",ce),q({title:"Food Added",description:`${ce.name} has been added to the food index.`,status:"success",duration:3e3,isClosable:!0}),I(),ne({name:"",brand:"",serving_size:1,serving_unit:"",nutrition:{calories:0,protein:0,carbs:0,fat:0,fiber:0,sugar:0,sodium:0},notes:"",dietary_attributes:{dietary_restrictions:[],allergens:[],food_categories:[]}}),t.trim()&&tn(t),qt(u,j,b,_)}catch(D){console.error("Error adding food:",D),q({title:"Add Food Error",description:"Failed to add food. Please try again.",status:"error",duration:3e3,isClosable:!0})}},kn=D=>{X(D),W({meal_type:"lunch",servings:1,unit:"serving",notes:""}),y(null),P()},En=(D,ge)=>{if(W(Xe=>({...Xe,servings:D,unit:ge})),pe){const Xe={calories:pe.nutrition?.calories||0,protein:pe.nutrition?.protein||0,carbs:pe.nutrition?.carbs||0,fat:pe.nutrition?.fat||0,fiber:pe.nutrition?.fiber||0,sugar:pe.nutrition?.sugar||0,sodium:pe.nutrition?.sodium||0},Ge=ud(Xe,pe.serving_size||1,pe.serving_unit||"serving",D,ge);y(Ge)}},K=D=>{Ie(D),J()},x=async()=>{if(ee)try{await Z.put(`/foods/${ee.id}`,ee),q({title:"Food Updated",description:`${ee.name} has been updated successfully.`,status:"success",duration:3e3,isClosable:!0}),ae(),t.trim()&&tn(t),qt(u,j,b,_)}catch(D){console.error("Error updating food:",D),q({title:"Update Error",description:"Failed to update food. Please try again.",status:"error",duration:3e3,isClosable:!0})}},T=async()=>{if(ee)try{await Z.delete(`/foods/${ee.id}`),q({title:"Food Deleted",description:`${ee.name} has been deleted.`,status:"success",duration:3e3,isClosable:!0}),ae(),t.trim()&&tn(t),qt(u,j,b,_)}catch(D){console.error("Error deleting food:",D),q({title:"Delete Error",description:"Failed to delete food. Please try again.",status:"error",duration:3e3,isClosable:!0})}},L=async()=>{if(pe)try{const D=te||{calories:pe.nutrition.calories*f.servings,protein:pe.nutrition.protein*f.servings,carbs:pe.nutrition.carbs*f.servings,fat:pe.nutrition.fat*f.servings,fiber:(pe.nutrition.fiber||0)*f.servings,sugar:(pe.nutrition.sugar||0)*f.servings,sodium:(pe.nutrition.sodium||0)*f.servings},ge={date:mn(xn()),meal_type:f.meal_type,food_id:pe.id,food_name:pe.name,amount:f.servings*(pe.serving_size||1),unit:f.unit,nutrition:D,notes:f.notes};await Z.post("/food-logs",ge),q({title:"Food Logged",description:`${pe.name} has been logged to your ${f.meal_type}.`,status:"success",duration:3e3,isClosable:!0}),M()}catch(D){console.error("Error logging food:",D),q({title:"Log Error",description:"Failed to log food. Please try again.",status:"error",duration:3e3,isClosable:!0})}},G=C.useMemo(()=>{console.log("🎯 displayedFoods calculation:",{allFoodsCount:s.length,searchResultsCount:r.length,searchQuery:t.trim(),applyDietaryFilter:Qe,userPreferences:he?"present":"null"});let D=s;t.trim()?(D=r,console.log("🔍 Using search results:",D.length)):console.log("📋 Using all foods:",D.length);const ge=en(D);return console.log("🎯 Final displayed foods count:",ge.length),ge},[s,r,t,he,Qe]),le=D=>(console.log(`🍎 FULL FOOD DATA for ${D.name}:`,JSON.stringify(D,null,2)),e.jsx(se,{_hover:{shadow:"md",cursor:"pointer"},children:e.jsx(re,{children:e.jsxs(S,{align:"start",spacing:3,children:[e.jsxs(F,{w:"full",onClick:()=>K(D),children:[D.brand&&e.jsx(d,{fontSize:"sm",color:"gray.400",fontWeight:"medium",textTransform:"uppercase",mb:1,children:D.brand}),e.jsx(d,{fontWeight:"bold",fontSize:"lg",children:D.name}),e.jsxs(A,{spacing:2,wrap:"wrap",mt:1,children:[D.source&&e.jsx(je,{colorScheme:"blue",size:"sm",children:D.source}),D.dietary_attributes?e.jsx(je,{colorScheme:"purple",size:"sm",variant:"outline",children:"HAS DIETARY DATA"}):e.jsx(je,{colorScheme:"gray",size:"sm",variant:"outline",children:"NO DIETARY DATA"})]})]}),he&&(he.dietary_restrictions?.length>0||he.allergens?.length>0)&&e.jsx(ac,{food:D,userProfile:he}),e.jsxs(d,{fontSize:"sm",color:"gray.600",children:["Per ",D.serving_size," ",D.serving_unit]}),e.jsxs(xe,{columns:2,spacing:2,w:"full",children:[e.jsxs(d,{fontSize:"sm",children:[e.jsx("strong",{children:"Calories:"})," ",Math.round(D.nutrition.calories)]}),e.jsxs(d,{fontSize:"sm",children:[e.jsx("strong",{children:"Protein:"})," ",D.nutrition.protein,"g"]}),e.jsxs(d,{fontSize:"sm",children:[e.jsx("strong",{children:"Carbs:"})," ",D.nutrition.carbs,"g"]}),e.jsxs(d,{fontSize:"sm",children:[e.jsx("strong",{children:"Fat:"})," ",D.nutrition.fat,"g"]})]}),e.jsxs(A,{w:"full",spacing:2,children:[e.jsx(H,{size:"sm",colorScheme:"green",leftIcon:e.jsx(mi,{}),onClick:ge=>{ge.stopPropagation(),kn(D)},flex:1,children:"Log Food"}),e.jsx(H,{size:"sm",colorScheme:"blue",variant:"outline",onClick:ge=>{ge.stopPropagation(),K(D)},children:"Edit"})]})]})})},D.id)),Ve=D=>e.jsx(se,{_hover:{shadow:"md",cursor:"pointer"},size:"sm",onClick:()=>K(D),bg:"linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(249,252,255,0.95) 100%)",children:e.jsx(re,{p:2,children:e.jsxs(S,{align:"start",spacing:1.5,w:"full",children:[e.jsxs(A,{justify:"space-between",align:"start",w:"full",children:[e.jsxs(S,{align:"start",spacing:0,flex:1,minW:0,children:[D.brand&&e.jsx(d,{fontSize:"xs",color:"gray.400",fontWeight:"medium",textTransform:"uppercase",noOfLines:1,children:D.brand}),e.jsx(d,{fontWeight:"bold",fontSize:"sm",lineHeight:"tight",noOfLines:1,color:"gray.800",children:D.name}),e.jsxs(d,{fontSize:"xs",color:"gray.500",noOfLines:1,children:[D.source," • ",D.serving_size," ",D.serving_unit]})]}),e.jsxs(S,{spacing:0,align:"end",minW:"fit-content",ml:2,children:[e.jsx(d,{fontSize:"lg",fontWeight:"bold",color:"green.600",children:Math.round(D.nutrition.calories)}),e.jsx(d,{fontSize:"xs",color:"gray.400",children:"cal"})]})]}),e.jsxs(A,{spacing:2,fontSize:"xs",color:"gray.700",w:"full",justify:"space-between",bg:"gray.50",p:1.5,borderRadius:"md",children:[e.jsxs(S,{spacing:0,align:"center",flex:1,children:[e.jsxs(d,{fontWeight:"bold",color:"blue.600",fontSize:"xs",children:[D.nutrition.protein,"g"]}),e.jsx(d,{fontSize:"xs",color:"gray.500",children:"Protein"})]}),e.jsxs(S,{spacing:0,align:"center",flex:1,children:[e.jsxs(d,{fontWeight:"bold",color:"orange.600",fontSize:"xs",children:[D.nutrition.carbs,"g"]}),e.jsx(d,{fontSize:"xs",color:"gray.500",children:"Carbs"})]}),e.jsxs(S,{spacing:0,align:"center",flex:1,children:[e.jsxs(d,{fontWeight:"bold",color:"purple.600",fontSize:"xs",children:[D.nutrition.fat,"g"]}),e.jsx(d,{fontSize:"xs",color:"gray.500",children:"Fat"})]})]}),e.jsxs(A,{w:"full",spacing:1,pt:1,children:[e.jsx(H,{size:"xs",colorScheme:"green",leftIcon:e.jsx(mi,{}),onClick:ge=>{ge.stopPropagation(),kn(D)},flex:1,fontSize:"xs",children:"Log Food"}),e.jsx(H,{size:"xs",colorScheme:"blue",variant:"outline",onClick:ge=>{ge.stopPropagation(),K(D)},fontSize:"xs",children:"Details"})]})]})})},D.id),at=D=>{ne({name:D.name||"",brand:"",serving_size:D.serving_size||1,serving_unit:"serving",nutrition:{calories:D.calories||0,protein:D.protein||0,carbs:D.carbs||0,fat:D.fat||0,fiber:D.fiber||0,sugar:D.sugar||0,sodium:D.sodium||0},notes:"Created from nutrition label scan",dietary_attributes:{dietary_restrictions:[],allergens:[],food_categories:[]}}),O(),U(),q({title:"Nutrition Information Scanned",description:"Food form has been pre-populated with scanned data. Review and save.",status:"success",duration:3e3,isClosable:!0})},nn=D=>{qt(u,j,b,_),O(),q({title:"Food Created",description:`${D.name} has been added to your food database.`,status:"success",duration:3e3,isClosable:!0})};return e.jsx(F,{bg:"linear-gradient(135deg, #f6f9fc 0%, #e9f4f9 100%)",minH:"100vh",children:e.jsx(It,{maxW:ye?"100%":"container.xl",py:ye?2:8,px:ye?2:8,children:e.jsxs(S,{spacing:ye?3:6,align:"stretch",children:[ye&&e.jsx(F,{bg:"white",p:4,borderRadius:"lg",shadow:"sm",children:e.jsxs(S,{spacing:3,children:[e.jsx(me,{size:"md",textAlign:"center",children:"Food Index 🥗"}),e.jsxs(Ys,{size:"md",children:[e.jsx(Ks,{pointerEvents:"none",children:e.jsx(Ds,{})}),e.jsx(ve,{placeholder:"Search foods...",value:t,onChange:D=>n(D.target.value),borderRadius:"full",bg:"gray.50",border:"none",_focus:{bg:"white",shadow:"outline"}})]}),e.jsxs(A,{spacing:2,w:"full",children:[e.jsx(H,{leftIcon:e.jsx(lc,{}),onClick:hn,size:"sm",variant:"outline",flex:1,children:"Filter"}),e.jsx(H,{leftIcon:e.jsx(cc,{}),onClick:E,size:"sm",colorScheme:"purple",flex:1,children:"Scan"}),e.jsx(H,{leftIcon:e.jsx(mi,{}),onClick:U,size:"sm",colorScheme:"green",flex:1,children:"Add"})]}),e.jsx(H,{onClick:Q,size:"sm",colorScheme:"orange",variant:"outline",w:"full",leftIcon:e.jsx(d,{fontSize:"sm",children:"⚙️"}),children:"Dietary Profile"}),e.jsxs(A,{justify:"space-between",w:"full",fontSize:"xs",color:"gray.600",children:[e.jsxs(d,{children:["Total: ",s.length]}),e.jsxs(d,{children:["Showing: ",G.length]})]})]})}),!ye&&e.jsx(F,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs(A,{justify:"space-between",align:"start",children:[e.jsxs(S,{align:"start",spacing:1,children:[e.jsx(me,{size:"lg",children:"Food Index 🍎"}),e.jsx(d,{color:"gray.600",children:"Browse and search our comprehensive food database"})]}),e.jsxs(A,{spacing:3,children:[e.jsx(H,{leftIcon:e.jsx(Ds,{}),size:"md",variant:"outline",colorScheme:"blue",children:"Search"}),e.jsx(H,{leftIcon:e.jsx(lc,{}),onClick:hn,size:"md",variant:"outline",colorScheme:"gray",children:"Filter"}),e.jsx(H,{leftIcon:e.jsx(cc,{}),onClick:E,size:"md",colorScheme:"purple",children:"Scan Label"}),e.jsx(H,{leftIcon:e.jsx(mi,{}),onClick:U,size:"md",colorScheme:"green",children:"Add Food"}),e.jsx(H,{size:"md",colorScheme:"orange",variant:"outline",onClick:Q,leftIcon:e.jsx(d,{fontSize:"sm",children:"⚙️"}),children:"Dietary Profile"})]})]}),e.jsxs(A,{spacing:4,w:"full",children:[e.jsxs(Ys,{size:"lg",flex:1,children:[e.jsx(Ks,{pointerEvents:"none",children:e.jsx(Ds,{})}),e.jsx(ve,{placeholder:"Search foods by name, category, or brand...",value:t,onChange:D=>n(D.target.value),borderRadius:"lg",bg:"white",border:"2px solid",borderColor:"gray.200",_focus:{borderColor:"blue.500",shadow:"lg"}})]}),e.jsxs(A,{spacing:3,children:[e.jsxs(Be,{value:b,onChange:D=>v(D.target.value),size:"lg",w:"150px",bg:"white",children:[e.jsx("option",{value:"name",children:"Sort by Name"}),e.jsx("option",{value:"calories",children:"Sort by Calories"}),e.jsx("option",{value:"protein",children:"Sort by Protein"})]}),e.jsxs(Be,{value:_,onChange:D=>N(D.target.value),size:"lg",w:"120px",bg:"white",children:[e.jsx("option",{value:"asc",children:"Low to High"}),e.jsx("option",{value:"desc",children:"High to Low"})]}),he&&(he.dietary_restrictions?.length>0||he.allergens?.length>0)&&e.jsxs(A,{spacing:2,bg:"white",p:3,borderRadius:"lg",border:"2px solid",borderColor:"gray.200",children:[e.jsx(d,{fontSize:"sm",fontWeight:"medium",children:"Dietary Filters:"}),e.jsx(Ht,{isChecked:Qe,onChange:D=>Ye(D.target.checked),colorScheme:"green",size:"lg"})]})]})]}),e.jsxs(A,{justify:"space-between",w:"full",fontSize:"sm",color:"gray.600",bg:"white",p:4,borderRadius:"lg",border:"1px solid",borderColor:"gray.200",children:[e.jsxs(A,{spacing:6,children:[e.jsxs(d,{children:[e.jsx("strong",{children:"Total Foods:"})," ",s.length]}),e.jsxs(d,{children:[e.jsx("strong",{children:"Displayed:"})," ",G.length]}),t.trim()&&e.jsxs(d,{children:[e.jsx("strong",{children:"Search Results:"})," ",r.length]})]}),he&&Qe&&(he.dietary_restrictions?.length>0||he.allergens?.length>0)&&e.jsxs(A,{spacing:2,children:[e.jsx(d,{fontSize:"sm",fontWeight:"medium",children:"Active Filters:"}),e.jsxs(Qt,{spacing:1,children:[he.dietary_restrictions?.slice(0,3).map(D=>e.jsx($t,{children:e.jsx(Rn,{size:"sm",colorScheme:"green",variant:"solid",children:e.jsx(ur,{children:D})})},D)),he.allergens?.slice(0,2).map(D=>e.jsx($t,{children:e.jsx(Rn,{size:"sm",colorScheme:"red",variant:"solid",children:e.jsxs(ur,{children:["No ",D]})})},D))]})]})]})]})}),e.jsxs(wc,{isOpen:Cn,placement:"bottom",onClose:At,children:[e.jsx(Te,{}),e.jsxs(Sc,{borderTopRadius:"xl",maxH:"80vh",children:[e.jsx(De,{}),e.jsx(Pe,{borderBottomWidth:"1px",pb:3,children:e.jsx(d,{fontWeight:"semibold",children:"Filter & Sort"})}),e.jsx(Le,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs($,{children:[e.jsx(V,{fontSize:"sm",children:"Sort by"}),e.jsxs(Be,{value:b,onChange:D=>v(D.target.value),size:"sm",children:[e.jsx("option",{value:"name",children:"Name"}),e.jsx("option",{value:"calories",children:"Calories"}),e.jsx("option",{value:"protein",children:"Protein"})]})]}),e.jsxs($,{children:[e.jsx(V,{fontSize:"sm",children:"Order"}),e.jsxs(Be,{value:_,onChange:D=>N(D.target.value),size:"sm",children:[e.jsx("option",{value:"asc",children:"Low to High"}),e.jsx("option",{value:"desc",children:"High to Low"})]})]}),he&&(he.dietary_restrictions?.length>0||he.allergens?.length>0)&&e.jsxs($,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(V,{htmlFor:"dietary-filter",mb:"0",fontSize:"sm",children:"Apply Dietary Filters"}),e.jsx(Ht,{id:"dietary-filter",isChecked:Qe,onChange:D=>Ye(D.target.checked),colorScheme:"green"})]}),he&&Qe&&(he.dietary_restrictions?.length>0||he.allergens?.length>0)&&e.jsxs(F,{children:[e.jsx(d,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Active Filters:"}),e.jsxs(Qt,{spacing:1,children:[he.dietary_restrictions?.map(D=>e.jsx($t,{children:e.jsx(Rn,{size:"sm",colorScheme:"green",variant:"solid",children:e.jsx(ur,{children:D})})},D)),he.allergens?.map(D=>e.jsx($t,{children:e.jsx(Rn,{size:"sm",colorScheme:"red",variant:"solid",children:e.jsxs(ur,{children:["No ",D]})})},D))]})]}),e.jsx(H,{colorScheme:"green",onClick:At,size:"sm",children:"Apply Filters"})]})})]})]}),l?e.jsx(Ot,{py:20,children:e.jsxs(S,{spacing:4,children:[e.jsx(ut,{size:"xl",color:"green.500"}),e.jsx(d,{color:"gray.600",fontSize:ye?"sm":"md",children:"Loading foods..."})]})}):e.jsx(F,{children:t.trim()?e.jsxs(S,{spacing:3,align:"stretch",children:[e.jsxs(d,{fontWeight:"medium",fontSize:"sm",color:"gray.600",px:2,children:['Search Results for "',t,'" (',r.length," found)"]}),r.length>0?e.jsx(xe,{columns:ye?1:{base:1,md:2,lg:3},spacing:ye?1:3,children:r.map(D=>ye?Ve(D):le(D))}):e.jsx(se,{children:e.jsxs(re,{textAlign:"center",py:8,children:[e.jsxs(d,{fontSize:ye?"sm":"lg",color:"gray.500",children:['No foods found for "',t,'"']}),e.jsx(d,{fontSize:ye?"xs":"sm",color:"gray.400",mt:1,children:"Try adjusting your search terms"})]})})]}):e.jsx(S,{spacing:3,align:"stretch",children:G.length>0?e.jsx(xe,{columns:ye?1:{base:1,md:2,lg:3},spacing:ye?1:4,children:G.map(D=>ye?Ve(D):le(D))}):e.jsx(se,{children:e.jsxs(re,{textAlign:"center",py:12,children:[e.jsx(d,{fontSize:ye?"sm":"lg",color:"gray.500",children:"No foods found"}),e.jsx(d,{fontSize:ye?"xs":"sm",color:"gray.400",mt:2,children:"Try adjusting your filter or add some foods to get started"})]})})})}),ye&&(u>1||g)&&e.jsxs(A,{justify:"center",spacing:4,py:4,children:[e.jsx(H,{size:"sm",variant:"outline",onClick:()=>Tt(u-1),isDisabled:u===1,leftIcon:e.jsx(Gx,{}),children:"Previous"}),e.jsxs(d,{fontSize:"sm",color:"gray.600",children:["Page ",u]}),e.jsx(H,{size:"sm",variant:"outline",onClick:()=>Tt(u+1),isDisabled:!g,rightIcon:e.jsx(Yx,{}),children:"Next"})]}),e.jsxs(Ue,{isOpen:R,onClose:I,size:ye?"full":"xl",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsx(Pe,{children:"Add New Food"}),e.jsx(De,{}),e.jsx(Le,{pb:6,children:e.jsxs(S,{spacing:4,children:[e.jsxs(A,{spacing:4,w:"full",children:[e.jsxs($,{isRequired:!0,children:[e.jsx(V,{children:"Food Name"}),e.jsx(ve,{value:ce.name,onChange:D=>ne({...ce,name:D.target.value}),placeholder:"e.g., Granny Smith Apple"})]}),e.jsxs($,{children:[e.jsx(V,{children:"Brand"}),e.jsx(ve,{value:ce.brand,onChange:D=>ne({...ce,brand:D.target.value}),placeholder:"e.g., Organic Valley"})]})]}),e.jsxs(A,{spacing:4,w:"full",children:[e.jsxs($,{isRequired:!0,children:[e.jsx(V,{children:"Serving Size"}),e.jsx(ue,{value:ce.serving_size,onChange:(D,ge)=>ne({...ce,serving_size:ge||1}),min:.01,step:.01,precision:2,children:e.jsx(de,{})})]}),e.jsxs($,{isRequired:!0,children:[e.jsx(V,{children:"Serving Unit"}),e.jsx(Be,{value:ce.serving_unit,onChange:D=>ne({...ce,serving_unit:D.target.value}),placeholder:"Select serving unit",children:oc.map(D=>e.jsx("option",{value:D,children:D},D))})]})]}),e.jsx(me,{size:"sm",alignSelf:"start",children:"Nutrition Facts"}),e.jsxs(xe,{columns:2,spacing:4,w:"full",children:[e.jsxs($,{children:[e.jsx(V,{children:"Calories"}),e.jsx(ue,{value:ce.nutrition.calories,onChange:(D,ge)=>ne({...ce,nutrition:{...ce.nutrition,calories:ge||0}}),min:0,children:e.jsx(de,{})})]}),e.jsxs($,{children:[e.jsx(V,{children:"Protein (g)"}),e.jsx(ue,{value:ce.nutrition.protein,onChange:(D,ge)=>ne({...ce,nutrition:{...ce.nutrition,protein:ge||0}}),min:0,step:.1,children:e.jsx(de,{})})]}),e.jsxs($,{children:[e.jsx(V,{children:"Carbs (g)"}),e.jsx(ue,{value:ce.nutrition.carbs,onChange:(D,ge)=>ne({...ce,nutrition:{...ce.nutrition,carbs:ge||0}}),min:0,step:.1,children:e.jsx(de,{})})]}),e.jsxs($,{children:[e.jsx(V,{children:"Fat (g)"}),e.jsx(ue,{value:ce.nutrition.fat,onChange:(D,ge)=>ne({...ce,nutrition:{...ce.nutrition,fat:ge||0}}),min:0,step:.1,children:e.jsx(de,{})})]}),e.jsxs($,{children:[e.jsx(V,{children:"Fiber (g)"}),e.jsx(ue,{value:ce.nutrition.fiber,onChange:(D,ge)=>ne({...ce,nutrition:{...ce.nutrition,fiber:ge||0}}),min:0,step:.1,children:e.jsx(de,{})})]}),e.jsxs($,{children:[e.jsx(V,{children:"Sugar (g)"}),e.jsx(ue,{value:ce.nutrition.sugar,onChange:(D,ge)=>ne({...ce,nutrition:{...ce.nutrition,sugar:ge||0}}),min:0,step:.1,children:e.jsx(de,{})})]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Sodium (mg)"}),e.jsx(ue,{value:ce.nutrition.sodium,onChange:(D,ge)=>ne({...ce,nutrition:{...ce.nutrition,sodium:ge||0}}),min:0,children:e.jsx(de,{})})]}),e.jsxs($,{children:[e.jsx(V,{children:"Notes (optional)"}),e.jsx(Kt,{value:ce.notes,onChange:D=>ne({...ce,notes:D.target.value}),placeholder:"Any additional information..."})]}),e.jsx(H,{colorScheme:"green",onClick:Un,w:"full",children:"Add Food"})]})})]})]}),e.jsxs(Ue,{isOpen:w,onClose:M,size:ye?"full":"lg",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsxs(Pe,{children:["Log Food: ",pe?.name]}),e.jsx(De,{}),e.jsx(Le,{pb:6,children:pe&&e.jsxs(S,{spacing:6,children:[e.jsx(se,{w:"full",bg:"gray.50",children:e.jsx(re,{children:e.jsxs(S,{spacing:3,children:[e.jsx(me,{size:"sm",children:"Food Information"}),e.jsxs(d,{fontSize:"sm",color:"gray.600",children:["Per ",pe.serving_size," ",pe.serving_unit]}),e.jsxs(xe,{columns:2,spacing:2,w:"full",children:[e.jsxs(d,{fontSize:"sm",children:[e.jsx("strong",{children:"Calories:"})," ",Math.round(pe.nutrition.calories)]}),e.jsxs(d,{fontSize:"sm",children:[e.jsx("strong",{children:"Protein:"})," ",pe.nutrition.protein,"g"]}),e.jsxs(d,{fontSize:"sm",children:[e.jsx("strong",{children:"Carbs:"})," ",pe.nutrition.carbs,"g"]}),e.jsxs(d,{fontSize:"sm",children:[e.jsx("strong",{children:"Fat:"})," ",pe.nutrition.fat,"g"]})]})]})})}),e.jsxs(S,{spacing:4,w:"full",children:[e.jsxs(A,{spacing:4,w:"full",children:[e.jsxs($,{children:[e.jsx(V,{children:"Meal Type"}),e.jsxs(Be,{value:f.meal_type,onChange:D=>W({...f,meal_type:D.target.value}),children:[e.jsx("option",{value:"breakfast",children:"Breakfast"}),e.jsx("option",{value:"lunch",children:"Lunch"}),e.jsx("option",{value:"dinner",children:"Dinner"}),e.jsx("option",{value:"snack",children:"Snack"})]})]}),e.jsx(Yo,{quantity:f.servings,unit:f.unit,onQuantityChange:D=>En(D,f.unit),onUnitChange:D=>En(f.servings,D),label:"Quantity & Unit"})]}),e.jsx(se,{w:"full",bg:"green.50",borderColor:"green.200",borderWidth:1,children:e.jsx(re,{children:e.jsxs(S,{spacing:3,children:[e.jsxs(me,{size:"sm",color:"green.700",children:["Total Nutrition (",f.servings," ",f.unit,")"]}),e.jsxs(xe,{columns:2,spacing:2,w:"full",children:[e.jsxs(d,{fontSize:"sm",color:"green.700",children:[e.jsx("strong",{children:"Calories:"})," ",Math.round(te?.calories||pe.nutrition.calories*f.servings)]}),e.jsxs(d,{fontSize:"sm",color:"green.700",children:[e.jsx("strong",{children:"Protein:"})," ",(te?.protein||pe.nutrition.protein*f.servings).toFixed(1),"g"]}),e.jsxs(d,{fontSize:"sm",color:"green.700",children:[e.jsx("strong",{children:"Carbs:"})," ",(te?.carbs||pe.nutrition.carbs*f.servings).toFixed(1),"g"]}),e.jsxs(d,{fontSize:"sm",color:"green.700",children:[e.jsx("strong",{children:"Fat:"})," ",(te?.fat||pe.nutrition.fat*f.servings).toFixed(1),"g"]})]})]})})}),e.jsxs($,{children:[e.jsx(V,{children:"Notes (optional)"}),e.jsx(Kt,{value:f.notes,onChange:D=>W({...f,notes:D.target.value}),placeholder:"Any additional notes about this meal..."})]}),e.jsx(H,{colorScheme:"green",onClick:L,w:"full",size:"lg",children:"Log Food"})]})]})})]})]}),e.jsxs(Ue,{isOpen:k,onClose:O,size:ye?"full":"xl",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsx(Pe,{children:"Scan Nutrition Label"}),e.jsx(De,{}),e.jsx(Le,{pb:6,children:e.jsx($w,{onScanComplete:at,onCreateFood:nn,showCreateButton:!0,className:"w-full"})})]})]}),e.jsxs(Ue,{isOpen:B,onClose:ae,size:ye?"full":"xl",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsxs(Pe,{children:["Edit Food: ",ee?.name]}),e.jsx(De,{}),e.jsx(Le,{pb:6,children:ee&&e.jsxs(S,{spacing:4,children:[e.jsxs(A,{spacing:4,w:"full",children:[e.jsxs($,{isRequired:!0,children:[e.jsx(V,{children:"Food Name"}),e.jsx(ve,{value:ee.name,onChange:D=>Ie({...ee,name:D.target.value}),placeholder:"e.g., Granny Smith Apple"})]}),e.jsxs($,{children:[e.jsx(V,{children:"Brand"}),e.jsx(ve,{value:ee.brand||"",onChange:D=>Ie({...ee,brand:D.target.value}),placeholder:"e.g., Organic Valley"})]})]}),e.jsx(A,{spacing:4,w:"full",children:e.jsxs($,{children:[e.jsx(V,{children:"Source"}),e.jsx(ve,{value:ee.source||"",onChange:D=>Ie({...ee,source:D.target.value}),placeholder:"e.g., USDA, Custom"})]})}),e.jsxs(A,{spacing:4,w:"full",children:[e.jsxs($,{isRequired:!0,children:[e.jsx(V,{children:"Serving Size"}),e.jsx(ue,{value:ee.serving_size,onChange:(D,ge)=>Ie({...ee,serving_size:ge||1}),min:.01,step:.01,precision:2,children:e.jsx(de,{})})]}),e.jsxs($,{isRequired:!0,children:[e.jsx(V,{children:"Serving Unit"}),e.jsx(Be,{value:ee.serving_unit,onChange:D=>Ie({...ee,serving_unit:D.target.value}),placeholder:"Select serving unit",children:oc.map(D=>e.jsx("option",{value:D,children:D},D))})]})]}),e.jsx(me,{size:"sm",alignSelf:"start",children:"Nutrition Facts"}),e.jsxs(xe,{columns:2,spacing:4,w:"full",children:[e.jsxs($,{children:[e.jsx(V,{children:"Calories"}),e.jsx(ue,{value:ee.nutrition.calories,onChange:(D,ge)=>Ie({...ee,nutrition:{...ee.nutrition,calories:ge||0}}),min:0,children:e.jsx(de,{})})]}),e.jsxs($,{children:[e.jsx(V,{children:"Protein (g)"}),e.jsx(ue,{value:ee.nutrition.protein,onChange:(D,ge)=>Ie({...ee,nutrition:{...ee.nutrition,protein:ge||0}}),min:0,step:.1,children:e.jsx(de,{})})]}),e.jsxs($,{children:[e.jsx(V,{children:"Carbs (g)"}),e.jsx(ue,{value:ee.nutrition.carbs,onChange:(D,ge)=>Ie({...ee,nutrition:{...ee.nutrition,carbs:ge||0}}),min:0,step:.1,children:e.jsx(de,{})})]}),e.jsxs($,{children:[e.jsx(V,{children:"Fat (g)"}),e.jsx(ue,{value:ee.nutrition.fat,onChange:(D,ge)=>Ie({...ee,nutrition:{...ee.nutrition,fat:ge||0}}),min:0,step:.1,children:e.jsx(de,{})})]}),e.jsxs($,{children:[e.jsx(V,{children:"Fiber (g)"}),e.jsx(ue,{value:ee.nutrition.fiber,onChange:(D,ge)=>Ie({...ee,nutrition:{...ee.nutrition,fiber:ge||0}}),min:0,step:.1,children:e.jsx(de,{})})]}),e.jsxs($,{children:[e.jsx(V,{children:"Sugar (g)"}),e.jsx(ue,{value:ee.nutrition.sugar,onChange:(D,ge)=>Ie({...ee,nutrition:{...ee.nutrition,sugar:ge||0}}),min:0,step:.1,children:e.jsx(de,{})})]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Sodium (mg)"}),e.jsx(ue,{value:ee.nutrition.sodium,onChange:(D,ge)=>Ie({...ee,nutrition:{...ee.nutrition,sodium:ge||0}}),min:0,children:e.jsx(de,{})})]}),ye&&he&&(he.dietary_restrictions?.length>0||he.allergens?.length>0)&&e.jsxs(F,{w:"full",borderWidth:"1px",borderRadius:"md",p:3,bg:"gray.50",children:[e.jsx(me,{size:"xs",mb:2,children:"Dietary Information"}),e.jsx(ac,{food:ee,userProfile:he})]}),e.jsxs(A,{spacing:3,w:"full",pt:4,children:[e.jsx(H,{colorScheme:"blue",onClick:x,flex:1,children:"Update Food"}),e.jsx(H,{colorScheme:"red",variant:"outline",onClick:T,children:"Delete"})]})]})})]})]}),e.jsxs(Ue,{isOpen:z,onClose:Ne,size:ye?"full":"xl",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsx(Pe,{children:"Dietary Profile Builder"}),e.jsx(De,{}),e.jsx(Le,{pb:6,children:e.jsx(Gw,{currentProfile:he,onProfileUpdate:D=>{dt(D),Ne(),q({title:"Preferences Updated",description:"Your dietary preferences have been updated.",status:"success",duration:3e3,isClosable:!0})}})})]})]})]})})})}const Ns="meal_suggestions_cache",uc="meal_suggestions_filters";function dc(){const[t,n]=C.useState([]),[r,i]=C.useState(!1),[s,o]=C.useState({}),[a,l]=C.useState({meal_type:"lunch",max_calories:500,dietary_restrictions:"",cuisine_preference:"",prep_time_preference:"",main_ingredients:"",use_food_index_only:!1,special_requests:""}),[c,u]=C.useState(null),[h,g]=C.useState(null),{isOpen:m,onOpen:p,onClose:j}=Fe(),b=wt(),v=Wt({base:!0,md:!1});C.useEffect(()=>{const P=localStorage.getItem(Ns),M=localStorage.getItem(uc);if(P)try{const k=JSON.parse(P);n(k)}catch(k){console.error("Error parsing cached suggestions:",k)}if(M)try{const k=JSON.parse(M);l(E=>({...E,...k}))}catch(k){console.error("Error parsing cached filters:",k)}},[]);const _=P=>{u(P),g({...P}),p()},N=P=>{o(M=>({...M,[P]:!M[P]}))},R=()=>{if(h&&c){const P=t.map(M=>M===c?h:M);n(P),localStorage.setItem(Ns,JSON.stringify(P)),b({title:"Suggestion Updated",description:"Your meal suggestion has been updated successfully.",status:"success",duration:3e3,isClosable:!0}),j()}},U=(P,M,k)=>{if(h){const E=[...h.ingredients];E[P]={...E[P],[M]:k},g({...h,ingredients:E})}},I=async()=>{i(!0);try{const P={meal_type:a.meal_type,remaining_calories:a.max_calories,dietary_preferences:a.dietary_restrictions?[a.dietary_restrictions]:[],allergies:[]};a.cuisine_preference&&(P.cuisine_preference=a.cuisine_preference),a.prep_time_preference&&(P.prep_time_preference=a.prep_time_preference),a.main_ingredients.trim()&&(P.main_ingredients=a.main_ingredients.split(",").map(E=>E.trim()).filter(E=>E.length>0).slice(0,3)),a.use_food_index_only&&(P.use_food_index_only=!0),a.special_requests.trim()&&(P.special_requests=a.special_requests.trim());const k=(await Z.post("/ai/meal-suggestions",P)).data.suggestions||[];n(k),localStorage.setItem(Ns,JSON.stringify(k)),localStorage.setItem(uc,JSON.stringify(a))}catch(P){console.error("Error getting meal suggestions:",P),b({title:"Suggestion Error",description:"Failed to get meal suggestions. Please try again.",status:"error",duration:3e3,isClosable:!0})}i(!1)},w=P=>{if(!P)return"Not specified";if(P<60)return`${P} minutes`;const M=Math.floor(P/60),k=P%60;return k>0?`${M}h ${k}m`:`${M} hour${M>1?"s":""}`};return e.jsx(F,{minH:"100vh",bg:"linear-gradient(135deg, #f6f9fc 0%, #e9f4f9 100%)",children:e.jsxs(It,{maxW:"container.xl",py:8,children:[e.jsxs(S,{spacing:8,align:"stretch",children:[e.jsxs(F,{children:[e.jsx(me,{size:"lg",mb:2,children:"Meal Suggestions 💡"}),e.jsx(d,{color:"gray.600",children:"Get AI-powered meal suggestions based on your preferences and goals"})]}),e.jsx(se,{bg:"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(249,252,255,0.98) 100%)",border:"1px solid",borderColor:"rgba(79, 172, 254, 0.15)",boxShadow:"0 4px 12px rgba(79, 172, 254, 0.08)",children:e.jsx(re,{children:e.jsxs(S,{spacing:4,children:[e.jsx(me,{size:"sm",alignSelf:"start",children:"Customize Your Suggestions"}),e.jsxs(xe,{columns:{base:1,md:2,lg:3},spacing:4,w:"full",children:[e.jsxs(F,{children:[e.jsx(d,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Meal Type"}),e.jsxs(Be,{value:a.meal_type,onChange:P=>l({...a,meal_type:P.target.value}),children:[e.jsx("option",{value:"breakfast",children:"Breakfast"}),e.jsx("option",{value:"lunch",children:"Lunch"}),e.jsx("option",{value:"dinner",children:"Dinner"}),e.jsx("option",{value:"snack",children:"Snack"})]})]}),e.jsxs(F,{children:[e.jsx(d,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Max Calories"}),e.jsx(ue,{value:a.max_calories,onChange:(P,M)=>l({...a,max_calories:M||500}),min:100,max:2e3,step:50,children:e.jsx(de,{})})]}),e.jsxs(F,{children:[e.jsx(d,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Dietary Preference"}),e.jsxs(Be,{value:a.dietary_restrictions,onChange:P=>l({...a,dietary_restrictions:P.target.value}),children:[e.jsx("option",{value:"",children:"Any"}),e.jsx("option",{value:"vegetarian",children:"Vegetarian"}),e.jsx("option",{value:"vegan",children:"Vegan"}),e.jsx("option",{value:"keto",children:"Keto"}),e.jsx("option",{value:"paleo",children:"Paleo"}),e.jsx("option",{value:"gluten-free",children:"Gluten-Free"}),e.jsx("option",{value:"dairy-free",children:"Dairy-Free"})]})]}),e.jsxs(F,{children:[e.jsx(d,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Cuisine Type"}),e.jsxs(Be,{value:a.cuisine_preference,onChange:P=>l({...a,cuisine_preference:P.target.value}),children:[e.jsx("option",{value:"",children:"Any"}),e.jsx("option",{value:"mediterranean",children:"Mediterranean"}),e.jsx("option",{value:"asian",children:"Asian"}),e.jsx("option",{value:"mexican",children:"Mexican"}),e.jsx("option",{value:"italian",children:"Italian"}),e.jsx("option",{value:"american",children:"American"}),e.jsx("option",{value:"indian",children:"Indian"})]})]}),e.jsxs(F,{children:[e.jsx(d,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Prep Time"}),e.jsxs(Be,{value:a.prep_time_preference,onChange:P=>l({...a,prep_time_preference:P.target.value}),children:[e.jsx("option",{value:"",children:"Any"}),e.jsx("option",{value:"quick",children:"Quick (≤15 min)"}),e.jsx("option",{value:"moderate",children:"Moderate (15-45 min)"}),e.jsx("option",{value:"complex",children:"Complex (45+ min)"})]})]}),e.jsxs(F,{children:[e.jsx(d,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Main Ingredients"}),e.jsx(ve,{placeholder:"e.g., chicken, vegetables, rice (max 3)",value:a.main_ingredients,onChange:P=>l({...a,main_ingredients:P.target.value})}),e.jsx(d,{fontSize:"xs",color:"gray.500",mt:1,children:"Separate with commas. Suggestions will feature these prominently."})]})]}),e.jsxs(F,{children:[e.jsx(d,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Special Requests"}),e.jsx(Kt,{placeholder:"Any special preferences, cooking methods, dietary needs, or custom instructions...",value:a.special_requests,onChange:P=>l({...a,special_requests:P.target.value}),rows:3,resize:"vertical"}),e.jsx(d,{fontSize:"xs",color:"gray.500",mt:1,children:'Provide any custom instructions for your meal suggestions (e.g., "easy to meal prep", "uses minimal ingredients", "no dairy substitutes").'})]}),e.jsx(_t,{}),e.jsxs($,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(A,{spacing:2,children:[e.jsx(V,{htmlFor:"food-index-toggle",mb:"0",fontWeight:"medium",children:"Use only foods from my food index"}),e.jsx(jr,{label:"When enabled, AI will only suggest meals using foods you've already added to your food index. Basic pantry items (oil, salt, spices) are still assumed available.",fontSize:"sm",placement:"top",children:e.jsx(F,{display:"inline-flex",alignItems:"center",children:e.jsx(Gr,{color:"gray.400",size:16})})})]}),e.jsx(Ht,{id:"food-index-toggle",isChecked:a.use_food_index_only,onChange:P=>l({...a,use_food_index_only:P.target.checked}),colorScheme:"green"})]}),e.jsx(H,{colorScheme:"green",onClick:I,isLoading:r,loadingText:"Getting suggestions...",alignSelf:"center",size:"lg",children:"Get Meal Suggestions"})]})})}),r&&e.jsx(xe,{columns:{base:1,md:2},spacing:6,children:[1,2,3,4].map(P=>e.jsx(se,{children:e.jsx(re,{children:e.jsxs(S,{align:"start",spacing:3,children:[e.jsx(ui,{height:"20px",width:"70%"}),e.jsx(ui,{height:"60px",width:"100%"}),e.jsx(ui,{height:"15px",width:"40%"}),e.jsx(ui,{height:"80px",width:"100%"})]})})},P))}),!r&&t.length>0&&e.jsxs(F,{children:[e.jsxs(me,{size:"md",mb:4,children:["Suggested Meals (",t.length,")"]}),e.jsx(xe,{columns:{base:1,md:2},spacing:v?3:6,children:t.map((P,M)=>e.jsx(se,{_hover:{boxShadow:"0 8px 20px rgba(79, 172, 254, 0.15), 0 2px 8px rgba(79, 172, 254, 0.08)",transform:"translateY(-2px)"},transition:"all 0.2s ease",bg:"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(249,252,255,0.98) 100%)",border:"1px solid",borderColor:"rgba(79, 172, 254, 0.15)",children:e.jsx(re,{p:v?3:6,children:e.jsxs(S,{align:"start",spacing:v?3:4,children:[e.jsxs(F,{w:"full",children:[e.jsxs(A,{justify:"space-between",mb:2,children:[e.jsx(me,{size:v?"sm":"md",children:P.name}),e.jsxs(A,{spacing:2,children:[P.prep_time&&e.jsx(je,{colorScheme:"blue",fontSize:v?"xs":"sm",children:w(P.prep_time)}),v&&e.jsx(et,{"aria-label":s[M]?"Expand meal details":"Collapse meal details",icon:s[M]?e.jsx(Vo,{}):e.jsx(qo,{}),size:"sm",variant:"ghost",onClick:()=>N(M)})]})]}),e.jsx(d,{color:"gray.600",fontSize:"sm",noOfLines:v?2:void 0,children:P.description})]}),e.jsxs(F,{w:"full",children:[e.jsx(d,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Nutrition (estimated)"}),e.jsxs(xe,{columns:v?4:2,spacing:2,children:[e.jsxs(d,{fontSize:v?"xs":"sm",children:[e.jsx("strong",{children:Math.round(P.nutrition.calories||0)})," cal"]}),e.jsxs(d,{fontSize:v?"xs":"sm",children:[e.jsxs("strong",{children:[Math.round(P.nutrition.protein||0),"g"]})," protein"]}),e.jsxs(d,{fontSize:v?"xs":"sm",children:[e.jsxs("strong",{children:[Math.round(P.nutrition.carbs||0),"g"]})," carbs"]}),e.jsxs(d,{fontSize:v?"xs":"sm",children:[e.jsxs("strong",{children:[Math.round(P.nutrition.fat||0),"g"]})," fat"]})]})]}),e.jsx(To,{in:!v||!s[M],animateOpacity:!0,children:e.jsxs(S,{align:"start",spacing:v?3:4,w:"full",children:[e.jsxs(F,{w:"full",children:[e.jsx(d,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Ingredients"}),e.jsx(S,{align:"start",spacing:1,children:P.ingredients.map((k,E)=>e.jsxs(d,{fontSize:v?"xs":"sm",color:"gray.700",children:["• ",k.amount," ",k.unit," ",k.name]},E))})]}),P.instructions&&P.instructions.length>0&&e.jsxs(F,{w:"full",children:[e.jsx(d,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Instructions"}),e.jsx(S,{align:"start",spacing:1,children:P.instructions.map((k,E)=>e.jsxs(d,{fontSize:v?"xs":"sm",color:"gray.700",children:[E+1,". ",k]},E))})]})]})}),e.jsx(_t,{}),e.jsxs(A,{w:"full",spacing:2,flexWrap:v?"wrap":"nowrap",children:[e.jsxs(H,{size:v?"xs":"sm",colorScheme:"blue",onClick:()=>_(P),flex:v?0:1,children:[e.jsx(Gr,{style:{marginRight:"4px"}}),"More Info"]}),e.jsx(H,{size:v?"xs":"sm",colorScheme:"green",flex:1,children:"Add to Meal Plan"}),e.jsx(H,{size:v?"xs":"sm",variant:"outline",flex:1,children:"Log This Meal"})]})]})})},M))})]}),!r&&t.length===0&&e.jsx(se,{bg:"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(249,252,255,0.98) 100%)",border:"1px solid",borderColor:"rgba(79, 172, 254, 0.15)",boxShadow:"0 4px 12px rgba(79, 172, 254, 0.08)",children:e.jsxs(re,{textAlign:"center",py:12,children:[e.jsx(d,{fontSize:"lg",color:"gray.500",children:"No meal suggestions yet"}),e.jsx(d,{fontSize:"sm",color:"gray.400",mt:2,children:'Customize your preferences above and click "Get Meal Suggestions"'})]})})]}),e.jsxs(Ue,{isOpen:m,onClose:j,size:"6xl",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsxs(Pe,{children:["Edit Meal Suggestion: ",h?.name]}),e.jsx(De,{}),e.jsx(Le,{children:h&&e.jsxs(S,{spacing:6,align:"stretch",children:[e.jsxs(xe,{columns:{base:1,md:2},spacing:4,children:[e.jsxs($,{children:[e.jsx(V,{children:"Meal Name"}),e.jsx(ve,{value:h.name,onChange:P=>g({...h,name:P.target.value})})]}),e.jsxs($,{children:[e.jsx(V,{children:"Prep Time (minutes)"}),e.jsx(ue,{value:h.prep_time||0,onChange:(P,M)=>g({...h,prep_time:M}),min:0,children:e.jsx(de,{})})]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Description"}),e.jsx(Kt,{value:h.description,onChange:P=>g({...h,description:P.target.value}),rows:3})]}),e.jsxs(F,{children:[e.jsx(d,{fontSize:"lg",fontWeight:"bold",mb:3,children:"Nutrition Information"}),e.jsx(xe,{columns:{base:2,md:4},spacing:4,children:["calories","protein","carbs","fat"].map(P=>e.jsxs(be,{size:"sm",children:[e.jsx(we,{textTransform:"capitalize",children:P}),e.jsx(Se,{children:e.jsx(ue,{value:h.nutrition[P]||0,onChange:(M,k)=>g({...h,nutrition:{...h.nutrition,[P]:k||0}}),min:0,size:"sm",children:e.jsx(de,{})})})]},P))})]}),e.jsxs(F,{children:[e.jsx(d,{fontSize:"lg",fontWeight:"bold",mb:3,children:"Ingredients"}),e.jsx(Xd,{children:e.jsxs(Zd,{size:"sm",children:[e.jsx(eh,{children:e.jsxs(ha,{children:[e.jsx(Hn,{children:"Ingredient"}),e.jsx(Hn,{children:"Amount"}),e.jsx(Hn,{children:"Unit"}),e.jsx(Hn,{children:"Calories"}),e.jsx(Hn,{children:"Protein (g)"}),e.jsx(Hn,{children:"Carbs (g)"}),e.jsx(Hn,{children:"Fat (g)"})]})}),e.jsx(th,{children:h.ingredients.map((P,M)=>e.jsxs(ha,{children:[e.jsx($n,{children:e.jsx(ve,{value:P.name,onChange:k=>U(M,"name",k.target.value),size:"sm"})}),e.jsx($n,{children:e.jsx(ue,{value:P.amount,onChange:(k,E)=>U(M,"amount",E||0),min:0,size:"sm",children:e.jsx(de,{})})}),e.jsx($n,{children:e.jsx(ve,{value:P.unit,onChange:k=>U(M,"unit",k.target.value),size:"sm"})}),e.jsx($n,{children:e.jsx(ue,{value:P.calories||0,onChange:(k,E)=>U(M,"calories",E||0),min:0,size:"sm",children:e.jsx(de,{})})}),e.jsx($n,{children:e.jsx(ue,{value:P.protein||0,onChange:(k,E)=>U(M,"protein",E||0),min:0,size:"sm",precision:1,children:e.jsx(de,{})})}),e.jsx($n,{children:e.jsx(ue,{value:P.carbs||0,onChange:(k,E)=>U(M,"carbs",E||0),min:0,size:"sm",precision:1,children:e.jsx(de,{})})}),e.jsx($n,{children:e.jsx(ue,{value:P.fat||0,onChange:(k,E)=>U(M,"fat",E||0),min:0,size:"sm",precision:1,children:e.jsx(de,{})})})]},M))})]})})]}),e.jsxs(F,{children:[e.jsx(d,{fontSize:"lg",fontWeight:"bold",mb:3,children:"Instructions"}),e.jsx(S,{spacing:2,align:"stretch",children:h.instructions?.map((P,M)=>e.jsxs(A,{children:[e.jsxs(d,{minW:"20px",fontSize:"sm",fontWeight:"bold",children:[M+1,"."]}),e.jsx(Kt,{value:P,onChange:k=>{const E=[...h.instructions||[]];E[M]=k.target.value,g({...h,instructions:E})},size:"sm",rows:2})]},M))})]})]})}),e.jsxs(mt,{children:[e.jsx(H,{variant:"ghost",mr:3,onClick:j,children:"Cancel"}),e.jsxs(H,{colorScheme:"blue",onClick:R,children:[e.jsx(Vi,{style:{marginRight:"8px"}}),"Save Changes"]})]})]})]})]})})}function Qi(t){return Ce({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"},child:[]}]})(t)}function hc(t){return Ce({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"},child:[]}]})(t)}function gc(t){return Ce({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"},child:[]},{tag:"path",attr:{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},child:[]}]})(t)}function Kw(t){return Ce({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49A1.003 1.003 0 0 0 20 4H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"},child:[]}]})(t)}function Ws(t){return Ce({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M17 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"},child:[]}]})(t)}function Bs(t){return Ce({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"},child:[]}]})(t)}function Jw(t){return Ce({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M11 9H9V2H7v7H5V2H3v7c0 2.12 1.66 3.84 3.75 3.97V22h2.5v-9.03C11.34 12.84 13 11.12 13 9V2h-2v7zm5-3v8h2.5v8H21V2c-2.76 0-5 2.24-5 4z"},child:[]}]})(t)}function Us(t){return Ce({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"},child:[]}]})(t)}function Qw(t){return Ce({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M17.65 6.35A7.958 7.958 0 0 0 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0 1 12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"},child:[]}]})(t)}function Xw({shoppingList:t,onUpdate:n,onRefresh:r,isLoading:i}){const[s,o]=C.useState({}),[a,l]=C.useState(null),[c,u]=C.useState(!1),[h,g]=C.useState(t.notes||""),[m,p]=C.useState(!1),{isOpen:j,onOpen:b,onClose:v}=Fe(),_=wt(),N=Wt({base:!0,lg:!1}),R=_e("white","gray.800"),U=_e("gray.200","gray.600");C.useEffect(()=>{const X=async()=>{const f=[...t.items];let W=!1;for(let te=0;te<f.length;te++){const y=f[te];if(y.food_id&&!y.nutrition)try{const ee=await Z.get(`/foods/${y.food_id}/nutrition`,{params:{amount:y.amount,unit:y.unit}});f[te]={...y,nutrition:ee.data.nutrition,in_food_index:!0},W=!0}catch(ee){console.warn(`Could not load nutrition for ${y.name}:`,ee)}}W&&n({...t,items:f})};t.items?.length>0&&X()},[t.shopping_list_id]);const I=t.items?.filter(X=>X.is_checked).length||0,w=t.items?.length||0,P=w>0?I/w*100:0,M=(X,f,W)=>{const te={g:1,kg:1e3,oz:28.3495,lb:453.592},y={ml:1,l:1e3,cup:236.588,tbsp:14.7868,tsp:4.92892};return f===W?X:te[f]&&te[W]?X*te[f]/te[W]:y[f]&&y[W]?X*y[f]/y[W]:X},k=async(X,f)=>{try{await Z.patch(`/meal-planning/shopping-lists/${t.shopping_list_id}/items/${X}`,{is_checked:f});const W=t.items.map(te=>te.item_id===X?{...te,is_checked:f}:te);n({...t,items:W,updated_at:new Date().toISOString()})}catch(W){console.error("Error updating item:",W),_({title:"Error",description:"Failed to update item status",status:"error",duration:3e3,isClosable:!0})}},E=X=>{X.item_id&&o(f=>({...f,[X.item_id]:{...X}}))},O=X=>{o(f=>{const W={...f};return delete W[X],W})},B=async(X,f,W)=>{const te=t.items.find(y=>y.item_id===X);if(!(!te||!te.food_id))try{const y=await Z.get(`/foods/${te.food_id}/nutrition`,{params:{amount:f,unit:W}});o(ee=>({...ee,[X]:{...ee[X],nutrition:y.data.nutrition}}))}catch(y){console.warn("Could not fetch real-time nutrition:",y)}},J=(X,f)=>{o(te=>({...te,[X]:{...te[X],amount:f}}));const W=s[X];W&&B(X,f,W.unit)},ae=(X,f)=>{const W=s[X];if(!W)return;const te=M(W.amount,W.unit,f);o(y=>({...y,[X]:{...y[X],unit:f,amount:Math.round(te*10)/10}})),B(X,te,f)},q=async X=>{const f=s[X];if(f)try{p(!0),await Z.patch(`/meal-planning/shopping-lists/${t.shopping_list_id}/items/${X}`,{amount:f.amount,unit:f.unit,notes:f.notes});const W=t.items.map(te=>te.item_id===X?{...te,amount:f.amount,unit:f.unit,notes:f.notes,nutrition:f.nutrition}:te);n({...t,items:W,updated_at:new Date().toISOString()}),O(X),_({title:"Success",description:"Item updated successfully",status:"success",duration:3e3,isClosable:!0})}catch(W){console.error("Error saving item edit:",W),_({title:"Error",description:"Failed to save changes",status:"error",duration:3e3,isClosable:!0})}finally{p(!1)}},oe=async()=>{try{p(!0),await Z.put(`/meal-planning/shopping-lists/${t.shopping_list_id}`,{items:t.items,notes:h}),n({...t,notes:h,updated_at:new Date().toISOString()}),u(!1),_({title:"Success",description:"Shopping list saved successfully",status:"success",duration:3e3,isClosable:!0})}catch(X){console.error("Error saving list:",X),_({title:"Error",description:"Failed to save shopping list",status:"error",duration:3e3,isClosable:!0})}finally{p(!1)}},fe=async X=>{if(X.item_id)try{let f=null;if(X.food_id)try{const W=await Z.get(`/foods/${X.food_id}/nutrition`,{params:{amount:X.amount,unit:X.unit}});f={item_name:X.name,amount:X.amount,unit:X.unit,nutrition:W.data.nutrition,food_id:X.food_id,used_in_meals:X.used_in_meals}}catch(W){console.warn("Could not fetch food nutrition:",W)}if(!f)try{f=(await Z.get(`/meal-planning/shopping-lists/${t.shopping_list_id}/items/${X.item_id}/nutrition`)).data}catch(W){console.error("Error fetching nutrition:",W)}f?(l(f),b()):_({title:"No Nutrition Data",description:"Nutrition information is not available for this item",status:"warning",duration:3e3,isClosable:!0})}catch(f){console.error("Error fetching nutrition:",f),_({title:"Error",description:"Could not load nutrition information",status:"error",duration:3e3,isClosable:!0})}},pe=t.items?.reduce((X,f)=>{const W=f.category||"Other";return X[W]||(X[W]=[]),X[W].push(f),X},{})||{};return e.jsx(It,{maxW:"8xl",p:0,children:e.jsxs(S,{spacing:6,align:"stretch",children:[e.jsx(se,{bg:R,borderColor:U,borderWidth:1,children:e.jsx(vt,{children:e.jsxs(S,{align:"stretch",spacing:3,children:[e.jsxs(A,{justify:"space-between",children:[e.jsxs(S,{align:"start",spacing:0,children:[e.jsx(d,{fontSize:"xl",fontWeight:"bold",children:"Shopping List"}),e.jsxs(d,{fontSize:"sm",color:"gray.600",children:[I," of ",w," items completed"]})]}),e.jsxs(S,{align:"end",spacing:0,children:[e.jsxs(d,{fontSize:"lg",fontWeight:"bold",color:"green.600",children:["$",t.total_estimated_cost?.toFixed(2)||"0.00"]}),e.jsx(d,{fontSize:"xs",color:"gray.500",children:t.store_location})]})]}),e.jsx(xt,{value:P,colorScheme:P===100?"green":"blue",size:"sm",borderRadius:"md"}),e.jsxs(A,{spacing:2,children:[e.jsx(H,{leftIcon:e.jsx(Qw,{}),size:"sm",variant:"outline",onClick:r,isLoading:i,children:"Refresh Prices"}),e.jsx(H,{leftIcon:c?e.jsx(Ws,{}):e.jsx(Bs,{}),size:"sm",colorScheme:c?"green":"blue",onClick:c?oe:()=>u(!0),isLoading:m,children:c?"Save List":"Edit List"}),c&&e.jsx(H,{leftIcon:e.jsx(Us,{}),size:"sm",variant:"ghost",onClick:()=>{u(!1),g(t.notes||"")},children:"Cancel"})]})]})})}),c&&e.jsx(se,{bg:R,borderColor:U,borderWidth:1,children:e.jsx(re,{children:e.jsxs(S,{align:"stretch",spacing:3,children:[e.jsx(d,{fontWeight:"bold",children:"List Notes"}),e.jsx(Kt,{value:h,onChange:X=>g(X.target.value),placeholder:"Add notes about this shopping list...",size:"sm"})]})})}),e.jsx(S,{spacing:1,align:"stretch",children:Object.entries(pe).map(([X,f])=>e.jsxs(F,{borderWidth:1,borderColor:"blue.200",borderRadius:"md",overflow:"hidden",children:[e.jsx(F,{bg:"blue.100",px:4,py:3,borderBottom:"1px",borderBottomColor:"blue.200",children:e.jsxs(Fn,{align:"center",justify:"space-between",children:[e.jsx(d,{fontSize:"lg",fontWeight:"bold",color:"blue.700",children:X}),e.jsxs(je,{variant:"solid",colorScheme:"blue",children:[f.length," items"]})]})}),e.jsx(F,{bg:R,p:4,children:e.jsx(S,{spacing:3,align:"stretch",children:f.map((W,te)=>{const y=s[W.item_id||""];return e.jsx(se,{variant:"outline",size:N?"xs":"sm",children:e.jsx(re,{p:N?2:4,children:N?e.jsxs(S,{spacing:2,align:"stretch",children:[e.jsxs(A,{spacing:3,align:"start",children:[e.jsx(ft,{isChecked:W.is_checked||!1,onChange:ee=>k(W.item_id,ee.target.checked),colorScheme:"green",size:"md"}),e.jsxs(S,{align:"start",spacing:1,flex:1,minW:0,children:[e.jsxs(A,{spacing:2,wrap:"wrap",align:"center",w:"full",children:[e.jsx(d,{fontSize:"md",fontWeight:"bold",textDecoration:W.is_checked?"line-through":"none",color:W.is_checked?"gray.500":"inherit",noOfLines:1,flex:1,children:W.name}),W.estimated_price&&e.jsxs(je,{colorScheme:"green",variant:"solid",fontSize:"xs",children:["$",W.estimated_price.toFixed(2)]})]}),y?e.jsxs(A,{spacing:2,w:"full",children:[e.jsx(ve,{value:y.amount.toString(),onChange:ee=>{const Ie=ee.target.value===""?0:parseFloat(ee.target.value)||0;J(W.item_id,Ie)},size:"sm",width:"80px",type:"number",step:"0.1",min:"0"}),e.jsxs(Be,{value:y.unit,onChange:ee=>ae(W.item_id,ee.target.value),size:"sm",width:"100px",children:[e.jsx("option",{value:"g",children:"g"}),e.jsx("option",{value:"kg",children:"kg"}),e.jsx("option",{value:"oz",children:"oz"}),e.jsx("option",{value:"lb",children:"lb"}),e.jsx("option",{value:"ml",children:"ml"}),e.jsx("option",{value:"l",children:"l"}),e.jsx("option",{value:"cup",children:"cups"}),e.jsx("option",{value:"tbsp",children:"tbsp"}),e.jsx("option",{value:"tsp",children:"tsp"}),e.jsx("option",{value:"piece",children:"pcs"}),e.jsx("option",{value:"serving",children:"srv"})]})]}):e.jsxs(d,{fontSize:"sm",color:"gray.600",fontWeight:"medium",children:[W.amount," ",W.unit]}),(y?y.nutrition:W.nutrition)&&e.jsxs(A,{spacing:2,fontSize:"xs",color:"gray.600",w:"full",bg:"gray.50",p:1,borderRadius:"md",children:[e.jsxs(d,{children:[e.jsx(d,{as:"span",fontWeight:"bold",children:Math.round((y?y.nutrition?.calories:W.nutrition?.calories)||0)}),"cal"]}),e.jsxs(d,{children:[e.jsxs(d,{as:"span",fontWeight:"bold",children:[Math.round((y?y.nutrition?.protein:W.nutrition?.protein)||0),"g"]}),"P"]}),e.jsxs(d,{children:[e.jsxs(d,{as:"span",fontWeight:"bold",children:[Math.round((y?y.nutrition?.carbs:W.nutrition?.carbs)||0),"g"]}),"C"]}),e.jsxs(d,{children:[e.jsxs(d,{as:"span",fontWeight:"bold",children:[Math.round((y?y.nutrition?.fat:W.nutrition?.fat)||0),"g"]}),"F"]})]}),e.jsxs(A,{spacing:1,wrap:"wrap",children:[W.is_checked&&e.jsx(je,{colorScheme:"green",size:"sm",children:e.jsx(Qi,{})}),W.food_id&&e.jsx(je,{colorScheme:"purple",size:"sm",children:"Food Index"}),W.used_in_meals&&W.used_in_meals.length>0&&e.jsxs(je,{size:"sm",colorScheme:"blue",variant:"subtle",children:[W.used_in_meals.length," meals"]})]})]}),e.jsx(S,{spacing:1,children:y?e.jsxs(e.Fragment,{children:[e.jsx(et,{icon:e.jsx(Ws,{}),size:"xs",colorScheme:"green",variant:"ghost",onClick:()=>q(W.item_id),isLoading:m,"aria-label":"Save"}),e.jsx(et,{icon:e.jsx(Us,{}),size:"xs",variant:"ghost",onClick:()=>O(W.item_id),"aria-label":"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsx(et,{icon:e.jsx(hc,{}),size:"xs",variant:"ghost",onClick:()=>fe(W),"aria-label":"Info"}),e.jsx(et,{icon:e.jsx(Bs,{}),size:"xs",variant:"ghost",onClick:()=>E(W),"aria-label":"Edit"})]})})]}),y&&e.jsx(ve,{value:y.notes||"",onChange:ee=>o(Ie=>({...Ie,[W.item_id]:{...Ie[W.item_id],notes:ee.target.value}})),placeholder:"Add notes...",size:"sm"}),!y&&W.notes&&e.jsx(d,{fontSize:"xs",color:"gray.500",fontStyle:"italic",children:W.notes})]}):e.jsxs(A,{spacing:4,align:"start",children:[e.jsx(ft,{isChecked:W.is_checked||!1,onChange:ee=>k(W.item_id,ee.target.checked),colorScheme:"green",size:"lg",mt:1}),e.jsxs(S,{align:"start",spacing:2,flex:1,children:[e.jsxs(A,{spacing:2,wrap:"wrap",align:"center",children:[e.jsx(d,{fontSize:"lg",fontWeight:"bold",textDecoration:W.is_checked?"line-through":"none",color:W.is_checked?"gray.500":"inherit",children:W.name}),W.is_checked&&e.jsx(je,{colorScheme:"green",size:"sm",children:e.jsx(Qi,{})}),W.food_id&&e.jsx(je,{colorScheme:"purple",size:"sm",children:"Food Index"}),W.estimated_price&&e.jsxs(je,{colorScheme:"green",variant:"solid",fontSize:"sm",children:["$",W.estimated_price.toFixed(2)]})]}),y?e.jsxs(A,{spacing:2,children:[e.jsx(ve,{value:y.amount.toString(),onChange:ee=>{const Ie=ee.target.value===""?0:parseFloat(ee.target.value)||0;J(W.item_id,Ie)},size:"sm",width:"100px",type:"number",step:"0.1",min:"0"}),e.jsxs(Be,{value:y.unit,onChange:ee=>ae(W.item_id,ee.target.value),size:"sm",width:"120px",children:[e.jsx("option",{value:"g",children:"grams (g)"}),e.jsx("option",{value:"kg",children:"kilograms (kg)"}),e.jsx("option",{value:"oz",children:"ounces (oz)"}),e.jsx("option",{value:"lb",children:"pounds (lb)"}),e.jsx("option",{value:"ml",children:"milliliters (ml)"}),e.jsx("option",{value:"l",children:"liters (l)"}),e.jsx("option",{value:"cup",children:"cups"}),e.jsx("option",{value:"tbsp",children:"tablespoons"}),e.jsx("option",{value:"tsp",children:"teaspoons"}),e.jsx("option",{value:"piece",children:"pieces"}),e.jsx("option",{value:"serving",children:"servings"})]})]}):e.jsxs(d,{fontSize:"md",color:"gray.600",fontWeight:"medium",children:[W.amount," ",W.unit]}),(y?y.nutrition:W.nutrition)&&e.jsxs(A,{spacing:4,fontSize:"sm",color:"gray.600",children:[e.jsxs(d,{children:[e.jsx("strong",{children:Math.round((y?y.nutrition?.calories:W.nutrition?.calories)||0)})," cal"]}),e.jsxs(d,{children:[e.jsxs("strong",{children:[Math.round((y?y.nutrition?.protein:W.nutrition?.protein)||0),"g"]})," protein"]}),e.jsxs(d,{children:[e.jsxs("strong",{children:[Math.round((y?y.nutrition?.carbs:W.nutrition?.carbs)||0),"g"]})," carbs"]}),e.jsxs(d,{children:[e.jsxs("strong",{children:[Math.round((y?y.nutrition?.fat:W.nutrition?.fat)||0),"g"]})," fat"]})]}),W.used_in_meals&&W.used_in_meals.length>0&&e.jsxs(A,{spacing:1,wrap:"wrap",children:[e.jsx(d,{fontSize:"sm",color:"blue.600",fontWeight:"medium",children:"Used in:"}),W.used_in_meals.map((ee,Ie)=>e.jsx(je,{size:"sm",colorScheme:"blue",variant:"subtle",children:ee},Ie))]}),y&&e.jsx(ve,{value:y.notes||"",onChange:ee=>o(Ie=>({...Ie,[W.item_id]:{...Ie[W.item_id],notes:ee.target.value}})),placeholder:"Add notes...",size:"sm"}),!y&&W.notes&&e.jsx(d,{fontSize:"sm",color:"gray.500",fontStyle:"italic",children:W.notes}),"                              "]}),e.jsxs(S,{align:"end",spacing:1,minW:"80px",children:[W.store_package_size&&e.jsxs(d,{fontSize:"xs",color:"gray.500",textAlign:"right",children:[W.store_package_size,": $",W.store_package_price?.toFixed(2)]}),e.jsx(A,{spacing:1,children:y?e.jsxs(e.Fragment,{children:[e.jsx(et,{icon:e.jsx(Ws,{}),size:"sm",colorScheme:"green",variant:"ghost",onClick:()=>q(W.item_id),isLoading:m,"aria-label":"Save changes"}),e.jsx(et,{icon:e.jsx(Us,{}),size:"sm",variant:"ghost",onClick:()=>O(W.item_id),"aria-label":"Cancel editing"})]}):e.jsxs(e.Fragment,{children:[e.jsx(jr,{label:"View nutrition info",children:e.jsx(et,{icon:e.jsx(hc,{}),size:"sm",variant:"ghost",onClick:()=>fe(W),"aria-label":"View nutrition"})}),e.jsx(jr,{label:"Edit item",children:e.jsx(et,{icon:e.jsx(Bs,{}),size:"sm",variant:"ghost",onClick:()=>E(W),"aria-label":"Edit item"})})]})})]})]})})},W.item_id||te)})})})]},X))}),e.jsxs(Ue,{isOpen:j,onClose:v,size:"md",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsx(Pe,{children:e.jsxs(S,{align:"start",spacing:1,children:[e.jsx(d,{children:"Nutrition Information"}),e.jsx(d,{fontSize:"sm",color:"gray.600",children:a?.item_name})]})}),e.jsx(De,{}),e.jsx(Le,{children:a?e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs(A,{justify:"space-between",children:[e.jsx(d,{fontWeight:"bold",children:"Amount:"}),e.jsxs(d,{children:[a.amount," ",a.unit]})]}),a.nutrition?e.jsxs(S,{spacing:2,align:"stretch",children:[e.jsx(d,{fontWeight:"bold",children:"Nutrition Facts (per amount):"}),e.jsx(_t,{}),Object.entries(a.nutrition||{}).map(([X,f])=>e.jsxs(A,{justify:"space-between",children:[e.jsxs(d,{textTransform:"capitalize",children:[X,":"]}),e.jsxs(d,{fontWeight:"bold",children:[f,X==="calories"?"":X==="sodium"?"mg":"g"]})]},X))]}):e.jsx(d,{color:"gray.500",textAlign:"center",children:"Nutrition data not available for this item"}),a.used_in_meals&&a.used_in_meals.length>0&&e.jsxs(S,{spacing:2,align:"stretch",children:[e.jsx(d,{fontWeight:"bold",children:"Used in meals:"}),e.jsx(S,{spacing:1,align:"start",children:a.used_in_meals.map((X,f)=>e.jsxs(A,{spacing:2,children:[e.jsx(Jw,{}),e.jsx(d,{children:X})]},f))})]})]}):e.jsx(Ot,{py:8,children:e.jsx(ut,{})})}),e.jsx(mt,{children:e.jsx(H,{onClick:v,children:"Close"})})]})]})]})})}function Zw({isOpen:t,onClose:n,onSuccess:r,meal:i,mealType:s}){const[o,a]=C.useState(""),[l,c]=C.useState(1),[u,h]=C.useState("serving"),[g,m]=C.useState(""),[p,j]=C.useState(""),[b,v]=C.useState(!1),[_,N]=C.useState({calories:0,protein:0,carbs:0,fat:0}),[R,U]=C.useState({calories:0,protein:0,carbs:0,fat:0}),I=wt(),w={serving:1,cup:1.2,piece:1,slice:.5,bowl:1.5,plate:2,g:.01,oz:.3,tbsp:.1,tsp:.03},P=(E,O,B)=>{if(O===B)return E;const ae=E*w[O]/w[B];return Math.round(ae*100)/100},M=E=>{const O=P(l,u,E);c(O),h(E)};C.useEffect(()=>{if(t&&i){a(i.food_name||""),c(1),h(i.portion_size&&i.portion_size.split(" ")[1]||"serving"),m(s||"lunch"),j(i.preparation_notes||"");const E={calories:i.calories||0,protein:i.protein||0,carbs:i.carbs||0,fat:i.fat||0,fiber:i.fiber,sodium:i.sodium};U(E),N(E)}},[t,i,s]),C.useEffect(()=>{l&&R&&N({calories:R.calories*l,protein:R.protein*l,carbs:R.carbs*l,fat:R.fat*l,fiber:R.fiber?R.fiber*l:void 0,sodium:R.sodium?R.sodium*l:void 0})},[l,R]);const k=async()=>{if(!o){I({title:"Missing information",description:"Please enter a food name",status:"warning",duration:3e3,isClosable:!0});return}v(!0);try{const E={food_name:o,amount:l,unit:u,meal_type:g,notes:p,nutrition:_,date:mn().split("T")[0]};await Z.post("/food-logs/",E),I({title:"Food logged successfully!",description:`${l} ${u} of ${o} added to ${g}`,status:"success",duration:3e3,isClosable:!0}),r?.(),n()}catch(E){console.error("Error logging food:",E),I({title:"Error logging food",description:E.response?.data?.detail||"Failed to log food. Please try again.",status:"error",duration:5e3,isClosable:!0})}finally{v(!1)}};return e.jsxs(Ue,{isOpen:t,onClose:n,size:"lg",scrollBehavior:"inside",children:[e.jsx(Te,{}),e.jsxs(He,{maxH:"85vh",children:[e.jsx(Pe,{children:"📝 Log Meal Food"}),e.jsx(De,{}),e.jsx(Le,{pb:6,children:e.jsxs(S,{spacing:4,w:"full",children:[e.jsxs($,{children:[e.jsx(V,{children:"Food Name"}),e.jsx(ve,{value:o,onChange:E=>a(E.target.value)})]}),e.jsxs(A,{spacing:4,w:"full",children:[e.jsxs($,{children:[e.jsx(V,{children:"Amount"}),e.jsxs(ue,{value:l,onChange:(E,O)=>c(O||1),min:.1,step:.1,precision:2,allowMouseWheel:!1,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Unit"}),e.jsxs(Be,{value:u,onChange:E=>M(E.target.value),children:[e.jsx("option",{value:"serving",children:"serving"}),e.jsx("option",{value:"cup",children:"cup"}),e.jsx("option",{value:"piece",children:"piece"}),e.jsx("option",{value:"slice",children:"slice"}),e.jsx("option",{value:"bowl",children:"bowl"}),e.jsx("option",{value:"plate",children:"plate"}),e.jsx("option",{value:"g",children:"g"}),e.jsx("option",{value:"oz",children:"oz"}),e.jsx("option",{value:"tbsp",children:"tbsp"}),e.jsx("option",{value:"tsp",children:"tsp"})]})]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Meal Type"}),e.jsxs(Be,{value:g,onChange:E=>m(E.target.value),children:[e.jsx("option",{value:"breakfast",children:"Breakfast"}),e.jsx("option",{value:"lunch",children:"Lunch"}),e.jsx("option",{value:"dinner",children:"Dinner"}),e.jsx("option",{value:"snack",children:"Snack"})]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Notes (Optional)"}),e.jsx(Kt,{value:p,onChange:E=>j(E.target.value),placeholder:"Any modifications or additional notes...",size:"sm"})]}),e.jsx(se,{w:"full",bg:"blue.50",children:e.jsx(re,{children:e.jsxs(S,{spacing:4,children:[e.jsxs(d,{fontWeight:"bold",color:"blue.700",children:["Nutrition per ",l," ",u,"(s) - All Values Editable"]}),e.jsxs(xe,{columns:2,spacing:4,w:"full",children:[e.jsxs($,{children:[e.jsx(V,{fontSize:"xs",color:"gray.600",children:"Calories"}),e.jsxs(ue,{value:_.calories,onChange:(E,O)=>{O!==void 0&&N(B=>({...B,calories:O}))},precision:1,min:0,step:.1,size:"sm",children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]}),e.jsxs($,{children:[e.jsx(V,{fontSize:"xs",color:"gray.600",children:"Protein (g)"}),e.jsxs(ue,{value:_.protein,onChange:(E,O)=>{O!==void 0&&N(B=>({...B,protein:O}))},precision:1,min:0,step:.1,size:"sm",children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]}),e.jsxs($,{children:[e.jsx(V,{fontSize:"xs",color:"gray.600",children:"Carbs (g)"}),e.jsxs(ue,{value:_.carbs,onChange:(E,O)=>{O!==void 0&&N(B=>({...B,carbs:O}))},precision:1,min:0,step:.1,size:"sm",children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]}),e.jsxs($,{children:[e.jsx(V,{fontSize:"xs",color:"gray.600",children:"Fat (g)"}),e.jsxs(ue,{value:_.fat,onChange:(E,O)=>{O!==void 0&&N(B=>({...B,fat:O}))},precision:1,min:0,step:.1,size:"sm",children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]}),_.fiber!==void 0&&e.jsxs($,{children:[e.jsx(V,{fontSize:"xs",color:"gray.600",children:"Fiber (g)"}),e.jsxs(ue,{value:_.fiber||0,onChange:(E,O)=>{N(B=>({...B,fiber:O}))},precision:1,min:0,step:.1,size:"sm",children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]}),_.sodium!==void 0&&e.jsxs($,{children:[e.jsx(V,{fontSize:"xs",color:"gray.600",children:"Sodium (mg)"}),e.jsxs(ue,{value:_.sodium||0,onChange:(E,O)=>{N(B=>({...B,sodium:O}))},precision:1,min:0,step:1,size:"sm",children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]})]})]})})})]})}),e.jsxs(mt,{children:[e.jsx(H,{variant:"outline",mr:3,onClick:n,children:"Cancel"}),e.jsx(H,{colorScheme:"green",onClick:k,isLoading:b,children:"Log Food"})]})]})]})}const eS=()=>{const[t,n]=C.useState([]),[r,i]=C.useState(null),[s,o]=C.useState(null),[a,l]=C.useState(null),[c,u]=C.useState(null),[h,g]=C.useState(!1),[m,p]=C.useState(""),[j,b]=C.useState(null),[v,_]=C.useState(null),[N,R]=C.useState(null),[U,I]=C.useState(null),[w,P]=C.useState({name:"",days:3,dietary_restrictions:[],preferred_cuisines:[],calories_per_day:2e3,protein_target:150,carbs_target:200,fat_target:65,exclude_foods:[],meal_types:["breakfast","lunch","dinner"],complexity_level:"any",protein_percent:30,carbs_percent:40,fat_percent:30,use_food_index_only:!1,special_requests:""}),{isOpen:M,onOpen:k,onClose:E}=Fe(),{isOpen:O,onOpen:B,onClose:J}=Fe(),{isOpen:ae,onOpen:q,onClose:oe}=Fe(),{isOpen:fe,onOpen:pe,onClose:X}=Fe(),{isOpen:f,onOpen:W,onClose:te}=Fe(),{isOpen:y,onClose:ee}=Fe(),{isOpen:Ie,onOpen:ce,onClose:ne}=Fe(),he=wt();C.useEffect(()=>{(async()=>{try{const T=await Z.get("/preferences/dietary");b(T.data)}catch(T){console.error("Error fetching dietary preferences:",T)}})()},[]);const dt=()=>{j&&(P(x=>({...x,dietary_restrictions:j.dietary_restrictions||[],preferred_cuisines:j.preferred_cuisines||[]})),he({title:"Preferences Applied",description:"Your dietary preferences have been applied to the meal plan.",status:"info",duration:2e3,isClosable:!0}))},Qe=(x,T,L)=>{const G=x+T+L;return G===0?{protein:30,carbs:40,fat:30}:{protein:Math.round(x/G*100),carbs:Math.round(T/G*100),fat:Math.round(L/G*100)}},Ye=async()=>{try{g(!0),p(""),console.log("Fetching meal plans...");const x=await Z.get("/meal-planning/plans");console.log("Meal plans response:",x.data);const T=x.data;let L=[];T&&typeof T=="object"&&(Array.isArray(T.meal_plans)?L=T.meal_plans:Array.isArray(T)&&(L=T)),console.log("Processed meal plans:",L),n(L)}catch(x){console.error("Error fetching meal plans:",x),p(x.response?.data?.detail||"Failed to load meal plans")}finally{g(!1)}};C.useEffect(()=>{Ye()},[]);const z=async()=>{try{g(!0),p("");const x=w.calories_per_day||2e3,{protein:T,carbs:L,fat:G}=Qe(w.protein_percent,w.carbs_percent,w.fat_percent),le=Math.round(x*T/100/4),Ve=Math.round(x*L/100/4),at=Math.round(x*G/100/9),nn={...w,protein_target:le,carbs_target:Ve,fat_target:at};console.log("Creating meal plan with data:",nn);const D=await Z.post("/meal-planning/generate-plan",nn);console.log("Create meal plan response:",D.data),he({title:"Meal Plan Created!",description:`Your ${w.days}-day meal plan has been generated and saved successfully.`,status:"success",duration:5e3,isClosable:!0}),await Ye(),P({name:"",days:3,dietary_restrictions:[],preferred_cuisines:[],calories_per_day:2e3,protein_target:150,carbs_target:200,fat_target:65,exclude_foods:[],meal_types:["breakfast","lunch","dinner"],protein_percent:30,carbs_percent:40,fat_percent:30,special_requests:""}),E()}catch(x){console.error("Error creating meal plan:",x),p(x.response?.data?.detail||"Failed to create meal plan"),he({title:"Error",description:x.response?.data?.detail||"Failed to create meal plan",status:"error",duration:5e3,isClosable:!0})}finally{g(!1)}},Q=async(x,T=!1)=>{try{if(g(!0),!T)try{const G=(await Z.get(`/meal-planning/plans/${x}/shopping-list`)).data;l(G),u(x),pe(),he({title:"Shopping List Loaded",description:`Cached shopping list loaded with ${G.items?.length||0} items. Total estimated cost: $${G.total_estimated_cost||0}`,status:"success",duration:3e3,isClosable:!0});return}catch{console.log("No cached shopping list found, generating new one...")}try{const G=(await Z.post(`/meal-planning/plans/${x}/shopping-list`,{force_regenerate:T})).data;l(G),u(x),pe()}catch(L){console.error("Error generating shopping list:",L),he({title:"Error Generating Shopping List",description:L.response?.data?.detail||"Failed to generate shopping list. The meal plan may no longer exist.",status:"error",duration:5e3,isClosable:!0});return}he({title:T?"Shopping List Regenerated":"Shopping List Generated",description:`Your shopping list has been ${T?"regenerated":"created"} with ${a?.items?.length||0} items. Total estimated cost: $${a?.total_estimated_cost||0}`,status:"success",duration:3e3,isClosable:!0})}catch(L){console.error("Error generating shopping list:",L),he({title:"Error",description:"Failed to generate shopping list",status:"error",duration:5e3,isClosable:!0})}finally{g(!1)}},Ne=async x=>{try{const T=await Z.post("/food-logs/",x);return console.log("Food log response:",T.data),T.data}catch(T){throw console.error("Error logging food item:",T),T}},ye=async x=>{if(window.confirm("Are you sure you want to delete this meal plan? This action cannot be undone."))try{await Z.delete(`/meal-planning/plans/${x}`),he({title:"Plan Deleted",description:"Meal plan has been deleted successfully",status:"success",duration:3e3,isClosable:!0}),await Ye(),r?.plan_id===x&&(i(null),J())}catch(T){console.error("Error deleting meal plan:",T),he({title:"Error",description:"Failed to delete meal plan",status:"error",duration:5e3,isClosable:!0})}},Cn=async(x,T)=>{const L={...x};if(!L.ingredients||L.ingredients.length===0)try{he({title:"Extracting Ingredients",description:`Analyzing "${x.food_name}" to extract ingredients...`,status:"info",duration:3e3,isClosable:!0});const G=await Z.post("/meal-planning/extract-ingredients",{meal_name:x.food_name,portion_size:x.portion_size||"1 serving"});G.data.ingredients&&G.data.ingredients.length>0?(L.ingredients=G.data.ingredients,he({title:"Ingredients Extracted",description:`Found ${G.data.ingredients.length} ingredients for ${x.food_name}`,status:"success",duration:3e3,isClosable:!0})):(L.ingredients=[],he({title:"No Ingredients Found",description:"Could not extract ingredients. You can add them manually.",status:"warning",duration:3e3,isClosable:!0}))}catch(G){console.error("Error extracting ingredients:",G),L.ingredients=[],he({title:"Extraction Failed",description:"Could not extract ingredients. You can add them manually.",status:"warning",duration:3e3,isClosable:!0})}_({meal:L,dayIndex:T}),W()},hn=async x=>{try{const L=(await Z.get(`/foods/search?q=${encodeURIComponent(x)}&limit=1`)).data;if(L&&L.length>0){const le=L[0].nutrition||{};return{calories:le.calories||0,protein:le.protein||0,carbs:le.carbs||0,fat:le.fat||0}}}catch{console.log("Food not found in database:",x)}return null},At=async(x,T,L)=>{if(!v)return;const G={...v};if(G.meal.ingredients){if(G.meal.ingredients[x]={...G.meal.ingredients[x],[T]:L},T==="name"&&L.trim())try{const le=await hn(L.trim());le?(G.meal.ingredients[x]={...G.meal.ingredients[x],calories:le.calories,protein:le.protein,carbs:le.carbs,fat:le.fat},he({title:"Nutrition Info Auto-Populated",description:`Found nutrition data for ${L}`,status:"success",duration:2e3,isClosable:!0})):he({title:"Nutrition Info Not Found",description:`No nutrition data found for "${L}". You can enter it manually.`,status:"warning",duration:3e3,isClosable:!0})}catch(le){console.error("Error looking up nutrition:",le),he({title:"Lookup Error",description:"Unable to fetch nutrition data. Please enter manually.",status:"warning",duration:3e3,isClosable:!0})}if(G.meal.ingredients.some(le=>le.calories||le.protein||le.carbs||le.fat)){const le=G.meal.ingredients.reduce((Ve,at)=>({calories:Ve.calories+(at.calories||0),protein:Ve.protein+(at.protein||0),carbs:Ve.carbs+(at.carbs||0),fat:Ve.fat+(at.fat||0)}),{calories:0,protein:0,carbs:0,fat:0});G.meal.calories=le.calories,G.meal.protein=le.protein,G.meal.carbs=le.carbs,G.meal.fat=le.fat}_(G)}},en=()=>{if(!v)return;const x={...v};x.meal.ingredients||(x.meal.ingredients=[]),x.meal.ingredients.push({name:"",amount:1,unit:"cup",calories:0,protein:0,carbs:0,fat:0}),_(x)},qt=x=>{if(!v||!v.meal.ingredients)return;const T={...v};if(T.meal.ingredients){T.meal.ingredients.splice(x,1);const L=T.meal.ingredients.reduce((G,le)=>({calories:G.calories+(le.calories||0),protein:G.protein+(le.protein||0),carbs:G.carbs+(le.carbs||0),fat:G.fat+(le.fat||0)}),{calories:0,protein:0,carbs:0,fat:0});T.meal.calories=L.calories,T.meal.protein=L.protein,T.meal.carbs=L.carbs,T.meal.fat=L.fat,_(T)}},tn=async()=>{if(!(!v||!r)){try{const x={...r},T=v.dayIndex,L=x.days[T].meals.findIndex(G=>G.food_name===v.meal.food_name&&G.meal_type===v.meal.meal_type);if(L!==-1){x.days[T].meals[L]=v.meal;const G=x.days[T].meals.reduce((le,Ve)=>({calories:le.calories+(Ve.calories||0),protein:le.protein+(Ve.protein||0),carbs:le.carbs+(Ve.carbs||0),fat:le.fat+(Ve.fat||0)}),{calories:0,protein:0,carbs:0,fat:0});x.days[T].total_nutrition=G,await Z.put(`/meal-planning/plans/${r.plan_id}`,{days:x.days,updated_at:new Date().toISOString()}),i(x),he({title:"Success",description:"Meal updated and saved successfully!",status:"success",duration:3e3,isClosable:!0})}}catch(x){console.error("Error saving meal changes:",x),he({title:"Error",description:"Failed to save meal changes",status:"error",duration:5e3,isClosable:!0})}te(),_(null)}},Tt=(x,T,L)=>{if(!N)return;const G={...N};G.ingredients[x]={...G.ingredients[x],[T]:L},R(G)},Un=async()=>{if(N)try{const x=N.ingredients.filter(L=>L.selected),T=x.map(L=>{const G={date:N.date,meal_type:N.mealType,food_id:L.food_id||`ingredient_${L.name.toLowerCase().replace(/\s+/g,"_")}`,food_name:L.name,amount:L.amount,unit:L.unit,nutrition:{calories:L.calories,protein:L.protein,carbs:L.carbs,fat:L.fat},notes:"From meal plan"};return Ne(G)});if(await Promise.all(T),x.length===N.ingredients.length&&r){const L={...r},G=L.days.findIndex(le=>le.date===N.date);if(G!==-1){const le=L.days[G].meals.findIndex(Ve=>Ve.meal_type===N.mealType);le!==-1&&(L.days[G].meals[le].is_logged=!0,i(L))}}he({title:"Foods Logged",description:`${x.length} item(s) have been logged to your food diary.`,status:"success",duration:3e3,isClosable:!0}),ee(),R(null)}catch(x){console.error("Error logging multiple foods:",x),he({title:"Error",description:"Failed to log ingredients to food diary",status:"error",duration:5e3,isClosable:!0})}},kn=(x,T)=>{I({meal:x,mealType:T.toLowerCase()}),ce()},En=x=>{try{return new Date(x).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}catch{return x}},K=x=>{const T=x.name||x.title||`Meal Plan ${x.plan_id.slice(-6)}`;let L={calories:0,protein:0,carbs:0,fat:0};if(x.days&&x.days.length>0){const G=x.days.length,le=x.days.reduce((Ve,at)=>({calories:Ve.calories+(at.total_nutrition?.calories||0),protein:Ve.protein+(at.total_nutrition?.protein||0),carbs:Ve.carbs+(at.total_nutrition?.carbs||0),fat:Ve.fat+(at.total_nutrition?.fat||0)}),{calories:0,protein:0,carbs:0,fat:0});L={calories:le.calories/G,protein:le.protein/G,carbs:le.carbs/G,fat:le.fat/G}}else L=x.target_nutrition||{calories:0,protein:0,carbs:0,fat:0};return e.jsx(se,{cursor:"pointer",_hover:{transform:"translateY(-2px)",shadow:"lg"},children:e.jsx(re,{children:e.jsxs(S,{align:"stretch",spacing:3,children:[e.jsxs(A,{justify:"space-between",children:[e.jsx(d,{fontSize:"lg",fontWeight:"bold",children:T}),e.jsxs(je,{colorScheme:"blue",children:[x.total_days||0," days"]})]}),e.jsxs(d,{fontSize:"sm",color:"gray.600",children:["Created ",new Date(x.created_at).toLocaleDateString()]}),x.dietary_restrictions&&x.dietary_restrictions.length>0&&e.jsx(A,{flexWrap:"wrap",spacing:1,children:x.dietary_restrictions.map((G,le)=>e.jsx(je,{variant:"outline",colorScheme:"green",fontSize:"xs",children:G},le))}),e.jsxs(xe,{columns:4,spacing:2,children:[e.jsxs(be,{size:"sm",children:[e.jsx(we,{fontSize:"xs",children:"Calories"}),e.jsx(Se,{fontSize:"sm",children:Math.round(L.calories)})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{fontSize:"xs",children:"Protein"}),e.jsxs(Se,{fontSize:"sm",children:[Math.round(L.protein),"g"]})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{fontSize:"xs",children:"Carbs"}),e.jsxs(Se,{fontSize:"sm",children:[Math.round(L.carbs),"g"]})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{fontSize:"xs",children:"Fat"}),e.jsxs(Se,{fontSize:"sm",children:[Math.round(L.fat),"g"]})]})]}),e.jsxs(A,{spacing:2,children:[e.jsx(H,{size:"sm",colorScheme:"blue",onClick:G=>{G.stopPropagation(),i(x),B()},children:"View Details"}),e.jsx(H,{size:"sm",colorScheme:"green",onClick:G=>{G.stopPropagation(),Q(x.plan_id)},children:"Shopping List"}),e.jsx(et,{size:"sm","aria-label":"Delete plan",icon:e.jsx(Ui,{}),colorScheme:"red",variant:"ghost",onClick:()=>ye(x.plan_id)})]})]})})},x.plan_id)};return e.jsx(F,{p:6,children:e.jsxs(S,{spacing:6,align:"stretch",children:[e.jsxs(A,{justify:"space-between",children:[e.jsx(d,{fontSize:"2xl",fontWeight:"bold",children:"Meal Plans"}),e.jsx(H,{leftIcon:e.jsx(Bi,{}),colorScheme:"blue",onClick:k,children:"Create New Plan"})]}),m&&e.jsxs(kt,{status:"error",children:[e.jsx(Et,{}),m]}),h?e.jsx(Fn,{justify:"center",p:8,children:e.jsx(ut,{size:"lg"})}):t.length===0?e.jsx(se,{children:e.jsxs(re,{textAlign:"center",py:8,children:[e.jsx(d,{fontSize:"lg",color:"gray.500",mb:4,children:"No meal plans found"}),e.jsx(d,{color:"gray.600",mb:4,children:"Create your first meal plan to get started with personalized nutrition planning."}),e.jsx(H,{colorScheme:"blue",onClick:k,children:"Create Your First Meal Plan"})]})}):e.jsx(xe,{columns:{base:1,md:2,lg:3},spacing:6,children:t.map(K)}),e.jsxs(Ue,{isOpen:M,onClose:E,size:"xl",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsx(Pe,{children:"Create New Meal Plan"}),e.jsx(De,{}),e.jsx(Le,{children:e.jsxs(S,{spacing:4,children:[e.jsxs($,{children:[e.jsx(V,{children:"Plan Name"}),e.jsx(ve,{value:w.name,onChange:x=>P({...w,name:x.target.value}),placeholder:"Enter a name for your meal plan"})]}),e.jsxs($,{children:[e.jsx(V,{children:"Number of Days"}),e.jsxs(ue,{value:w.days,onChange:(x,T)=>P({...w,days:T||3}),min:1,max:5,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Daily Calorie Target"}),e.jsxs(ue,{value:w.calories_per_day,onChange:(x,T)=>P({...w,calories_per_day:T||2e3}),min:1e3,max:5e3,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Macro Distribution (%)"}),e.jsxs(xe,{columns:3,spacing:3,children:[e.jsxs(F,{children:[e.jsx(d,{fontSize:"sm",mb:1,children:"Protein"}),e.jsx(ue,{value:w.protein_percent,onChange:(x,T)=>P({...w,protein_percent:T||30}),min:5,max:50,children:e.jsx(de,{})})]}),e.jsxs(F,{children:[e.jsx(d,{fontSize:"sm",mb:1,children:"Carbs"}),e.jsx(ue,{value:w.carbs_percent,onChange:(x,T)=>P({...w,carbs_percent:T||40}),min:20,max:70,children:e.jsx(de,{})})]}),e.jsxs(F,{children:[e.jsx(d,{fontSize:"sm",mb:1,children:"Fat"}),e.jsx(ue,{value:w.fat_percent,onChange:(x,T)=>P({...w,fat_percent:T||30}),min:15,max:45,children:e.jsx(de,{})})]})]}),e.jsx(bt,{children:"Percentages will be normalized to 100%"})]}),e.jsxs($,{children:[e.jsx(V,{children:"Dietary Restrictions"}),e.jsx(Yn,{value:w.dietary_restrictions,onChange:x=>P({...w,dietary_restrictions:x}),children:e.jsxs(Gs,{direction:"row",flexWrap:"wrap",children:[e.jsx(ft,{value:"vegetarian",children:"Vegetarian"}),e.jsx(ft,{value:"vegan",children:"Vegan"}),e.jsx(ft,{value:"gluten-free",children:"Gluten-Free"}),e.jsx(ft,{value:"dairy-free",children:"Dairy-Free"}),e.jsx(ft,{value:"low-carb",children:"Low-Carb"}),e.jsx(ft,{value:"keto",children:"Keto"})]})})]}),e.jsxs($,{children:[e.jsx(V,{children:"Preferred Cuisines"}),e.jsx(Yn,{value:w.preferred_cuisines,onChange:x=>P({...w,preferred_cuisines:x}),children:e.jsxs(Gs,{direction:"row",flexWrap:"wrap",children:[e.jsx(ft,{value:"mediterranean",children:"Mediterranean"}),e.jsx(ft,{value:"asian",children:"Asian"}),e.jsx(ft,{value:"mexican",children:"Mexican"}),e.jsx(ft,{value:"italian",children:"Italian"}),e.jsx(ft,{value:"american",children:"American"}),e.jsx(ft,{value:"indian",children:"Indian"})]})})]}),e.jsxs($,{children:[e.jsx(V,{children:"Meal Complexity Level"}),e.jsxs(Be,{value:w.complexity_level,onChange:x=>P({...w,complexity_level:x.target.value}),children:[e.jsx("option",{value:"any",children:"Any - Mix of different complexity levels"}),e.jsx("option",{value:"simple",children:"Simple - Quick meals with 3-5 ingredients (under 15 mins)"}),e.jsx("option",{value:"moderate",children:"Moderate - Balanced meals with 5-8 ingredients (15-30 mins)"}),e.jsx("option",{value:"complex",children:"Complex - Elaborate meals with 8+ ingredients (30+ mins)"})]}),e.jsx(bt,{children:"Choose based on your available time and cooking preference"})]}),e.jsxs($,{children:[e.jsxs(A,{children:[e.jsx(V,{mb:0,children:"Use Only My Food Index"}),e.jsx(jr,{label:"When enabled, meal plans will only use foods from your personal food index for main ingredients. Pantry staples like oil, salt, and spices are assumed to be available.",placement:"top",children:e.jsx($e,{as:Gr,color:"gray.500"})})]}),e.jsx(Ht,{isChecked:w.use_food_index_only,onChange:x=>P({...w,use_food_index_only:x.target.checked}),colorScheme:"blue",size:"lg"}),e.jsx(bt,{children:"This provides more realistic nutrition results using foods you've already logged."})]}),e.jsxs($,{children:[e.jsx(V,{children:"Special Requests"}),e.jsx(Kt,{value:w.special_requests,onChange:x=>P({...w,special_requests:x.target.value}),placeholder:"Any special dietary needs, cooking preferences, meal timing, or other custom requirements...",rows:4,resize:"vertical"}),e.jsx(bt,{children:"Provide any custom instructions for your meal plan (e.g., meal prep friendly, specific cooking methods, equipment limitations, etc.)"})]}),j&&e.jsx(H,{variant:"outline",colorScheme:"blue",onClick:dt,w:"full",children:"Apply My Dietary Preferences"})]})}),e.jsxs(mt,{children:[e.jsx(H,{variant:"ghost",mr:3,onClick:E,children:"Cancel"}),e.jsx(H,{colorScheme:"blue",onClick:z,isLoading:h,loadingText:"Creating...",children:"Create Plan"})]})]})]}),e.jsxs(Ue,{isOpen:O,onClose:J,size:"6xl",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsx(Pe,{children:r?.name||r?.title||"Meal Plan Details"}),e.jsx(De,{}),e.jsx(Le,{children:r&&e.jsxs(S,{spacing:6,align:"stretch",children:[e.jsx(se,{children:e.jsx(re,{children:e.jsxs(xe,{columns:{base:2,md:4},spacing:4,children:[e.jsxs(be,{children:[e.jsx(we,{children:"Duration"}),e.jsxs(Se,{children:[r.total_days," days"]})]}),e.jsxs(be,{children:[e.jsx(we,{children:"Created"}),e.jsx(Se,{fontSize:"md",children:new Date(r.created_at).toLocaleDateString()})]}),e.jsxs(be,{children:[e.jsx(we,{children:"Target Calories"}),e.jsx(Se,{children:(()=>{if(r.target_nutrition?.calories)return r.target_nutrition.calories;if(r.calories_per_day)return r.calories_per_day;if(r.days&&r.days.length>0){const x=r.days.reduce((L,G)=>L+(G.total_nutrition?.calories||0),0),T=Math.round(x/r.days.length);return T>0?T:"N/A"}return"N/A"})()})]}),e.jsxs(be,{children:[e.jsx(we,{children:"Restrictions"}),e.jsx(Se,{fontSize:"sm",children:r.dietary_restrictions?.length||0})]})]})})}),e.jsx(Ao,{defaultIndex:[0],allowMultiple:!0,children:r.days?.map((x,T)=>e.jsxs(Lr,{children:[e.jsxs(Rr,{children:[e.jsx(F,{flex:"1",textAlign:"left",children:e.jsxs(A,{justify:"space-between",children:[e.jsx(d,{fontWeight:"bold",children:En(x.date)}),e.jsxs(je,{colorScheme:"blue",children:[Math.round(x.total_nutrition?.calories||0)," cal"]})]})}),e.jsx(Mr,{})]}),e.jsx(Or,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs(xe,{columns:4,spacing:3,children:[e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Calories"}),e.jsx(Se,{children:Math.round(x.total_nutrition?.calories||0)})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Protein"}),e.jsxs(Se,{children:[Math.round(x.total_nutrition?.protein||0),"g"]})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Carbs"}),e.jsxs(Se,{children:[Math.round(x.total_nutrition?.carbs||0),"g"]})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Fat"}),e.jsxs(Se,{children:[Math.round(x.total_nutrition?.fat||0),"g"]})]})]}),e.jsx(_t,{}),e.jsx(S,{spacing:3,align:"stretch",children:x.meals?.map((L,G)=>e.jsx(se,{variant:"outline",children:e.jsx(re,{children:e.jsxs(S,{align:"stretch",spacing:3,children:[e.jsxs(A,{justify:"space-between",children:[e.jsxs(S,{align:"start",spacing:1,children:[e.jsx(je,{colorScheme:"purple",textTransform:"capitalize",children:L.meal_type}),e.jsx(d,{fontWeight:"bold",children:L.food_name}),e.jsxs(d,{fontSize:"sm",color:"gray.600",children:["Portion: ",L.portion_size]})]}),e.jsxs(S,{align:"end",spacing:1,children:[e.jsxs(d,{fontSize:"lg",fontWeight:"bold",children:[Math.round(L.calories)," cal"]}),e.jsxs(d,{fontSize:"sm",children:["P: ",Math.round(L.protein),"g | C: ",Math.round(L.carbs),"g | F: ",Math.round(L.fat),"g"]})]})]}),L.preparation_notes&&e.jsxs(d,{fontSize:"sm",color:"gray.600",children:[e.jsx("strong",{children:"Notes:"})," ",L.preparation_notes]}),L.instructions&&L.instructions.length>0&&e.jsxs(F,{children:[e.jsx(d,{fontSize:"sm",fontWeight:"bold",mb:2,children:"Cooking Instructions:"}),e.jsx(ga,{spacing:1,children:L.instructions.map((le,Ve)=>e.jsxs(pa,{fontSize:"sm",children:[e.jsx(fa,{as:Qi,color:"green.500"}),le]},Ve))})]}),L.ingredients&&L.ingredients.length>0&&e.jsxs(F,{children:[e.jsx(d,{fontSize:"sm",fontWeight:"bold",mb:2,children:"Ingredients:"}),e.jsx(xe,{columns:{base:1,md:2},spacing:1,children:L.ingredients.map((le,Ve)=>e.jsxs(d,{fontSize:"sm",children:["• ",le.amount," ",le.unit," ",le.name]},Ve))})]}),e.jsxs(A,{spacing:2,children:[e.jsx(H,{size:"sm",colorScheme:L.is_logged?"gray":"green",onClick:()=>kn(L,L.meal_type),isDisabled:L.is_logged,children:L.is_logged?"Already Logged":"Log Food"}),L.ingredients&&L.ingredients.length>0&&e.jsx(H,{size:"sm",colorScheme:"blue",variant:"outline",leftIcon:e.jsx(Qu,{}),onClick:()=>Cn(L,T),children:"Edit Recipe"}),e.jsx(H,{size:"sm",variant:"ghost",leftIcon:e.jsx(qx,{}),onClick:()=>{o({meal:L,dayIndex:T}),q()},children:"Details"})]})]})})},G))})]})})]},T))})]})}),e.jsxs(mt,{children:[e.jsx(H,{variant:"ghost",mr:3,onClick:J,children:"Close"}),e.jsx(H,{colorScheme:"green",onClick:()=>r&&Q(r.plan_id),children:"Generate Shopping List"})]})]})]}),e.jsxs(Ue,{isOpen:ae,onClose:oe,size:"lg",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsx(Pe,{children:s?.meal.food_name}),e.jsx(De,{}),e.jsx(Le,{children:s&&e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs(A,{justify:"space-between",children:[e.jsx(je,{colorScheme:"purple",textTransform:"capitalize",children:s.meal.meal_type}),e.jsxs(d,{fontSize:"lg",fontWeight:"bold",children:[Math.round(s.meal.calories)," calories"]})]}),e.jsxs(xe,{columns:3,spacing:3,children:[e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Protein"}),e.jsxs(Se,{children:[Math.round(s.meal.protein),"g"]})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Carbs"}),e.jsxs(Se,{children:[Math.round(s.meal.carbs),"g"]})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Fat"}),e.jsxs(Se,{children:[Math.round(s.meal.fat),"g"]})]})]}),s.meal.preparation_notes&&e.jsxs(F,{children:[e.jsx(d,{fontWeight:"bold",mb:2,children:"Preparation Notes:"}),e.jsx(d,{children:s.meal.preparation_notes})]}),s.meal.instructions&&s.meal.instructions.length>0&&e.jsxs(F,{children:[e.jsx(d,{fontWeight:"bold",mb:2,children:"Cooking Instructions:"}),e.jsx(ga,{spacing:2,children:s.meal.instructions.map((x,T)=>e.jsxs(pa,{children:[e.jsx(fa,{as:Qi,color:"green.500"}),x]},T))})]}),s.meal.ingredients&&s.meal.ingredients.length>0&&e.jsxs(F,{children:[e.jsx(d,{fontWeight:"bold",mb:2,children:"Ingredients:"}),e.jsx(S,{align:"stretch",spacing:1,children:s.meal.ingredients.map((x,T)=>e.jsxs(d,{children:["• ",x.amount," ",x.unit," ",x.name]},T))})]}),(s.meal.cooking_time||s.meal.prep_time)&&e.jsxs(A,{spacing:4,children:[s.meal.prep_time&&e.jsxs(A,{children:[e.jsx(gc,{}),e.jsxs(d,{fontSize:"sm",children:["Prep: ",s.meal.prep_time," min"]})]}),s.meal.cooking_time&&e.jsxs(A,{children:[e.jsx(gc,{}),e.jsxs(d,{fontSize:"sm",children:["Cook: ",s.meal.cooking_time," min"]})]})]})]})}),e.jsx(mt,{children:e.jsx(H,{onClick:oe,children:"Close"})})]})]}),e.jsxs(Ue,{isOpen:f,onClose:te,size:"xl",scrollBehavior:"inside",children:[e.jsx(Te,{}),e.jsxs(He,{maxH:"90vh",children:[e.jsx(Pe,{children:"Edit Meal Details"}),e.jsx(De,{}),e.jsx(Le,{overflowY:"auto",maxH:"70vh",children:v&&e.jsxs(S,{spacing:6,align:"stretch",children:[e.jsxs($,{children:[e.jsx(V,{children:"Meal Name"}),e.jsx(ve,{value:v.meal.food_name,onChange:x=>_({...v,meal:{...v.meal,food_name:x.target.value}})})]}),e.jsxs($,{children:[e.jsx(V,{children:"Preparation Notes"}),e.jsx(ve,{value:v.meal.preparation_notes||"",onChange:x=>_({...v,meal:{...v.meal,preparation_notes:x.target.value}}),placeholder:"Add preparation notes..."})]}),e.jsxs(F,{children:[e.jsxs(A,{justify:"space-between",mb:3,children:[e.jsx(d,{fontWeight:"bold",children:"Ingredients"}),e.jsx(H,{size:"sm",onClick:en,leftIcon:e.jsx(Bi,{}),children:"Add Ingredient"})]}),v.meal.ingredients?.map((x,T)=>e.jsx(se,{variant:"outline",mb:3,children:e.jsx(re,{children:e.jsxs(S,{spacing:3,children:[e.jsxs(xe,{columns:{base:1,md:3},spacing:3,w:"full",children:[e.jsxs($,{children:[e.jsx(V,{fontSize:"sm",children:"Ingredient"}),e.jsx(ve,{value:x.name,onChange:L=>At(T,"name",L.target.value),size:"sm"})]}),e.jsxs($,{children:[e.jsx(V,{fontSize:"sm",children:"Amount"}),e.jsxs(ue,{value:x.amount,onChange:(L,G)=>At(T,"amount",G),size:"sm",min:0,step:.1,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]}),e.jsxs($,{children:[e.jsx(V,{fontSize:"sm",children:"Unit"}),e.jsx(ve,{value:x.unit,onChange:L=>At(T,"unit",L.target.value),size:"sm"})]})]}),e.jsxs(xe,{columns:{base:2,md:4},spacing:3,w:"full",children:[e.jsxs($,{children:[e.jsx(V,{fontSize:"xs",children:"Calories"}),e.jsx(ue,{value:x.calories||0,onChange:(L,G)=>At(T,"calories",G||0),size:"sm",min:0,children:e.jsx(de,{})})]}),e.jsxs($,{children:[e.jsx(V,{fontSize:"xs",children:"Protein (g)"}),e.jsx(ue,{value:x.protein||0,onChange:(L,G)=>At(T,"protein",G||0),size:"sm",min:0,step:.1,children:e.jsx(de,{})})]}),e.jsxs($,{children:[e.jsx(V,{fontSize:"xs",children:"Carbs (g)"}),e.jsx(ue,{value:x.carbs||0,onChange:(L,G)=>At(T,"carbs",G||0),size:"sm",min:0,step:.1,children:e.jsx(de,{})})]}),e.jsxs($,{children:[e.jsx(V,{fontSize:"xs",children:"Fat (g)"}),e.jsx(ue,{value:x.fat||0,onChange:(L,G)=>At(T,"fat",G||0),size:"sm",min:0,step:.1,children:e.jsx(de,{})})]})]}),e.jsx(A,{justify:"end",w:"full",children:e.jsx(et,{size:"sm",colorScheme:"red",variant:"ghost","aria-label":"Remove ingredient",icon:e.jsx(Ui,{}),onClick:()=>qt(T)})})]})})},T))]}),e.jsx(se,{bg:"gray.50",children:e.jsxs(re,{children:[e.jsx(d,{fontWeight:"bold",mb:2,children:"Updated Nutrition:"}),e.jsxs(xe,{columns:4,spacing:3,children:[e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Calories"}),e.jsx(Se,{children:Math.round(v.meal.calories)})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Protein"}),e.jsxs(Se,{children:[Math.round(v.meal.protein),"g"]})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Carbs"}),e.jsxs(Se,{children:[Math.round(v.meal.carbs),"g"]})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Fat"}),e.jsxs(Se,{children:[Math.round(v.meal.fat),"g"]})]})]})]})})]})}),e.jsxs(mt,{children:[e.jsx(H,{variant:"ghost",mr:3,onClick:te,children:"Cancel"}),e.jsx(H,{colorScheme:"blue",onClick:tn,children:"Save Changes"})]})]})]}),e.jsxs(Ue,{isOpen:y,onClose:ee,size:"xl",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsx(Pe,{children:e.jsxs(S,{align:"start",spacing:1,children:[e.jsx(d,{children:"Log Food Items"}),e.jsx(d,{fontSize:"sm",color:"gray.600",children:N&&`${N.mealType} on ${N.date}`})]})}),e.jsx(De,{}),e.jsx(Le,{children:N&&e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs(kt,{status:"info",variant:"left-accent",children:[e.jsx(Et,{}),e.jsx(F,{children:e.jsx(d,{fontSize:"sm",children:"Select which items to log and adjust amounts/nutrition as needed."})})]}),N.ingredients.map((x,T)=>e.jsx(se,{variant:x.selected?"solid":"outline",colorScheme:x.selected?"blue":void 0,children:e.jsx(re,{children:e.jsxs(S,{spacing:4,children:[e.jsxs(A,{w:"full",justify:"space-between",children:[e.jsxs(A,{spacing:3,children:[e.jsx(ft,{isChecked:x.selected,onChange:L=>Tt(T,"selected",L.target.checked),size:"lg"}),e.jsxs(S,{align:"start",spacing:0,children:[e.jsx(d,{fontWeight:"bold",fontSize:"lg",children:x.name}),e.jsxs(d,{fontSize:"sm",color:"gray.600",children:[x.amount," ",x.unit]})]})]}),e.jsxs(S,{align:"end",spacing:0,children:[e.jsxs(d,{fontWeight:"bold",color:"green.600",children:[Math.round(x.calories)," cal"]}),e.jsxs(d,{fontSize:"sm",color:"gray.600",children:["P:",Math.round(x.protein),"g C:",Math.round(x.carbs),"g F:",Math.round(x.fat),"g"]})]})]}),x.selected&&e.jsxs(S,{spacing:3,w:"full",bg:"gray.50",p:3,borderRadius:"md",children:[e.jsxs(xe,{columns:{base:1,md:2},spacing:3,w:"full",children:[e.jsxs($,{children:[e.jsx(V,{fontSize:"sm",children:"Amount"}),e.jsxs(ue,{value:x.amount,onChange:(L,G)=>Tt(T,"amount",G||0),size:"sm",min:0,step:.1,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]}),e.jsxs($,{children:[e.jsx(V,{fontSize:"sm",children:"Unit"}),e.jsx(ve,{value:x.unit,onChange:L=>Tt(T,"unit",L.target.value),size:"sm"})]})]}),e.jsxs(xe,{columns:{base:2,md:4},spacing:2,w:"full",children:[e.jsxs($,{children:[e.jsx(V,{fontSize:"xs",children:"Calories"}),e.jsx(ue,{value:x.calories,onChange:(L,G)=>Tt(T,"calories",G||0),size:"sm",min:0,children:e.jsx(de,{})})]}),e.jsxs($,{children:[e.jsx(V,{fontSize:"xs",children:"Protein (g)"}),e.jsx(ue,{value:x.protein,onChange:(L,G)=>Tt(T,"protein",G||0),size:"sm",min:0,step:.1,children:e.jsx(de,{})})]}),e.jsxs($,{children:[e.jsx(V,{fontSize:"xs",children:"Carbs (g)"}),e.jsx(ue,{value:x.carbs,onChange:(L,G)=>Tt(T,"carbs",G||0),size:"sm",min:0,step:.1,children:e.jsx(de,{})})]}),e.jsxs($,{children:[e.jsx(V,{fontSize:"xs",children:"Fat (g)"}),e.jsx(ue,{value:x.fat,onChange:(L,G)=>Tt(T,"fat",G||0),size:"sm",min:0,step:.1,children:e.jsx(de,{})})]})]})]})]})})},T)),e.jsx(se,{bg:"green.50",borderColor:"green.200",children:e.jsx(re,{children:e.jsxs(S,{spacing:2,children:[e.jsx(d,{fontWeight:"bold",color:"green.800",children:"Selected Items Summary"}),e.jsxs(xe,{columns:4,spacing:2,w:"full",children:[e.jsxs(be,{size:"sm",children:[e.jsx(we,{color:"green.700",children:"Total Calories"}),e.jsx(Se,{color:"green.800",children:Math.round(N.ingredients.filter(x=>x.selected).reduce((x,T)=>x+T.calories,0))})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{color:"green.700",children:"Protein"}),e.jsxs(Se,{color:"green.800",children:[Math.round(N.ingredients.filter(x=>x.selected).reduce((x,T)=>x+T.protein,0)),"g"]})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{color:"green.700",children:"Carbs"}),e.jsxs(Se,{color:"green.800",children:[Math.round(N.ingredients.filter(x=>x.selected).reduce((x,T)=>x+T.carbs,0)),"g"]})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{color:"green.700",children:"Fat"}),e.jsxs(Se,{color:"green.800",children:[Math.round(N.ingredients.filter(x=>x.selected).reduce((x,T)=>x+T.fat,0)),"g"]})]})]})]})})})]})}),e.jsxs(mt,{children:[e.jsx(H,{variant:"ghost",mr:3,onClick:ee,children:"Cancel"}),e.jsxs(H,{colorScheme:"green",onClick:Un,isDisabled:!N?.ingredients.some(x=>x.selected),children:["Log Selected Items (",N?.ingredients.filter(x=>x.selected).length||0,")"]})]})]})]}),e.jsxs(Ue,{isOpen:fe,onClose:X,size:"xl",children:[e.jsx(Te,{}),e.jsxs(He,{maxH:"90vh",children:[e.jsx(Pe,{children:e.jsxs(A,{children:[e.jsx(Kw,{}),e.jsx(d,{children:"Smart Shopping List"})]})}),e.jsx(De,{}),e.jsx(Le,{p:0,children:a?e.jsx(Xw,{shoppingList:a,onUpdate:x=>l(x),onRefresh:()=>c&&Q(c,!0),isLoading:h}):e.jsx(F,{p:6,textAlign:"center",children:e.jsx(d,{children:"No shopping list available"})})}),e.jsx(mt,{children:e.jsx(H,{onClick:X,children:"Close"})})]})]}),U&&e.jsx(Zw,{isOpen:Ie,onClose:()=>{ne(),I(null)},onSuccess:()=>{Ye(),he({title:"Food logged successfully",status:"success",duration:3e3,isClosable:!0})},meal:U.meal,mealType:U.mealType})]})})},pc=["What should I eat for lunch?","Help me plan a healthy meal","Suggest a high-protein snack","What are good foods for weight loss?","Plan my meals for today","Analyze my nutrition goals"];function fc(){const[t,n]=C.useState([{role:"assistant",content:"Hello! I'm your nutrition AI assistant. I can help you with meal planning, nutrition questions, diet advice, and food recommendations. What would you like to know?"}]),[r,i]=C.useState(""),[s,o]=C.useState(!1),a=C.useRef(null),l=wt(),c=Wt({base:!0,lg:!1}),u=_e("white","gray.800"),h=_e("gray.50","gray.700"),g=_e("green.500","green.600"),{searchUserFoods:m}=Ju();C.useEffect(()=>{p()},[t]);const p=()=>{a.current?.scrollIntoView({behavior:"smooth"})},j=async I=>{const w=I||r.trim();if(!w)return;const P={role:"user",content:w};n(k=>[...k,P]),i(""),o(!0);const M=/food|eat|foods|meal|nutrition|diet/i.test(w.toLowerCase());try{let k={};if(M)try{const B=await m(w);B.length>0&&(k={foodSearchResults:B.slice(0,5)})}catch(B){console.error("Error prefetching food data:",B)}const O={role:"assistant",content:(await Z.post("/ai/chat",{message:P.content,conversation_history:t.slice(-10),context:{...k}})).data.response};n(B=>[...B,O])}catch(k){console.error("Error sending message:",k),l({title:"Chat Error",description:"Failed to send message. Please try again.",status:"error",duration:3e3,isClosable:!0});const E={role:"assistant",content:"Sorry, I'm having trouble responding right now. Please try again in a moment."};n(O=>[...O,E])}o(!1)},b=I=>{I.key==="Enter"&&!I.shiftKey&&(I.preventDefault(),j())},v=I=>{j(I)},_=()=>{n([{role:"assistant",content:"Hello! I'm your nutrition AI assistant. I can help you with meal planning, nutrition questions, diet advice, and food recommendations. What would you like to know?"}])},N=I=>{let w=I.replace(/AI_SEARCH_FOODS:\s*[^\n]*/gi,"").replace(/AI_LOG_FOOD:\s*[^\n]*/gi,"").replace(/AI_CREATE_MEAL_PLAN:\s*[^\n]*/gi,"").replace(/AI_INDEX_FOOD:\s*[^\n]*/gi,"").replace(/AI_SAVE_PREFERENCES:\s*[^\n]*/gi,"").replace(/AI_UPDATE_GOAL:\s*[^\n]*/gi,"").replace(/AI_SEARCH_USER_LOGS:\s*[^\n]*/gi,"");return w=w.replace(/❌ Couldn't search foods:[^\n]*/gi,"🔍 Searching your food database...").replace(/Expecting property name enclosed in double quotes[^\n]*/gi,"").replace(/line \d+ column \d+ \(char \d+\)/gi,""),I.toLowerCase().includes("food index")&&(w=w.replace(/Let me search your food index\.?\s*/gi,`🍎 **Your Food Index:**

`).replace(/Based on the context provided,?\s*/gi,"").replace(/I can see that your food index is currently empty or not available/gi,"Your food index appears to be empty. You can add foods by logging meals or manually adding them.")),I.toLowerCase().includes("calorie")&&I.toLowerCase().includes("should")&&(w=w.replace(/Based on your profile/gi,`📊 **Calorie Recommendation:**

Based on your profile`)),(I.toLowerCase().includes("meal plan")||I.toLowerCase().includes("meal suggestion"))&&(w=w.replace(/I'd love to help you/gi,`🍽️ **Meal Planning:**

I'd love to help you`)),w=w.replace(/\n\s*\n\s*\n/g,`

`).replace(/^\s+|\s+$/g,"").replace(/\s+([.!?])/g,"$1"),(w.includes("•")||w.includes("-"))&&(w=w.replace(/(^|\n)([•-])\s*/gm,"$1$2 ")),w.match(/^[🔍🍎📊🍽️💡⚠️✅❌]/)||(I.toLowerCase().includes("nutrition")||I.toLowerCase().includes("health"))&&(w="💡 "+w),w},R=I=>{const w=/```json\\s*([\\s\\S]*?)\\s*```/g,P=[];let M;for(;(M=w.exec(I))!==null;)try{const k=JSON.parse(M[1]);P.push({original:M[0],parsed:k,jsonString:M[1]})}catch{}return P},U=({message:I,isUser:w})=>{const{onCopy:P,hasCopied:M}=nh(""),k=w?I.content:N(I.content),E=R(k);return e.jsx(Fn,{justify:w?"flex-end":"flex-start",w:"full",children:e.jsxs(A,{spacing:2,maxW:c?"85%":"70%",flexDirection:w?"row-reverse":"row",children:[e.jsx(Ei,{size:c?"sm":"md",name:w?"You":"AI",bg:w?"green.500":"blue.500",color:"white",fontSize:c?"xs":"sm"}),e.jsx(se,{size:"sm",bg:w?g:h,color:w?"white":"inherit",shadow:"sm",borderRadius:"lg",children:e.jsx(re,{p:c?3:4,children:E.length>0?e.jsxs(S,{spacing:3,align:"stretch",children:[e.jsx(d,{fontSize:c?"sm":"md",lineHeight:"1.6",whiteSpace:"pre-wrap",children:k.replace(/```json\s*[\s\S]*?\s*```/g,"[JSON Response - see below]")}),E.map((O,B)=>e.jsxs(F,{bg:w?"whiteAlpha.200":"gray.100",p:3,borderRadius:"md",children:[e.jsxs(A,{justify:"space-between",mb:2,children:[e.jsx(d,{fontSize:"xs",fontWeight:"bold",color:w?"whiteAlpha.800":"gray.600",children:"JSON Response"}),e.jsx(H,{size:"xs",variant:"ghost",leftIcon:e.jsx($x,{}),onClick:()=>P(JSON.stringify(O.parsed,null,2)),color:w?"whiteAlpha.800":"gray.600",children:M?"Copied!":"Copy"})]}),e.jsx(vc,{display:"block",whiteSpace:"pre",fontSize:"xs",p:2,bg:w?"whiteAlpha.300":"white",color:w?"gray.800":"inherit",borderRadius:"sm",maxH:"300px",overflowY:"auto",children:JSON.stringify(O.parsed,null,2)})]},B))]}):e.jsx(Ji,{content:I.content,isMobile:c,fontSize:c?"sm":"md"})})})]})})};return e.jsx(F,{bg:"gray.50",h:c?"calc(100vh - 140px)":"100vh",position:"relative",children:e.jsxs(It,{maxW:c?"100%":"container.lg",h:"100%",p:0,display:"flex",flexDirection:"column",children:[e.jsx(F,{bg:u,p:c?3:4,borderBottomWidth:1,borderColor:"gray.200",flexShrink:0,children:e.jsxs(A,{justify:"space-between",children:[e.jsxs(S,{align:"start",spacing:0,children:[e.jsx(me,{size:c?"md":"lg",children:"🤖 AI Nutrition Assistant"}),e.jsx(d,{fontSize:c?"xs":"sm",color:"gray.600",children:"Ask me anything about nutrition and health"})]}),e.jsx(et,{"aria-label":"Clear chat",icon:e.jsx(Ui,{}),size:c?"sm":"md",variant:"ghost",onClick:_})]})}),e.jsx(F,{flex:1,overflowY:"auto",p:c?3:4,bg:"gray.50",minH:0,maxH:"100%",children:e.jsxs(S,{spacing:c?3:4,align:"stretch",children:[t.map((I,w)=>e.jsx(U,{message:I,isUser:I.role==="user"},w)),s&&e.jsx(Fn,{justify:"flex-start",w:"full",children:e.jsxs(A,{spacing:2,maxW:"70%",children:[e.jsx(Ei,{size:c?"sm":"md",name:"AI",bg:"blue.500",color:"white",fontSize:c?"xs":"sm"}),e.jsx(se,{size:"sm",bg:h,shadow:"sm",borderRadius:"lg",children:e.jsx(re,{p:c?3:4,children:e.jsxs(A,{spacing:1,children:[e.jsx(F,{w:2,h:2,bg:"gray.400",borderRadius:"full",animation:"pulse 1.5s infinite"}),e.jsx(F,{w:2,h:2,bg:"gray.400",borderRadius:"full",animation:"pulse 1.5s infinite 0.5s"}),e.jsx(F,{w:2,h:2,bg:"gray.400",borderRadius:"full",animation:"pulse 1.5s infinite 1s"})]})})})]})}),e.jsx("div",{ref:a})]})}),c&&t.length<=2&&e.jsxs(F,{p:3,bg:u,borderTopWidth:1,borderColor:"gray.200",flexShrink:0,children:[e.jsx(d,{fontSize:"xs",color:"gray.600",mb:2,children:"Quick questions:"}),e.jsx(Qt,{spacing:1,children:pc.map((I,w)=>e.jsx($t,{children:e.jsx(Rn,{size:"sm",variant:"outline",cursor:"pointer",onClick:()=>v(I),_hover:{bg:"green.50",borderColor:"green.300"},borderRadius:"full",children:e.jsx(ur,{fontSize:"xs",children:I})})},w))})]}),e.jsx(F,{p:c?3:4,bg:u,borderTopWidth:1,borderColor:"gray.200",flexShrink:0,children:e.jsxs(S,{spacing:2,children:[e.jsxs(A,{spacing:2,w:"full",children:[c?e.jsx(Kt,{value:r,onChange:I=>i(I.target.value),placeholder:"Ask me about nutrition...",onKeyPress:b,disabled:s,resize:"none",minH:"40px",maxH:"60px",fontSize:"sm",flex:1}):e.jsx(ve,{value:r,onChange:I=>i(I.target.value),placeholder:"Ask me about nutrition, meal planning, or diet advice...",onKeyPress:b,disabled:s,size:"md"}),e.jsx(et,{"aria-label":"Send message",icon:e.jsx(Bi,{}),colorScheme:"green",onClick:()=>j(),isLoading:s,disabled:!r.trim()||s,size:c?"sm":"md"})]}),!c&&t.length<=2&&e.jsxs(F,{w:"full",children:[e.jsx(d,{fontSize:"sm",color:"gray.600",mb:2,children:"Try asking:"}),e.jsx(Qt,{spacing:2,children:pc.slice(0,4).map((I,w)=>e.jsx($t,{children:e.jsx(Rn,{size:"md",variant:"outline",cursor:"pointer",onClick:()=>v(I),_hover:{bg:"green.50",borderColor:"green.300"},borderRadius:"full",children:e.jsx(ur,{children:I})})},w))})]})]})})]})})}const mc=t=>t*.453592,Vn=t=>t*2.20462,lr=80,cr=600,Hs=.5,$s=3,it={calories:{min:1e3,max:5e3},protein:{min:30,max:400},carbs:{min:50,max:800},fat:{min:20,max:300},fiber:{min:10,max:80},sugar:{min:0,max:200},sodium:{min:500,max:4e3}},tS=(t,n,r,i)=>{if(!t||!n||!r||t===n)return"";const s=Math.abs(n-t),o=Math.ceil(s/r),a=new Date(i),l=new Date(a);return l.setDate(a.getDate()+o*7),l.toISOString().split("T")[0]},Vs=t=>t>=lr&&t<=cr,ar=(t,n)=>{const r=it[t];return n>=r.min&&n<=r.max},nS=(t,n)=>{const r=Math.round(t*n.protein/100/4),i=Math.round(t*n.carbs/100/4),s=Math.round(t*n.fat/100/9);return{protein:r,carbs:i,fat:s}},qn=t=>{const n=t.protein+t.carbs+t.fat;return Math.abs(n-100)<.1};function rS(){const{goals:t,activeGoal:n,currentWeight:r,weightLogs:i,refreshGoals:s,refreshWeightLogs:o,loading:a}=ai(),l=Wt({base:!0,md:!1}),c=C.useRef(null),[u,h]=C.useState(!1),[g,m]=C.useState(!1),[p,j]=C.useState(!1),[b,v]=C.useState(null),[_,N]=C.useState(!0),[R,U]=C.useState(!1),[I,w]=C.useState({protein:30,carbs:40,fat:30}),{isOpen:P,onOpen:M,onClose:k}=Fe(),{isOpen:E,onOpen:O,onClose:B}=Fe(),{isOpen:J,onOpen:ae,onClose:q}=Fe(),{isOpen:oe,onOpen:fe,onClose:pe}=Fe(),X=wt(),[f,W]=C.useState({title:"",goal_type:"weight_loss",start_date:new Date().toISOString().split("T")[0],end_date:"",weight_target:{current_weight:154,target_weight:140,weekly_rate:1},nutrition_targets:{calories:2e3,protein:150,carbs:200,fat:65,fiber:30,sugar:50,sodium:2300}}),[te,y]=C.useState({date:new Date().toISOString().split("T")[0],weight:154,notes:""});C.useEffect(()=>{f.weight_target.current_weight===154&&r!==154&&W(z=>({...z,weight_target:{...z.weight_target,current_weight:r}}))},[r]);const ee=async()=>{h(!0);try{await Z.post("/goals/",f),X({title:"Goal Created",description:"Your new goal has been set successfully!",status:"success",duration:3e3,isClosable:!0}),k(),await s(),W({title:"",goal_type:"weight_loss",start_date:new Date().toISOString().split("T")[0],end_date:"",weight_target:{current_weight:r,target_weight:140,weekly_rate:1},nutrition_targets:{calories:2e3,protein:150,carbs:200,fat:65,fiber:30,sugar:50,sodium:2300}})}catch(z){console.error("Error creating goal:",z),X({title:"Creation Error",description:"Failed to create goal. Please try again.",status:"error",duration:3e3,isClosable:!0})}h(!1)},Ie=async()=>{try{const z={date:te.date,weight:mc(te.weight),notes:te.notes};await Z.post("/weight-logs/",z),X({title:"Weight Logged",description:"Your weight has been recorded successfully!",status:"success",duration:3e3,isClosable:!0}),pe(),await o(),y({date:new Date().toISOString().split("T")[0],weight:r,notes:""})}catch(z){console.error("Error logging weight:",z),X({title:"Weight Log Error",description:"Failed to log weight. Please try again.",status:"error",duration:3e3,isClosable:!0})}},ce=z=>{v(z),W({title:z.title,goal_type:z.goal_type,start_date:z.start_date?new Date(z.start_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],end_date:z.end_date?new Date(z.end_date).toISOString().split("T")[0]:"",weight_target:{current_weight:z.weight_target?Vn(z.weight_target.current_weight):r,target_weight:z.weight_target?Vn(z.weight_target.target_weight):140,weekly_rate:z.weight_target?z.weight_target.weekly_rate:1},nutrition_targets:{calories:z.nutrition_targets?.calories||2e3,protein:z.nutrition_targets?.protein||150,carbs:z.nutrition_targets?.carbs||200,fat:z.nutrition_targets?.fat||65,fiber:z.nutrition_targets?.fiber||30,sugar:z.nutrition_targets?.sugar||50,sodium:z.nutrition_targets?.sodium||2300}}),O()},ne=async()=>{if(b){m(!0);try{await Z.put(`/goals/${b.id}`,f),X({title:"Goal Updated",description:"Your goal has been updated successfully!",status:"success",duration:3e3,isClosable:!0}),B(),await s()}catch(z){console.error("Error updating goal:",z),X({title:"Update Error",description:"Failed to update goal. Please try again.",status:"error",duration:3e3,isClosable:!0})}m(!1)}},he=z=>{v(z),ae()},dt=async()=>{if(b){j(!0);try{await Z.delete(`/goals/${b.id}`),X({title:"Goal Deleted",description:"Your goal has been deleted successfully.",status:"success",duration:3e3,isClosable:!0}),q(),await s()}catch(z){console.error("Error deleting goal:",z),X({title:"Delete Error",description:"Failed to delete goal. Please try again.",status:"error",duration:3e3,isClosable:!0})}j(!1)}},Qe=async()=>{try{const z={age:30,weight:mc(r),height:175,gender:"male",activity_level:"moderate",goal_type:f.goal_type},Q=await Z.post("/goals/calculate-targets",z);W({...f,nutrition_targets:Q.data})}catch(z){console.error("Error calculating targets:",z),X({title:"Calculation Error",description:"Failed to calculate nutrition targets.",status:"error",duration:3e3,isClosable:!0})}};C.useEffect(()=>{const z=tS(r,f.weight_target.target_weight,f.weight_target.weekly_rate,f.start_date);z&&z!==f.end_date&&W(Q=>({...Q,end_date:z}))},[r,f.weight_target.target_weight,f.weight_target.weekly_rate,f.start_date]),C.useEffect(()=>{_&&r>0&&Qe()},[r,f.goal_type,_]),C.useEffect(()=>{if(R&&qn(I)){const z=nS(f.nutrition_targets.calories,I);W(Q=>({...Q,nutrition_targets:{...Q.nutrition_targets,protein:z.protein,carbs:z.carbs,fat:z.fat}}))}},[R,I,f.nutrition_targets.calories]);const Ye=z=>z.split("_").map(Q=>Q.charAt(0).toUpperCase()+Q.slice(1)).join(" ");return e.jsxs(It,{maxW:l?"100%":"container.xl",py:l?4:8,px:l?3:8,children:[e.jsxs(S,{spacing:l?4:8,align:"stretch",children:[e.jsxs(F,{textAlign:l?"center":"left",children:[e.jsx(me,{size:l?"md":"lg",mb:2,children:"Goals & Targets 🎯"}),e.jsx(d,{color:"gray.600",fontSize:l?"sm":"md",children:"Set and track your nutrition and fitness goals"}),l&&e.jsxs(A,{spacing:2,mt:4,justify:"center",children:[e.jsx(H,{colorScheme:"blue",onClick:fe,size:"sm",flex:1,children:"Log Weight"}),e.jsx(H,{colorScheme:"green",onClick:M,size:"sm",flex:1,children:"New Goal"})]})]}),!l&&e.jsxs(A,{justify:"space-between",children:[e.jsx(F,{}),e.jsxs(A,{spacing:3,children:[e.jsx(H,{colorScheme:"blue",onClick:fe,children:"Log Weight"}),e.jsx(H,{colorScheme:"green",onClick:M,children:"Create New Goal"})]})]}),e.jsx(se,{bg:"blue.50",borderColor:"blue.200",borderWidth:2,size:l?"sm":"md",children:e.jsx(re,{children:e.jsxs(S,{spacing:l?3:4,align:"stretch",children:[e.jsxs(S,{spacing:2,align:l?"center":"start",children:[e.jsx(me,{size:l?"sm":"md",children:"Current Weight"}),e.jsx(d,{color:"gray.600",fontSize:"sm",textAlign:l?"center":"left",children:"Track your weight progress over time"}),e.jsxs(d,{fontSize:l?"xl":"2xl",fontWeight:"bold",color:"blue.600",children:[r.toFixed(1)," lbs"]}),e.jsx(d,{fontSize:"sm",color:"gray.500",textAlign:l?"center":"left",children:i.length>0?`Last updated: ${new Date(i[0].date).toLocaleDateString()}`:"No weight logs yet"})]}),i.length>0&&e.jsxs(F,{children:[e.jsx(d,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Recent Weight History"}),e.jsx(A,{spacing:2,justify:"space-between",overflow:"auto",children:i.slice(0,7).reverse().map(z=>e.jsxs(S,{spacing:1,minW:"60px",children:[e.jsx(d,{fontSize:"xs",color:"gray.500",children:new Date(z.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),e.jsx(F,{bg:"blue.400",color:"white",px:2,py:1,borderRadius:"md",fontSize:"xs",fontWeight:"medium",children:Vn(z.weight).toFixed(1)})]},z.id))})]})]})})}),n&&e.jsx(se,{bg:"green.50",borderColor:"green.200",borderWidth:2,children:e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs(A,{justify:"space-between",flexDir:{base:"column",sm:"row"},children:[e.jsxs(F,{children:[e.jsxs(A,{children:[e.jsx(me,{size:"md",children:n.title}),e.jsx(je,{colorScheme:"green",children:"Active"})]}),e.jsx(d,{color:"gray.600",fontSize:"sm",children:Ye(n.goal_type)})]}),e.jsxs(F,{textAlign:"right",children:[e.jsxs(d,{fontSize:"sm",color:"gray.500",children:["Started: ",new Date(n.start_date).toLocaleDateString()]}),n.end_date&&e.jsxs(d,{fontSize:"sm",color:"gray.500",children:["Target: ",new Date(n.end_date).toLocaleDateString()]})]})]}),n.weight_target&&e.jsxs(F,{children:[e.jsx(d,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Weight Progress"}),e.jsxs(A,{spacing:4,children:[e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Current"}),e.jsxs(Se,{children:[r.toFixed(1)," lbs"]})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Target"}),e.jsxs(Se,{children:[Vn(n.weight_target.target_weight).toFixed(1)," lbs"]})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Weekly Rate"}),e.jsxs(Se,{children:[Vn(n.weight_target.weekly_rate).toFixed(1)," lbs/week"]})]})]})]}),e.jsx(_t,{}),e.jsxs(F,{children:[e.jsx(d,{fontSize:"sm",fontWeight:"medium",mb:3,children:"Daily Nutrition Targets"}),e.jsxs(xe,{columns:{base:2,md:4},spacing:4,children:[e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Calories"}),e.jsx(Se,{children:Math.round(n.nutrition_targets.calories)}),e.jsx(ot,{children:"kcal"})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Protein"}),e.jsx(Se,{children:Math.round(n.nutrition_targets.protein)}),e.jsx(ot,{children:"grams"})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Carbs"}),e.jsx(Se,{children:Math.round(n.nutrition_targets.carbs)}),e.jsx(ot,{children:"grams"})]}),e.jsxs(be,{size:"sm",children:[e.jsx(we,{children:"Fat"}),e.jsx(Se,{children:Math.round(n.nutrition_targets.fat)}),e.jsx(ot,{children:"grams"})]})]})]})]})})}),e.jsxs(F,{children:[e.jsxs(me,{size:"md",mb:4,children:["All Goals (",t.length,")"]}),a?e.jsx(d,{children:"Loading goals..."}):t.length===0?e.jsx(se,{children:e.jsxs(re,{textAlign:"center",py:12,children:[e.jsx(d,{fontSize:"lg",color:"gray.500",children:"No goals yet"}),e.jsx(d,{fontSize:"sm",color:"gray.400",mt:2,children:"Create your first goal to get started"})]})}):e.jsx(xe,{columns:{base:1,md:2},spacing:6,children:t.map(z=>e.jsx(se,{_hover:{shadow:"md"},children:e.jsx(re,{children:e.jsxs(S,{align:"start",spacing:3,children:[e.jsxs(A,{justify:"space-between",w:"full",children:[e.jsxs(F,{children:[e.jsx(me,{size:"sm",children:z.title}),e.jsx(d,{fontSize:"sm",color:"gray.600",children:Ye(z.goal_type)})]}),e.jsxs(A,{spacing:2,children:[e.jsx(je,{colorScheme:z.active?"green":"gray",children:z.active?"Active":"Inactive"}),e.jsxs(jc,{children:[e.jsx(yc,{as:et,"aria-label":"Goal options",icon:e.jsx(Vx,{}),variant:"ghost",size:"sm"}),e.jsxs(bc,{children:[e.jsx(Pr,{icon:e.jsx(Qu,{}),onClick:()=>ce(z),children:"Edit Goal"}),e.jsx(Pr,{icon:e.jsx(Ui,{}),onClick:()=>he(z),color:"red.500",children:"Delete Goal"})]})]})]})]}),e.jsxs(d,{fontSize:"sm",color:"gray.500",children:["Created: ",new Date(z.created_at).toLocaleDateString()]}),z.weight_target&&e.jsxs(d,{fontSize:"sm",children:["Target: ",Vn(z.weight_target.current_weight).toFixed(1)," lbs → ",Vn(z.weight_target.target_weight).toFixed(1)," lbs"]}),e.jsxs(d,{fontSize:"sm",children:["Daily calories: ",z.nutrition_targets?Math.round(z.nutrition_targets.calories):"Not set"," kcal"]})]})})},z.id))})]})]}),e.jsxs(Ue,{isOpen:P,onClose:k,size:"xl",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsx(Pe,{children:"Create New Goal"}),e.jsx(De,{}),e.jsx(Le,{pb:6,children:e.jsxs(S,{spacing:4,children:[e.jsxs($,{isRequired:!0,children:[e.jsx(V,{children:"Goal Title"}),e.jsx(ve,{value:f.title,onChange:z=>W({...f,title:z.target.value}),placeholder:"e.g., Lose weight for summer"})]}),e.jsxs($,{isRequired:!0,children:[e.jsx(V,{children:"Goal Type"}),e.jsxs(Be,{value:f.goal_type,onChange:z=>W({...f,goal_type:z.target.value}),children:[e.jsx("option",{value:"weight_loss",children:"Weight Loss"}),e.jsx("option",{value:"weight_gain",children:"Weight Gain"}),e.jsx("option",{value:"maintenance",children:"Maintenance"}),e.jsx("option",{value:"muscle_gain",children:"Muscle Gain"})]})]}),e.jsxs(A,{spacing:4,w:"full",children:[e.jsxs($,{isRequired:!0,children:[e.jsx(V,{children:"Start Date"}),e.jsx(ve,{type:"date",value:f.start_date,onChange:z=>W({...f,start_date:z.target.value})})]}),e.jsxs($,{children:[e.jsx(V,{children:"End Date (Expected Completion)"}),e.jsx(ve,{type:"date",value:f.end_date,onChange:z=>W({...f,end_date:z.target.value}),isReadOnly:!0,bg:"gray.50"}),e.jsx(bt,{children:"Automatically calculated based on your weight targets and weekly rate"})]})]}),e.jsx(me,{size:"sm",alignSelf:"start",children:"Weight Targets (Imperial - lbs)"}),e.jsxs(xe,{columns:3,spacing:4,w:"full",children:[e.jsxs($,{isRequired:!0,children:[e.jsx(V,{children:"Current Weight (lbs)"}),e.jsxs(ue,{value:r,onChange:(z,Q)=>{Q&&Vs(Q)&&W({...f,weight_target:{...f.weight_target,current_weight:Q}})},min:lr,max:cr,step:.1,precision:1,allowMouseWheel:!1,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]}),e.jsxs(bt,{children:["Current weight from your logs: ",r.toFixed(1)," lbs"]})]}),e.jsxs($,{isRequired:!0,children:[e.jsx(V,{children:"Target Weight (lbs)"}),e.jsxs(ue,{value:f.weight_target.target_weight,onChange:(z,Q)=>{Q&&Vs(Q)&&W({...f,weight_target:{...f.weight_target,target_weight:Q}})},min:lr,max:cr,step:.1,precision:1,allowMouseWheel:!1,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]}),e.jsxs(bt,{children:["Range: ",lr,"-",cr," lbs"]})]}),e.jsxs($,{isRequired:!0,children:[e.jsx(V,{children:"Weekly Rate (lbs/week)"}),e.jsxs(ue,{value:f.weight_target.weekly_rate,onChange:(z,Q)=>{Q&&Q>=Hs&&Q<=$s&&W({...f,weight_target:{...f.weight_target,weekly_rate:Q}})},min:Hs,max:$s,step:.1,precision:1,allowMouseWheel:!1,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]}),e.jsxs(bt,{children:["Safe range: ",Hs,"-",$s," lbs/week"]})]})]}),e.jsx(se,{bg:"blue.50",borderColor:"blue.200",children:e.jsx(re,{py:3,children:e.jsxs(A,{justify:"space-between",children:[e.jsxs(d,{fontSize:"sm",fontWeight:"medium",children:["Weight Change: ",Math.abs(f.weight_target.target_weight-r).toFixed(1)," lbs"]}),e.jsxs(d,{fontSize:"sm",fontWeight:"medium",children:["Direction: ",f.weight_target.target_weight>r?"Gain":"Loss"]}),e.jsxs(d,{fontSize:"sm",fontWeight:"medium",children:["Expected Duration: ",Math.ceil(Math.abs(f.weight_target.target_weight-r)/f.weight_target.weekly_rate)," weeks"]})]})})}),e.jsxs(A,{justify:"space-between",w:"full",children:[e.jsx(me,{size:"sm",children:"Nutrition Targets"}),e.jsxs(A,{children:[e.jsxs($,{display:"flex",alignItems:"center",children:[e.jsx(V,{htmlFor:"percentage-mode",mb:"0",fontSize:"sm",children:"Percentage Mode"}),e.jsx(Ht,{id:"percentage-mode",isChecked:R,onChange:z=>U(z.target.checked),colorScheme:"purple",isDisabled:_})]}),e.jsxs($,{display:"flex",alignItems:"center",children:[e.jsx(V,{htmlFor:"auto-calculate",mb:"0",fontSize:"sm",children:"Auto-calculate"}),e.jsx(Ht,{id:"auto-calculate",isChecked:_,onChange:z=>N(z.target.checked),colorScheme:"green"})]}),e.jsx(H,{size:"sm",variant:"outline",onClick:Qe,isDisabled:_,children:"Manual Calculate"})]})]}),R&&!_&&e.jsxs(e.Fragment,{children:[e.jsx(F,{p:3,bg:qn(I)?"green.50":"orange.50",borderRadius:"md",children:e.jsxs(A,{justify:"space-between",children:[e.jsxs(S,{align:"start",spacing:0,children:[e.jsx(d,{fontSize:"sm",fontWeight:"bold",children:"Macro Percentages"}),e.jsx(d,{fontSize:"sm",color:qn(I)?"green.600":"orange.600",children:qn(I)?`Total: ${(I.protein+I.carbs+I.fat).toFixed(1)}% ✓`:`Total: ${(I.protein+I.carbs+I.fat).toFixed(1)}% - Must equal 100%`})]}),!qn(I)&&e.jsx(H,{size:"sm",colorScheme:"orange",onClick:()=>{const Q=100/(I.protein+I.carbs+I.fat);w({protein:Math.round(I.protein*Q),carbs:Math.round(I.carbs*Q),fat:Math.round(I.fat*Q)})},children:"Auto-Balance"})]})}),e.jsxs(xe,{columns:3,spacing:4,w:"full",children:[e.jsxs($,{children:[e.jsx(V,{children:"Protein (%)"}),e.jsxs(ue,{value:I.protein,onChange:(z,Q)=>{Q!==void 0&&Q>=0&&Q<=100&&w(Ne=>({...Ne,protein:Q}))},min:0,max:100,step:1,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]}),e.jsxs(bt,{children:[Math.round(f.nutrition_targets.calories*I.protein/100/4),"g"]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Carbs (%)"}),e.jsxs(ue,{value:I.carbs,onChange:(z,Q)=>{Q!==void 0&&Q>=0&&Q<=100&&w(Ne=>({...Ne,carbs:Q}))},min:0,max:100,step:1,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]}),e.jsxs(bt,{children:[Math.round(f.nutrition_targets.calories*I.carbs/100/4),"g"]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Fat (%)"}),e.jsxs(ue,{value:I.fat,onChange:(z,Q)=>{Q!==void 0&&Q>=0&&Q<=100&&w(Ne=>({...Ne,fat:Q}))},min:0,max:100,step:1,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]}),e.jsxs(bt,{children:[Math.round(f.nutrition_targets.calories*I.fat/100/9),"g"]})]})]}),e.jsxs(A,{spacing:2,w:"full",justify:"center",children:[e.jsx(d,{fontSize:"sm",color:"gray.600",children:"Quick Presets:"}),e.jsx(H,{size:"xs",variant:"outline",onClick:()=>w({protein:30,carbs:40,fat:30}),children:"Balanced (30/40/30)"}),e.jsx(H,{size:"xs",variant:"outline",onClick:()=>w({protein:40,carbs:30,fat:30}),children:"High Protein (40/30/30)"}),e.jsx(H,{size:"xs",variant:"outline",onClick:()=>w({protein:20,carbs:15,fat:65}),children:"Keto (20/15/65)"}),e.jsx(H,{size:"xs",variant:"outline",onClick:()=>w({protein:25,carbs:55,fat:20}),children:"Low Fat (25/55/20)"})]})]}),e.jsxs(xe,{columns:2,spacing:4,w:"full",children:[e.jsxs($,{children:[e.jsx(V,{children:"Calories"}),e.jsxs(ue,{value:f.nutrition_targets.calories,onChange:(z,Q)=>{Q&&ar("calories",Q)&&W({...f,nutrition_targets:{...f.nutrition_targets,calories:Q}})},min:it.calories.min,max:it.calories.max,step:50,isDisabled:_,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]}),e.jsxs(bt,{children:["Range: ",it.calories.min,"-",it.calories.max," kcal"]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Protein (g)"}),e.jsxs(ue,{value:f.nutrition_targets.protein,onChange:(z,Q)=>{Q&&ar("protein",Q)&&W({...f,nutrition_targets:{...f.nutrition_targets,protein:Q}})},min:it.protein.min,max:it.protein.max,step:5,isDisabled:_||R,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]}),e.jsx(bt,{children:R?`${(f.nutrition_targets.protein*4/f.nutrition_targets.calories*100).toFixed(1)}% of calories`:`Range: ${it.protein.min}-${it.protein.max} g`})]}),e.jsxs($,{children:[e.jsx(V,{children:"Carbs (g)"}),e.jsxs(ue,{value:f.nutrition_targets.carbs,onChange:(z,Q)=>{Q&&ar("carbs",Q)&&W({...f,nutrition_targets:{...f.nutrition_targets,carbs:Q}})},min:it.carbs.min,max:it.carbs.max,step:5,isDisabled:_||R,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]}),e.jsx(bt,{children:R?`${(f.nutrition_targets.carbs*4/f.nutrition_targets.calories*100).toFixed(1)}% of calories`:`Range: ${it.carbs.min}-${it.carbs.max} g`})]}),e.jsxs($,{children:[e.jsx(V,{children:"Fat (g)"}),e.jsxs(ue,{value:f.nutrition_targets.fat,onChange:(z,Q)=>{Q&&ar("fat",Q)&&W({...f,nutrition_targets:{...f.nutrition_targets,fat:Q}})},min:it.fat.min,max:it.fat.max,step:5,isDisabled:_||R,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]}),e.jsx(bt,{children:R?`${(f.nutrition_targets.fat*9/f.nutrition_targets.calories*100).toFixed(1)}% of calories`:`Range: ${it.fat.min}-${it.fat.max} g`})]}),e.jsxs($,{children:[e.jsx(V,{children:"Fiber (g)"}),e.jsxs(ue,{value:f.nutrition_targets.fiber||25,onChange:(z,Q)=>{Q&&ar("fiber",Q)&&W({...f,nutrition_targets:{...f.nutrition_targets,fiber:Q}})},min:it.fiber.min,max:it.fiber.max,step:1,isDisabled:_,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]}),e.jsxs(bt,{children:["Range: ",it.fiber.min,"-",it.fiber.max," g"]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Sodium (mg)"}),e.jsxs(ue,{value:f.nutrition_targets.sodium||2300,onChange:(z,Q)=>{Q&&ar("sodium",Q)&&W({...f,nutrition_targets:{...f.nutrition_targets,sodium:Q}})},min:it.sodium.min,max:it.sodium.max,step:100,isDisabled:_,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]}),e.jsxs(bt,{children:["Range: ",it.sodium.min,"-",it.sodium.max," mg"]})]})]}),e.jsxs(H,{colorScheme:"green",onClick:ee,isLoading:u,loadingText:"Creating goal...",w:"full",size:"lg",isDisabled:R&&!qn(I),children:["Create Goal",R&&!qn(I)&&e.jsx(d,{fontSize:"xs",color:"gray.400",ml:2,children:"(Balance percentages to 100%)"})]})]})})]})]}),e.jsxs(Ue,{isOpen:oe,onClose:pe,size:"md",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsx(Pe,{children:"Log Your Weight"}),e.jsx(De,{}),e.jsx(Le,{pb:6,children:e.jsxs(S,{spacing:4,children:[e.jsxs($,{isRequired:!0,children:[e.jsx(V,{children:"Date"}),e.jsx(ve,{type:"date",value:te.date,onChange:z=>y({...te,date:z.target.value})})]}),e.jsxs($,{isRequired:!0,children:[e.jsx(V,{children:"Weight (lbs)"}),e.jsxs(ue,{value:te.weight,onChange:(z,Q)=>{Q&&Vs(Q)&&y({...te,weight:Q})},min:lr,max:cr,step:.1,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]}),e.jsxs(bt,{children:["Range: ",lr,"-",cr," lbs"]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Notes (Optional)"}),e.jsx(Kt,{value:te.notes,onChange:z=>y({...te,notes:z.target.value}),placeholder:"e.g., Morning weight, after workout, etc.",rows:3})]}),e.jsx(H,{colorScheme:"blue",onClick:Ie,isLoading:u,loadingText:"Logging weight...",w:"full",size:"lg",children:"Log Weight"})]})})]})]}),e.jsxs(Ue,{isOpen:E,onClose:B,size:"xl",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsx(Pe,{children:"Edit Goal"}),e.jsx(De,{}),e.jsx(Le,{pb:6,children:e.jsxs(S,{spacing:4,children:[e.jsxs($,{isRequired:!0,children:[e.jsx(V,{children:"Goal Title"}),e.jsx(ve,{value:f.title,onChange:z=>W({...f,title:z.target.value}),placeholder:"e.g., Lose weight for summer"})]}),e.jsxs($,{isRequired:!0,children:[e.jsx(V,{children:"Goal Type"}),e.jsxs(Be,{value:f.goal_type,onChange:z=>W({...f,goal_type:z.target.value}),children:[e.jsx("option",{value:"weight_loss",children:"Weight Loss"}),e.jsx("option",{value:"weight_gain",children:"Weight Gain"}),e.jsx("option",{value:"maintenance",children:"Maintenance"}),e.jsx("option",{value:"muscle_gain",children:"Muscle Gain"})]})]}),e.jsx(H,{colorScheme:"green",onClick:ne,isLoading:g,loadingText:"Updating goal...",w:"full",size:"lg",children:"Update Goal"})]})})]})]}),e.jsx(rh,{isOpen:J,leastDestructiveRef:c,onClose:q,children:e.jsx(Te,{children:e.jsxs(ih,{children:[e.jsx(Pe,{fontSize:"lg",fontWeight:"bold",children:"Delete Goal"}),e.jsxs(Le,{children:['Are you sure you want to delete "',b?.title,'"? This action cannot be undone.']}),e.jsxs(mt,{children:[e.jsx(H,{ref:c,onClick:q,children:"Cancel"}),e.jsx(H,{colorScheme:"red",onClick:dt,isLoading:p,loadingText:"Deleting...",ml:3,children:"Delete"})]})]})})})]})}function iS(){const{user:t}=vr(),[n,r]=C.useState(!1),[i,s]=C.useState(!1),o=wt(),a=Wt({base:!0,md:!1}),[l,c]=C.useState({dietary_restrictions:[],allergens:[],disliked_foods:[],preferred_cuisines:[],cooking_skill_level:"intermediate",max_prep_time:45,budget_preference:"moderate"}),[u,h]=C.useState({units:"metric",theme:"light",timezone:"America/New_York",notifications_enabled:!0,weekly_reports:!0}),[g,m]=C.useState({name:"",about_me:""}),[p,j]=C.useState([]),[b,v]=C.useState(!1);C.useEffect(()=>{_()},[]);const _=async()=>{r(!0);try{const k=await Z.get("/preferences/dietary");k.data&&c(B=>({...B,...k.data}));const E=await Z.get("/preferences/nutrition");E.data&&h(B=>({...B,...E.data}));const O=await Z.get("/auth/profile");O.data&&m(B=>({...B,name:O.data.name||"",about_me:O.data.about_me||""}))}catch(k){console.error("Error fetching preferences:",k),o({title:"Fetch Error",description:"Failed to load preferences. Using defaults.",status:"warning",duration:3e3,isClosable:!0})}r(!1)},N=async()=>{s(!0);try{await Z.put("/preferences/dietary",l),o({title:"Preferences Saved",description:"Your dietary preferences have been updated.",status:"success",duration:3e3,isClosable:!0})}catch(k){console.error("Error saving dietary preferences:",k),o({title:"Save Error",description:"Failed to save dietary preferences. Please try again.",status:"error",duration:3e3,isClosable:!0})}s(!1)},R=async()=>{s(!0);try{await Z.put("/preferences/nutrition",u),Nx(u.timezone),o({title:"Preferences Saved",description:"Your nutrition preferences have been updated.",status:"success",duration:3e3,isClosable:!0})}catch(k){console.error("Error saving nutrition preferences:",k),o({title:"Save Error",description:"Failed to save nutrition preferences. Please try again.",status:"error",duration:3e3,isClosable:!0})}s(!1)},U=async()=>{s(!0);try{await Z.put("/auth/profile",g),o({title:"Profile Saved",description:"Your profile information has been updated.",status:"success",duration:3e3,isClosable:!0})}catch(k){console.error("Error saving user profile:",k),o({title:"Save Error",description:"Failed to save profile. Please try again.",status:"error",duration:3e3,isClosable:!0})}s(!1)},I=async()=>{v(!0);try{const k=await Z.get("/ai/chat/history");k.data&&j(k.data.sessions||[])}catch(k){console.error("Error fetching session history:",k),o({title:"Fetch Error",description:"Failed to load session history.",status:"error",duration:3e3,isClosable:!0})}v(!1)},w=["vegetarian","vegan","keto","paleo","gluten-free","dairy-free","low-carb","low-fat","mediterranean"],P=["nuts","shellfish","fish","eggs","milk","soy","wheat","sesame"],M=["mediterranean","asian","mexican","italian","indian","american","french","thai","japanese","middle-eastern"];return n?e.jsx(It,{maxW:"container.lg",py:8,children:e.jsx(d,{children:"Loading preferences..."})}):e.jsx(It,{maxW:a?"100%":"container.lg",py:a?4:8,px:a?3:8,children:e.jsxs(S,{spacing:a?4:8,align:"stretch",children:[e.jsxs(F,{textAlign:a?"center":"left",children:[e.jsx(me,{size:a?"md":"lg",mb:2,children:"Settings ⚙️"}),e.jsx(d,{color:"gray.600",fontSize:a?"sm":"md",children:"Customize your nutrition tracking experience"})]}),e.jsx(se,{size:a?"sm":"md",children:e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsx(me,{size:"sm",children:"Account Information"}),e.jsxs(S,{spacing:3,align:"stretch",children:[e.jsxs(A,{justify:"space-between",flexDirection:a?"column":"row",align:a?"start":"center",children:[e.jsx(d,{fontWeight:"medium",fontSize:a?"sm":"md",children:"Email:"}),e.jsx(d,{color:"gray.600",fontSize:a?"sm":"md",children:t?.email})]}),e.jsxs(A,{justify:"space-between",flexDirection:a?"column":"row",align:a?"start":"center",children:[e.jsx(d,{fontWeight:"medium",fontSize:a?"sm":"md",children:"Account Type:"}),e.jsx(je,{colorScheme:"green",fontSize:a?"xs":"sm",children:"Premium"})]}),e.jsx(_t,{}),e.jsxs($,{children:[e.jsx(V,{fontSize:a?"sm":"md",fontWeight:"medium",children:"Display Name"}),e.jsx(ve,{value:g.name,onChange:k=>m(E=>({...E,name:k.target.value})),placeholder:"Enter your name",size:a?"sm":"md"})]}),e.jsxs($,{children:[e.jsx(V,{fontSize:a?"sm":"md",fontWeight:"medium",children:"About Me"}),e.jsx(Kt,{value:g.about_me,onChange:k=>m(E=>({...E,about_me:k.target.value})),placeholder:"Tell the AI about yourself, your goals, preferences, or any other relevant information for personalized recommendations",resize:"vertical",minH:a?"80px":"100px",size:a?"sm":"md"}),e.jsx(d,{fontSize:"xs",color:"gray.500",mt:1,children:"This information helps the AI provide more personalized nutrition advice"})]}),e.jsx(H,{colorScheme:"green",onClick:U,isLoading:i,size:a?"sm":"md",children:"Save Profile"})]})]})})}),a?e.jsxs(Ao,{defaultIndex:[0],allowMultiple:!0,children:[e.jsxs(Lr,{children:[e.jsxs(Rr,{py:4,children:[e.jsx(F,{flex:"1",textAlign:"left",children:e.jsx(d,{fontWeight:"semibold",children:"🥗 Dietary Preferences"})}),e.jsx(Mr,{})]}),e.jsx(Or,{pb:4,children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs($,{children:[e.jsx(V,{fontSize:"sm",fontWeight:"medium",children:"Dietary Restrictions"}),e.jsx(Yn,{value:l.dietary_restrictions,onChange:k=>c(E=>({...E,dietary_restrictions:k})),children:e.jsx(Qt,{spacing:2,children:w.map(k=>e.jsx($t,{children:e.jsx(ft,{value:k,size:"sm",children:k.charAt(0).toUpperCase()+k.slice(1).replace("-"," ")})},k))})})]}),e.jsxs($,{children:[e.jsx(V,{fontSize:"sm",fontWeight:"medium",children:"Allergens to Avoid"}),e.jsx(Yn,{value:l.allergens,onChange:k=>c(E=>({...E,allergens:k})),children:e.jsx(Qt,{spacing:2,children:P.map(k=>e.jsx($t,{children:e.jsx(ft,{value:k,size:"sm",colorScheme:"red",children:k.charAt(0).toUpperCase()+k.slice(1)})},k))})})]}),e.jsxs(xe,{columns:1,spacing:3,children:[e.jsxs($,{children:[e.jsx(V,{fontSize:"sm",children:"Cooking Skill Level"}),e.jsxs(Be,{value:l.cooking_skill_level,onChange:k=>c(E=>({...E,cooking_skill_level:k.target.value})),size:"sm",children:[e.jsx("option",{value:"beginner",children:"Beginner"}),e.jsx("option",{value:"intermediate",children:"Intermediate"}),e.jsx("option",{value:"advanced",children:"Advanced"})]})]}),e.jsxs($,{children:[e.jsx(V,{fontSize:"sm",children:"Max Prep Time (minutes)"}),e.jsxs(Be,{value:l.max_prep_time,onChange:k=>c(E=>({...E,max_prep_time:parseInt(k.target.value)})),size:"sm",children:[e.jsx("option",{value:15,children:"15 minutes"}),e.jsx("option",{value:30,children:"30 minutes"}),e.jsx("option",{value:45,children:"45 minutes"}),e.jsx("option",{value:60,children:"1 hour"}),e.jsx("option",{value:90,children:"1.5 hours"})]})]})]}),e.jsx(H,{colorScheme:"green",onClick:N,isLoading:i,size:"sm",w:"full",children:"Save Dietary Preferences"})]})})]}),e.jsxs(Lr,{children:[e.jsxs(Rr,{py:4,children:[e.jsx(F,{flex:"1",textAlign:"left",children:e.jsx(d,{fontWeight:"semibold",children:"⚙️ App Preferences"})}),e.jsx(Mr,{})]}),e.jsx(Or,{pb:4,children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs(xe,{columns:1,spacing:3,children:[e.jsxs($,{children:[e.jsx(V,{fontSize:"sm",children:"Units"}),e.jsxs(Be,{value:u.units,onChange:k=>h(E=>({...E,units:k.target.value})),size:"sm",children:[e.jsx("option",{value:"metric",children:"Metric (kg, cm)"}),e.jsx("option",{value:"imperial",children:"Imperial (lbs, ft)"})]})]}),e.jsxs($,{children:[e.jsx(V,{fontSize:"sm",children:"Theme"}),e.jsxs(Be,{value:u.theme,onChange:k=>h(E=>({...E,theme:k.target.value})),size:"sm",children:[e.jsx("option",{value:"light",children:"Light"}),e.jsx("option",{value:"dark",children:"Dark"}),e.jsx("option",{value:"auto",children:"Auto"})]})]}),e.jsxs($,{children:[e.jsx(V,{fontSize:"sm",children:"Timezone"}),e.jsxs(Be,{value:u.timezone,onChange:k=>h(E=>({...E,timezone:k.target.value})),size:"sm",children:[e.jsx("option",{value:"America/New_York",children:"Eastern Time"}),e.jsx("option",{value:"America/Chicago",children:"Central Time"}),e.jsx("option",{value:"America/Denver",children:"Mountain Time"}),e.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time"})]})]})]}),e.jsxs(S,{spacing:3,align:"stretch",children:[e.jsxs($,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(V,{htmlFor:"notifications",mb:"0",fontSize:"sm",children:"Push Notifications"}),e.jsx(Ht,{id:"notifications",isChecked:u.notifications_enabled,onChange:k=>h(E=>({...E,notifications_enabled:k.target.checked})),colorScheme:"green",size:"sm"})]}),e.jsxs($,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(V,{htmlFor:"reports",mb:"0",fontSize:"sm",children:"Weekly Reports"}),e.jsx(Ht,{id:"reports",isChecked:u.weekly_reports,onChange:k=>h(E=>({...E,weekly_reports:k.target.checked})),colorScheme:"green",size:"sm"})]})]}),e.jsx(H,{colorScheme:"blue",onClick:R,isLoading:i,size:"sm",w:"full",children:"Save App Preferences"})]})})]}),e.jsxs(Lr,{children:[e.jsxs(Rr,{py:4,children:[e.jsx(F,{flex:"1",textAlign:"left",children:e.jsx(d,{fontWeight:"semibold",children:"💬 Session History"})}),e.jsx(Mr,{})]}),e.jsx(Or,{pb:4,children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs(A,{justify:"space-between",children:[e.jsx(d,{fontSize:"sm",color:"gray.600",children:"View your AI chat sessions"}),e.jsx(H,{size:"sm",variant:"outline",onClick:I,isLoading:b,children:"Load History"})]}),p.length>0?e.jsx(S,{spacing:2,align:"stretch",maxH:"200px",overflowY:"auto",children:p.slice(0,10).map((k,E)=>e.jsx(se,{size:"sm",variant:"outline",children:e.jsx(re,{p:3,children:e.jsxs(S,{spacing:1,align:"stretch",children:[e.jsxs(A,{justify:"space-between",children:[e.jsx(d,{fontSize:"xs",fontWeight:"medium",children:new Date(k.created_at).toLocaleDateString()}),e.jsxs(d,{fontSize:"xs",color:"gray.500",children:[k.message_count," messages"]})]}),e.jsx(d,{fontSize:"xs",color:"gray.600",noOfLines:2,children:k.preview||"No preview available"})]})})},E))}):e.jsx(d,{fontSize:"sm",color:"gray.500",textAlign:"center",py:4,children:"No session history available"})]})})]})]}):e.jsxs(Kr,{variant:"enclosed",colorScheme:"green",children:[e.jsxs(Jr,{children:[e.jsx(Pt,{children:"🥗 Dietary Preferences"}),e.jsx(Pt,{children:"⚙️ App Preferences"}),e.jsx(Pt,{children:"💬 Session History"}),e.jsx(Pt,{children:"🍎 Custom Foods"}),e.jsx(Pt,{children:"📊 Data & Privacy"})]}),e.jsxs(Qr,{children:[e.jsx(Lt,{children:e.jsxs(S,{spacing:6,align:"stretch",children:[e.jsx(se,{children:e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsx(me,{size:"sm",children:"Dietary Restrictions"}),e.jsx(Yn,{value:l.dietary_restrictions,onChange:k=>c({...l,dietary_restrictions:k}),children:e.jsx(Qt,{spacing:2,children:w.map(k=>e.jsx($t,{children:e.jsx(ft,{value:k,children:k.charAt(0).toUpperCase()+k.slice(1)})},k))})})]})})}),e.jsx(se,{children:e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsx(me,{size:"sm",children:"Allergies & Intolerances"}),e.jsx(Yn,{value:l.allergens,onChange:k=>c({...l,allergens:k}),children:e.jsx(Qt,{spacing:2,children:P.map(k=>e.jsx($t,{children:e.jsx(ft,{value:k,children:k.charAt(0).toUpperCase()+k.slice(1)})},k))})})]})})}),e.jsx(se,{children:e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsx(me,{size:"sm",children:"Cuisine Preferences"}),e.jsx(Yn,{value:l.preferred_cuisines,onChange:k=>c({...l,preferred_cuisines:k}),children:e.jsx(Qt,{spacing:2,children:M.map(k=>e.jsx($t,{children:e.jsx(ft,{value:k,children:k.charAt(0).toUpperCase()+k.slice(1).replace("-"," ")})},k))})})]})})}),e.jsx(se,{children:e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsx(me,{size:"sm",children:"Cooking Preferences"}),e.jsxs(A,{spacing:4,w:"full",children:[e.jsxs($,{children:[e.jsx(V,{children:"Cooking Skill Level"}),e.jsxs(Be,{value:l.cooking_skill_level,onChange:k=>c({...l,cooking_skill_level:k.target.value}),children:[e.jsx("option",{value:"beginner",children:"Beginner"}),e.jsx("option",{value:"intermediate",children:"Intermediate"}),e.jsx("option",{value:"advanced",children:"Advanced"})]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Max Prep Time (minutes)"}),e.jsxs(Be,{value:l.max_prep_time.toString(),onChange:k=>c({...l,max_prep_time:parseInt(k.target.value)}),children:[e.jsx("option",{value:"15",children:"15 minutes"}),e.jsx("option",{value:"30",children:"30 minutes"}),e.jsx("option",{value:"45",children:"45 minutes"}),e.jsx("option",{value:"60",children:"1 hour"}),e.jsx("option",{value:"90",children:"1.5 hours"}),e.jsx("option",{value:"120",children:"2 hours"})]})]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Budget Preference"}),e.jsxs(Be,{value:l.budget_preference,onChange:k=>c({...l,budget_preference:k.target.value}),children:[e.jsx("option",{value:"budget",children:"Budget-friendly"}),e.jsx("option",{value:"moderate",children:"Moderate"}),e.jsx("option",{value:"premium",children:"Premium"})]})]})]})})}),e.jsx(se,{border:"2px solid",borderColor:"red.200",bg:"red.50",children:e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs(A,{justify:"space-between",align:"center",children:[e.jsxs(S,{align:"start",spacing:1,children:[e.jsx(me,{size:"md",color:"red.700",children:"🚫 Foods to Avoid"}),e.jsx(d,{fontSize:"sm",color:"red.600",children:"Foods you dislike will be excluded from all meal plans and suggestions"})]}),e.jsxs(je,{colorScheme:"red",variant:"subtle",children:[l.disliked_foods.length," foods avoided"]})]}),l.disliked_foods.length>0&&e.jsxs(F,{children:[e.jsx(d,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Currently avoiding:"}),e.jsx(A,{spacing:2,wrap:"wrap",children:l.disliked_foods.map((k,E)=>e.jsxs(je,{colorScheme:"red",variant:"solid",cursor:"pointer",onClick:()=>{const O=l.disliked_foods.filter((B,J)=>J!==E);c({...l,disliked_foods:O})},title:"Click to remove",children:[k," ✕"]},E))})]}),e.jsxs(S,{spacing:2,align:"stretch",children:[e.jsx(d,{fontSize:"sm",fontWeight:"medium",children:"Add foods to avoid:"}),e.jsx(ve,{value:l.disliked_foods.join(", "),onChange:k=>c({...l,disliked_foods:k.target.value.split(",").map(E=>E.trim()).filter(E=>E.length>0)}),placeholder:"e.g., mushrooms, olives, cilantro, shrimp",bg:"white"}),e.jsx(d,{fontSize:"xs",color:"gray.500",children:"💡 Tip: The AI will automatically add foods you mention disliking in conversations"})]})]})})}),e.jsx(H,{colorScheme:"green",onClick:N,isLoading:i,loadingText:"Saving...",size:"lg",children:"Save Dietary Preferences"})]})}),e.jsx(Lt,{children:e.jsxs(S,{spacing:6,align:"stretch",children:[e.jsx(se,{children:e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsx(me,{size:"sm",children:"Units & Display"}),e.jsxs(A,{spacing:4,w:"full",children:[e.jsxs($,{children:[e.jsx(V,{children:"Measurement Units"}),e.jsxs(Be,{value:u.units,onChange:k=>h({...u,units:k.target.value}),children:[e.jsx("option",{value:"metric",children:"Metric (kg, cm, °C)"}),e.jsx("option",{value:"imperial",children:"Imperial (lb, ft, °F)"})]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Theme"}),e.jsxs(Be,{value:u.theme,onChange:k=>h({...u,theme:k.target.value}),children:[e.jsx("option",{value:"light",children:"Light"}),e.jsx("option",{value:"dark",children:"Dark"}),e.jsx("option",{value:"auto",children:"Auto"})]})]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Timezone"}),e.jsx(d,{fontSize:"sm",color:"gray.600",mb:2,children:"Used for accurate meal logging and date calculations"}),e.jsxs(Be,{value:u.timezone,onChange:k=>h({...u,timezone:k.target.value}),children:[e.jsxs("optgroup",{label:"US & Canada",children:[e.jsx("option",{value:"America/New_York",children:"Eastern Time (ET)"}),e.jsx("option",{value:"America/Chicago",children:"Central Time (CT)"}),e.jsx("option",{value:"America/Denver",children:"Mountain Time (MT)"}),e.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time (PT)"}),e.jsx("option",{value:"America/Anchorage",children:"Alaska Time (AKT)"}),e.jsx("option",{value:"Pacific/Honolulu",children:"Hawaii Time (HST)"}),e.jsx("option",{value:"America/Toronto",children:"Toronto (ET)"}),e.jsx("option",{value:"America/Vancouver",children:"Vancouver (PT)"})]}),e.jsxs("optgroup",{label:"Europe",children:[e.jsx("option",{value:"Europe/London",children:"London (GMT/BST)"}),e.jsx("option",{value:"Europe/Paris",children:"Paris (CET/CEST)"}),e.jsx("option",{value:"Europe/Berlin",children:"Berlin (CET/CEST)"}),e.jsx("option",{value:"Europe/Madrid",children:"Madrid (CET/CEST)"}),e.jsx("option",{value:"Europe/Rome",children:"Rome (CET/CEST)"}),e.jsx("option",{value:"Europe/Amsterdam",children:"Amsterdam (CET/CEST)"}),e.jsx("option",{value:"Europe/Stockholm",children:"Stockholm (CET/CEST)"}),e.jsx("option",{value:"Europe/Moscow",children:"Moscow (MSK)"})]}),e.jsxs("optgroup",{label:"Asia",children:[e.jsx("option",{value:"Asia/Tokyo",children:"Tokyo (JST)"}),e.jsx("option",{value:"Asia/Shanghai",children:"Shanghai (CST)"}),e.jsx("option",{value:"Asia/Hong_Kong",children:"Hong Kong (HKT)"}),e.jsx("option",{value:"Asia/Singapore",children:"Singapore (SGT)"}),e.jsx("option",{value:"Asia/Seoul",children:"Seoul (KST)"}),e.jsx("option",{value:"Asia/Mumbai",children:"Mumbai (IST)"}),e.jsx("option",{value:"Asia/Dubai",children:"Dubai (GST)"})]}),e.jsxs("optgroup",{label:"Australia & Oceania",children:[e.jsx("option",{value:"Australia/Sydney",children:"Sydney (AEST/AEDT)"}),e.jsx("option",{value:"Australia/Melbourne",children:"Melbourne (AEST/AEDT)"}),e.jsx("option",{value:"Australia/Perth",children:"Perth (AWST)"}),e.jsx("option",{value:"Pacific/Auckland",children:"Auckland (NZST/NZDT)"})]}),e.jsxs("optgroup",{label:"Other",children:[e.jsx("option",{value:"UTC",children:"UTC (Coordinated Universal Time)"}),e.jsx("option",{value:"America/Sao_Paulo",children:"São Paulo (BRT/BRST)"}),e.jsx("option",{value:"Africa/Cairo",children:"Cairo (EET/EEST)"}),e.jsx("option",{value:"Africa/Johannesburg",children:"Johannesburg (SAST)"})]})]})]})]})})}),e.jsx(se,{children:e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsx(me,{size:"sm",children:"Notifications"}),e.jsxs(A,{justify:"space-between",children:[e.jsxs(F,{children:[e.jsx(d,{fontWeight:"medium",children:"Enable Notifications"}),e.jsx(d,{fontSize:"sm",color:"gray.600",children:"Get reminders about logging meals and progress updates"})]}),e.jsx(Ht,{isChecked:u.notifications_enabled,onChange:k=>h({...u,notifications_enabled:k.target.checked})})]}),e.jsx(_t,{}),e.jsxs(A,{justify:"space-between",children:[e.jsxs(F,{children:[e.jsx(d,{fontWeight:"medium",children:"Weekly Reports"}),e.jsx(d,{fontSize:"sm",color:"gray.600",children:"Receive weekly nutrition and progress summaries"})]}),e.jsx(Ht,{isChecked:u.weekly_reports,onChange:k=>h({...u,weekly_reports:k.target.checked})})]})]})})}),e.jsx(H,{colorScheme:"green",onClick:R,isLoading:i,loadingText:"Saving...",size:"lg",children:"Save App Settings"})]})}),e.jsx(Lt,{children:e.jsx(S,{spacing:6,align:"stretch",children:e.jsx(se,{children:e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs(A,{justify:"space-between",children:[e.jsxs(F,{children:[e.jsx(me,{size:"sm",children:"AI Chat Sessions"}),e.jsx(d,{fontSize:"sm",color:"gray.600",children:"View your conversation history with the AI assistant"})]}),e.jsx(H,{variant:"outline",onClick:I,isLoading:b,loadingText:"Loading...",children:"Refresh History"})]}),p.length>0?e.jsx(S,{spacing:3,align:"stretch",maxH:"400px",overflowY:"auto",children:p.map((k,E)=>e.jsx(se,{variant:"outline",size:"sm",children:e.jsxs(re,{children:[e.jsxs(A,{justify:"space-between",mb:2,children:[e.jsxs(S,{align:"start",spacing:0,children:[e.jsxs(d,{fontWeight:"medium",fontSize:"sm",children:["Session ",E+1]}),e.jsx(d,{fontSize:"xs",color:"gray.500",children:new Date(k.created_at).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),e.jsxs(je,{colorScheme:"blue",fontSize:"xs",children:[k.message_count," messages"]})]}),e.jsx(d,{fontSize:"sm",color:"gray.600",noOfLines:3,children:k.preview||"No preview available"})]})},E))}):e.jsx(d,{textAlign:"center",color:"gray.500",py:8,children:"No chat sessions found. Start a conversation with the AI to see your history here."})]})})})})}),e.jsx(Lt,{children:e.jsxs(S,{spacing:6,align:"stretch",children:[e.jsx(se,{children:e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsx(me,{size:"sm",children:"Custom Foods"}),e.jsx(d,{fontSize:"sm",color:"gray.600",children:"Add your frequently eaten foods that aren't in our database. This feature is coming soon!"}),e.jsx(je,{colorScheme:"blue",alignSelf:"start",children:"Coming Soon"})]})})}),e.jsx(se,{children:e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsx(me,{size:"sm",children:"Export Data"}),e.jsx(d,{fontSize:"sm",color:"gray.600",children:"Download your nutrition data and food logs."}),e.jsxs(A,{children:[e.jsx(H,{variant:"outline",isDisabled:!0,children:"Export to CSV"}),e.jsx(H,{variant:"outline",isDisabled:!0,children:"Export to PDF"})]}),e.jsx(je,{colorScheme:"blue",alignSelf:"start",children:"Coming Soon"})]})})})]})}),e.jsx(Lt,{children:e.jsxs(S,{spacing:6,align:"stretch",children:[e.jsx(se,{children:e.jsx(re,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsx(me,{size:"sm",children:"Data & Privacy"}),e.jsx(d,{fontSize:"sm",color:"gray.600",children:"Manage your data sharing and privacy settings."}),e.jsx(_t,{}),e.jsxs(A,{justify:"space-between",w:"full",children:[e.jsx(d,{fontSize:"sm",children:"Share data with partners"}),e.jsx(Ht,{isChecked:!0,onChange:()=>{},colorScheme:"green",size:"sm"})]}),e.jsxs(A,{justify:"space-between",w:"full",children:[e.jsx(d,{fontSize:"sm",children:"Allow AI to suggest foods"}),e.jsx(Ht,{isChecked:!0,onChange:()=>{},colorScheme:"green",size:"sm"})]}),e.jsxs(A,{justify:"space-between",w:"full",children:[e.jsx(d,{fontSize:"sm",children:"Receive personalized ads"}),e.jsx(Ht,{isChecked:!1,onChange:()=>{},colorScheme:"green",size:"sm"})]})]})})}),e.jsx(H,{colorScheme:"red",onClick:()=>{},size:"lg",w:"full",children:"Delete Account"})]})})]})]})]})})}const sS=(t,n)=>{const r={nutrition:{icon:td,color:"green",bgColor:"green.50",borderColor:"green.200"},habits:{icon:id,color:"blue",bgColor:"blue.50",borderColor:"blue.200"},progress:{icon:rd,color:"purple",bgColor:"purple.50",borderColor:"purple.200"},recommendation:{icon:n===3?y0:Gr,color:n===3?"red":"orange",bgColor:n===3?"red.50":"orange.50",borderColor:n===3?"red.200":"orange.200"}};return r[t]||r.recommendation},oS=t=>{switch(t){case 3:return{label:"High Priority",color:"red"};case 2:return{label:"Medium",color:"orange"};case 1:return{label:"Low",color:"gray"};default:return{label:"Info",color:"gray"}}};function qs({insight:t}){const{icon:n,color:r,bgColor:i,borderColor:s}=sS(t.category,t.importance),{label:o,color:a}=oS(t.importance),l=_e("white","gray.800"),c=_e("gray.600","gray.300"),u=_e(s,"gray.600"),h=_e(i,`${r}.900`);return e.jsx(se,{bg:l,borderWidth:2,borderColor:u,_hover:{transform:"translateY(-2px)",shadow:"lg",borderColor:`${r}.300`},transition:"all 0.2s",children:e.jsxs(re,{children:[e.jsxs(A,{spacing:3,align:"start",mb:3,children:[e.jsx(F,{p:2,bg:h,borderRadius:"md",color:`${r}.600`,children:e.jsx($e,{as:n,boxSize:4})}),e.jsxs(F,{flex:1,children:[e.jsxs(A,{justify:"space-between",align:"start",mb:2,children:[e.jsx(me,{size:"sm",lineHeight:"short",children:t.title}),e.jsx(je,{colorScheme:a,variant:"subtle",size:"sm",children:o})]}),e.jsxs(A,{mb:3,children:[e.jsx(je,{colorScheme:r,variant:"outline",size:"sm",textTransform:"capitalize",children:t.category}),t.importance===3&&e.jsxs(A,{spacing:1,children:[e.jsx($e,{as:E0,color:"yellow.500",boxSize:3}),e.jsx(d,{fontSize:"xs",color:"yellow.600",fontWeight:"medium",children:"Action Needed"})]})]})]})]}),e.jsx(d,{color:c,fontSize:"sm",lineHeight:"relaxed",children:t.content})]})})}function aS({title:t,trends:n,timeframe:r}){const i=_e("white","gray.800"),s=_e("gray.200","gray.700"),o=(l,c)=>!c||c===0?0:Math.min(l/c*100,100),a=(l,c)=>{if(!c)return"gray";const u=l/c*100;return u>=90?"green":u>=70?"yellow":"red"};return e.jsx(se,{bg:i,borderColor:s,children:e.jsxs(re,{children:[e.jsxs(F,{mb:4,children:[e.jsxs(A,{justify:"space-between",align:"center",mb:2,children:[e.jsx(me,{size:"md",children:t}),e.jsx(je,{colorScheme:"blue",variant:"subtle",children:r})]}),e.jsx(d,{color:"gray.600",fontSize:"sm",children:"Track your nutrition metrics over time"})]}),e.jsx(xe,{columns:{base:1,md:2,lg:n.length>3?4:n.length},spacing:4,children:n.map((l,c)=>e.jsxs(be,{children:[e.jsx(we,{fontSize:"sm",color:"gray.600",children:l.name}),e.jsxs(Se,{fontSize:"2xl",children:[typeof l.value=="number"?l.value.toFixed(1):l.value,e.jsx(d,{as:"span",fontSize:"sm",color:"gray.500",ml:1,children:l.unit})]}),l.trend!==void 0&&l.trend_direction&&e.jsxs(ot,{children:[e.jsx(sh,{type:l.trend_direction==="up"?"increase":"decrease"}),Math.abs(l.trend).toFixed(1),"% from last period"]}),l.target&&e.jsxs(F,{mt:2,children:[e.jsxs(d,{fontSize:"xs",color:"gray.500",mb:1,children:["Target: ",l.target," ",l.target_unit||l.unit]}),e.jsx(xt,{value:o(l.value,l.target),colorScheme:a(l.value,l.target),size:"sm",borderRadius:"md"})]})]},c))}),n.length===0&&e.jsx(d,{color:"gray.500",textAlign:"center",py:8,children:"No trend data available for this period. Keep logging your meals to see meaningful trends!"})]})})}function lS({insights:t,trends:n,loading:r,lastUpdated:i,onRefresh:s,timeframe:o,onTimeframeChange:a}){const[l,c]=C.useState(!1),u=wt(),h=async()=>{c(!0);try{await s(),u({title:"Insights Updated",description:"Your analytics have been refreshed with the latest data.",status:"success",duration:3e3,isClosable:!0})}catch{u({title:"Refresh Failed",description:"Failed to update insights. Please try again.",status:"error",duration:5e3,isClosable:!0})}finally{c(!1)}},g=b=>{if(!b)return"Never";const v=new Date(b),N=new Date().getTime()-v.getTime(),R=Math.floor(N/(1e3*60)),U=Math.floor(R/60);return R<1?"Just now":R<60?`${R} min${R>1?"s":""} ago`:U<24?`${U} hour${U>1?"s":""} ago`:v.toLocaleDateString()},m=t.filter(b=>b.importance===3),p=t.filter(b=>b.importance===2),j=t.filter(b=>b.importance===1);return e.jsxs(S,{spacing:6,align:"stretch",children:[e.jsx(F,{children:e.jsxs(A,{justify:"space-between",align:"center",mb:4,children:[e.jsxs(F,{children:[e.jsx(me,{size:"lg",mb:2,children:"AI-Powered Analytics & Trends 🤖"}),e.jsx(d,{color:"gray.600",children:"Personalized insights about your nutrition patterns and progress"})]}),e.jsxs(S,{align:"end",spacing:2,children:[e.jsxs(A,{spacing:2,children:[e.jsx(H,{size:"sm",variant:o==="week"?"solid":"outline",colorScheme:"blue",onClick:()=>a("week"),children:"Week"}),e.jsx(H,{size:"sm",variant:o==="month"?"solid":"outline",colorScheme:"blue",onClick:()=>a("month"),children:"Month"})]}),e.jsx(A,{spacing:2,children:e.jsx(H,{size:"sm",leftIcon:l?e.jsx(ut,{size:"xs"}):e.jsx(nd,{}),onClick:h,isLoading:l,loadingText:"Updating",children:"Refresh"})}),i&&e.jsxs(A,{spacing:1,color:"gray.500",fontSize:"xs",children:[e.jsx(Go,{}),e.jsxs(d,{children:["Updated ",g(i)]})]})]})]})}),r&&e.jsxs(kt,{status:"info",children:[e.jsx(Et,{}),e.jsxs(F,{flex:"1",children:[e.jsx(d,{children:"Generating AI insights..."}),e.jsx(d,{fontSize:"sm",color:"gray.600",children:"This may take a few moments while we analyze your nutrition data."})]})]}),!r&&n.length>0&&e.jsx(aS,{title:"Nutrition Trends",trends:n,timeframe:o}),!r&&m.length>0&&e.jsxs(F,{children:[e.jsxs(A,{mb:4,align:"center",children:[e.jsx(me,{size:"md",children:"🚨 High Priority Insights"}),e.jsx(je,{colorScheme:"red",variant:"solid",children:"Action Needed"})]}),e.jsx(xe,{columns:{base:1,lg:2},spacing:4,children:m.map(b=>e.jsx(qs,{insight:b},b.id))})]}),!r&&p.length>0&&e.jsxs(F,{children:[e.jsx(me,{size:"md",mb:4,children:"💡 Key Insights"}),e.jsx(xe,{columns:{base:1,lg:2,xl:3},spacing:4,children:p.map(b=>e.jsx(qs,{insight:b},b.id))})]}),!r&&j.length>0&&e.jsxs(F,{children:[e.jsx(me,{size:"md",mb:4,children:"📈 Additional Insights"}),e.jsx(xe,{columns:{base:1,lg:2,xl:3},spacing:4,children:j.map(b=>e.jsx(qs,{insight:b},b.id))})]}),!r&&t.length===0&&e.jsxs(kt,{status:"info",children:[e.jsx(Et,{}),e.jsxs(F,{flex:"1",children:[e.jsx(d,{fontWeight:"medium",children:"Ready to Generate Insights"}),e.jsx(d,{fontSize:"sm",children:"Start logging your meals to receive personalized AI-powered insights about your nutrition patterns, goal progress, and recommendations for improvement."})]})]})]})}class cS{async generateInsights(n="week",r=!1){try{return(await Z.get("/analytics/insights",{params:{timeframe:n,force_refresh:r}})).data}catch(i){throw console.error("Error generating insights:",i),i}}async getNutritionTrends(n=30){try{return(await Z.get("/analytics/nutrition-trends",{params:{days:n}})).data}catch(r){throw console.error("Error fetching nutrition trends:",r),r}}async getGoalProgress(){try{return(await Z.get("/analytics/goal-progress")).data}catch(n){throw console.error("Error fetching goal progress:",n),n}}async getFoodPatterns(n=30){try{return(await Z.get("/analytics/food-patterns",{params:{days:n}})).data}catch(r){throw console.error("Error fetching food patterns:",r),r}}async getMacroBreakdown(n="week"){try{return(await Z.get("/analytics/macro-breakdown",{params:{timeframe:n}})).data}catch(r){throw console.error("Error fetching macro breakdown:",r),r}}async clearInsightsCache(){try{return(await Z.delete("/analytics/insights/cache")).data}catch(n){throw console.error("Error clearing insights cache:",n),n}}async getWeeklySummary(n){try{return(await Z.get("/analytics/weekly-summary",{params:n?{end_date:n}:{}})).data}catch(r){throw console.error("Error fetching weekly summary:",r),r}}async getComprehensiveAnalytics(n="week"){const r=n==="week"?7:30,i=await Promise.allSettled([this.generateInsights(n),this.getNutritionTrends(r),this.getGoalProgress(),this.getFoodPatterns(r),this.getMacroBreakdown(n)]);return{insights:i[0].status==="fulfilled"?i[0].value:null,trends:i[1].status==="fulfilled"?i[1].value:null,goalProgress:i[2].status==="fulfilled"?i[2].value:null,patterns:i[3].status==="fulfilled"?i[3].value:null,macroBreakdown:i[4].status==="fulfilled"?i[4].value:null}}}const uS=new cS,dS=zo(se),xi=({title:t,icon:n,children:r,defaultExpanded:i=!1,colorScheme:s="blue",size:o="md",...a})=>{const[l,c]=C.useState(i),u=_e("white","gray.800"),h=_e("gray.200","gray.600"),g=Wt({base:!0,md:!1});return e.jsxs(dS,{bg:u,borderColor:h,borderWidth:1,size:o,boxShadow:"sm",_hover:{boxShadow:"md",transform:"translateY(-1px)"},transition:"all 0.2s",...a,children:[e.jsx(vt,{pb:2,cursor:"pointer",onClick:()=>c(!l),_hover:{bg:_e("gray.50","gray.700")},borderRadius:"md",transition:"background 0.2s",children:e.jsxs(A,{justify:"space-between",children:[e.jsxs(A,{spacing:3,children:[e.jsx(F,{w:8,h:8,borderRadius:"full",bg:`${s}.100`,display:"flex",alignItems:"center",justifyContent:"center",children:e.jsx($e,{as:n,color:`${s}.600`,w:4,h:4})}),e.jsx(me,{size:g?"sm":"md",color:`${s}.600`,children:t})]}),e.jsx(et,{icon:l?e.jsx(qo,{}):e.jsx(Vo,{}),size:"sm",variant:"ghost","aria-label":l?"Collapse":"Expand",color:`${s}.600`})]})}),e.jsx(To,{in:l,animateOpacity:!0,children:e.jsx(re,{pt:0,children:r})})]})};function hS(){const{dailySummary:t,weightLogs:n,goals:r,loading:i}=ai(),s=Wt({base:!0,md:!1}),[o,a]=C.useState([]),[l,c]=C.useState([]),[u,h]=C.useState(!1),[g,m]=C.useState(),[p,j]=C.useState("week"),b=wt(),v=_e("gray.200","gray.700"),_=async(E=p)=>{if(!u){h(!0);try{console.log("📊 Fetching AI insights and trends...");const O=await uS.getComprehensiveAnalytics(E);console.log("✅ Analytics data received:",{insightsCount:O.insights?.insights?.length||0,trendsCount:O.trends?.trends?.length||0,summary:O.insights?.summary||"No summary available"}),a(O.insights?.insights||[]);const B=[];if(O.insights?.statistics){const J=O.insights.statistics;J.avg_calories&&B.push({name:"Avg Daily Calories",value:J.avg_calories,unit:"kcal",trend:J.calorie_trend,trend_direction:J.calorie_trend_direction}),J.avg_protein&&B.push({name:"Avg Daily Protein",value:J.avg_protein,unit:"g",trend:J.protein_trend,trend_direction:J.protein_trend_direction}),J.avg_carbs&&B.push({name:"Avg Daily Carbs",value:J.avg_carbs,unit:"g",trend:J.carb_trend,trend_direction:J.carb_trend_direction}),J.avg_fat&&B.push({name:"Avg Daily Fat",value:J.avg_fat,unit:"g",trend:J.fat_trend,trend_direction:J.fat_trend_direction})}c(B),m(new Date().toLocaleString())}catch(O){console.error("❌ Failed to fetch analytics data:",O),b({title:"Failed to load analytics",description:"Please try again later",status:"error",duration:3e3,isClosable:!0})}finally{h(!1)}}},N=async()=>{await _(p)},R=E=>{j(E),_(E)};C.useEffect(()=>{_()},[]);const U=(E,O)=>O>0?Math.min(E/O*100,100):0,I=r.find(E=>E.active),w=I?.nutrition_targets||{calories:2e3,protein:150,carbs:250,fat:65},M=(()=>{if(!I?.weight_target||!n.length)return null;const E=n[0]?.weight,O=I.weight_target.current_weight,B=I.weight_target.target_weight;if(!E||!O||!B)return null;const J=O-E,ae=O-B,q=ae>0?J/ae*100:0;return{current:E,start:O,target:B,lost:J,progressPercent:q}})();if(i)return e.jsx(It,{maxW:"container.xl",py:8,children:e.jsx(d,{children:"Loading analytics..."})});const k=t?.total_nutrition||{calories:0,protein:0,carbs:0,fat:0};return e.jsx(It,{maxW:s?"100%":"container.xl",py:s?2:8,px:s?2:8,children:e.jsxs(S,{spacing:s?3:6,align:"stretch",children:[e.jsxs(F,{textAlign:s?"center":"left",children:[e.jsx(me,{size:s?"md":"lg",mb:s?1:2,children:"Analytics 📊"}),!s&&e.jsx(d,{color:"gray.600",fontSize:"md",children:"Track your nutrition progress and get AI-powered insights"})]}),e.jsx(lS,{insights:o,trends:l,statistics:[],loading:u,lastUpdated:g,onRefresh:N,timeframe:p,onTimeframeChange:R}),!s&&e.jsx(_t,{}),!I&&!s&&e.jsxs(kt,{status:"info",size:"sm",children:[e.jsx(Et,{}),e.jsxs(F,{flex:"1",children:[e.jsx(Xn,{fontSize:"sm",children:"No Goals Set"}),e.jsx(wn,{fontSize:"xs",children:"Set up your nutrition goals to see detailed analytics."})]})]}),e.jsx(xi,{title:"Today's Nutrition",icon:_0,colorScheme:"blue",size:s?"sm":"md",defaultExpanded:!s,children:e.jsxs(xe,{columns:{base:2,md:4},spacing:s?3:4,children:[e.jsxs(be,{children:[e.jsx(we,{fontSize:s?"xs":"sm",children:"Calories"}),e.jsx(Se,{fontSize:s?"lg":"xl",children:Math.round(k.calories)}),e.jsxs(ot,{fontSize:"xs",children:["of ",w.calories," kcal"]}),e.jsx(xt,{value:U(k.calories,w.calories),colorScheme:"blue",size:"sm",mt:2})]}),e.jsxs(be,{children:[e.jsx(we,{fontSize:s?"xs":"sm",children:"Protein"}),e.jsxs(Se,{fontSize:s?"lg":"xl",children:[Math.round(k.protein),"g"]}),e.jsxs(ot,{fontSize:"xs",children:["of ",w.protein,"g"]}),e.jsx(xt,{value:U(k.protein,w.protein),colorScheme:"red",size:"sm",mt:2})]}),e.jsxs(be,{children:[e.jsx(we,{fontSize:s?"xs":"sm",children:"Carbs"}),e.jsxs(Se,{fontSize:s?"lg":"xl",children:[Math.round(k.carbs),"g"]}),e.jsxs(ot,{fontSize:"xs",children:["of ",w.carbs,"g"]}),e.jsx(xt,{value:U(k.carbs,w.carbs),colorScheme:"green",size:"sm",mt:2})]}),e.jsxs(be,{children:[e.jsx(we,{fontSize:s?"xs":"sm",children:"Fat"}),e.jsxs(Se,{fontSize:s?"lg":"xl",children:[Math.round(k.fat),"g"]}),e.jsxs(ot,{fontSize:"xs",children:["of ",w.fat,"g"]}),e.jsx(xt,{value:U(k.fat,w.fat),colorScheme:"yellow",size:"sm",mt:2})]})]})}),M&&e.jsx(xi,{title:"Weight Progress",icon:id,colorScheme:"green",size:s?"sm":"md",defaultExpanded:!1,children:e.jsxs(xe,{columns:{base:1,md:3},spacing:s?3:6,children:[e.jsxs(be,{children:[e.jsx(we,{fontSize:s?"xs":"sm",children:"Current Weight"}),e.jsxs(Se,{fontSize:s?"lg":"xl",children:[M.current," lbs"]}),e.jsx(ot,{fontSize:"xs",children:"Latest measurement"})]}),e.jsxs(be,{children:[e.jsx(we,{fontSize:s?"xs":"sm",children:"Weight Lost"}),e.jsxs(Se,{fontSize:s?"lg":"xl",children:[M.lost.toFixed(1)," lbs"]}),e.jsxs(ot,{fontSize:"xs",children:["Since starting (",M.start," lbs)"]})]}),e.jsxs(be,{children:[e.jsx(we,{fontSize:s?"xs":"sm",children:"Progress"}),e.jsxs(Se,{fontSize:s?"lg":"xl",children:[M.progressPercent.toFixed(1),"%"]}),e.jsxs(ot,{fontSize:"xs",children:["Target: ",M.target," lbs"]}),e.jsx(xt,{value:M.progressPercent,colorScheme:"green",size:"sm",mt:2})]})]})}),n.length>0&&e.jsx(xi,{title:"Recent Weights",icon:b0,colorScheme:"purple",size:s?"sm":"md",defaultExpanded:!1,children:e.jsx(S,{spacing:2,align:"stretch",children:n.slice(0,s?3:5).map(E=>e.jsx(F,{p:3,borderWidth:1,borderColor:v,borderRadius:"md",fontSize:s?"sm":"md",children:e.jsxs(A,{justify:"space-between",children:[e.jsxs(S,{align:"start",spacing:0,children:[e.jsxs(d,{fontWeight:"medium",children:[E.weight," lbs"]}),e.jsx(d,{fontSize:"xs",color:"gray.600",children:new Date(E.date).toLocaleDateString()})]}),E.notes&&e.jsx(d,{fontSize:"xs",color:"gray.600",maxW:s?"120px":"200px",noOfLines:2,children:E.notes})]})},E.id))})}),t?.meals&&t.meals.length>0&&e.jsx(xi,{title:`Today's Meals (${t.meals.length})`,icon:Go,colorScheme:"orange",size:s?"sm":"md",defaultExpanded:!1,children:e.jsxs(S,{spacing:2,align:"stretch",children:[t.meals.slice(0,s?3:5).map(E=>e.jsx(F,{p:3,borderWidth:1,borderColor:v,borderRadius:"md",fontSize:s?"sm":"md",children:e.jsxs(A,{justify:"space-between",children:[e.jsxs(S,{align:"start",spacing:1,children:[e.jsx(d,{fontWeight:"medium",fontSize:s?"sm":"md",children:E.food_name}),e.jsxs(d,{fontSize:"xs",color:"gray.600",children:[E.meal_type," • ",E.amount," ",E.unit]})]}),e.jsxs(S,{align:"end",spacing:1,children:[e.jsxs(d,{fontWeight:"medium",fontSize:s?"sm":"md",children:[Math.round(E.nutrition.calories)," cal"]}),e.jsxs(d,{fontSize:"xs",color:"gray.600",children:["P: ",Math.round(E.nutrition.protein),"g • C: ",Math.round(E.nutrition.carbs),"g • F: ",Math.round(E.nutrition.fat),"g"]})]})]})},E.id)),t.meals.length>(s?3:5)&&e.jsxs(d,{fontSize:"xs",color:"gray.500",textAlign:"center",pt:2,children:["+",t.meals.length-(s?3:5)," more meals"]})]})})]})})}function gS(){const[t,n]=C.useState([]),[r,i]=C.useState([]),[s,o]=C.useState(null),[a,l]=C.useState(new Set),[c,u]=C.useState(!1),[h,g]=C.useState(null),[m,p]=C.useState(null),[j,b]=C.useState(null),[v,_]=C.useState(null),[N,R]=C.useState(!1),[U,I]=C.useState({food_name:"",brand:"",amount:1,unit:"serving",meal_type:"lunch",notes:""}),[w,P]=C.useState(null),[M,k]=C.useState(null),[E,O]=C.useState(!1),{isOpen:B,onOpen:J,onClose:ae}=Fe(),{isOpen:q,onOpen:oe,onClose:fe}=Fe(),{isOpen:pe,onOpen:X,onClose:f}=Fe(),{onClose:W}=Fe(),te=wt(),y=Wt({base:!0,lg:!1}),ee=C.useRef(null),Ie=C.useRef(null),[ce]=C.useState({meal_types:[],dietary_preferences:[],max_calories:void 0,max_sodium:void 0,allergen_exclusions:[],include_modifications:!0}),[ne,he]=C.useState(""),[dt,Qe]=C.useState(""),[Ye,z]=C.useState(null),[Q,Ne]=C.useState("url");C.useEffect(()=>{ye()},[]),C.useEffect(()=>{t.length>0&&En()},[ce,t]),C.useEffect(()=>{M&&U.amount&&P({calories:M.calories*U.amount,protein:M.protein*U.amount,carbs:M.carbs*U.amount,fat:M.fat*U.amount,fiber:M.fiber?M.fiber*U.amount:void 0,sodium:M.sodium?M.sodium*U.amount:void 0,sugar:M.sugar?M.sugar*U.amount:void 0,confidence_score:M.confidence_score})},[M,U.amount]);const ye=async()=>{u(!0);try{const T=(await Z.get("/restaurant-ai/analyses")).data||[];n(T),i(T)}catch(x){console.error("Error loading analyses:",x),te({title:"Loading Error",description:"Failed to load previous menu analyses.",status:"error",duration:3e3,isClosable:!0})}u(!1)},Cn=async()=>{if(!ne.trim()&&!Ye){te({title:"Missing Information",description:"Please provide a menu URL or upload an image/PDF.",status:"warning",duration:3e3,isClosable:!0});return}u(!0);try{const x={source_type:Ye?Ye.type.includes("pdf")?"pdf":"image":"url",source_data:Ye?await hn(Ye):ne,restaurant_name:dt,menu_name:""},L=(await Z.post("/restaurant-ai/analyze",x)).data,G=[L,...t];n(G),i(G),te({title:"Menu Analyzed Successfully!",description:`Found ${L.total_items_found} menu items with ${L.analysis_confidence}% confidence.`,status:"success",duration:5e3,isClosable:!0}),he(""),Qe(""),z(null),Ne("url"),W()}catch(x){console.error("Error analyzing menu:",x),te({title:"Analysis Failed",description:x.response?.data?.detail||"Failed to analyze menu. Please try again.",status:"error",duration:5e3,isClosable:!0})}u(!1)},hn=x=>new Promise((T,L)=>{const G=new FileReader;G.readAsDataURL(x),G.onload=()=>T(G.result),G.onerror=le=>L(le)}),At=async()=>{try{const x=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});p(x),ee.current&&(ee.current.srcObject=x)}catch{te({title:"Camera Error",description:"Unable to access camera. Please check permissions.",status:"error",duration:3e3,isClosable:!0})}},en=()=>{m&&(m.getTracks().forEach(x=>x.stop()),p(null))},qt=()=>{if(ee.current&&Ie.current){const x=Ie.current,T=ee.current;x.width=T.videoWidth,x.height=T.videoHeight;const L=x.getContext("2d");if(L){L.drawImage(T,0,0);const G=x.toDataURL("image/jpeg",.8);b(G),en()}}},tn=async(x,T)=>{if(!j){te({title:"No Image",description:"Please capture a photo first.",status:"warning",duration:3e3,isClosable:!0});return}R(!0);try{const L={item_id:x.id,image_data:j.split(",")[1],menu_analysis_id:T},le=(await Z.post("/restaurant-ai/visual-nutrition",L)).data;_(le),te({title:"Visual Analysis Complete!",description:`Analyzed portion with ${le.confidence_score}% confidence.`,status:"success",duration:3e3,isClosable:!0})}catch(L){console.error("Error analyzing visual nutrition:",L),te({title:"Analysis Failed",description:L.response?.data?.detail||"Failed to analyze meal image.",status:"error",duration:3e3,isClosable:!0})}R(!1)},Tt=(x,T)=>{I({food_name:x.name,brand:s?.restaurant_name||"",amount:1,unit:"serving",meal_type:Un(),notes:x.description});const L=T?{calories:T.calories,protein:T.protein,carbs:T.carbs,fat:T.fat,fiber:T.fiber,sodium:T.sodium,sugar:void 0,confidence_score:T.confidence_score}:x.estimated_nutrition;k(L),X()},Un=()=>{const x=new Date().getHours();return x<11?"breakfast":x<15?"lunch":x<18?"snack":"dinner"},kn=async()=>{O(!0);try{if(!w)throw new Error("No nutrition data available");const x={food_name:U.food_name,brand:U.brand,amount:U.amount,unit:U.unit,meal_type:U.meal_type,notes:U.notes,nutrition:{calories:w.calories,protein:w.protein,carbs:w.carbs,fat:w.fat,fiber:w.fiber,sodium:w.sodium},date:new Date().toISOString().split("T")[0]};await Z.post("/food-logs",x),te({title:"Food Logged!",description:`${U.food_name} has been added to your food log.`,status:"success",duration:3e3,isClosable:!0}),f(),b(null),_(null)}catch(x){console.error("Error logging food:",x),te({title:"Logging Failed",description:x.response?.data?.detail||"Failed to log food.",status:"error",duration:3e3,isClosable:!0})}O(!1)},En=()=>{if(t.length===0){i([]);return}let x=t.map(T=>({...T,recommendations:T.recommendations.filter(L=>!(ce.meal_types.length>0&&!ce.meal_types.includes(L.category)||ce.dietary_preferences.length>0&&!ce.dietary_preferences.some(le=>L.dietary_attributes.dietary_restrictions.includes(le))||ce.max_calories&&L.estimated_nutrition.calories>ce.max_calories||ce.min_protein&&L.estimated_nutrition.protein<ce.min_protein||ce.max_carbs&&L.estimated_nutrition.carbs>ce.max_carbs||ce.max_sodium&&L.estimated_nutrition.sodium&&L.estimated_nutrition.sodium>ce.max_sodium||ce.allergen_exclusions.length>0&&ce.allergen_exclusions.some(le=>L.dietary_attributes.allergens.includes(le)))).sort((L,G)=>G.recommendations_score-L.recommendations_score)})).filter(T=>T.recommendations.length>0);i(x)},K=async x=>{const T=x.target.files?.[0];if(!T)return;if(!["image/jpeg","image/png","image/jpg","application/pdf"].includes(T.type)){te({title:"Invalid File Type",description:"Please upload a JPEG, PNG, or PDF file.",status:"error",duration:3e3,isClosable:!0});return}if(T.size>10*1024*1024){te({title:"File Too Large",description:"Please upload a file smaller than 10MB.",status:"error",duration:3e3,isClosable:!0});return}z(T)};return e.jsxs(F,{bg:"gray.50",minH:"100vh",overflowX:"hidden",children:[e.jsx(It,{maxW:y?"100vw":"container.xl",py:y?2:8,px:y?3:8,w:"full",children:e.jsxs(S,{spacing:y?3:6,align:"stretch",w:"full",children:[y&&e.jsx(F,{bg:"white",p:4,borderRadius:"lg",shadow:"sm",w:"full",maxW:"100%",children:e.jsxs(S,{spacing:3,w:"full",children:[e.jsx(me,{size:"md",textAlign:"center",children:"🍽️ Restaurant AI"}),e.jsx(d,{fontSize:"sm",color:"gray.600",textAlign:"center",children:"Analyze restaurant menus and get personalized recommendations"})]})}),!y&&e.jsxs(F,{children:[e.jsx(me,{size:"xl",mb:2,textAlign:"center",children:"🍽️ Restaurant AI"}),e.jsx(d,{color:"gray.600",textAlign:"center",fontSize:"lg",children:"Smart menu analysis with personalized nutrition recommendations"})]}),e.jsx(se,{size:y?"sm":"md",w:"full",maxW:"100%",children:e.jsx(re,{children:e.jsxs(S,{spacing:4,w:"full",children:[e.jsx(me,{size:y?"sm":"md",children:"Analyze Restaurant Menu"}),e.jsxs(A,{spacing:y?2:4,w:"full",justify:"center",flexWrap:y?"wrap":"nowrap",children:[e.jsx(H,{size:y?"sm":"md",variant:Q==="url"?"solid":"outline",colorScheme:"green",onClick:()=>Ne("url"),flex:y?1:0,minW:y?"120px":"auto",children:"🔗 Website URL"}),e.jsx(H,{size:y?"sm":"md",variant:Q==="image"?"solid":"outline",colorScheme:"green",onClick:()=>Ne("image"),flex:y?1:0,minW:y?"120px":"auto",children:"📸 Upload Image"})]}),e.jsxs(S,{spacing:3,w:"full",maxW:"100%",children:[e.jsxs($,{w:"full",children:[e.jsx(V,{fontSize:y?"sm":"md",children:"Restaurant Name"}),e.jsx(ve,{value:dt,onChange:x=>Qe(x.target.value),placeholder:"e.g., McDonald's, Chipotle, Local Diner",size:y?"sm":"md",w:"full"})]}),Q==="url"?e.jsxs($,{w:"full",children:[e.jsx(V,{fontSize:y?"sm":"md",children:"Menu URL"}),e.jsx(ve,{value:ne,onChange:x=>he(x.target.value),placeholder:"https://restaurant.com/menu",size:y?"sm":"md",w:"full"})]}):e.jsxs($,{w:"full",children:[e.jsx(V,{fontSize:y?"sm":"md",children:"Menu Image"}),e.jsx(H,{leftIcon:e.jsx(sd,{}),onClick:()=>document.getElementById("menu-upload")?.click(),variant:"outline",w:"full",size:y?"sm":"md",children:Ye?Ye.name:"Choose Image"}),e.jsx("input",{id:"menu-upload",type:"file",accept:"image/*",onChange:K,style:{display:"none"}})]}),e.jsx(H,{colorScheme:"green",size:y?"sm":"md",w:"full",onClick:Cn,isLoading:c,loadingText:"Analyzing Menu...",isDisabled:!ne.trim()&&!Ye,children:"🔍 Analyze Menu"})]})]})})}),r.length>0&&e.jsxs(S,{spacing:y?3:6,align:"stretch",w:"full",children:[e.jsxs(me,{size:y?"md":"lg",textAlign:"center",children:["🍽️ Analyzed Restaurants (",r.length,")"]}),e.jsx(xe,{columns:y?1:{base:1,md:2,lg:3},spacing:y?3:4,children:r.map(x=>e.jsx(se,{size:y?"sm":"md",w:"full",maxW:"100%",_hover:{shadow:"lg",transform:"translateY(-2px)"},transition:"all 0.2s",cursor:"pointer",onClick:()=>{o(x),J()},children:e.jsx(re,{children:e.jsxs(S,{spacing:3,align:"stretch",w:"full",children:[e.jsxs(A,{justify:"space-between",align:"start",children:[e.jsxs(S,{align:"start",spacing:1,flex:1,children:[e.jsx(me,{size:y?"sm":"md",noOfLines:2,children:x.restaurant_name}),e.jsxs(A,{spacing:2,wrap:"wrap",children:[e.jsxs(je,{colorScheme:"green",variant:"subtle",children:[x.total_items_found," items"]}),e.jsxs(je,{colorScheme:"blue",variant:"subtle",children:[x.analysis_confidence,"% confidence"]})]})]}),e.jsx(et,{icon:e.jsx(Gr,{}),size:"sm",variant:"ghost","aria-label":"View details"})]}),e.jsxs(S,{spacing:2,align:"start",w:"full",children:[e.jsxs(A,{spacing:2,fontSize:"xs",color:"gray.600",children:[e.jsx(Go,{}),e.jsx(d,{children:new Date(x.created_at).toLocaleDateString()}),e.jsx(v0,{}),e.jsx(d,{children:x.source_type})]}),x.recommendations.length>0&&e.jsxs(F,{w:"full",children:[e.jsx(d,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Top Recommendations:"}),e.jsxs(S,{spacing:1,align:"start",w:"full",children:[x.recommendations.slice(0,3).map(T=>e.jsxs(A,{justify:"space-between",w:"full",fontSize:"xs",children:[e.jsx(d,{color:"gray.700",noOfLines:1,flex:1,children:T.name}),e.jsxs(je,{size:"sm",colorScheme:"green",variant:"outline",children:[T.recommendations_score,"%"]})]},T.id)),x.recommendations.length>3&&e.jsxs(d,{fontSize:"xs",color:"gray.500",children:["+",x.recommendations.length-3," more items"]})]})]})]}),e.jsx(H,{size:"sm",colorScheme:"green",variant:"outline",w:"full",children:"View Full Analysis"})]})})},x.id))})]}),e.jsxs(Ue,{isOpen:B,onClose:ae,size:y?"full":"6xl",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsx(Pe,{children:e.jsxs(S,{align:"start",spacing:2,children:[e.jsx(me,{size:"lg",children:s?.restaurant_name}),e.jsxs(A,{wrap:"wrap",spacing:2,children:[e.jsxs(je,{colorScheme:"green",children:[s?.total_items_found," items found"]}),e.jsxs(je,{colorScheme:"blue",children:[s?.analysis_confidence,"% confidence"]}),e.jsx(je,{colorScheme:"purple",children:s?.source_type}),e.jsxs(d,{fontSize:"sm",color:"gray.500",children:["Analyzed on ",s&&new Date(s.created_at).toLocaleDateString()]})]})]})}),e.jsx(De,{}),e.jsx(Le,{pb:6,children:s&&s.recommendations.length>0?e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs(kt,{status:"info",borderRadius:"md",children:[e.jsx(Et,{}),e.jsxs(F,{children:[e.jsx(Xn,{children:"AI Analysis Complete!"}),e.jsxs(wn,{children:["Found ",s.recommendations.length," recommended items based on nutritional analysis."]})]})]}),e.jsx(S,{spacing:3,align:"stretch",children:s.recommendations.map((x,T)=>e.jsx(se,{size:"sm",bg:"gray.50",children:e.jsx(re,{children:e.jsxs(S,{spacing:3,align:"stretch",children:[e.jsxs(A,{justify:"space-between",align:"start",children:[e.jsxs(S,{align:"start",spacing:1,flex:1,children:[e.jsxs(A,{spacing:2,children:[e.jsxs(je,{colorScheme:"blue",variant:"solid",children:["#",T+1]}),e.jsx(me,{size:"sm",children:x.name})]}),e.jsx(F,{fontSize:"sm",color:"gray.600",noOfLines:2,children:e.jsx(Ji,{content:x.description,isMobile:y,fontSize:"sm"})}),x.price&&e.jsx(je,{colorScheme:"green",variant:"outline",children:x.price})]}),e.jsxs(S,{spacing:1,align:"end",children:[e.jsxs(je,{colorScheme:x.recommendations_score>=80?"green":x.recommendations_score>=60?"yellow":"red",variant:"solid",children:[x.recommendations_score,"% Match"]}),e.jsxs(d,{fontSize:"sm",color:"gray.500",children:[Math.round(x.estimated_nutrition.calories)," cal"]})]})]}),e.jsxs(xe,{columns:4,spacing:3,fontSize:"sm",children:[e.jsxs(S,{spacing:0,children:[e.jsxs(d,{fontWeight:"bold",children:[x.estimated_nutrition.protein,"g"]}),e.jsx(d,{color:"gray.500",fontSize:"xs",children:"Protein"})]}),e.jsxs(S,{spacing:0,children:[e.jsxs(d,{fontWeight:"bold",children:[x.estimated_nutrition.carbs,"g"]}),e.jsx(d,{color:"gray.500",fontSize:"xs",children:"Carbs"})]}),e.jsxs(S,{spacing:0,children:[e.jsxs(d,{fontWeight:"bold",children:[x.estimated_nutrition.fat,"g"]}),e.jsx(d,{color:"gray.500",fontSize:"xs",children:"Fat"})]}),e.jsxs(S,{spacing:0,children:[e.jsxs(d,{fontWeight:"bold",children:[x.estimated_nutrition.confidence_score,"%"]}),e.jsx(d,{color:"gray.500",fontSize:"xs",children:"Accuracy"})]})]}),e.jsxs(A,{spacing:2,w:"full",children:[e.jsx(H,{size:"sm",leftIcon:e.jsx(ed,{}),colorScheme:"blue",variant:"outline",flex:1,onClick:()=>{g(x),oe(),At()},children:"Analyze Photo"}),e.jsx(H,{size:"sm",leftIcon:e.jsx(go,{}),colorScheme:"green",flex:1,onClick:()=>Tt(x),children:"Log Food"})]}),e.jsx(To,{in:a.has(x.id),children:e.jsxs(S,{spacing:3,align:"stretch",pt:3,children:[e.jsx(_t,{}),e.jsxs(F,{children:[e.jsx(d,{fontSize:"sm",fontWeight:"bold",color:"blue.600",mb:2,children:"🤖 AI Analysis:"}),e.jsx(F,{fontSize:"sm",color:"gray.700",children:e.jsx(Ji,{content:x.reasoning,isMobile:y,fontSize:"sm"})})]}),x.dietary_attributes.dietary_restrictions.length>0&&e.jsxs(F,{children:[e.jsx(d,{fontSize:"sm",fontWeight:"bold",color:"green.600",mb:2,children:"🌱 Dietary Info:"}),e.jsx(Qt,{spacing:1,children:x.dietary_attributes.dietary_restrictions.map(L=>e.jsx($t,{children:e.jsx(Rn,{size:"sm",colorScheme:"green",variant:"solid",children:L})},L))})]}),x.dietary_attributes.allergens.length>0&&e.jsxs(F,{children:[e.jsx(d,{fontSize:"sm",fontWeight:"bold",color:"red.600",mb:2,children:"⚠️ Contains Allergens:"}),e.jsx(Qt,{spacing:1,children:x.dietary_attributes.allergens.map(L=>e.jsx($t,{children:e.jsx(Rn,{size:"sm",colorScheme:"red",variant:"solid",children:L})},L))})]}),x.modifications_suggested&&x.modifications_suggested.length>0&&e.jsxs(F,{children:[e.jsx(d,{fontSize:"sm",fontWeight:"bold",color:"orange.600",mb:2,children:"💡 Suggested Modifications:"}),e.jsx(S,{spacing:1,align:"start",children:x.modifications_suggested.map((L,G)=>e.jsxs(d,{fontSize:"sm",color:"gray.700",children:["• ",L]},G))})]}),e.jsxs(F,{children:[e.jsxs(A,{justify:"space-between",mb:2,children:[e.jsx(d,{fontSize:"sm",fontWeight:"bold",color:"purple.600",children:"📊 Nutrition Confidence:"}),e.jsxs(d,{fontSize:"sm",fontWeight:"bold",children:[x.estimated_nutrition.confidence_score,"%"]})]}),e.jsx(xt,{value:x.estimated_nutrition.confidence_score,size:"sm",colorScheme:x.estimated_nutrition.confidence_score>70?"green":"orange",borderRadius:"full"})]})]})}),e.jsx(H,{size:"sm",variant:"ghost",leftIcon:a.has(x.id)?e.jsx(qo,{}):e.jsx(Vo,{}),onClick:L=>{L.stopPropagation(),l(G=>{const le=new Set(G);return le.has(x.id)?le.delete(x.id):le.add(x.id),le})},w:"full",children:a.has(x.id)?"Show Less":"Show More Details"})]})})},x.id))})]}):e.jsx(Ot,{py:8,children:e.jsxs(S,{spacing:3,children:[e.jsx(d,{fontSize:"lg",color:"gray.500",children:"No recommendations found"}),e.jsx(d,{fontSize:"sm",color:"gray.400",textAlign:"center",children:"This menu analysis didn't yield any recommendations based on current filters."})]})})})]})]}),!c&&r.length===0&&e.jsx(se,{size:y?"sm":"md",w:"full",maxW:"100%",children:e.jsx(re,{children:e.jsxs(S,{spacing:3,py:8,children:[e.jsx(d,{fontSize:"lg",color:"gray.500",children:"🍽️ No menu analyses yet"}),e.jsx(d,{fontSize:"sm",color:"gray.400",textAlign:"center",children:"Upload a menu image or provide a restaurant menu URL to get started with AI-powered nutrition analysis."})]})})})]})}),e.jsxs(Ue,{isOpen:q,onClose:()=>{fe(),en(),b(null)},size:"lg",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsx(Pe,{children:"📸 Capture Meal Photo"}),e.jsx(De,{}),e.jsx(Le,{children:e.jsx(S,{spacing:4,children:j?e.jsxs(e.Fragment,{children:[e.jsx(Io,{src:j,alt:"Captured meal",borderRadius:"md"}),e.jsxs(A,{spacing:2,w:"full",children:[e.jsx(H,{variant:"outline",onClick:()=>{b(null),At()},flex:1,children:"Retake"}),e.jsx(H,{colorScheme:"green",onClick:()=>{h&&s&&tn(h,s.id)},isLoading:N,flex:1,children:"Analyze Nutrition"})]}),v&&e.jsx(se,{w:"full",bg:"green.50",children:e.jsx(re,{children:e.jsxs(S,{spacing:2,align:"start",children:[e.jsxs(d,{fontWeight:"bold",color:"green.700",children:["🎯 Visual Analysis Complete! (",v.confidence_score,"% confidence)"]}),e.jsxs(xe,{columns:2,spacing:4,w:"full",children:[e.jsxs(S,{spacing:0,children:[e.jsxs(d,{fontWeight:"bold",children:[Math.round(v.calories)," cal"]}),e.jsx(d,{fontSize:"xs",color:"gray.600",children:"Calories"})]}),e.jsxs(S,{spacing:0,children:[e.jsxs(d,{fontWeight:"bold",children:[Math.round(v.protein),"g"]}),e.jsx(d,{fontSize:"xs",color:"gray.600",children:"Protein"})]}),e.jsxs(S,{spacing:0,children:[e.jsxs(d,{fontWeight:"bold",children:[Math.round(v.carbs),"g"]}),e.jsx(d,{fontSize:"xs",color:"gray.600",children:"Carbs"})]}),e.jsxs(S,{spacing:0,children:[e.jsxs(d,{fontWeight:"bold",children:[Math.round(v.fat),"g"]}),e.jsx(d,{fontSize:"xs",color:"gray.600",children:"Fat"})]})]}),e.jsx(d,{fontSize:"sm",color:"gray.700",children:v.portion_notes}),e.jsx(H,{colorScheme:"green",size:"sm",w:"full",leftIcon:e.jsx(go,{}),onClick:()=>{fe(),Tt(h,v)},children:"Log This Food"})]})})})]}):e.jsxs(e.Fragment,{children:[e.jsx(oh,{ratio:4/3,w:"full",children:e.jsx(F,{children:e.jsx("video",{ref:ee,autoPlay:!0,playsInline:!0,style:{width:"100%",height:"100%",objectFit:"cover"}})})}),e.jsx(H,{colorScheme:"blue",onClick:qt,w:"full",children:"📸 Capture Photo"})]})})})]})]}),e.jsxs(Ue,{isOpen:pe,onClose:f,size:"lg",scrollBehavior:"outside",children:[e.jsx(Te,{}),e.jsxs(He,{maxH:"90vh",display:"flex",flexDirection:"column",children:[e.jsx(Pe,{flexShrink:0,children:"📝 Log Food Entry"}),e.jsx(De,{}),e.jsx(Le,{pb:6,flex:"1",overflowY:"auto",children:e.jsxs(S,{spacing:4,w:"full",align:"stretch",children:[e.jsxs($,{children:[e.jsx(V,{children:"Food Name"}),e.jsx(ve,{value:U.food_name,onChange:x=>I(T=>({...T,food_name:x.target.value}))})]}),e.jsxs($,{children:[e.jsx(V,{children:"Restaurant/Brand"}),e.jsx(ve,{value:U.brand,onChange:x=>I(T=>({...T,brand:x.target.value}))})]}),e.jsxs(A,{spacing:4,w:"full",children:[e.jsxs($,{children:[e.jsx(V,{children:"Amount"}),e.jsxs(ue,{value:U.amount,onChange:(x,T)=>I(L=>({...L,amount:T||1})),min:.1,step:.1,precision:2,allowMouseWheel:!1,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Unit"}),e.jsxs(Be,{value:U.unit,onChange:x=>I(T=>({...T,unit:x.target.value})),children:[e.jsx("option",{value:"serving",children:"serving"}),e.jsx("option",{value:"cup",children:"cup"}),e.jsx("option",{value:"piece",children:"piece"}),e.jsx("option",{value:"slice",children:"slice"}),e.jsx("option",{value:"bowl",children:"bowl"}),e.jsx("option",{value:"plate",children:"plate"})]})]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Meal Type"}),e.jsxs(Be,{value:U.meal_type,onChange:x=>I(T=>({...T,meal_type:x.target.value})),children:[e.jsx("option",{value:"breakfast",children:"Breakfast"}),e.jsx("option",{value:"lunch",children:"Lunch"}),e.jsx("option",{value:"dinner",children:"Dinner"}),e.jsx("option",{value:"snack",children:"Snack"})]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Notes (Optional)"}),e.jsx(Kt,{value:U.notes,onChange:x=>I(T=>({...T,notes:x.target.value})),placeholder:"Any modifications or additional notes...",size:"sm"})]}),w&&e.jsx(se,{w:"full",bg:"blue.50",children:e.jsx(re,{children:e.jsxs(S,{spacing:4,children:[e.jsxs(d,{fontWeight:"bold",color:"blue.700",children:["Nutrition per ",U.amount," ",U.unit,"(s) - All Values Editable"]}),e.jsxs(xe,{columns:2,spacing:4,w:"full",children:[e.jsxs($,{children:[e.jsx(V,{fontSize:"xs",color:"gray.600",children:"Calories"}),"                          ",e.jsxs(ue,{value:w.calories,onChange:(x,T)=>{T!==void 0&&P(L=>L?{...L,calories:T}:null)},precision:1,min:0,step:.1,size:"sm",allowMouseWheel:!1,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]}),"                          ",e.jsxs($,{children:[e.jsx(V,{fontSize:"xs",color:"gray.600",children:"Protein (g)"}),e.jsxs(ue,{value:w.protein,onChange:(x,T)=>{T!==void 0&&P(L=>L?{...L,protein:T}:null)},precision:1,min:0,step:.1,size:"sm",allowMouseWheel:!1,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]}),"                          ",e.jsxs($,{children:[e.jsx(V,{fontSize:"xs",color:"gray.600",children:"Carbs (g)"}),e.jsxs(ue,{value:w.carbs,onChange:(x,T)=>{T!==void 0&&P(L=>L?{...L,carbs:T}:null)},precision:1,min:0,step:.1,size:"sm",allowMouseWheel:!1,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]}),"                          ",e.jsxs($,{children:[e.jsx(V,{fontSize:"xs",color:"gray.600",children:"Fat (g)"}),e.jsxs(ue,{value:w.fat,onChange:(x,T)=>{T!==void 0&&P(L=>L?{...L,fat:T}:null)},precision:1,min:0,step:.1,size:"sm",allowMouseWheel:!1,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]}),w.fiber!==void 0&&e.jsxs($,{children:[e.jsx(V,{fontSize:"xs",color:"gray.600",children:"Fiber (g)"}),e.jsxs(ue,{value:w.fiber||0,onChange:(x,T)=>{P(L=>L?{...L,fiber:T}:null)},precision:1,min:0,step:.1,size:"sm",allowMouseWheel:!1,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]}),w.sodium!==void 0&&e.jsxs($,{children:[e.jsx(V,{fontSize:"xs",color:"gray.600",children:"Sodium (mg)"}),e.jsxs(ue,{value:w.sodium||0,onChange:(x,T)=>{P(L=>L?{...L,sodium:T}:null)},precision:1,min:0,step:1,size:"sm",allowMouseWheel:!1,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]})]}),w.confidence_score&&e.jsxs(F,{w:"full",children:[e.jsxs(d,{fontSize:"xs",color:"gray.600",mb:1,children:["AI Confidence: ",w.confidence_score,"%"]}),e.jsx(xt,{value:w.confidence_score,size:"xs",colorScheme:w.confidence_score>70?"green":"yellow"})]})]})})})]})}),e.jsx(mt,{flexShrink:0,borderTop:"1px solid",borderColor:"gray.200",children:e.jsxs(A,{spacing:2,w:"full",justify:"flex-end",children:[e.jsx(H,{variant:"outline",onClick:f,children:"Cancel"}),e.jsx(H,{colorScheme:"green",leftIcon:e.jsx(Vi,{}),onClick:kn,isLoading:E,children:"Log Food"})]})})]})]}),e.jsx("canvas",{ref:Ie,style:{display:"none"}})]})}function pS(t){return Ce({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"},child:[]}]})(t)}function fS(t){return Ce({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"},child:[]}]})(t)}function mS(t){return Ce({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M384 121.9c0-6.3-2.5-12.4-7-16.9L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128zM571 308l-95.7-96.4c-10.1-10.1-27.4-3-27.4 11.3V288h-64v64h64v65.2c0 14.3 17.3 21.4 27.4 11.3L571 332c6.6-6.6 6.6-17.4 0-24zm-379 28v-32c0-8.8 7.2-16 16-16h176V160H248c-13.2 0-24-10.8-24-24V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V352H208c-8.8 0-16-7.2-16-16z"},child:[]}]})(t)}function xc(t){return Ce({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"},child:[]}]})(t)}function Yd(t){return Ce({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M96.06 454.35c.01 6.29 1.87 12.45 5.36 17.69l17.09 25.69a31.99 31.99 0 0 0 26.64 14.28h61.71a31.99 31.99 0 0 0 26.64-14.28l17.09-25.69a31.989 31.989 0 0 0 5.36-17.69l.04-38.35H96.01l.05 38.35zM0 176c0 44.37 16.45 84.85 43.56 115.78 16.52 18.85 42.36 58.23 52.21 91.45.04.26.07.52.11.78h160.24c.04-.26.07-.51.11-.78 9.85-33.22 35.69-72.6 52.21-91.45C335.55 260.85 352 220.37 352 176 352 78.61 272.91-.3 175.45 0 73.44.31 0 82.97 0 176zm176-80c-44.11 0-80 35.89-80 80 0 8.84-7.16 16-16 16s-16-7.16-16-16c0-61.76 50.24-112 112-112 8.84 0 16 7.16 16 16s-7.16 16-16 16z"},child:[]}]})(t)}function xS(t){return Ce({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"},child:[]}]})(t)}function Br(t){return Ce({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(t)}function jS(t){return Ce({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(t)}function yS(t){return Ce({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M528.12 301.319l47.273-208C578.806 78.301 567.391 64 551.99 64H159.208l-9.166-44.81C147.758 8.021 137.93 0 126.529 0H24C10.745 0 0 10.745 0 24v16c0 13.255 10.745 24 24 24h69.883l70.248 343.435C147.325 417.1 136 435.222 136 456c0 30.928 25.072 56 56 56s56-25.072 56-56c0-15.674-6.447-29.835-16.824-40h209.647C430.447 426.165 424 440.326 424 456c0 30.928 25.072 56 56 56s56-25.072 56-56c0-22.172-12.888-41.332-31.579-50.405l5.517-24.276c3.413-15.018-8.002-29.319-23.403-29.319H218.117l-6.545-32h293.145c11.206 0 20.92-7.754 23.403-18.681z"},child:[]}]})(t)}function bS(t){return Ce({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"},child:[]}]})(t)}function wS(t){return Ce({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48z"},child:[]}]})(t)}function ko(t){return Ce({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(t)}function SS(t){return Ce({attr:{viewBox:"0 0 416 512"},child:[{tag:"path",attr:{d:"M207.9 15.2c.8 4.7 16.1 94.5 16.1 128.8 0 52.3-27.8 89.6-68.9 104.6L168 486.7c.7 13.7-10.2 25.3-24 25.3H80c-13.7 0-24.7-11.5-24-25.3l12.9-238.1C27.7 233.6 0 196.2 0 144 0 109.6 15.3 19.9 16.1 15.2 19.3-5.1 61.4-5.4 64 16.3v141.2c1.3 3.4 15.1 3.2 16 0 1.4-25.3 7.9-139.2 8-141.8 3.3-20.8 44.7-20.8 47.9 0 .2 2.7 6.6 116.5 8 141.8.9 3.2 14.8 3.4 16 0V16.3c2.6-21.6 44.8-21.4 48-1.1zm119.2 285.7l-15 185.1c-1.2 14 9.9 26 23.9 26h56c13.3 0 24-10.7 24-24V24c0-13.2-10.7-24-24-24-82.5 0-221.4 178.5-64.9 300.9z"},child:[]}]})(t)}const vS=({planId:t,dayNumber:n,mealType:r,onClose:i,onUpdate:s})=>{const[o,a]=C.useState([]),[l,c]=C.useState([]),[u,h]=C.useState([]),[g,m]=C.useState([]),[p,j]=C.useState(""),[b,v]=C.useState(!0),[_,N]=C.useState(!1),[R,U]=C.useState([]),[I,w]=C.useState(null),[P,M]=C.useState(100),[k,E]=C.useState("g"),O=wt(),{isOpen:B,onOpen:J,onClose:ae}=Fe(),q=_e("white","gray.700"),oe=_e("gray.200","gray.600");C.useEffect(()=>{if(I){const z=dd(I.name,I.serving_unit);E(z),M(100)}},[I]),C.useEffect(()=>{fe(),pe(),X(),f()},[t,n,r]);const fe=async()=>{try{const Ne=(await Z.get(`/meal-planning/manual/plans/${t}`)).data.plan.days.find(ye=>ye.day_number===n);Ne&&a(Ne.meals[r]||[])}catch(z){console.error("Error loading meal data:",z),O({title:"Error loading meal data",description:"Failed to load meal information. Please try again.",status:"error",duration:3e3,isClosable:!0})}finally{v(!1)}},pe=async()=>{try{const z=await Z.get("/meal-planning/manual/suggestions",{params:{plan_id:t,day_number:n,meal_type:r}});U(z.data.suggestions||[])}catch(z){console.error("Error loading suggestions:",z)}},X=async()=>{try{const z=await Z.get("/user/recent-foods");h(z.data.recent_foods||[])}catch(z){console.error("Error loading recent foods:",z)}},f=async()=>{try{const z=await Z.get("/user/favorite-foods");m(z.data.favorite_foods||[])}catch(z){console.error("Error loading favorite foods:",z)}},W=async(z,Q,Ne)=>{try{const ye=ce(z.nutrition,Q);await Z.post("/user/recent-foods",{food_id:z.id,food_name:z.name,quantity:Q,unit:Ne,calories:ye.calories,protein:ye.protein,carbs:ye.carbs,fat:ye.fat,fiber:ye.fiber,sugar:ye.sugar,sodium:ye.sodium})}catch(ye){console.error("Error adding to recent foods:",ye)}},te=async(z,Q,Ne)=>{try{const ye=ce(z.nutrition,Q);await Z.post("/user/favorite-foods",{food_id:z.id,food_name:z.name,default_quantity:Q,default_unit:Ne,calories:ye.calories,protein:ye.protein,carbs:ye.carbs,fat:ye.fat,fiber:ye.fiber,sugar:ye.sugar,sodium:ye.sodium}),f(),O({title:"Added to favorites",status:"success",duration:2e3,isClosable:!0})}catch(ye){console.error("Error adding to favorites:",ye),O({title:"Error adding to favorites",description:"Failed to add food to favorites.",status:"error",duration:3e3,isClosable:!0})}},y=async z=>{try{await Z.delete(`/user/favorite-foods/${z}`),f(),O({title:"Removed from favorites",status:"success",duration:2e3,isClosable:!0})}catch(Q){console.error("Error removing from favorites:",Q),O({title:"Error removing from favorites",description:"Failed to remove food from favorites.",status:"error",duration:3e3,isClosable:!0})}},ee=z=>g.some(Q=>Q.food_id===z),Ie=async z=>{ee(z.id)?await y(z.id):await te(z,100,"g")},ce=(z,Q)=>{const Ne=Q/100;return{calories:Math.round(z.calories*Ne),protein:Math.round(z.protein*Ne*10)/10,carbs:Math.round(z.carbs*Ne*10)/10,fat:Math.round(z.fat*Ne*10)/10,fiber:Math.round(z.fiber*Ne*10)/10,sugar:Math.round(z.sugar*Ne*10)/10,sodium:Math.round(z.sodium*Ne*10)/10}},ne=async z=>{if(!z.trim()){c([]);return}N(!0);try{const Q=await Z.get("/foods/search",{params:{q:z}});c(Q.data||[])}catch(Q){console.error("Error searching foods:",Q),O({title:"Error searching foods",description:"Failed to search for foods. Please try again.",status:"error",duration:3e3,isClosable:!0})}finally{N(!1)}},he=async()=>{if(!I)return;const z={day_number:n,meal_type:r,food:{food_id:I.id,food_name:I.name,quantity:P,unit:k,calories:I.nutrition.calories*P/100,protein:I.nutrition.protein*P/100,carbs:I.nutrition.carbs*P/100,fat:I.nutrition.fat*P/100,fiber:I.nutrition.fiber*P/100,sugar:I.nutrition.sugar*P/100,sodium:I.nutrition.sodium*P/100}};try{(await Z.post(`/meal-planning/manual/plans/${t}/add-food`,z)).data.success&&(O({title:"Food added successfully",status:"success",duration:3e3,isClosable:!0}),await W(I,P,k),fe(),s(),ae(),w(null),M(100),E("g"))}catch(Q){console.error("Error adding food:",Q),O({title:"Error adding food",description:"Failed to add food to meal. Please try again.",status:"error",duration:3e3,isClosable:!0})}},dt=async z=>{try{(await Z.delete(`/meal-planning/manual/plans/${t}/remove-food`,{params:{day_number:n,meal_type:r,food_index:z}})).data.success&&(O({title:"Food removed successfully",status:"success",duration:3e3,isClosable:!0}),fe(),s())}catch(Q){console.error("Error removing food:",Q),O({title:"Error removing food",description:"Failed to remove food from meal. Please try again.",status:"error",duration:3e3,isClosable:!0})}},Ye=o.reduce((z,Q)=>({calories:z.calories+Q.calories,protein:z.protein+Q.protein,carbs:z.carbs+Q.carbs,fat:z.fat+Q.fat,fiber:z.fiber+Q.fiber}),{calories:0,protein:0,carbs:0,fat:0,fiber:0});return b?e.jsx(Ot,{h:"400px",children:e.jsx(ut,{size:"xl",color:"blue.500"})}):e.jsxs(F,{p:6,maxW:"6xl",mx:"auto",children:[e.jsxs(S,{spacing:6,align:"stretch",children:[e.jsxs(A,{justify:"space-between",align:"center",children:[e.jsxs(S,{align:"start",spacing:1,children:[e.jsxs(me,{size:"lg",color:"blue.600",children:[r.charAt(0).toUpperCase()+r.slice(1)," - Day ",n]}),e.jsxs(d,{color:"gray.600",children:[Ye.calories.toFixed(0)," calories • ",Ye.protein.toFixed(1),"g protein"]})]}),e.jsxs(A,{spacing:3,children:[e.jsx(H,{leftIcon:e.jsx(Br,{}),colorScheme:"blue",onClick:J,children:"Add Food"}),e.jsx(H,{variant:"outline",onClick:i,children:"Close"})]})]}),e.jsxs(se,{bg:q,border:"1px",borderColor:oe,children:[e.jsx(vt,{children:e.jsx(d,{fontWeight:"bold",children:"Nutrition Summary"})}),e.jsx(re,{children:e.jsxs(Ii,{templateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:4,children:[e.jsxs(ht,{children:[e.jsx(d,{fontSize:"sm",color:"gray.600",children:"Calories"}),e.jsx(d,{fontSize:"2xl",fontWeight:"bold",color:"blue.600",children:Ye.calories.toFixed(0)})]}),e.jsxs(ht,{children:[e.jsx(d,{fontSize:"sm",color:"gray.600",children:"Protein"}),e.jsxs(d,{fontSize:"2xl",fontWeight:"bold",color:"green.600",children:[Ye.protein.toFixed(1),"g"]})]}),e.jsxs(ht,{children:[e.jsx(d,{fontSize:"sm",color:"gray.600",children:"Carbs"}),e.jsxs(d,{fontSize:"2xl",fontWeight:"bold",color:"orange.600",children:[Ye.carbs.toFixed(1),"g"]})]}),e.jsxs(ht,{children:[e.jsx(d,{fontSize:"sm",color:"gray.600",children:"Fat"}),e.jsxs(d,{fontSize:"2xl",fontWeight:"bold",color:"purple.600",children:[Ye.fat.toFixed(1),"g"]})]})]})})]}),R.length>0&&e.jsxs(se,{bg:q,border:"1px",borderColor:oe,children:[e.jsx(vt,{children:e.jsxs(A,{children:[e.jsx(Yd,{color:"gold"}),e.jsx(d,{fontWeight:"bold",children:"AI Suggestions"})]})}),e.jsx(re,{children:e.jsx(S,{spacing:3,align:"stretch",children:R.map((z,Q)=>e.jsxs(F,{p:3,bg:"gray.50",rounded:"md",children:[e.jsx(d,{fontWeight:"semibold",mb:2,children:z.message}),e.jsx(A,{spacing:2,flexWrap:"wrap",children:z.foods.map((Ne,ye)=>e.jsx(je,{colorScheme:"blue",children:Ne.name},ye))})]},Q))})})]}),e.jsxs(se,{bg:q,border:"1px",borderColor:oe,children:[e.jsx(vt,{children:e.jsxs(A,{children:[e.jsx(SS,{}),e.jsx(d,{fontWeight:"bold",children:"Foods in this meal"})]})}),e.jsx(re,{children:o.length===0?e.jsx(Ot,{py:8,children:e.jsxs(S,{spacing:4,children:[e.jsx(d,{color:"gray.500",children:"No foods added yet"}),e.jsx(H,{leftIcon:e.jsx(Br,{}),colorScheme:"blue",onClick:J,children:"Add Your First Food"})]})}):e.jsx(S,{spacing:3,align:"stretch",children:o.map((z,Q)=>e.jsx(F,{p:4,bg:"gray.50",rounded:"md",border:"1px",borderColor:oe,children:e.jsxs(A,{justify:"space-between",children:[e.jsxs(S,{align:"start",spacing:1,children:[e.jsx(d,{fontWeight:"semibold",children:z.food_name}),e.jsxs(d,{fontSize:"sm",color:"gray.600",children:[z.quantity,z.unit]})]}),e.jsxs(A,{spacing:4,children:[e.jsxs(S,{spacing:0,children:[e.jsx(d,{fontSize:"sm",fontWeight:"bold",children:z.calories.toFixed(0)}),e.jsx(d,{fontSize:"xs",color:"gray.500",children:"cal"})]}),e.jsxs(S,{spacing:0,children:[e.jsx(d,{fontSize:"sm",fontWeight:"bold",children:z.protein.toFixed(1)}),e.jsx(d,{fontSize:"xs",color:"gray.500",children:"protein"})]}),e.jsx(et,{"aria-label":"Remove food",icon:e.jsx(ko,{}),size:"sm",colorScheme:"red",variant:"ghost",onClick:()=>dt(Q)})]})]})},Q))})})]})]}),e.jsxs(Ue,{isOpen:B,onClose:ae,size:"xl",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsxs(Pe,{children:["Add Food to ",r]}),e.jsx(De,{}),e.jsx(Le,{children:e.jsxs(S,{spacing:6,align:"stretch",children:[u.length>0&&e.jsxs(F,{children:[e.jsxs(A,{mb:3,children:[e.jsx(pS,{}),e.jsx(d,{fontWeight:"bold",children:"Recent Foods"})]}),e.jsx(A,{spacing:2,overflowX:"auto",pb:2,children:u.slice(0,5).map(z=>e.jsx(F,{minW:"200px",p:3,bg:"gray.50",rounded:"md",border:"1px",borderColor:"gray.200",cursor:"pointer",onClick:()=>{w({id:z.food_id,name:z.food_name,nutrition:{calories:z.calories,protein:z.protein,carbs:z.carbs,fat:z.fat,fiber:z.fiber,sugar:z.sugar,sodium:z.sodium}}),M(z.quantity),E(z.unit)},_hover:{bg:"blue.50"},children:e.jsxs(S,{align:"start",spacing:1,children:[e.jsx(d,{fontWeight:"semibold",fontSize:"sm",noOfLines:1,children:z.food_name}),e.jsxs(d,{fontSize:"xs",color:"gray.600",children:[z.quantity," ",z.unit]}),e.jsxs(d,{fontSize:"xs",fontWeight:"bold",children:[z.calories," cal"]})]})},z.food_id))})]}),g.length>0&&e.jsxs(F,{children:[e.jsxs(A,{mb:3,children:[e.jsx(bS,{}),e.jsx(d,{fontWeight:"bold",children:"Favorite Foods"})]}),e.jsx(A,{spacing:2,overflowX:"auto",pb:2,children:g.slice(0,5).map(z=>e.jsxs(F,{minW:"200px",p:3,bg:"yellow.50",rounded:"md",border:"1px",borderColor:"yellow.200",position:"relative",children:[e.jsxs(S,{align:"start",spacing:1,children:[e.jsx(d,{fontWeight:"semibold",fontSize:"sm",noOfLines:1,children:z.food_name}),e.jsxs(d,{fontSize:"xs",color:"gray.600",children:[z.default_quantity," ",z.default_unit]}),e.jsxs(d,{fontSize:"xs",fontWeight:"bold",children:[z.calories," cal"]})]}),e.jsxs(A,{position:"absolute",top:2,right:2,spacing:1,children:[e.jsx(et,{"aria-label":"Add to meal",icon:e.jsx(Br,{}),size:"xs",colorScheme:"blue",onClick:()=>{w({id:z.food_id,name:z.food_name,nutrition:{calories:z.calories,protein:z.protein,carbs:z.carbs,fat:z.fat,fiber:z.fiber,sugar:z.sugar,sodium:z.sodium}}),M(z.default_quantity),E(z.default_unit)}}),e.jsx(et,{"aria-label":"Remove from favorites",icon:e.jsx(ko,{}),size:"xs",colorScheme:"red",variant:"ghost",onClick:()=>y(z.food_id)})]})]},z.food_id))})]}),e.jsxs($,{children:[e.jsx(V,{children:"Search Foods"}),e.jsxs(A,{children:[e.jsx(ve,{placeholder:"Search for foods...",value:p,onChange:z=>j(z.target.value),onKeyPress:z=>z.key==="Enter"&&ne(p)}),e.jsx(H,{leftIcon:e.jsx(jS,{}),onClick:()=>ne(p),isLoading:_,colorScheme:"blue",children:"Search"})]})]}),l.length>0&&e.jsxs(F,{children:[e.jsx(d,{fontWeight:"bold",mb:3,children:"Search Results"}),e.jsx(S,{spacing:2,maxH:"300px",overflowY:"auto",children:l.map((z,Q)=>e.jsx(F,{p:3,w:"full",bg:I?.id===z.id?"blue.50":"gray.50",rounded:"md",border:"1px",borderColor:I?.id===z.id?"blue.200":oe,cursor:"pointer",onClick:()=>w(z),_hover:{bg:"blue.50"},children:e.jsxs(A,{justify:"space-between",children:[e.jsxs(S,{align:"start",spacing:1,children:[e.jsx(d,{fontWeight:"semibold",children:z.name}),z.brand&&e.jsx(d,{fontSize:"sm",color:"gray.600",children:z.brand})]}),e.jsxs(A,{spacing:2,children:[e.jsxs(S,{spacing:0,children:[e.jsxs(d,{fontSize:"sm",fontWeight:"bold",children:[z.nutrition.calories," cal"]}),e.jsx(d,{fontSize:"xs",color:"gray.500",children:"per 100g"})]}),e.jsx(et,{"aria-label":ee(z.id)?"Remove from favorites":"Add to favorites",icon:e.jsx(xc,{}),size:"sm",colorScheme:ee(z.id)?"red":"gray",variant:ee(z.id)?"solid":"outline",onClick:Ne=>{Ne.stopPropagation(),Ie(z)},_hover:{colorScheme:"red",variant:"solid"}})]})]})},Q))})]}),I&&e.jsxs(F,{children:[e.jsx(d,{fontWeight:"bold",mb:3,children:"Quantity"}),e.jsx(Yo,{quantity:P,unit:k,onQuantityChange:M,onUnitChange:E,label:"Amount & Unit",foodName:I.name,servingUnit:I.serving_unit||"g",showSmartSuggestions:!0}),e.jsxs(F,{mt:4,p:3,bg:"blue.50",rounded:"md",children:[e.jsxs(A,{justify:"space-between",align:"center",mb:2,children:[e.jsx(d,{fontWeight:"semibold",children:"Nutrition Preview"}),e.jsx(H,{size:"sm",leftIcon:e.jsx(xc,{}),colorScheme:"yellow",variant:"outline",onClick:()=>te(I,P,k),children:"Add to Favorites"})]}),e.jsxs(A,{spacing:6,children:[e.jsxs(d,{fontSize:"sm",children:[e.jsx("strong",{children:"Calories:"})," ",(I.nutrition.calories*P/100).toFixed(0)]}),e.jsxs(d,{fontSize:"sm",children:[e.jsx("strong",{children:"Protein:"})," ",(I.nutrition.protein*P/100).toFixed(1),"g"]}),e.jsxs(d,{fontSize:"sm",children:[e.jsx("strong",{children:"Carbs:"})," ",(I.nutrition.carbs*P/100).toFixed(1),"g"]}),e.jsxs(d,{fontSize:"sm",children:[e.jsx("strong",{children:"Fat:"})," ",(I.nutrition.fat*P/100).toFixed(1),"g"]})]})]})]})]})}),e.jsxs(mt,{children:[e.jsx(H,{variant:"ghost",mr:3,onClick:ae,children:"Cancel"}),e.jsx(H,{colorScheme:"blue",onClick:he,isDisabled:!I,children:"Add Food"})]})]})]})]})},_S=()=>{const[t,n]=C.useState([]),[r,i]=C.useState([]),[s,o]=C.useState(!0),[a,l]=C.useState(null),[c,u]=C.useState(null),h=wt(),{isOpen:g,onOpen:m,onClose:p}=Fe(),{isOpen:j,onOpen:b,onClose:v}=Fe(),[_,N]=C.useState({name:"",duration_days:7,target_nutrition:{calories:2e3,protein:150,carbs:250,fat:65},notes:""}),R=_e("white","gray.700"),U=_e("gray.200","gray.600");C.useEffect(()=>{I(),w()},[]);const I=async()=>{try{const oe=(await Z.get("/meal-planning/manual/plans")).data.plans||[];n(oe),l(oe.find(fe=>fe.is_active)||null)}catch(q){console.error("Error loading plans:",q),h({title:"Error loading plans",description:"Failed to load meal plans. Please try again.",status:"error",duration:3e3,isClosable:!0})}finally{o(!1)}},w=async()=>{try{const q=await Z.get("/meal-planning/manual/templates");i(q.data.templates||[])}catch(q){console.error("Error loading templates:",q)}},P=async()=>{try{(await Z.post("/meal-planning/manual/create",_)).data.success&&(h({title:"Plan created successfully",status:"success",duration:3e3,isClosable:!0}),I(),p(),N({name:"",duration_days:7,target_nutrition:{calories:2e3,protein:150,carbs:250,fat:65},notes:""}))}catch(q){console.error("Error creating plan:",q),h({title:"Error creating plan",description:"Failed to create meal plan. Please try again.",status:"error",duration:3e3,isClosable:!0})}},M=async q=>{try{(await Z.post(`/meal-planning/manual/plans/${q}/activate`)).data.success&&(h({title:"Plan activated successfully",status:"success",duration:3e3,isClosable:!0}),I())}catch(oe){console.error("Error activating plan:",oe),h({title:"Error activating plan",description:"Failed to activate meal plan. Please try again.",status:"error",duration:3e3,isClosable:!0})}},k=async q=>{try{(await Z.post(`/meal-planning/manual/plans/${q}/deactivate`)).data.success&&(h({title:"Plan deactivated successfully",status:"success",duration:3e3,isClosable:!0}),I())}catch(oe){console.error("Error deactivating plan:",oe),h({title:"Error deactivating plan",description:"Failed to deactivate meal plan. Please try again.",status:"error",duration:3e3,isClosable:!0})}},E=async q=>{if(confirm("Are you sure you want to delete this plan?"))try{(await Z.delete(`/meal-planning/manual/plans/${q}`)).data.success&&(h({title:"Plan deleted successfully",status:"success",duration:3e3,isClosable:!0}),I())}catch(oe){console.error("Error deleting plan:",oe),h({title:"Error deleting plan",description:"Failed to delete meal plan. Please try again.",status:"error",duration:3e3,isClosable:!0})}},O=async(q,oe)=>{try{(await Z.post(`/meal-planning/manual/plans/${q}/save-template`,null,{params:{template_name:oe}})).data.success&&(h({title:"Template saved successfully",status:"success",duration:3e3,isClosable:!0}),w())}catch(fe){console.error("Error saving template:",fe),h({title:"Error saving template",description:"Failed to save template. Please try again.",status:"error",duration:3e3,isClosable:!0})}},B=async(q,oe)=>{try{(await Z.post("/meal-planning/manual/create-from-template",null,{params:{template_id:q,plan_name:oe}})).data.success&&(h({title:"Plan created from template successfully",status:"success",duration:3e3,isClosable:!0}),I(),v())}catch(fe){console.error("Error creating from template:",fe),h({title:"Error creating from template",description:"Failed to create plan from template. Please try again.",status:"error",duration:3e3,isClosable:!0})}},J=async q=>{try{(await Z.post(`/meal-planning/manual/plans/${q}/insights`)).data.success&&h({title:"Insights generated",description:"Check the insights panel for AI recommendations.",status:"success",duration:3e3,isClosable:!0})}catch(oe){console.error("Error generating insights:",oe),h({title:"Error generating insights",description:"Failed to generate insights. Please try again.",status:"error",duration:3e3,isClosable:!0})}},ae=async q=>{try{const oe=await Z.get(`/meal-planning/manual/plans/${q}/export/grocery-list`);if(oe.data.success){const fe=oe.data.grocery_list,pe=oe.data.plan_name,X=fe.map(y=>`${y.name} - ${y.quantity} ${y.unit}`).join(`
`),f=new Blob([X],{type:"text/plain"}),W=window.URL.createObjectURL(f),te=document.createElement("a");te.href=W,te.download=`${pe}-grocery-list.txt`,te.click(),window.URL.revokeObjectURL(W),h({title:"Grocery list exported",description:"Your grocery list has been downloaded.",status:"success",duration:3e3,isClosable:!0})}}catch(oe){console.error("Error exporting grocery list:",oe),h({title:"Error exporting grocery list",description:"Failed to export grocery list. Please try again.",status:"error",duration:3e3,isClosable:!0})}};return s?e.jsx(Ot,{h:"400px",children:e.jsx(ut,{size:"xl",color:"blue.500"})}):e.jsxs(F,{p:6,maxW:"7xl",mx:"auto",children:[e.jsxs(S,{spacing:6,align:"stretch",children:[e.jsxs(A,{justify:"space-between",align:"center",children:[e.jsx(me,{size:"lg",color:"blue.600",children:"Manual Meal Planning"}),e.jsxs(A,{spacing:3,children:[e.jsx(H,{leftIcon:e.jsx(Br,{}),colorScheme:"blue",onClick:m,children:"Create Plan"}),e.jsx(H,{leftIcon:e.jsx(mS,{}),variant:"outline",colorScheme:"green",onClick:b,children:"Templates"})]})]}),a&&e.jsxs(kt,{status:"info",rounded:"md",children:[e.jsx(Et,{}),e.jsx(Xn,{children:"Active Plan:"}),e.jsxs(wn,{children:[a.name," is currently active"]})]}),e.jsx(xe,{columns:{base:1,md:2,lg:3},spacing:6,children:t.map(q=>e.jsxs(se,{bg:R,border:"1px",borderColor:q.is_active?"blue.300":U,shadow:q.is_active?"lg":"md",_hover:{shadow:"lg"},transition:"all 0.2s",children:[e.jsx(vt,{pb:2,children:e.jsxs(A,{justify:"space-between",children:[e.jsxs(S,{align:"start",spacing:1,children:[e.jsx(d,{fontWeight:"bold",fontSize:"lg",children:q.name}),e.jsx(je,{colorScheme:q.is_active?"green":"gray",children:q.is_active?"Active":"Inactive"})]}),e.jsx(et,{"aria-label":"Delete plan",icon:e.jsx(ko,{}),size:"sm",colorScheme:"red",variant:"ghost",onClick:()=>E(q.plan_id)})]})}),e.jsx(re,{pt:0,children:e.jsxs(S,{align:"stretch",spacing:4,children:[e.jsxs(A,{justify:"space-between",children:[e.jsxs(d,{fontSize:"sm",color:"gray.600",children:["Duration: ",q.duration_days," days"]}),e.jsxs(d,{fontSize:"sm",color:"gray.600",children:["Target: ",q.target_nutrition.calories||0," cal"]})]}),e.jsx(_t,{}),e.jsxs(S,{spacing:2,children:[e.jsxs(A,{spacing:2,w:"full",children:[e.jsx(H,{size:"sm",colorScheme:q.is_active?"red":"green",leftIcon:q.is_active?e.jsx(wS,{}):e.jsx(xS,{}),onClick:()=>q.is_active?k(q.plan_id):M(q.plan_id),flex:1,children:q.is_active?"Deactivate":"Activate"}),e.jsx(et,{"aria-label":"Generate insights",icon:e.jsx(Yd,{}),size:"sm",colorScheme:"yellow",onClick:()=>J(q.plan_id)})]}),e.jsxs(A,{spacing:2,w:"full",children:[e.jsx(H,{size:"sm",variant:"outline",leftIcon:e.jsx(yS,{}),onClick:()=>ae(q.plan_id),flex:1,children:"Grocery List"}),e.jsx(H,{size:"sm",variant:"outline",leftIcon:e.jsx(fS,{}),onClick:()=>{const oe=prompt("Enter template name:");oe&&O(q.plan_id,oe)},flex:1,children:"Save as Template"})]})]})]})})]},q.plan_id))}),a&&e.jsxs(S,{spacing:6,align:"stretch",children:[e.jsxs(me,{size:"md",color:"blue.600",children:[a.name," - Daily Meal View"]}),e.jsx(xe,{columns:{base:1,lg:2},spacing:6,children:a.days.map(q=>e.jsxs(se,{bg:R,border:"1px",borderColor:U,children:[e.jsx(vt,{children:e.jsxs(A,{justify:"space-between",children:[e.jsxs(d,{fontWeight:"bold",fontSize:"lg",children:["Day ",q.day_number]}),e.jsxs(je,{colorScheme:"blue",children:[q.daily_totals.calories.toFixed(0)," cal"]})]})}),e.jsx(re,{children:e.jsxs(xe,{columns:2,spacing:3,children:[e.jsx(se,{bg:"orange.50",border:"1px",borderColor:"orange.200",cursor:"pointer",_hover:{bg:"orange.100",transform:"translateY(-2px)"},transition:"all 0.2s",onClick:()=>u({planId:a.plan_id,dayNumber:q.day_number,mealType:"breakfast"}),children:e.jsx(re,{p:3,children:e.jsxs(S,{spacing:2,children:[e.jsx(d,{fontSize:"sm",fontWeight:"bold",color:"orange.700",children:"🍳 Breakfast"}),e.jsxs(d,{fontSize:"xs",color:"gray.600",children:[q.meals.breakfast.length," items"]}),e.jsxs(d,{fontSize:"xs",color:"gray.600",children:[q.meals.breakfast.reduce((oe,fe)=>oe+fe.calories,0).toFixed(0)," cal"]})]})})}),e.jsx(se,{bg:"green.50",border:"1px",borderColor:"green.200",cursor:"pointer",_hover:{bg:"green.100",transform:"translateY(-2px)"},transition:"all 0.2s",onClick:()=>u({planId:a.plan_id,dayNumber:q.day_number,mealType:"lunch"}),children:e.jsx(re,{p:3,children:e.jsxs(S,{spacing:2,children:[e.jsx(d,{fontSize:"sm",fontWeight:"bold",color:"green.700",children:"🥗 Lunch"}),e.jsxs(d,{fontSize:"xs",color:"gray.600",children:[q.meals.lunch.length," items"]}),e.jsxs(d,{fontSize:"xs",color:"gray.600",children:[q.meals.lunch.reduce((oe,fe)=>oe+fe.calories,0).toFixed(0)," cal"]})]})})}),e.jsx(se,{bg:"purple.50",border:"1px",borderColor:"purple.200",cursor:"pointer",_hover:{bg:"purple.100",transform:"translateY(-2px)"},transition:"all 0.2s",onClick:()=>u({planId:a.plan_id,dayNumber:q.day_number,mealType:"dinner"}),children:e.jsx(re,{p:3,children:e.jsxs(S,{spacing:2,children:[e.jsx(d,{fontSize:"sm",fontWeight:"bold",color:"purple.700",children:"🍽️ Dinner"}),e.jsxs(d,{fontSize:"xs",color:"gray.600",children:[q.meals.dinner.length," items"]}),e.jsxs(d,{fontSize:"xs",color:"gray.600",children:[q.meals.dinner.reduce((oe,fe)=>oe+fe.calories,0).toFixed(0)," cal"]})]})})}),e.jsx(se,{bg:"yellow.50",border:"1px",borderColor:"yellow.200",cursor:"pointer",_hover:{bg:"yellow.100",transform:"translateY(-2px)"},transition:"all 0.2s",onClick:()=>u({planId:a.plan_id,dayNumber:q.day_number,mealType:"snacks"}),children:e.jsx(re,{p:3,children:e.jsxs(S,{spacing:2,children:[e.jsx(d,{fontSize:"sm",fontWeight:"bold",color:"yellow.700",children:"🥜 Snacks"}),e.jsxs(d,{fontSize:"xs",color:"gray.600",children:[q.meals.snacks.length," items"]}),e.jsxs(d,{fontSize:"xs",color:"gray.600",children:[q.meals.snacks.reduce((oe,fe)=>oe+fe.calories,0).toFixed(0)," cal"]})]})})})]})})]},q.day_number))})]}),t.length===0&&e.jsx(se,{bg:R,border:"1px",borderColor:U,children:e.jsx(re,{children:e.jsx(Ot,{py:12,children:e.jsxs(S,{spacing:4,children:[e.jsx(d,{fontSize:"lg",color:"gray.500",children:"No meal plans yet"}),e.jsx(H,{leftIcon:e.jsx(Br,{}),colorScheme:"blue",onClick:m,children:"Create Your First Plan"})]})})})})]}),e.jsxs(Ue,{isOpen:g,onClose:p,size:"lg",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsx(Pe,{children:"Create New Meal Plan"}),e.jsx(De,{}),e.jsx(Le,{children:e.jsxs(S,{spacing:4,align:"stretch",children:[e.jsxs($,{children:[e.jsx(V,{children:"Plan Name"}),e.jsx(ve,{value:_.name,onChange:q=>N({..._,name:q.target.value}),placeholder:"Enter plan name"})]}),e.jsxs($,{children:[e.jsx(V,{children:"Duration (days)"}),e.jsxs(ue,{value:_.duration_days,onChange:(q,oe)=>N({..._,duration_days:oe||7}),min:1,max:30,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Target Calories"}),e.jsxs(ue,{value:_.target_nutrition.calories,onChange:(q,oe)=>N({..._,target_nutrition:{..._.target_nutrition,calories:oe||2e3}}),min:1e3,max:5e3,children:[e.jsx(de,{}),e.jsxs(Re,{children:[e.jsx(Me,{}),e.jsx(Oe,{})]})]})]}),e.jsxs($,{children:[e.jsx(V,{children:"Notes"}),e.jsx(ve,{value:_.notes,onChange:q=>N({..._,notes:q.target.value}),placeholder:"Optional notes about this plan"})]})]})}),e.jsxs(mt,{children:[e.jsx(H,{variant:"ghost",mr:3,onClick:p,children:"Cancel"}),e.jsx(H,{colorScheme:"blue",onClick:P,children:"Create Plan"})]})]})]}),e.jsxs(Ue,{isOpen:j,onClose:v,size:"lg",children:[e.jsx(Te,{}),e.jsxs(He,{children:[e.jsx(Pe,{children:"Meal Plan Templates"}),e.jsx(De,{}),e.jsx(Le,{children:e.jsx(S,{spacing:4,align:"stretch",children:r.length===0?e.jsx(Ot,{py:8,children:e.jsx(d,{color:"gray.500",children:"No templates available"})}):r.map(q=>e.jsx(se,{bg:R,border:"1px",borderColor:U,children:e.jsx(re,{children:e.jsxs(A,{justify:"space-between",children:[e.jsxs(S,{align:"start",spacing:1,children:[e.jsx(d,{fontWeight:"bold",children:q.name}),e.jsxs(d,{fontSize:"sm",color:"gray.600",children:[q.duration_days," days • ",q.target_nutrition.calories||0," cal"]})]}),e.jsx(H,{size:"sm",colorScheme:"blue",onClick:()=>{const oe=prompt("Enter new plan name:");oe&&B(q.plan_id,oe)},children:"Use Template"})]})})},q.plan_id))})}),e.jsx(mt,{children:e.jsx(H,{onClick:v,children:"Close"})})]})]}),c&&e.jsx(vS,{planId:c.planId,dayNumber:c.dayNumber,mealType:c.mealType,onClose:()=>u(null),onUpdate:I})]})};function CS(){return e.jsx(_S,{})}function kS(){const t=Wt({base:!0,lg:!1}),{isOpen:n,onOpen:r,onClose:i}=Fe(),[s,o]=C.useState(!1);return C.useEffect(()=>{if(!(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0)){const l=setTimeout(()=>{localStorage.getItem("pwa-install-prompt-seen")||(o(!0),localStorage.setItem("pwa-install-prompt-seen","true"))},5e3);return()=>clearTimeout(l)}},[]),e.jsxs(F,{minH:"100vh",bg:"linear-gradient(135deg, #f6f9fc 0%, #e9f4f9 100%)",children:[e.jsx(P0,{}),e.jsx(i0,{isDrawerOpen:n,onDrawerOpen:r,onDrawerClose:i}),e.jsx(F,{pb:t?"80px":0,children:e.jsxs(kc,{children:[e.jsx(St,{path:"/",element:e.jsx(sc,{})}),e.jsx(St,{path:"/dashboard",element:e.jsx(R0,{})}),e.jsx(St,{path:"/ai-dashboard",element:e.jsx(sc,{})}),e.jsx(St,{path:"/food-log",element:e.jsx(Hw,{})}),e.jsx(St,{path:"/food-index",element:e.jsx(Yw,{})}),e.jsx(St,{path:"/meal-suggestions",element:e.jsx(dc,{})}),e.jsx(St,{path:"/meal-planning",element:e.jsx(dc,{})}),e.jsx(St,{path:"/meal-plans",element:e.jsx(eS,{})}),e.jsx(St,{path:"/manual-meal-planning",element:e.jsx(CS,{})}),e.jsx(St,{path:"/restaurant-ai",element:e.jsx(gS,{})}),e.jsx(St,{path:"/ai",element:e.jsx(fc,{})}),e.jsx(St,{path:"/ai-chat",element:e.jsx(fc,{})}),e.jsx(St,{path:"/goals",element:e.jsx(rS,{})}),e.jsx(St,{path:"/settings",element:e.jsx(iS,{})}),e.jsx(St,{path:"/analytics",element:e.jsx(hS,{})})]})}),e.jsx(u0,{onMenuOpen:r}),e.jsx(L0,{isOpen:s,onClose:()=>o(!1)})]})}class ES extends jn.Component{constructor(n){super(n),this.state={hasError:!1}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){console.error("ErrorBoundary caught an error:",n,r)}render(){return this.state.hasError?e.jsx(F,{p:8,maxW:"md",mx:"auto",mt:16,children:e.jsxs(S,{spacing:6,children:[e.jsxs(kt,{status:"error",children:[e.jsx(Et,{}),e.jsxs(F,{children:[e.jsx(me,{size:"md",mb:2,children:"Something went wrong"}),e.jsx(d,{fontSize:"sm",children:this.state.error?.message||"An unexpected error occurred"})]})]}),e.jsx(H,{colorScheme:"green",onClick:()=>window.location.reload(),children:"Reload Page"}),e.jsx(d,{fontSize:"sm",color:"gray.600",textAlign:"center",children:"If this error persists, please contact support."})]})}):this.props.children}}function IS({children:t}){const{user:n,loading:r}=vr();return r?e.jsx(Ot,{h:"100vh",children:e.jsx(ut,{size:"xl",color:"green.500"})}):n?e.jsx(e.Fragment,{children:t}):e.jsx(Ec,{to:"/login",replace:!0})}function zS(){const{user:t,loading:n}=vr();return n?e.jsx(Ot,{h:"100vh",children:e.jsx(ut,{size:"xl",color:"green.500"})}):e.jsx(F,{minH:"100vh",bg:"linear-gradient(135deg, #f6f9fc 0%, #e9f4f9 100%)",children:e.jsxs(kc,{children:[e.jsx(St,{path:"/login",element:t?e.jsx(Ec,{to:"/",replace:!0}):e.jsx(Hx,{})}),e.jsx(St,{path:"/*",element:e.jsx(IS,{children:e.jsx(Bx,{children:e.jsx(Ux,{children:e.jsx(kS,{})})})})})]})})}function AS(){return e.jsx(ah,{children:e.jsx(ES,{children:e.jsx(Dx,{children:e.jsx(ch,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsx(zS,{})})})})})}Js.createRoot(document.getElementById("root")).render(e.jsx(jn.StrictMode,{children:e.jsx(AS,{})}));
